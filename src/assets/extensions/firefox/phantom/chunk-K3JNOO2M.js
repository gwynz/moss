import{Ab as Le,Dc as rt,Ec as Ve,Jb as Re,Ka as ve,gb as we,kb as ot,ld as Ne,ob as Pe,pb as Te,qb as Ie,rb as xe,tb as qt,ub as Ee,vd as _e,wd as Ce}from"./chunk-MR3IPRFB.js";import{ia as Ke}from"./chunk-EHX5ZB7Z.js";import{$a as Ot,$b as Mt,H as Dt,I as le,J as O,K as et,L as c,Ya as _,_a as ke,c as Ho,eb as ge,ke as Ft,oc as Ae,oe as he,r as se}from"./chunk-TCQHUZGC.js";import{i as B,l as z}from"./chunk-RV6OM76W.js";import{j as be}from"./chunk-56MPBIEL.js";import{L as Se,q as pe}from"./chunk-OWVMO73E.js";import{D as ut,h as bt,u as ht,w as de,z as E}from"./chunk-SHY2LMMT.js";import{T as me,U as fe,W as ye,a as tt,b as Ct,w as F}from"./chunk-SEWPLVP7.js";import{a as j,c as _t,d as ct,e as J,f as ce,g as ue,h as b}from"./chunk-CNVMLXTH.js";import{c as jo,f as K,h as n,l as Go,m as Buffer,n as i}from"./chunk-JORLGFWZ.js";var Lo=jo(y=>{"use strict";n();i();var Yr=y&&y.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(y,"__esModule",{value:!0});y.map=y.array=y.rustEnum=y.str=y.vecU8=y.tagged=y.vec=y.bool=y.option=y.publicKey=y.i256=y.u256=y.i128=y.u128=y.i64=y.u64=y.struct=y.f64=y.f32=y.i32=y.u32=y.i16=y.u16=y.i8=y.u8=void 0;var x=we(),Jr=se(),$r=Yr(bt()),H=we();Object.defineProperty(y,"u8",{enumerable:!0,get:function(){return H.u8}});Object.defineProperty(y,"i8",{enumerable:!0,get:function(){return H.s8}});Object.defineProperty(y,"u16",{enumerable:!0,get:function(){return H.u16}});Object.defineProperty(y,"i16",{enumerable:!0,get:function(){return H.s16}});Object.defineProperty(y,"u32",{enumerable:!0,get:function(){return H.u32}});Object.defineProperty(y,"i32",{enumerable:!0,get:function(){return H.s32}});Object.defineProperty(y,"f32",{enumerable:!0,get:function(){return H.f32}});Object.defineProperty(y,"f64",{enumerable:!0,get:function(){return H.f64}});Object.defineProperty(y,"struct",{enumerable:!0,get:function(){return H.struct}});var $=class extends x.Layout{constructor(e,o,r){super(e,r),this.blob=(0,x.blob)(e),this.signed=o}decode(e,o=0){let r=new $r.default(this.blob.decode(e,o),10,"le");return this.signed?r.fromTwos(this.span*8).clone():r}encode(e,o,r=0){return this.signed&&(e=e.toTwos(this.span*8)),this.blob.encode(e.toArrayLike(Buffer,"le",this.span),o,r)}};function xo(t){return new $(8,!1,t)}y.u64=xo;function Xr(t){return new $(8,!0,t)}y.i64=Xr;function Zr(t){return new $(16,!1,t)}y.u128=Zr;function ta(t){return new $(16,!0,t)}y.i128=ta;function ea(t){return new $(32,!1,t)}y.u256=ea;function oa(t){return new $(32,!0,t)}y.i256=oa;var Q=class extends x.Layout{constructor(e,o,r,a){super(e.span,a),this.layout=e,this.decoder=o,this.encoder=r}decode(e,o){return this.decoder(this.layout.decode(e,o))}encode(e,o,r){return this.layout.encode(this.encoder(e),o,r)}getSpan(e,o){return this.layout.getSpan(e,o)}};function ra(t){return new Q((0,x.blob)(32),e=>new Jr.PublicKey(e),e=>e.toBuffer(),t)}y.publicKey=ra;var re=class extends x.Layout{constructor(e,o){super(-1,o),this.layout=e,this.discriminator=(0,x.u8)()}encode(e,o,r=0){return e==null?this.discriminator.encode(0,o,r):(this.discriminator.encode(1,o,r),this.layout.encode(e,o,r+1)+1)}decode(e,o=0){let r=this.discriminator.decode(e,o);if(r===0)return null;if(r===1)return this.layout.decode(e,o+1);throw new Error("Invalid option "+this.property)}getSpan(e,o=0){let r=this.discriminator.decode(e,o);if(r===0)return 1;if(r===1)return this.layout.getSpan(e,o+1)+1;throw new Error("Invalid option "+this.property)}};function aa(t,e){return new re(t,e)}y.option=aa;function na(t){return new Q((0,x.u8)(),ia,sa,t)}y.bool=na;function ia(t){if(t===0)return!1;if(t===1)return!0;throw new Error("Invalid bool: "+t)}function sa(t){return t?1:0}function ca(t,e){let o=(0,x.u32)("length"),r=(0,x.struct)([o,(0,x.seq)(t,(0,x.offset)(o,-o.span),"values")]);return new Q(r,({values:a})=>a,a=>({values:a}),e)}y.vec=ca;function ua(t,e,o){let r=(0,x.struct)([xo("tag"),e.replicate("data")]);function a({tag:s,data:u}){if(!s.eq(t))throw new Error("Invalid tag, expected: "+t.toString("hex")+", got: "+s.toString("hex"));return u}return new Q(r,a,s=>({tag:t,data:s}),o)}y.tagged=ua;function Eo(t){let e=(0,x.u32)("length"),o=(0,x.struct)([e,(0,x.blob)((0,x.offset)(e,-e.span),"data")]);return new Q(o,({data:r})=>r,r=>({data:r}),t)}y.vecU8=Eo;function la(t){return new Q(Eo(),e=>e.toString("utf-8"),e=>Buffer.from(e,"utf-8"),t)}y.str=la;function pa(t,e,o){let r=(0,x.union)(o??(0,x.u8)(),e);return t.forEach((a,s)=>r.addVariant(s,a,a.property)),r}y.rustEnum=pa;function da(t,e,o){let r=(0,x.struct)([(0,x.seq)(t,e,"values")]);return new Q(r,({values:a})=>a,a=>({values:a}),o)}y.array=da;var ae=class extends x.Layout{constructor(e,o,r){super(e.span+o.span,r),this.keyLayout=e,this.valueLayout=o}decode(e,o){o=o||0;let r=this.keyLayout.decode(e,o),a=this.valueLayout.decode(e,o+this.keyLayout.getSpan(e,o));return[r,a]}encode(e,o,r){r=r||0;let a=this.keyLayout.encode(e[0],o,r),s=this.valueLayout.encode(e[1],o,r+a);return a+s}getSpan(e,o){return this.keyLayout.getSpan(e,o)+this.valueLayout.getSpan(e,o)}};function ma(t,e,o){let r=(0,x.u32)("length"),a=(0,x.struct)([r,(0,x.seq)(new ae(t,e),(0,x.offset)(r,-r.span),"values")]);return new Q(a,({values:s})=>new Map(s),s=>({values:Array.from(s.entries())}),o)}y.map=ma});n();i();n();i();var vt=K(Ho(),1);var Oe=K(se(),1);var De=(0,vt.struct)([(0,vt.u8)("instruction"),Pe("amount")]);function Me(t,e,o,r,a=[],s=ot){let u=xe([{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:e,isSigner:!1,isWritable:!1}],o,a),d=Buffer.alloc(De.span);return De.encode({instruction:Te.Approve,amount:BigInt(r)},d),new Oe.TransactionInstruction({keys:u,programId:s,data:d})}var Fe=new c.PublicKey("Config1111111111111111111111111111111111111"),Yo="https://docs.solana.com/staking",Jo="https://docs.solana.com/implemented-proposals/staking-rewards",$o={type:"SolanaNative",data:{amount:"0",balance:new tt(0),chain:{id:_.solana.mainnetID,imageUrl:_.solana.iconUrl,name:_.solana.name,symbol:_.solana.tokenSymbol},decimals:9,key:"SolanaNative",logoUri:"https://cdn.jsdelivr.net/gh/solana-labs/token-list@main/assets/mainnet/So11111111111111111111111111111111111111112/logo.png",name:"Solana",symbol:"SOL",tokenAddress:void 0,walletAddress:"",spamStatus:"NOT_VERIFIED"}},qe=new Map([[ke.Solana.Mainnet,$o]]),Xo="https://www.jito.network/blog/lsts-vs-native-assets/",Zo="https://www.jito.network/staking/?mode=unstake",tr="https://help.phantom.com/hc/en-us/articles/29846774040467",er="https://www.jito.network/blog/reward-bearing-vs-rebasing-solana-liquid-staking-tokens/",or="https://www.jito.network/interceptor",rr="solana:101/address:J1toso1uCk3RLmjorhTtrVwY9HJ7X8V9yYac6Y7kGCPn",Ma=5,Fa=3e4;n();i();function lt(t,e){let o=new Ct(t/100),r=new Ct(e/100);return o.minus(o.times(r)).times(100).decimalPlaces(2).toNumber()}n();i();n();i();n();i();var V="staking";var Ut=[V,"stakeAccounts"],Wt=[V,"stakeActivationData"],Bt=[V,"convertStakeAccountList"],zt=[V,"convertStakeTransaction"],Qt=[V,"mintTokenTransaction"],jt="averageValidatorApy",ar="recommendedValidators",nr="signatureStatus",ir="stakeAccountMinBalance",sr="stakeRewardsHistory",cr="stakeApy",ur="validatorInfo",lr="voteAccounts",pr="keybaseUserAvatar",L={keybaseUserAvatar(t){return[V,pr,t]},signatureStatus(t){return[V,nr,t]},stakeAccounts(t,e){return[...Ut,t,e]},stakeAccountMinBalance(){return[V,ir]},stakeActivationData(t){return[...Wt,t]},stakeRewardsHistory(t){return[V,sr,t]},stakeApy(){return[V,cr]},averageValidatorApy(){return[V,jt]},recommendedValidators(){return[V,ar]},validatorInfo(){return[V,ur]},voteAccounts(t){return[V,lr,t]},convertStakeAccountList(t,e){return[...Bt,t,e]},liquidStakingSupportedTokens(){return[V,"liquidStakingSupportedTokens"]},getConvertStakeTransaction(t){return[...zt,t]},getMintTokenTransaction(t){return[...Qt,t]},featureUsed(){return[V,"featureUsed"]}};var wt=t=>()=>{t.invalidateQueries({predicate:e=>{let o=r=>r.every((a,s)=>e.queryKey[s]===a);return o(Ut)||o(Wt)||o(Bt)||o(zt)||o(Qt)}})};n();i();function Gt(t,e=9){return t.match(new RegExp(`^\\d*(\\.\\d{0,${e}})?$`))}n();i();var Ue={type:"fungible",isNativeOfType:"sol",chain:"solana",name:"Solana",symbol:"SOL",iconUrl:"https://cdn.jsdelivr.net/gh/solana-labs/token-list@main/assets/mainnet/So11111111111111111111111111111111111111112/logo.png",decimals:9},mr="stake",We=t=>new Ht(t,mr),Ht=class extends Ke{createStakeAccountAndDelegateStake=e=>{this.analytics.capture("createStakeAccountAndDelegateStake",{data:{...e,...Ue}})};deactivateStake=()=>{this.analytics.capture("deactivateStake",{data:{...Ue}})}};var Yt=ye(Ae,t=>We(t));n();i();var Pt=K(j());n();i();var ze=(t,e)=>t+e[1];function Qe(t){let e=fr(t),o={commissionWeight:.6,epochCreditsWeight:.1,activatedStakeWeight:.3},r=Sr(e.maxEpochCredits,e.maxActivatedStake,o);return t.sort(r)}function fr(t){let e={maxEpochCredits:0,maxActivatedStake:0};for(let o of t){let r=o.epochCredits.reduce(ze,0);e.maxEpochCredits<r&&(e.maxEpochCredits=r),e.maxActivatedStake<o.activatedStake&&(e.maxActivatedStake=o.activatedStake)}return e}function yr(t,e,o,r,a){let s=(100-t)/100,u=e/o,d=Math.log10(r+1)/Math.log10(a+1);return{normalizedCommission:s,normalizedEpochCredits:u,normalizedActivatedStake:d}}function Be(t,e,o,r){let{commission:a,epochCredits:s,activatedStake:u}=t,{commissionWeight:d,epochCreditsWeight:g,activatedStakeWeight:p}=r,{normalizedCommission:f,normalizedEpochCredits:k,normalizedActivatedStake:A}=yr(a,s.reduce(ze,0),e,u,o);return(a>10?.5:1)*(d*f+g*k+p*A)}function Sr(t,e,o){return(r,a)=>{let s=Be(r,t,e,o);return Be(a,t,e,o)-s}}n();i();n();i();var pt=(a=>(a[a.Always=1/0]="Always",a[a.Short=F({days:1})]="Short",a[a.Medium=F({days:3})]="Medium",a[a.Long=F({days:7})]="Long",a))(pt||{}),G=(s=>(s[s.Immediate=0]="Immediate",s[s.Short=F({minutes:1})]="Short",s[s.Medium=F({minutes:2.5})]="Medium",s[s.Long=F({minutes:5})]="Long",s[s.Never=1/0]="Never",s))(G||{});var kr=t=>async()=>(await t.getParsedProgramAccounts(Fe)).reduce((o,r)=>{if(r.account.data.parsed?.type!=="validatorInfo")return o;let a=r.pubkey.toString(),s=r.account.data.parsed.info.keys,[,u]=s;if(!u.signer)return o;let d=u.pubkey,g=r.account.data.parsed.info.configData;return o.push({identityPubkey:d,infoPubkey:a,info:g}),o},[]);function je(t){let e=L.validatorInfo(),o=kr(t);return E({queryKey:e,queryFn:o,placeholderData:[],staleTime:1/0})}n();i();var gr=async t=>{let e=await t.getVoteAccounts();return[...e.current,...e.delinquent].map(o=>({identityPubkey:o.nodePubkey,voteAccountPubkey:o.votePubkey,commission:o.commission,lastVote:o.lastVote,epochCredits:o.epochCredits,activatedStake:o.activatedStake})).filter(o=>o.commission<99)};function Ge(t){let e=L.voteAccounts(t.rpcEndpoint);return E({queryKey:e,queryFn:async()=>gr(t),placeholderData:[],staleTime:1/0})}function at(t){let{isFetched:e,isFetching:o,isPending:r,isSuccess:a,isError:s,dataUpdatedAt:u,errorUpdatedAt:d,error:g,refetch:p,data:f}=Ge(t),k=Math.max(u,d),{isFetched:A,isFetching:v,isPending:S,isSuccess:h,isError:I,dataUpdatedAt:w,errorUpdatedAt:R,error:P,refetch:N,data:D}=je(t),T=Math.max(w,R),M=Math.max(k,T),Y=e&&A,U=o||v,W=a||h,gt=s||I,At=g||P,Fo=r||S,qo=(0,Pt.useCallback)(async()=>{Promise.all([p(),N()])},[N,p]);return{results:(0,Pt.useMemo)(()=>{if(!f)return[];if(!D)return[];let Uo=Qe(f),Wo=new Map(Uo.map(Z=>[Z.identityPubkey,Z])),Bo=new Map(D.map(Z=>[Z.identityPubkey,Z])),ie=[];for(let[Z,zo]of Wo){let Qo=Bo.get(Z);ie.push({...zo,...Qo})}return ie},[D,f]),dataUpdatedAt:M,error:At,isSuccess:W,isError:gt,isFetched:Y,isFetching:U,isPending:Fo,refetch:qo}}n();i();function Jt(t){let e=!!t?.info.meta.lockup,o=new Date((t?.info.meta.lockup?.unixTimestamp??0)*1e3);return e&&o.getTime()>Date.now()}n();i();n();i();n();i();var dt=b.object({apy:b.number()}),$t=b.object({validators:b.array(b.string())}),He=b.object({epoch:b.number(),effectiveSlot:b.number(),amount:b.number(),postBalance:b.number(),percentChange:b.number(),apr:b.number(),timestamp:b.number()}),Ar=b.object({items:b.array(He)}),br=b.object({address:b.string(),chainId:Ot,decimals:b.number(),logoURI:b.string(),name:b.string(),symbol:b.string()}),hr=b.object({caip19:b.string(),metadata:br}),vr=b.object({vote_account:b.string()}),wr=b.object({apy:b.string(),chainId:Ot,convertRatio:b.string(),name:b.string(),stakePoolAddress:b.string(),stakePoolTokenMetadata:hr,validators:b.array(vr)}),Ye=b.record(b.string(),b.array(wr));var Je=new Error("Failed to fetch staking APY");async function $e(){try{let t=await B.api().get("/staking/v1/apy");if(!z(t))throw Je;let e=t.data;return dt.parse(e).apy}catch{throw Je}}var Xt=()=>{let t=L.stakeApy();return E({enabled:!0,queryKey:t,gcTime:pt.Short,staleTime:1/0,async queryFn(){return $e()}})};n();i();var it=K(j());n();i();var Xe={location:0,distance:50,threshold:.2,shouldSort:!0,keys:[{name:"info.name",weight:.5},{name:"info.keybaseUsername",weight:.3},{name:"info.website",weight:.1},{name:"voteAccountPubkey",weight:.1},{name:"identityPubkey",weight:.1}]},Ze={identityPublicKey:"7GkMBmtrTZz8QbjSe1sXvAUtz7Pp42SQxfT5ymmJD4We",voteAccountPublicKey:"J2nUHEAgZFRyuJbFjdqPrAa9gyWDuc7hErtDQHPhsYRp"};n();i();var to=t=>(e,o)=>{let r=t.indexOf(e.voteAccountPubkey),a=t.indexOf(o.voteAccountPubkey);return(r>-1?r:1/0)-(a>-1?a:1/0)};n();i();n();i();var eo=new Error("Failed to fetch recommended staking validators.");async function oo(){try{let t=await B.api().get("/staking/v1/recommended");if(!z(t))throw eo;let e=t.data;return $t.parse(e).validators}catch{throw eo}}var ro=()=>{let t=L.recommendedValidators();return E({enabled:!0,queryKey:t,gcTime:pt.Long,staleTime:1/0,async queryFn(){return oo()}})};function ao(){let{connection:t}=rt(),e=at(t),{results:o=[]}=e,r=ro(),{data:a=null,isFetched:s}=Xt(),u=pe.isFeatureEnabled("kill-phantom-validator"),[d,g]=(0,it.useState)(""),p=me(d),f=(0,it.useMemo)(()=>{let I=o.map(P=>({...P,totalApy:a?lt(a,P?.commission):null})),w=r.data??[];if(w.length===0)return I;let R=I.sort(to(w));return u?R.filter(P=>P.identityPubkey!==Ze.identityPublicKey):R},[o,r.data,a,u]),k=fe(f,p||"",Xe),A=(0,it.useCallback)(()=>{e.isError&&!e.isFetching&&e.refetch(),r.isError&&!r.isFetching&&r.refetch()},[r,e]),v=!e.isFetched||!s||!r.isFetched,S=e.isError||r.isError,h=e.isSuccess;return{isLoading:v,isSuccess:h,hasError:S,searchResults:k,showApy:a!==null,onRefetch:A,searchTerm:d,setSearchTerm:g}}n();i();n();i();var no=({numSignatures:t,lamportsPerSignature:e,lamportBalance:o,rentExemptionMinimum:r})=>{let a=tt(e).multipliedBy(t),s=o.minus(a);return tt.max(s.minus(r),0)};var Pr=({balance:t,rentExemptionMinimum:e})=>{let o=no({numSignatures:11,lamportsPerSignature:Re,lamportBalance:tt(t),rentExemptionMinimum:le(e)});return parseFloat(Dt(o).toFixed(9))};n();i();n();i();var Tr="https://keybase.io/_/api/1.0/user/pic_url.json",Tt=async t=>{let e=await B.get(`${Tr}?username=${encodeURIComponent(t)}`);if(!z(e)||e.data.status?.code!==0)throw new Error("Couldn't fetch keybase user avatar");return e.data.pic_url};var Ir=t=>{let e=L.keybaseUserAvatar(t);return E({enabled:!!t,queryKey:e,async queryFn(){if(!t)throw new Error("Keybase username is required");return Tt(t)},placeholderData:"",staleTime:1/0})};n();i();var xr=t=>async()=>await t.getMinimumBalanceForRentExemption(c.StakeProgram.space);function Er(t){let e=L.stakeAccountMinBalance(),o=xr(t);return E({queryKey:e,queryFn:o,placeholderData:0,staleTime:1/0})}n();i();n();i();var mt=K(j());n();i();n();i();var io=new Error("Failed to fetch Average Validator APY");async function so(){let t=await B.api().get("/staking/v1/avg-validator-apy");if(!z(t))throw io;let e=dt.safeParse(t.data);if(e.success)return e.data.apy;throw io}var co=()=>{let t=L.averageValidatorApy();return E({enabled:!0,queryKey:t,gcTime:F({hours:1}),staleTime:1/0,async queryFn(){return so()}})};n();i();n();i();var uo=new Error("Failed to fetch liquid staking supported tokens"),Lr=new Error("Missing supported tokens in response");async function lo(){try{let t=await B.api().get("/liquid-staking/v1/supported-tokens");if(!z(t))throw uo;let e=Ye.safeParse(t.data.supportedTokens);if(!e.success)throw Lr;return e.data}catch{throw uo}}var po=()=>{let t=L.liquidStakingSupportedTokens();return E({queryKey:t,staleTime:F({minutes:15}),async queryFn(){return await lo()}})};n();i();n();i();var mo={transactionData:void 0,fungibleToStake:void 0,provider:void 0,convert:{validatorVote:"",stakeAccount:"",validatorName:"",eligibleAccountsCount:0},amount:"",navigateTo:null,skipDismissRouting:void 0},nt=he(t=>({...mo,resetStaking:()=>t(mo),setTransactionData:e=>t({transactionData:e}),setFungibleToStake:e=>t({fungibleToStake:e}),setProvider:e=>t({provider:e}),setConvertStakeAccount:e=>t({convert:e}),setAmount:e=>t({amount:e}),setNavigateTo:e=>t({navigateTo:e}),setSkipDismissRouting:e=>t({skipDismissRouting:e})}));var fo=t=>{let e=nt(S=>S.provider),o=nt(S=>S.setProvider),r=nt(S=>S.setFungibleToStake),a=nt(S=>S.setSkipDismissRouting),s=(0,mt.useMemo)(()=>t?ge(Ne(t)):"",[t]),{data:u,isPending:d}=co(),g=u?u/100:null,{data:p={},isPending:f}=po(),k=(0,mt.useMemo)(()=>p[s]??[],[s,p]),A=k?k[0]:void 0,v=(0,mt.useCallback)((S,h)=>{if(!t||!A)return;let I=k.find(w=>w.stakePoolTokenMetadata.caip19===h);if(h){I&&(o(I),r(t),a(S));return}o(A),r(t),a(S)},[t,A,r,o,a,k]);return{isLoading:f||d,isSupported:k.length>0,providers:k,initLiquidStake:v,defaultProvider:A,avgValidatorApy:g,activeProvider:e}};var yo=t=>{let e=qe.get(t);return fo(e)};n();i();var Kr=async(t,e,o,r="confirmed")=>await t.getInflationReward(e,o,r),Vr=async(t,e)=>{let o=[];e.ownerPublicKey&&o.push({memcmp:{offset:44,bytes:e.ownerPublicKey}}),e.voteAccountPublicKey&&o.push({dataSize:200},{memcmp:{offset:124,bytes:e.voteAccountPublicKey}});let r=await t.getParsedProgramAccounts(c.StakeProgram.programId,{filters:o}),a=[];if(e.fetchInflationRewards)try{a=await Kr(t,r.map(({pubkey:s})=>s))}catch(s){let u=s;!u.message.includes("RPC request timed out")&&ut.captureError(u,"staking")}return r.map((s,u)=>({pubkey:s.pubkey.toString(),lamports:s.account.lamports,inflationReward:a[u]?.amount,...s.account.data.parsed}))},Nr=(t,e)=>L.stakeAccounts(t,e),_r=(t,e)=>()=>Vr(t,{ownerPublicKey:e,fetchInflationRewards:!0});function Cr(t,e){let o=Nr(e,t.rpcEndpoint),r=_r(t,e);return E({queryKey:o,queryFn:r,placeholderData:[],staleTime:1/0})}n();i();n();i();var ko=K(j());n();i();var zr=K(j());n();i();n();i();var st=K(j());n();i();var vo=K(j());n();i();n();i();n();i();function It(t,e){for(let o of e)if(o.epoch===t)return o;return null}var go=.09;function Dr(t,e,o){if(t.activationEpoch===t.deactivationEpoch)return{effective:BigInt(0),activating:BigInt(0)};if(e===t.activationEpoch)return{effective:BigInt(0),activating:t.stake};if(e<t.activationEpoch)return{effective:BigInt(0),activating:BigInt(0)};let r=t.activationEpoch,a=It(r,o);if(a!==null){let s=BigInt(0);for(;a!==null;){r++;let u=t.stake-s,d=Number(u)/Number(a.activating),g=Number(a.effective)*go,p=BigInt(Math.max(1,Math.round(d*g)));if(s+=p,s>=t.stake){s=t.stake;break}if(r>=e||r>=t.deactivationEpoch)break;a=It(r,o)}return{effective:s,activating:t.stake-s}}else return{effective:t.stake,activating:BigInt(0)}}function Ao(t,e,o){let{effective:r,activating:a}=Dr(t,e,o);if(e<t.deactivationEpoch)return{effective:r,activating:a,deactivating:BigInt(0)};if(e==t.deactivationEpoch)return{effective:r,activating:BigInt(0),deactivating:r};let s=t.deactivationEpoch,u=It(s,o);if(u!==null){let d=r;for(;u!==null&&(s++,u.deactivating!==BigInt(0));){let g=Number(d)/Number(u.deactivating),p=Number(u.effective)*go,f=BigInt(Math.max(1,Math.round(g*p)));if(d-=f,d<=0){d=BigInt(0);break}if(s>=e)break;u=It(s,o)}return{effective:d,deactivating:d,activating:BigInt(0)}}else return{effective:BigInt(0),activating:BigInt(0),deactivating:BigInt(0)}}n();i();var bo=function(t){if(t.value===null||t.value.data instanceof Buffer)throw new Error("Account not found");let e=[];return t.value.data.parsed.info.forEach(o=>{e.push({epoch:BigInt(o.epoch),effective:BigInt(o.stakeHistory.effective),activating:BigInt(o.stakeHistory.activating),deactivating:BigInt(o.stakeHistory.deactivating)})}),e},ho=function(t){let e=BigInt(0);if(t.value===null||t.value.data instanceof Buffer)throw new Error("Account not found");return t.value.data.parsed.type==="delegated"&&(e=BigInt(1)),{discriminant:e,meta:{rentExemptReserve:BigInt(t.value.data.parsed.info.meta.rentExemptReserve),authorized:{staker:t.value.data.parsed.info.meta.authorized.staker,withdrawer:t.value.data.parsed.info.meta.authorized.withdrawer},lockup:{unixTimestamp:BigInt(t.value.data.parsed.info.meta.lockup.unixTimestamp),epoch:BigInt(t.value.data.parsed.info.meta.lockup.epoch),custodian:t.value.data.parsed.info.meta.lockup.custodian}},stake:{delegation:{voterPubkey:t.value.data.parsed.info.stake.delegation.voterPubkey,stake:BigInt(t.value.data.parsed.info.stake.delegation.stake),activationEpoch:BigInt(t.value.data.parsed.info.stake.delegation.activationEpoch),deactivationEpoch:BigInt(t.value.data.parsed.info.stake.delegation.deactivationEpoch)},creditsObserved:BigInt(t.value.data.parsed.info.stake.creditsObserved)}}};async function Zt(t,e){let o=new c.PublicKey("SysvarStakeHistory1111111111111111111111111"),r=await t.getParsedAccountInfo(e);if(r===null||r.value===null)throw new Error("Account not found");let a=await t.getParsedAccountInfo(o);if(a===null)throw new Error("StakeHistory not found");let s=bo(a),u=await t.getEpochInfo(),d=ho(r),{effective:g,activating:p,deactivating:f}=Ao(d.stake.delegation,BigInt(u.epoch),s),k;f>0?k="deactivating":p>0?k="activating":g>0?k="active":k="inactive";let A=BigInt(r.value.lamports)-g-d.meta.rentExemptReserve;return{state:k,active:Number(g),inactive:Number(A)}}var Or=t=>{let e=[];return t.ownerPublicKey&&e.push({memcmp:{offset:44,bytes:t.ownerPublicKey}}),t.voteAccountPublicKey&&e.push({dataSize:200},{memcmp:{offset:124,bytes:t.voteAccountPublicKey}}),e},wo=async(t,e,o)=>{let r=Or(e),a=await t.getParsedProgramAccounts(c.StakeProgram.programId,{filters:r}),u=(await Promise.allSettled(a.map(p=>Zt(t,p.pubkey)))).map(p=>{if(p.status==="fulfilled")return p.value.state}),g=(await Promise.allSettled(a.map(p=>{let f=p.account.data.parsed.info?.stake.delegation.voter,k=o.get(f),A=k?.info?.keybaseUsername,v=k?.info?.iconUrl;return v?new Promise(S=>S(v)):A?Tt(A):new Promise(S=>S(null))}))).map(p=>{if(p.status==="fulfilled"&&p.value!==null)return p.value});return a.map((p,f)=>({pubkey:p.pubkey.toString(),lamports:p.account.lamports,activationState:u[f],imageUri:g[f],...p.account.data.parsed}))},Po=(t,e)=>L.convertStakeAccountList(t,e),Mr=(t,e,o)=>()=>wo(t,{ownerPublicKey:e},o);function To(t,e,o,r=!0){let a=Po(e,t.rpcEndpoint),s=Mr(t,e,o);return E({queryKey:a,queryFn:s,enabled:!!e&&r,staleTime:1/0})}var iu=(t,e,o,r)=>{let a=ht();return(0,vo.useCallback)(async()=>{r&&await a.prefetchQuery({queryKey:Po(e,t.rpcEndpoint),queryFn:()=>wo(t,{ownerPublicKey:e},o)})},[a,e,t,o,r])};n();i();var ee=(t,e)=>{if(t.type==="initialized")return!1;let o=t?.info?.stake?.delegation?.voter??"",r=Jt(t);return t.activationState==="active"&&e.has(o)&&!r};var Fr=t=>{let{data:[e]}=Se(["kill-liquid-staking-convert"]),o=t?.validators,r=(0,st.useMemo)(()=>o?new Map(o.map(P=>[P.vote_account,P])):new Map,[o]),{connection:a}=rt(),{data:s}=Ft("solana"),{results:u,isFetched:d,isError:g}=at(a),p=(0,st.useMemo)(()=>new Map(u.map(P=>[P.voteAccountPubkey,P])),[u]),{data:f,isLoading:k,isFetching:A,error:v,refetch:S}=To(a,s?.address??"",p,d||g),h=k||A,I=(0,st.useMemo)(()=>h||!f?[]:f.map(P=>qr(P,p,r)).sort((P,N)=>P.lamports>N.lamports?-1:1),[h,f,p,r]),w=(0,st.useMemo)(()=>I.filter(P=>P.eligible),[I]),R=(0,st.useMemo)(()=>I.filter(P=>!P.eligible),[I]);return t?.stakePoolTokenMetadata.caip19===Ce?{hasConvertibleStakeAccounts:!1,eligibleStakeAccounts:[],inelegibleStakeAccounts:[],isLoadingList:!1,error:null,refetch:()=>{}}:{hasConvertibleStakeAccounts:!e&&w.length>0,eligibleStakeAccounts:w,inelegibleStakeAccounts:R,isLoadingList:h,error:v,refetch:S}},qr=(t,e,o)=>{let r=ee(t,o),a=Ur(t,e),s=t.lamports;return{...t,amount:s,eligible:r,title:a,imageUri:t.imageUri}},Ur=(t,e)=>{let o="";if(t.type==="delegated"){let{voter:r}=t.info.stake.delegation,a=e.get(r),s=a?.info?.keybaseUsername;o=a?.info?.name??s??Mt(r)}else t.type==="initialized"&&(o=t.pubkey);return o};n();i();var Wr=K(j());n();i();var Br=K(j());n();i();n();i();var Gr=["liquidStakingSupportedTokens","featureUsed",jt],Hr=t=>{let e=String(t.queryKey[1]);return Gr.includes(e)};n();i();n();i();var kt=K(bt());n();i();var oe=K(Go());var kl=new c.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s");var C=new c.PublicKey("SPoo1Ku8WFXoNDMHPsrGSTSG1Y47rzgn41SLUNakuHy");var gl=oe.Buffer.from("ephemeral"),Io=oe.Buffer.from("transient"),ft=c.LAMPORTS_PER_SOL;n();i();var xt=Object.freeze({DepositStake:{index:9,layout:O.struct([O.u8("instruction")])},DepositSol:{index:14,layout:O.struct([O.u8("instruction"),O.ns64("lamports")])},WithdrawStake:{index:10,layout:O.struct([O.u8("instruction"),O.ns64("poolTokens")])},WithdrawSol:{index:16,layout:O.struct([O.u8("instruction"),O.ns64("poolTokens")])}});function Et(t,e){let o=t.layout.span,r=Buffer.alloc(o),a=Object.assign({instruction:t.index},e);return t.layout.encode(a,r),r}var yt=class{static depositStake(e){let{stakePool:o,validatorList:r,depositAuthority:a,withdrawAuthority:s,depositStake:u,validatorStake:d,reserveStake:g,destinationPoolAccount:p,managerFeeAccount:f,referralPoolAccount:k,poolMint:A,referralAccount:v}=e,S=xt.DepositStake,h=Et(S),I=[{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:g,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:k,isSigner:!1,isWritable:!0},{pubkey:A,isSigner:!1,isWritable:!0},{pubkey:c.SYSVAR_CLOCK_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_STAKE_HISTORY_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:ot,isSigner:!1,isWritable:!1},{pubkey:c.StakeProgram.programId,isSigner:!1,isWritable:!1}];return v&&I.push({pubkey:v,isSigner:!1,isWritable:!1}),new et.TransactionInstruction({programId:C,keys:I,data:h})}static depositSol(e){let{stakePool:o,withdrawAuthority:r,depositAuthority:a,reserveStake:s,fundingAccount:u,destinationPoolAccount:d,managerFeeAccount:g,referralPoolAccount:p,poolMint:f,lamports:k,referralAccount:A}=e,v=xt.DepositSol,S=Et(v,{lamports:k}),h=[{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!0,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:g,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:c.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:ot,isSigner:!1,isWritable:!1}];return a&&h.push({pubkey:a,isSigner:!0,isWritable:!1}),A&&h.push({pubkey:A,isSigner:!1,isWritable:!1}),new et.TransactionInstruction({programId:C,keys:h,data:S})}static withdrawStake(e){let{stakePool:o,validatorList:r,withdrawAuthority:a,validatorStake:s,destinationStake:u,destinationStakeAuthority:d,sourceTransferAuthority:g,sourcePoolAccount:p,managerFeeAccount:f,poolMint:k,poolTokens:A}=e,v=xt.WithdrawStake,S=Et(v,{poolTokens:A}),h=[{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:g,isSigner:!0,isWritable:!1},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:k,isSigner:!1,isWritable:!0},{pubkey:c.SYSVAR_CLOCK_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:ot,isSigner:!1,isWritable:!1},{pubkey:c.StakeProgram.programId,isSigner:!1,isWritable:!1}];return new et.TransactionInstruction({programId:C,keys:h,data:S})}static withdrawSol(e){let{stakePool:o,withdrawAuthority:r,sourceTransferAuthority:a,sourcePoolAccount:s,reserveStake:u,destinationSystemAccount:d,managerFeeAccount:g,solWithdrawAuthority:p,poolMint:f,poolTokens:k}=e,A=xt.WithdrawSol,v=Et(A,{poolTokens:k}),S=[{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:g,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:c.SYSVAR_CLOCK_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_STAKE_HISTORY_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:c.StakeProgram.programId,isSigner:!1,isWritable:!1},{pubkey:ot,isSigner:!1,isWritable:!1}];return p&&S.push({pubkey:p,isSigner:!0,isWritable:!1}),new et.TransactionInstruction({programId:C,keys:S,data:v})}};n();i();var l=K(Lo());var Ro=K(bt());var X=[(0,l.u64)("denominator"),(0,l.u64)("numerator")];var Lt=_t().transform(t=>new Ro.default(t,10)),Rt=_t().transform(t=>new c.PublicKey(t)),fa=ce(["uninitialized","initialized","delegated","rewardsPool"]),ya=J({rentExemptReserve:Lt,authorized:J({staker:Rt,withdrawer:Rt}),lockup:J({unixTimestamp:ct(),epoch:ct(),custodian:Rt})}),Sa=J({meta:ya,stake:J({delegation:J({voter:Rt,stake:Lt,activationEpoch:Lt,deactivationEpoch:Lt,warmupCooldownRate:ct()}),creditsObserved:ct()}).nullish().default(null)}),Ko=J({type:fa,info:ue(Sa)}),Vo=(0,l.struct)([(0,l.u8)("accountType"),(0,l.publicKey)("manager"),(0,l.publicKey)("staker"),(0,l.publicKey)("stakeDepositAuthority"),(0,l.u8)("stakeWithdrawBumpSeed"),(0,l.publicKey)("validatorList"),(0,l.publicKey)("reserveStake"),(0,l.publicKey)("poolMint"),(0,l.publicKey)("managerFeeAccount"),(0,l.publicKey)("tokenProgramId"),(0,l.u64)("totalLamports"),(0,l.u64)("poolTokenSupply"),(0,l.u64)("lastUpdateEpoch"),(0,l.struct)([(0,l.u64)("unixTimestamp"),(0,l.u64)("epoch"),(0,l.publicKey)("custodian")],"lockup"),(0,l.struct)(X,"epochFee"),(0,l.option)((0,l.struct)(X),"nextEpochFee"),(0,l.option)((0,l.publicKey)(),"preferredDepositValidatorVoteAddress"),(0,l.option)((0,l.publicKey)(),"preferredWithdrawValidatorVoteAddress"),(0,l.struct)(X,"stakeDepositFee"),(0,l.struct)(X,"stakeWithdrawalFee"),(0,l.option)((0,l.struct)(X),"nextStakeWithdrawalFee"),(0,l.u8)("stakeReferralFee"),(0,l.option)((0,l.publicKey)(),"solDepositAuthority"),(0,l.struct)(X,"solDepositFee"),(0,l.u8)("solReferralFee"),(0,l.option)((0,l.publicKey)(),"solWithdrawAuthority"),(0,l.struct)(X,"solWithdrawalFee"),(0,l.option)((0,l.struct)(X),"nextSolWithdrawalFee"),(0,l.u64)("lastEpochPoolTokenSupply"),(0,l.u64)("lastEpochTotalLamports")]);var ka=(0,l.struct)([(0,l.u64)("activeStakeLamports"),(0,l.u64)("transientStakeLamports"),(0,l.u64)("lastUpdateEpoch"),(0,l.u64)("transientSeedSuffixStart"),(0,l.u64)("transientSeedSuffixEnd"),(0,l.u8)("status"),(0,l.publicKey)("voteAccountAddress")]),Kt=(0,l.struct)([(0,l.u8)("accountType"),(0,l.u32)("maxValidators"),(0,l.vec)(ka,"validators")]);n();i();var q=K(bt());function No(t){return isNaN(t)?0:Number(t*c.LAMPORTS_PER_SOL)}function Vt(t,e){let o=e.mul(t.totalLamports),r=t.poolTokenSupply;return o.lt(r)?new q.default(0):o.div(r)}async function ne(t,e){let[o]=await c.PublicKey.findProgramAddress([e.toBuffer(),Buffer.from("withdraw")],t);return o}async function Nt(t,e,o,r){let[a]=await c.PublicKey.findProgramAddress([e.toBuffer(),o.toBuffer(),r?new q.default(r).toArrayLike(Buffer,"le",4):Buffer.alloc(0)],t);return a}function St(t){if(typeof t=="number")return Math.abs(t)/c.LAMPORTS_PER_SOL;if(typeof t=="bigint")return Math.abs(Number(t))/c.LAMPORTS_PER_SOL;let e=1;t.isNeg()&&(e=-1);let r=t.abs().toString(10).padStart(10,"0"),a=r.length-9,s=r.slice(0,a)+"."+r.slice(a);return e*parseFloat(s)}async function ga(t,e,o,r){let[a]=await c.PublicKey.findProgramAddress([Io,e.toBuffer(),o.toBuffer(),r.toArrayLike(Buffer,"le",8)],t);return a}function Aa(t,e){return t.poolTokenSupply.isZero()||t.totalLamports.isZero()?e:e.mul(t.poolTokenSupply).div(t.totalLamports)}async function _o(t,e,o,r,a,s){let u=await t.getAccountInfo(e.validatorList),d=Kt.decode(u?.data);if(!d?.validators||d?.validators.length==0)throw new Error("No accounts found");let g=await t.getMinimumBalanceForRentExemption(c.StakeProgram.space),p=new q.default(g+ft),f=[];for(let w of d.validators){if(w.status!==0)continue;let R=await Nt(C,w.voteAccountAddress,o);if(!w.activeStakeLamports.isZero()){let N=e?.preferredWithdrawValidatorVoteAddress?.equals(w.voteAccountAddress);f.push({type:N?"preferred":"active",voteAddress:w.voteAccountAddress,stakeAddress:R,lamports:w.activeStakeLamports})}let P=w.transientStakeLamports.sub(p);if(P.gt(new q.default(0))){let N=await ga(C,w.voteAccountAddress,o,w.transientSeedSuffixStart);f.push({type:"transient",voteAddress:w.voteAccountAddress,stakeAddress:N,lamports:P})}}f=f.sort(a||((w,R)=>R.lamports.sub(w.lamports).toNumber()));let k=await t.getAccountInfo(e.reserveStake),A=new q.default((k?.lamports??0)-g);A.gt(new q.default(0))&&f.push({type:"reserve",stakeAddress:e.reserveStake,lamports:A});let v=[],S=new q.default(r),h=e.stakeWithdrawalFee,I={numerator:h.denominator.sub(h.numerator),denominator:h.denominator};for(let w of["preferred","active","transient","reserve"]){let R=f.filter(P=>P.type==w);for(let{stakeAddress:P,voteAddress:N,lamports:D}of R){if(D.lte(p)&&w=="transient")continue;let T=Aa(e,D);!s&&!I.numerator.isZero()&&(T=T.mul(I.denominator).div(I.numerator));let M=q.default.min(T,S);if(!M.lte(new q.default(0))&&(v.push({stakeAddress:P,voteAddress:N,poolAmount:M}),S=S.sub(M),S.isZero()))break}if(S.isZero())break}if(S.gt(new q.default(0)))throw new Error(`No stake accounts found in this pool with enough balance to withdraw ${St(r)} pool tokens.`);return v}function Co(t,e,o){let r=c.Keypair.generate();return e.push(c.SystemProgram.createAccount({fromPubkey:t,newAccountPubkey:r.publicKey,lamports:o,space:c.StakeProgram.space,programId:c.StakeProgram.programId})),r}async function Do(t,e){let o=await t.getAccountInfo(e);if(!o)throw new Error("Invalid stake pool account");return{pubkey:e,account:{data:Vo.decode(o.data),executable:o.executable,lamports:o.lamports,owner:o.owner}}}async function ba(t,e){let o=(await t.getParsedAccountInfo(e)).value;if(!o||!("parsed"in o.data))throw new Error("Invalid stake account");if(o.data.program!="stake")throw new Error("Not a stake account");return Ko.parse(o.data.parsed)}async function Yl(t,e,o,r,a,s,u,d){let g=await t.getBalance(o,"confirmed");if(g<r)throw new Error(`Not enough SOL to deposit into pool. Maximum deposit amount is ${St(g)} SOL.`);let f=(await Do(t,e)).account.data,k=new c.Keypair,A=[k],v=[];if(v.push(c.SystemProgram.transfer({fromPubkey:o,toPubkey:k.publicKey,lamports:r})),!a){let h=qt(f.poolMint,o);v.push(Ee(o,h,o,f.poolMint)),a=h}let S=await ne(C,e);return v.push(yt.depositSol({stakePool:e,reserveStake:f.reserveStake,fundingAccount:k.publicKey,destinationPoolAccount:a,managerFeeAccount:f.managerFeeAccount,referralPoolAccount:u??a,poolMint:f.poolMint,lamports:r,withdrawAuthority:S,depositAuthority:d,referralAccount:s})),{instructions:v,signers:A}}async function Oo(t,e,o,r,a=!1,s,u,d,g){let p=await Do(t,e),f=new kt.default(No(r));d||(d=qt(p.account.data.poolMint,o));let k=await Ie(t,d);if(k.amount<f.toNumber())throw new Error(`Not enough token balance to withdraw ${St(f)} pool tokens.
          Maximum withdraw amount is ${St(k.amount)} pool tokens.`);let A=await t.getMinimumBalanceForRentExemption(c.StakeProgram.space),v=await ne(C,e),S=null;u&&(S=await ba(t,u));let h=[];if(a)h.push({stakeAddress:p.account.data.reserveStake,voteAddress:void 0,poolAmount:f});else if(S&&S?.type=="delegated"){let T=S.info?.stake?.delegation.voter;if(!T)throw new Error(`Invalid stake reciever ${u} delegation`);let M=await t.getAccountInfo(p.account.data.validatorList),U=Kt.decode(M?.data).validators.find(W=>W.voteAccountAddress.equals(T));if(s&&s!==T)throw new Error(`Provided withdrawal vote account ${s} does not match delegation on stake receiver account ${T},
        remove this flag or provide a different stake account delegated to ${s}`);if(U){let W=await Nt(C,T,e),gt=await t.getAccountInfo(W);if(!gt)throw new Error("Preferred withdraw valdator's stake account is invalid");let At=Vt(p.account.data,new kt.default(gt.lamports-ft-A));if(At.lt(f))throw new Error(`Not enough lamports available for withdrawal from ${W},
              ${f} asked, ${At} available.`);h.push({stakeAddress:W,voteAddress:T,poolAmount:f})}else throw new Error(`Provided stake account is delegated to a vote account ${T} which does not exist in the stake pool`)}else if(s){let T=await Nt(C,s,e),M=await t.getAccountInfo(T);if(!M)throw new Error("Invalid Stake Account");let Y=new kt.default(M.lamports-ft-A);if(Y.lt(new kt.default(0)))throw new Error("Invalid Stake Account");let U=Vt(p.account.data,Y);if(U.lt(f))throw new Error(`Not enough lamports available for withdrawal from ${T},
            ${f} asked, ${U} available.`);h.push({stakeAddress:T,voteAddress:s,poolAmount:f})}else{let T=await _o(t,p.account.data,e,f,g,d.equals(p.account.data.managerFeeAccount));h.push(...T)}let I=[],w=c.Keypair.generate(),R=[w];I.push(Me(d,w.publicKey,o,f.toNumber()));let P=0,N=5,D=0;for(let T of h){if(D>N)break;let Y=`Withdrawing \u25CE${Vt(p.account.data,T.poolAmount)},
        from stake account ${T.stakeAddress?.toBase58()}`;T.voteAddress&&(Y=`${Y}, delegated to ${T.voteAddress?.toBase58()}`);let U;if(!u||S&&S.type==="delegated"){let W=Co(o,I,A);R.push(W),P+=A,U=W.publicKey}else U=u;I.push(yt.withdrawStake({stakePool:e,validatorList:p.account.data.validatorList,validatorStake:T.stakeAddress,destinationStake:U,destinationStakeAuthority:o,sourceTransferAuthority:w.publicKey,sourcePoolAccount:d,managerFeeAccount:p.account.data.managerFeeAccount,poolMint:p.account.data.poolMint,poolTokens:T.poolAmount.toNumber(),withdrawAuthority:v})),D++}return u&&S&&S.type==="delegated"&&R.forEach(T=>{I.concat(c.StakeProgram.merge({stakePubkey:u,sourceStakePubKey:T.publicKey,authorizedPubkey:o}).instructions)}),{instructions:I,signers:R,stakeReceiver:u,totalRentFreeBalances:P}}function ha(t){let{t:e}=be(),o=ht(),r=Yt(),{mutateAsync:a}=Ve(t);return de({mutationFn:async({stakePoolAddress:d,amount:g,accountIdentifier:p,senderAddress:f})=>{let{networkID:k,address:A}=f,v=new c.PublicKey(A),S=new c.PublicKey(A),{instructions:h,signers:I}=await Oo(t,d,v,g,!1).catch(D=>{throw ut.captureError(D,"staking"),D}),w=new et.Transaction;w.add(...h);let R=await ve(w,{connection:t}),P={ownerAddress:A??"",networkID:k,data:{signature:""},type:"withdrawStake",display:{summary:{topLeft:{text:e("transactionsPendingWithdrawingStake")}}}};r.approved({chainType:"solana",chainName:"solana",networkId:_.getSolanaNetworkIDValue(k),type:"withdraw-liquid-stake"});let N=await a({accountIdentifier:p,feePayer:S,transaction:R,pendingTransactionInput:P,opts:{additionalSignerAccounts:I}});return r.submittedTransaction(N,{chainType:"solana",chainName:"solana",networkId:_.getSolanaNetworkIDValue(k),method:"signAndSendTransaction"}),{networkID:k,id:N}},onSuccess:d=>{Le({connection:t,signature:d.id}).then(()=>{r.transactionStatus(d.id,{chainType:"solana",chainName:"solana",networkId:_.getSolanaNetworkIDValue(d.networkID),status:{type:"confirmed"}}),wt(o)()}).catch(g=>{r.transactionStatus(d.id,{chainType:"solana",chainName:"solana",networkId:_.getSolanaNetworkIDValue(d.networkID),status:{type:"error"}}),ut.captureError(g,"staking")})}})}n();i();n();i();var kp={name:"Jito",stakePoolAddress:"Jito4APyf642JPZPx3hGc6WWJ8zPKtRbRs4P815Awbb",apy:"0.0760131222374123",convertRatio:"1.1067926864808721",stakePoolTokenMetadata:{metadata:{address:"J1toso1uCk3RLmjorhTtrVwY9HJ7X8V9yYac6Y7kGCPn",name:"Jito Staked SOL",symbol:"JitoSOL",decimals:9,logoURI:"https://storage.googleapis.com/token-metadata/JitoSOL-256.png",chainId:"solana:101"},caip19:"solana:101/address:J1toso1uCk3RLmjorhTtrVwY9HJ7X8V9yYac6Y7kGCPn"},chainId:"solana:101",validators:[{vote_account:"validator"}]},Mo={name:"Phantom Staked SOL",stakePoolAddress:"pSPcvR8GmG9aKDUbn9nbKYjkxt9hxMS7kF1qqKJaPqJ",apy:"0.0950000000000000",convertRatio:"1.0500000000000000",stakePoolTokenMetadata:{metadata:{address:_e,name:"Phantom Staked SOL",symbol:"PSOL",decimals:9,logoURI:"https://storage.googleapis.com/token-metadata/PSOL-256.png",chainId:"solana:101"},caip19:"solana:101/address:pSo1f9nQXWgXibFtKf7NWYxb5enAM4qfP6UJSiXRQfL"},chainId:"solana:101",validators:[{vote_account:"validator"}]};function va(t){return t?t.stakePoolTokenMetadata.caip19===Mo.stakePoolTokenMetadata.caip19:!1}export{Yo as a,Jo as b,Xo as c,Zo as d,tr as e,er as f,or as g,rr as h,Ma as i,Fa as j,lt as k,L as l,wt as m,Gt as n,Yt as o,nt as p,Hr as q,pt as r,at as s,Jt as t,Lo as u,Yl as v,ha as w,va as x,Xt as y,ao as z,Pr as A,Ir as B,Er as C,po as D,fo as E,yo as F,Cr as G,Zt as H,iu as I,Fr as J};
//# sourceMappingURL=chunk-K3JNOO2M.js.map
