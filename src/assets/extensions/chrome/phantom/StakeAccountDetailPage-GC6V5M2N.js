import{a as _t}from"./chunk-T2KHQDBL.js";import"./chunk-KRL4NDP5.js";import"./chunk-DBX43DCB.js";import{a as Ht}from"./chunk-62SZ2XSE.js";import"./chunk-YTLZ2SGV.js";import"./chunk-IRPDX252.js";import{b as Ot,d as g}from"./chunk-U5BHRVQL.js";import"./chunk-5S2LR6TU.js";import"./chunk-UN5DVVHZ.js";import"./chunk-K3AOJOH2.js";import{o as Mt,p as Ft}from"./chunk-QNVGN5HE.js";import"./chunk-KYC3TN2Q.js";import{b as zt}from"./chunk-KECH4XEC.js";import"./chunk-RKISZW47.js";import"./chunk-OP3E2FEL.js";import"./chunk-D6ZWMAKN.js";import"./chunk-OHN4H3IY.js";import"./chunk-YEWLBR7H.js";import"./chunk-HAR363KY.js";import"./chunk-YE5I2OIJ.js";import"./chunk-XCWTSWVJ.js";import"./chunk-OEKZJ4Z7.js";import{b as Et,g as W}from"./chunk-IAL2BZAA.js";import"./chunk-M6UNEOVM.js";import"./chunk-Y7HDHZJX.js";import"./chunk-DQLUBVF4.js";import"./chunk-RHCYAVA3.js";import"./chunk-3ZRYSYYB.js";import"./chunk-IP6N33CZ.js";import"./chunk-S2IXR5HZ.js";import"./chunk-GA7OWDUC.js";import"./chunk-EOII3ZM4.js";import"./chunk-4AQPJCXC.js";import"./chunk-NFWY65KR.js";import"./chunk-KUVQSLSD.js";import"./chunk-IEGIKGVV.js";import{a as Nt}from"./chunk-H3HVEJML.js";import{_a as i}from"./chunk-NDIBTKLE.js";import{c as s}from"./chunk-6JMEWALM.js";import"./chunk-5NEPC5CX.js";import"./chunk-JQE54VLJ.js";import"./chunk-KWNEQJE2.js";import{B as bt,I as Dt,J as Pt,T as Tt,U as Rt,Y as Bt,aa as Ut,ba as Wt,da as It,pa as Vt,qa as Lt,y as $}from"./chunk-HGG2EQ5O.js";import"./chunk-PQUTVVRL.js";import{C as ht,Oa as xt}from"./chunk-IOXJCRJI.js";import{b as vt}from"./chunk-XGLSOW44.js";import"./chunk-56GZZQJU.js";import"./chunk-QLEUWUCH.js";import"./chunk-ZGQB4B3Z.js";import"./chunk-OJPBMZQC.js";import{fa as At,ga as gt}from"./chunk-FLYQWZR6.js";import"./chunk-UPPQC44E.js";import"./chunk-CYENH7PC.js";import{B as K,Fb as mt}from"./chunk-F236ETGH.js";import{Pc as wt,Va as Ct,Wa as ft,vd as yt}from"./chunk-QF7OLC35.js";import{D as lt,Kb as dt,ec as kt,uf as Q}from"./chunk-LPV5DSV2.js";import"./chunk-NEE4FZIK.js";import"./chunk-BYU664DD.js";import{Ba as c,J as ut,L as ne,La as pt,M as U,Sa as St,Y as f,hb as d}from"./chunk-JYKVQ4NC.js";import"./chunk-U7OZEJ4F.js";import"./chunk-ZRGHR2IN.js";import{a as v,g as D,i as R,n as B}from"./chunk-TSHWMJEM.js";R();B();var m=D(ne(),1);R();B();var k=D(U(),1),re=s.div`
  display: grid;
  grid-template-columns: 100%;
  grid-template-rows: 47px auto;
  align-items: center;
  justify-content: flex-start;
  background: ${c.colors.legacy.elementBase};
  width: 328px;
  border-radius: 6px;
  margin-top: 24px;
`,ce=s.div`
  display: grid;
  gap: 10px;
  grid-template-columns: 33px 1fr auto;
  align-items: center;
  padding: 9px 14px;
  border-bottom: 1px solid ${c.colors.legacy.areaBase};
`,se=s(Ot)``,le=s.section`
  padding: 14px;
`,ue=s.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  height: 30px;
  align-items: center;
`,de=s(i)`
  color: ${n=>n.activationState==="active"?c.colors.legacy.spotPositive:n.activationState==="inactive"?c.colors.legacy.spotNegative:n.activationState==="activating"?c.colors.brand.yellowMoon:n.activationState==="deactivating"?c.colors.brand.yellowMoon:c.colors.legacy.textDiminished};
`,ke=s(Ht).attrs(()=>({tooltipAlignment:"bottomCenter",iconSize:12,lineHeight:17,fontWeight:400,fontSize:14,noWrap:!0}))``,q=v(n=>{let{t:e}=f(),{data:u}=Bt(n.validatorKeybaseUsername),p=n.validatorName??n.validatorKeybaseUsername??n.voteAccountPubkey??n.stakeAccountPubkey;return(0,k.jsxs)(re,{children:[(0,k.jsxs)(ce,{children:[(0,k.jsx)(se,{width:28,iconUrl:n.validatorIconUrl??u}),(0,k.jsx)(i,{textAlign:"left",weight:600,size:16,noWrap:!0,children:p}),(0,k.jsx)(de,{activationState:n.status,textAlign:"right",weight:400,size:14,noWrap:!0,textTransform:"capitalize",children:n.status??""})]}),(0,k.jsx)(le,{children:Object.entries(n.data).map(([r,a])=>(0,k.jsxs)(ue,{onClick:a.onClick,children:[(0,k.jsxs)(ke,{info:a.tooltip?(0,k.jsx)(Ft,{children:(0,k.jsx)(Mt,{children:a.tooltip})}):null,children:[r==="Stake Account"?e("stakeAccountCardStakeAccount"):"",r==="Balance"?e("stakeAccountCardBalance"):"",r==="Rent Reserve"?e("stakeAccountCardRentReserve"):"",r==="Active Stake"?e("stakeAccountCardActiveStake"):"",r==="Lockup"?e("stakeAccountCardLockup"):"",r==="Rewards"?e("stakeAccountCardRewards"):""]}),a.node]},r))})]})},"StakeAccountCard");var t=D(U(),1),I=s.div`
  position: relative;
  height: 100%;
  display: flex;
  flex-direction: column;
  overflow-y: scroll;
`,V=s.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  flex-grow: 1;
`,Y=s.a.attrs({target:"_blank",rel:"noopener noreferrer"})`
  color: ${c.colors.legacy.spotBase};
  text-decoration: none;
  cursor: pointer;
`,P=s.section`
  display: flex;
  gap: 15px;
`,Kt=s.section`
  display: flex;
  gap: 15px;
  margin-top: 24px;
  flex-direction: column;
`,me=s.div`
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: flex-end;
`,pe=5e3,Se=v(n=>{let{t:e}=f(),{showStakeAccountDeactivateStakeStatusModal:u,showStakeAccountDelegateStakeStatusModal:p,showStakeAccountWithdrawStakeStatusModal:r,closeAllModals:a}=zt(),{data:A}=mt(),C=(0,m.useMemo)(()=>A?.addresses.find(b=>dt.isSolanaNetworkID(b.networkID)),[A]),{solanaPublicKey:T,connection:w,networkID:j}=(0,m.useMemo)(()=>{let b=C?.address??"",st=C?.networkID,ae=Ct(ft(st));return{solanaPublicKey:b,connection:ae,networkID:st}},[C]),L=It(wt),qt=kt(lt.Solana),{data:Yt}=ht({query:{data:qt}}),{data:G}=xt(),N=Yt?.usd,y=Ut(w,T),o=y.data?.find(b=>b.pubkey===n.stakeAccountPubkey),z=o?.info.meta.authorized.staker,jt=o?.lamports??0,J=parseFloat(o?.info.meta.rentExemptReserve??"0"),Gt=!!o?.inflationReward,{data:Jt=J}=yt(C),E=!!(G&&new ut(G.totalQuantityString).gt(Jt+pe)),X=Vt(),l=Wt(w,o?.pubkey).data,Xt=l?.active??0,Zt=l?.inactive??0,O=jt-J-Xt,Z=o?.info.stake?.delegation.voter,te=ve(),S=Z?te.get(Z):void 0,tt=new Date((o?.info.meta.lockup?.unixTimestamp??0)*1e3),M=Rt(o),F=Pt(l?.state)&&E,H=Dt(l?.state)&&!M&&E,h=L&&H,x=L&&F,et=L&&l?.state==="deactivating",{data:ee}=At(j),{data:ot}=gt(j,o?.pubkey??""),{pushDetailView:at}=Et(),oe=(0,m.useCallback)(()=>{at((0,t.jsx)(_t,{}))},[at]),nt=Lt(oe),it=(0,m.useCallback)(()=>{if(!o)throw new Error("Stake account not found");nt({stakeAccount:o,validatorName:S?.info?.name??"",activationState:l?.state})},[nt,o,S,l]),_=[{key:"viewOnExplorer",label:e("stakeAccountViewViewOnExplorer",{explorer:ee}),onClick:v(()=>{ot&&self.open(ot,"_blank")},"onClick")}];o&&(S&&(l?.state==="inactive"||l?.state==="deactivating")&&_.push({key:"restake",label:e("stakeAccountViewRestake"),onClick:v(()=>{p({stakeAccountPubkey:o.pubkey,voteAccountPubkey:S?.voteAccountPubkey,lamports:l.inactive,onClose:a})},"onClick")}),O>0&&O>Zt&&_.push({key:"withdrawUnstakedSOL",label:e("stakeAccountViewWithdrawUnstakedSOL"),onClick:v(()=>{r({stakeAccountPubkey:o.pubkey,amount:O,usdPerSol:N,onClose:a})},"onClick")}));let rt=(0,m.useCallback)(()=>{!o||!z||u({stakeAccountPubkey:o.pubkey,stakeAuthorityPubkey:z,onClose:a})},[o,z,u,a]),ct=(0,m.useCallback)(()=>{o&&r({stakeAccountPubkey:o.pubkey,amount:o.lamports,usdPerSol:N,onClose:a})},[o,r,N,a]);return y.isPending?(0,t.jsx)(I,{children:(0,t.jsx)(Nt,{})}):y.isError?(0,t.jsxs)(I,{children:[(0,t.jsx)(W,{children:e("stakeAccountViewPrimaryText")}),(0,t.jsx)(V,{children:(0,t.jsx)(i,{size:16,color:c.colors.legacy.textDiminished,lineHeight:20,children:y.error?.message??e("stakeAccountViewError")})}),(0,t.jsx)(P,{children:(0,t.jsx)(d,{onClick:a,children:e("commandClose")})})]}):y.isSuccess&&o?(0,t.jsxs)(I,{canConvertStake:h,canConvertDelayedStake:x,children:[(0,t.jsx)(W,{items:_,children:e("stakeAccountViewPrimaryText")}),S?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(V,{children:[(0,t.jsx)(Qt,{canConvertStake:h,canConvertDelayedStake:x,hasValidator:!!S,durationUntilEpochEnds:X,isDeactivating:et}),(0,t.jsx)(q,{stakeAccountPubkey:o.pubkey,voteAccountPubkey:S?.voteAccountPubkey,validatorName:S?.info?.name,validatorKeybaseUsername:S?.info?.keybaseUsername,validatorIconUrl:S?.info?.iconUrl,status:l?.state,data:{"Stake Account":{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:K(o.pubkey)})},Balance:{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:(0,t.jsx)(g,{children:o.lamports})})},"Rent Reserve":{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:(0,t.jsx)(g,{children:o.info.meta.rentExemptReserve})})},"Active Stake":{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:(0,t.jsx)(g,{children:l?.active})})},Lockup:{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:M?Q(tt):"\u2013"})},Rewards:Gt?{node:(0,t.jsx)(me,{children:(0,t.jsxs)(i,{color:c.colors.legacy.spotPositive,textAlign:"right",weight:500,size:14,noWrap:!0,children:["+",(0,t.jsx)(g,{children:o?.inflationReward})]})}),tooltip:e("stakeAccountCardRewardsTooltip")}:{node:(0,t.jsx)(i,{color:c.colors.legacy.textDiminished,textAlign:"right",weight:500,size:14,noWrap:!0,children:"\u2013"})}}}),E?null:(0,t.jsx)(pt,{marginY:"base",children:(0,t.jsx)(St,{color:"spotNegative",children:e("stakeAccountInsufficientFunds")})})]}),(0,t.jsx)($t,{canConvertStake:h,canUnstake:F,canWithdrawStake:H,canConvertDelayedStake:x,onClose:a,onUnstake:rt,onWithdrawStake:ct,onConvertStake:it})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(V,{children:[(0,t.jsx)(Qt,{canConvertStake:h,canConvertDelayedStake:x,hasValidator:!!S,durationUntilEpochEnds:X,isDeactivating:et}),(0,t.jsx)(q,{stakeAccountPubkey:o.pubkey,status:l?.state,data:{"Stake Account":{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:K(o.pubkey)})},Balance:{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:(0,t.jsx)(g,{children:o.lamports})})},"Rent Reserve":{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:(0,t.jsx)(g,{children:o.info.meta.rentExemptReserve})})},"Active Stake":{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:(0,t.jsx)(g,{children:l?.active})})},Lockup:{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:M?Q(tt):"\u2013"})}}})]}),(0,t.jsx)($t,{canUnstake:F,canWithdrawStake:H,canConvertStake:h,canConvertDelayedStake:x,onClose:a,onUnstake:rt,onWithdrawStake:ct,onConvertStake:it})]})]}):(0,t.jsxs)(I,{children:[(0,t.jsx)(W,{children:e("stakeAccountViewPrimaryText")}),(0,t.jsx)(V,{children:(0,t.jsx)(i,{size:16,color:c.colors.legacy.textDiminished,lineHeight:20,children:e("stakeAccountViewStakeNotFound")})}),(0,t.jsx)(P,{children:(0,t.jsx)(d,{onClick:a,children:e("commandClose")})})]})},"StakeAccountDetailPage"),oo=Se,Qt=v(({canConvertStake:n,canConvertDelayedStake:e,isDeactivating:u,hasValidator:p,durationUntilEpochEnds:r})=>{let{t:a}=f(),A=(0,m.useMemo)(()=>n?(0,t.jsxs)(t.Fragment,{children:[a("stakeAccountViewStakeInactiveToPSOL.part1")," ",(0,t.jsx)(Y,{href:bt,children:a("stakeAccountViewStakeInactiveToPSOL.part2")})]}):u?a("stakeAccountViewStakeDeactivatingToPSOL",{durationUntilEpochEnds:r}):e?a("convertToPSOLDelayDisclaimer",{durationUntilEpochEnds:r}):p?(0,t.jsxs)(vt,{i18nKey:"stakeAccountViewSOLCurrentlyStakedInterpolated",children:["Your SOL is currently staked with a validator. You'll need to unstake to ",(0,t.jsx)("br",{}),"access these funds. ",(0,t.jsx)(Y,{href:$,children:"Learn more"})]}):(0,t.jsxs)(t.Fragment,{children:[a("stakeAccountViewStakeInactive.part1")," ",(0,t.jsx)(Y,{href:$,children:a("stakeAccountViewStakeInactive.part2")})]}),[n,e,u,p,r,a]);return(0,t.jsx)(i,{size:16,color:c.colors.legacy.textDiminished,lineHeight:20,children:A})},"StakeDescription"),$t=v(n=>{let{t:e}=f(),{canUnstake:u,canWithdrawStake:p,canConvertStake:r,canConvertDelayedStake:a,onClose:A,onUnstake:C,onWithdrawStake:T,onConvertStake:w}=n;return r?(0,t.jsxs)(Kt,{children:[(0,t.jsx)(d,{background:"spot",onClick:w,children:e("convertToPhantomLST")}),(0,t.jsxs)(P,{children:[(0,t.jsx)(d,{onClick:A,children:e("commandClose")}),(0,t.jsx)(d,{onClick:T,children:e("stakeAccountViewWithdrawStake")})]})]}):a?(0,t.jsxs)(Kt,{children:[(0,t.jsx)(d,{background:"spot",onClick:w,children:e("convertToPhantomLST")}),(0,t.jsxs)(P,{children:[(0,t.jsx)(d,{onClick:A,children:e("commandClose")}),(0,t.jsx)(d,{onClick:C,children:e("stakeAccountViewActionButtonUnstake")})]})]}):(0,t.jsxs)(P,{children:[(0,t.jsx)(d,{onClick:A,children:e("commandClose")}),p&&(0,t.jsx)(d,{onClick:T,children:e("stakeAccountViewWithdrawStake")}),u&&(0,t.jsx)(d,{background:"spot",onClick:C,children:e("stakeAccountViewActionButtonUnstake")})]})},"StakeActions"),ve=v(()=>{let n=Tt(),e=n.results??[],u=(0,m.useRef)(e);return u.current=e,(0,m.useMemo)(()=>new Map(u.current.map(p=>[p.voteAccountPubkey,p])),[n.dataUpdatedAt])},"useValidatorsByVoteAccountPubkey");export{Se as StakeAccountDetailPage,oo as default};
//# sourceMappingURL=StakeAccountDetailPage-GC6V5M2N.js.map
