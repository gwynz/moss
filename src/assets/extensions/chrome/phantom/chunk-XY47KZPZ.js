import{da as Q}from"./chunk-KWNEQJE2.js";import{$ as L,H as G,W as O,X as H,qa as P}from"./chunk-IOXJCRJI.js";import{Fb as F,i as S,wc as M}from"./chunk-F236ETGH.js";import{Ab as N,Hd as V,Ra as q,Wc as v,Xc as K,rc as D,sc as _,sd as U,zb as B}from"./chunk-QF7OLC35.js";import{Ad as A,Hc as g,Kb as x,Kc as b,Qb as R,cd as w,dd as h,jd as I,wd as k}from"./chunk-LPV5DSV2.js";import{L as W}from"./chunk-JYKVQ4NC.js";import{a as i,g as J,i as c,n as u}from"./chunk-TSHWMJEM.js";c();u();var Z="fungible-transfer-tx",$=h({seconds:30});function de(e){let n=e?.fungibleKey,r=e?.encodedCaip19?R(e?.encodedCaip19):void 0,s=r?[r]:void 0,{fungible:o}=P({key:n,fungibleAddresses:s,splTokenAccount:e?.splTokenAccount}),C=L(e?.sendFormValues?.recipient,o?.data.chain.id)??"",t=e?.sendSessionId??"",{chain:d,walletAddress:l}=o?.data??{},{data:m}=M({address:l,networkID:d?.id}),{data:f}=H(m),{data:p}=G({networkID:d?.id,enableFallback:!0}),a=ee(d?.id,p,f,m),E=a?.sendContextRequired?a.sendContext:void 0,T=e?.sendFormValues;return A({staleTime:$,enabled:!!o&&!!e&&!!a,queryKey:U.transferTransaction({fungibleKey:n,fungibleSendFormValues:T,sendSessionId:t,sendContext:E}),async queryFn(){if(!o||!T||!a)throw new Error("Missing required data to construct fungible transfer transaction");try{return await V(o,{...T,recipient:C},E)}catch(y){if(w(y)){let z=y.response?.status;v(y,z,Z)}}throw new Error("Failed to create transfer transaction")}})}i(de,"useTransferTransaction");function ee(e,n,r,s){if(e)return x.isBitcoinNetworkID(e)?!n||!r||!s?void 0:{sendContextRequired:!0,sendContext:{transactionSpeedsToUnitCost:n,utxoState:r,chainAddress:s}}:{sendContextRequired:!1}}i(ee,"createSendContext");c();u();var j=J(W());c();u();var X=i(()=>{let{setRetryArgs:e}=Q();return n=>{if(n instanceof N){let{successfulTxIds:r}=n,[s,o]=r;e({type:K.BRC20,commitTxId:s,revealTxId:o})}}},"useHandleRetryableTransactionError");function Me(){let e=I(),{data:n}=F({select:(0,j.useCallback)(t=>t.identifier,[])}),r=X(),s=O(),o=S();return k({mutationFn:i(async({multichainTransaction:t,pendingTransactionInput:d,senderAddress:l,gasEstimation:m})=>{if(!n)throw new Error("No account identifier found");let{networkID:f}=t,p=await q.get(f).onBeforeSend({multichainTransaction:t,gasEstimation:m}),a=await _({accountIdentifier:n,accountSigner:o,multichainTransaction:p,networkID:f,pendingTransactionInput:d,senderAddress:l,storage:e,utxoManager:s});return D(f,a)},"mutationFn"),onError(t){t instanceof Error&&(b.captureError(t,g.Fungibles),t instanceof B&&r(t))}})}i(Me,"useTransferFungible");export{de as a,Me as b};
//# sourceMappingURL=chunk-XY47KZPZ.js.map
