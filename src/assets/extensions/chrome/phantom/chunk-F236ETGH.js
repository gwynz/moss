import{$a as tr,A as K,Ab as tT,Ad as Tr,Bc as Ht,C as pu,D as tn,Db as Ew,Dc as fr,Df as Vw,Eb as Sr,Ec as qa,Ef as W0,F as uw,Fd as Xn,Fe as Yl,Ff as qw,Gb as jl,Gc as oe,Gd as za,Gf as $0,Hc as Y,Hf as Hw,Ib as _w,If as jw,Jb as j0,Jf as Jl,Kb as be,Kc as J,Kf as zw,M as wr,Mf as Ar,Nd as Ow,Nf as Fw,Od as Kw,Pd as Rw,Qc as z0,Qd as Uw,Rb as Mw,Rd as Nw,Sc as Ha,T as lw,Tc as $l,U as Yn,V as Jn,Wa as Da,Wc as Pw,Xd as Lw,Ya as dw,Yd as Gl,Za as H0,_a as jr,_c as Mt,a as Jv,ab as Ul,bb as zs,bd as ja,c as Xv,cb as hw,cc as Iw,ce as Zl,d as $I,db as D,dc as Va,dd as ts,eb as pw,ec as Tw,ef as Dw,f as ew,fb as mw,fd as Cw,g as ZI,gb as gw,h as tw,hb as JI,i as rw,ib as es,ic as Bw,id as gu,jb as yw,jc as zl,k as hu,kb as bw,l as nw,le as zr,m as q0,mb as XI,mc as Jt,n as ow,ne as rs,o as Te,ob as wo,oc as Fl,oe as F0,p as ve,pe as rT,q as iw,qb as vw,qc as kw,r as sw,rb as pt,rc as Fs,s as aw,sb as Nl,t as cw,tb as xr,u as vi,ub as Ll,uc as ut,ud as rr,va as fw,vb as ww,wb as Dl,wd as Re,xb as QI,yb as eT,z as Na}from"./chunk-LPV5DSV2.js";import{b as Qv,c as GI,e as YI,g as La,m as mu,o as xw,q as Vl,r as ql,s as Hl,w as Sw,x as Aw}from"./chunk-NEE4FZIK.js";import{L as qt,M as Wl,T as xo,Y as ns,a as er,b as Ua,e as Yv,g as Hr,w as v,ya as nT}from"./chunk-JYKVQ4NC.js";import{a as i,d as ae,e as FI,g as me,i as m,j as k,k as WI,l as vo,m as Buffer,n as g}from"./chunk-TSHWMJEM.js";var Qa=ae(lf=>{"use strict";m();g();Object.defineProperty(lf,"__esModule",{value:!0});lf.AppAuthError=void 0;var IT=function(){function e(t,r){this.message=t,this.extras=r}return i(e,"AppAuthError"),e}();lf.AppAuthError=IT});var ff=ae(Ao=>{"use strict";m();g();Object.defineProperty(Ao,"__esModule",{value:!0});Ao.DefaultCrypto=Ao.textEncodeLite=Ao.urlSafe=Ao.bufferToString=void 0;var TT=WI(),ux=Qa(),lx=typeof self<"u"&&!!self.crypto,BT=lx&&!!self.crypto.subtle,rp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function fx(e){for(var t=[],r=0;r<e.byteLength;r+=1){var n=e[r]%rp.length;t.push(rp[n])}return t.join("")}i(fx,"bufferToString");Ao.bufferToString=fx;function dx(e){var t=TT.fromByteArray(new Uint8Array(e));return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}i(dx,"urlSafe");Ao.urlSafe=dx;function hx(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return r}i(hx,"textEncodeLite");Ao.textEncodeLite=hx;var kT=function(){function e(){}return i(e,"DefaultCrypto"),e.prototype.generateRandom=function(t){var r=new Uint8Array(t);if(lx)self.crypto.getRandomValues(r);else for(var n=0;n<t;n+=1)r[n]=Math.random()*rp.length|0;return fx(r)},e.prototype.deriveChallenge=function(t){return t.length<43||t.length>128?Promise.reject(new ux.AppAuthError("Invalid code length.")):BT?new Promise(function(r,n){self.crypto.subtle.digest("SHA-256",hx(t)).then(function(o){return r(dx(new Uint8Array(o)))},function(o){return n(o)})}):Promise.reject(new ux.AppAuthError("window.crypto.subtle is unavailable."))},e}();Ao.DefaultCrypto=kT});var np=ae(rn=>{"use strict";m();g();Object.defineProperty(rn,"__esModule",{value:!0});rn.IS_PROFILE=rn.IS_LOG=rn.setFlag=rn.Flags=void 0;rn.Flags={IS_LOG:!0,IS_PROFILE:!1};function PT(e,t){rn.Flags[e]=t}i(PT,"setFlag");rn.setFlag=PT;rn.IS_LOG=rn.Flags.IS_LOG,rn.IS_PROFILE=rn.Flags.IS_PROFILE});var Au=ae(as=>{"use strict";m();g();var op=as&&as.__spreadArray||function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,s;n<o;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))};Object.defineProperty(as,"__esModule",{value:!0});as.profile=as.log=void 0;var px=np();function ip(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(px.Flags.IS_LOG){var n=t?t.length:0;n>0?console.log.apply(console,op([e],t,!1)):console.log(e)}}i(ip,"log");as.log=ip;var CT=typeof self<"u"&&!!self.performance&&!!console.profile;function OT(e,t,r){return px.Flags.IS_PROFILE?KT(e,t,r):r}i(OT,"profile");as.profile=OT;function KT(e,t,r){var n=r.value,o=n.name;return o||(o="anonymous function"),CT?r.value=function(s){console.profile(o);var a=self.performance.now(),l=n.call.apply(n,op([this||self],s,!1)),f=self.performance.now()-a;return console.log("".concat(o," took ").concat(f," ms")),console.profileEnd(),l}:r.value=function(s){ip("Profile start ".concat(o));var a=Date.now(),l=n.call.apply(n,op([this||self],s,!1)),f=Date.now()-a;return ip("Profile end ".concat(o," took ").concat(f," ms.")),l},r}i(KT,"performProfile")});var sp=ae(df=>{"use strict";m();g();Object.defineProperty(df,"__esModule",{value:!0});df.AuthorizationRequest=void 0;var RT=ff(),UT=Au(),NT=10,LT=i(function(e){return e.generateRandom(NT)},"newState"),DT=function(){function e(t,r,n){r===void 0&&(r=new RT.DefaultCrypto),n===void 0&&(n=!0),this.crypto=r,this.usePkce=n,this.clientId=t.client_id,this.redirectUri=t.redirect_uri,this.scope=t.scope,this.responseType=t.response_type||e.RESPONSE_TYPE_CODE,this.state=t.state||LT(r),this.extras=t.extras,this.internal=t.internal}return i(e,"AuthorizationRequest"),e.prototype.setupCodeVerifier=function(){var t=this;if(this.usePkce){var r=this.crypto.generateRandom(128),n=this.crypto.deriveChallenge(r).catch(function(o){(0,UT.log)("Unable to generate PKCE challenge. Not using PKCE",o)});return n.then(function(o){o&&(t.internal=t.internal||{},t.internal.code_verifier=r,t.extras=t.extras||{},t.extras.code_challenge=o,t.extras.code_challenge_method="S256")})}else return Promise.resolve()},e.prototype.toJson=function(){var t=this;return this.setupCodeVerifier().then(function(){return{response_type:t.responseType,client_id:t.clientId,redirect_uri:t.redirectUri,scope:t.scope,state:t.state,extras:t.extras,internal:t.internal}})},e.RESPONSE_TYPE_TOKEN="token",e.RESPONSE_TYPE_CODE="code",e}();df.AuthorizationRequest=DT});var mx=ae(hf=>{"use strict";m();g();Object.defineProperty(hf,"__esModule",{value:!0});hf.requireValidUrl=void 0;var VT=Qa();function qT(e){try{return new URL(e),e}catch{throw new VT.AppAuthError("Invalid input url ".concat(e))}}i(qT,"requireValidUrl");hf.requireValidUrl=qT});var cp=ae(Ei=>{"use strict";m();g();Object.defineProperty(Ei,"__esModule",{value:!0});Ei.AuthorizationRequestHandler=Ei.BUILT_IN_PARAMETERS=Ei.AuthorizationNotifier=void 0;var ap=Au(),HT=mx(),jT=function(){function e(){this.listener=null}return i(e,"AuthorizationNotifier"),e.prototype.setAuthorizationListener=function(t){this.listener=t},e.prototype.onAuthorizationComplete=function(t,r,n){this.listener&&this.listener(t,r,n)},e}();Ei.AuthorizationNotifier=jT;Ei.BUILT_IN_PARAMETERS=["redirect_uri","client_id","response_type","state","scope"];var zT=function(){function e(t,r){this.utils=t,this.crypto=r,this.notifier=null}return i(e,"AuthorizationRequestHandler"),e.prototype.buildRequestUrl=function(t,r){var n={redirect_uri:r.redirectUri,client_id:r.clientId,response_type:r.responseType,state:r.state,scope:r.scope};if(r.extras)for(var o in r.extras)r.extras.hasOwnProperty(o)&&Ei.BUILT_IN_PARAMETERS.indexOf(o)<0&&(n[o]=r.extras[o]);var s=this.utils.stringify(n),a=(0,HT.requireValidUrl)(t.authorizationEndpoint),l="".concat(a,"?").concat(s);return l},e.prototype.completeAuthorizationRequestIfPossible=function(){var t=this;return(0,ap.log)("Checking to see if there is an authorization response to be delivered."),this.notifier||(0,ap.log)(`Notifier is not present on AuthorizationRequest handler.
          No delivery of result will be possible`),this.completeAuthorizationRequest().then(function(r){r||(0,ap.log)("No result is available yet."),r&&t.notifier&&t.notifier.onAuthorizationComplete(r.request,r.response,r.error)})},e.prototype.setAuthorizationNotifier=function(t){return this.notifier=t,this},e}();Ei.AuthorizationRequestHandler=zT});var up=ae(ec=>{"use strict";m();g();Object.defineProperty(ec,"__esModule",{value:!0});ec.AuthorizationError=ec.AuthorizationResponse=void 0;var FT=function(){function e(t){this.code=t.code,this.state=t.state}return i(e,"AuthorizationResponse"),e.prototype.toJson=function(){return{code:this.code,state:this.state}},e}();ec.AuthorizationResponse=FT;var WT=function(){function e(t){this.error=t.error,this.errorDescription=t.error_description,this.errorUri=t.error_uri,this.state=t.state}return i(e,"AuthorizationError"),e.prototype.toJson=function(){return{error:this.error,error_description:this.errorDescription,error_uri:this.errorUri,state:this.state}},e}();ec.AuthorizationError=WT});var mf=ae(bn=>{"use strict";m();g();var fp=bn&&bn.__extends||function(){var e=i(function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},e(t,r)},"extendStatics");return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}i(n,"__"),t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(bn,"__esModule",{value:!0});bn.TestRequestor=bn.FetchRequestor=bn.JQueryRequestor=bn.Requestor=void 0;var lp=Qa(),pf=function(){function e(){}return i(e,"Requestor"),e}();bn.Requestor=pf;var $T=function(e){fp(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return i(t,"JQueryRequestor"),t.prototype.xhr=function(r){var n=$.ajax(r);return new Promise(function(o,s){n.then(function(a,l,f){o(a)},function(a,l,f){s(new lp.AppAuthError(f))})})},t}(pf);bn.JQueryRequestor=$T;var GT=function(e){fp(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return i(t,"FetchRequestor"),t.prototype.xhr=function(r){if(!r.url)return Promise.reject(new lp.AppAuthError("A URL must be provided."));var n=new URL(r.url),o={};if(o.method=r.method,o.mode="cors",r.data)if(r.method&&r.method.toUpperCase()==="POST")o.body=r.data;else{var s=new URLSearchParams(r.data);s.forEach(function(f,p){n.searchParams.append(p,f)})}if(o.headers={},r.headers)for(var a in r.headers)r.headers.hasOwnProperty(a)&&(o.headers[a]=r.headers[a]);var l=r.dataType&&r.dataType.toLowerCase()==="json";return l&&(o.headers.Accept="application/json, text/javascript, */*; q=0.01"),fetch(n.toString(),o).then(function(f){if(f.status>=200&&f.status<300){var p=f.headers.get("content-type");return l||p&&p.indexOf("application/json")!==-1?f.json():f.text()}else return Promise.reject(new lp.AppAuthError(f.status.toString(),f.statusText))})},t}(pf);bn.FetchRequestor=GT;var ZT=function(e){fp(t,e);function t(r){var n=e.call(this)||this;return n.promise=r,n}return i(t,"TestRequestor"),t.prototype.xhr=function(r){return this.promise},t}(pf);bn.TestRequestor=ZT});var gx=ae(gf=>{"use strict";m();g();Object.defineProperty(gf,"__esModule",{value:!0});gf.AuthorizationServiceConfiguration=void 0;var YT=mf(),JT=".well-known",XT="openid-configuration",QT=function(){function e(t){this.authorizationEndpoint=t.authorization_endpoint,this.tokenEndpoint=t.token_endpoint,this.revocationEndpoint=t.revocation_endpoint,this.userInfoEndpoint=t.userinfo_endpoint,this.endSessionEndpoint=t.end_session_endpoint}return i(e,"AuthorizationServiceConfiguration"),e.prototype.toJson=function(){return{authorization_endpoint:this.authorizationEndpoint,token_endpoint:this.tokenEndpoint,revocation_endpoint:this.revocationEndpoint,end_session_endpoint:this.endSessionEndpoint,userinfo_endpoint:this.userInfoEndpoint}},e.fetchFromIssuer=function(t,r){var n="".concat(t,"/").concat(JT,"/").concat(XT),o=r||new YT.JQueryRequestor;return o.xhr({url:n,dataType:"json",method:"GET"}).then(function(s){return new e(s)})},e}();gf.AuthorizationServiceConfiguration=QT});var bf=ae(yf=>{"use strict";m();g();Object.defineProperty(yf,"__esModule",{value:!0});yf.BasicQueryStringUtils=void 0;var e6=function(){function e(){}return i(e,"BasicQueryStringUtils"),e.prototype.parse=function(t,r){return r?this.parseQueryString(t.hash):this.parseQueryString(t.search)},e.prototype.parseQueryString=function(t){var r={};t=t.trim().replace(/^(\?|#|&)/,"");for(var n=t.split("&"),o=0;o<n.length;o+=1){var s=n[o],a=s.split("=");if(a.length>=2){var l=decodeURIComponent(a.shift()),f=a.length>0?a.join("="):null;f&&(r[l]=decodeURIComponent(f))}}return r},e.prototype.stringify=function(t){var r=[];for(var n in t)t.hasOwnProperty(n)&&t[n]&&r.push("".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(t[n])));return r.join("&")},e}();yf.BasicQueryStringUtils=e6});var dp=ae(cs=>{"use strict";m();g();var t6=cs&&cs.__extends||function(){var e=i(function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},e(t,r)},"extendStatics");return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}i(n,"__"),t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(cs,"__esModule",{value:!0});cs.LocalStorageBackend=cs.StorageBackend=void 0;var yx=function(){function e(){}return i(e,"StorageBackend"),e}();cs.StorageBackend=yx;var r6=function(e){t6(t,e);function t(r){var n=e.call(this)||this;return n.storage=r||self.localStorage,n}return i(t,"LocalStorageBackend"),t.prototype.getItem=function(r){var n=this;return new Promise(function(o,s){var a=n.storage.getItem(r);o(a||null)})},t.prototype.removeItem=function(r){var n=this;return new Promise(function(o,s){n.storage.removeItem(r),o()})},t.prototype.clear=function(){var r=this;return new Promise(function(n,o){r.storage.clear(),n()})},t.prototype.setItem=function(r,n){var o=this;return new Promise(function(s,a){o.storage.setItem(r,n),s()})},t}(yx);cs.LocalStorageBackend=r6});var wx=ae(tc=>{"use strict";m();g();var n6=tc&&tc.__extends||function(){var e=i(function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},e(t,r)},"extendStatics");return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}i(n,"__"),t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(tc,"__esModule",{value:!0});tc.RedirectRequestHandler=void 0;var o6=sp(),i6=cp(),bx=up(),s6=ff(),vf=Au(),a6=bf(),c6=dp(),hp=i(function(e){return"".concat(e,"_appauth_authorization_request")},"authorizationRequestKey"),vx=i(function(e){return"".concat(e,"_appauth_authorization_service_configuration")},"authorizationServiceConfigurationKey"),pp="appauth_current_authorization_request",u6=function(e){n6(t,e);function t(r,n,o,s){r===void 0&&(r=new c6.LocalStorageBackend),n===void 0&&(n=new a6.BasicQueryStringUtils),o===void 0&&(o=self.location),s===void 0&&(s=new s6.DefaultCrypto);var a=e.call(this,n,s)||this;return a.storageBackend=r,a.locationLike=o,a}return i(t,"RedirectRequestHandler"),t.prototype.performAuthorizationRequest=function(r,n){var o=this,s=this.crypto.generateRandom(10),a=Promise.all([this.storageBackend.setItem(pp,s),n.toJson().then(function(l){return o.storageBackend.setItem(hp(s),JSON.stringify(l))}),this.storageBackend.setItem(vx(s),JSON.stringify(r.toJson()))]);a.then(function(){var l=o.buildRequestUrl(r,n);(0,vf.log)("Making a request to ",n,l),o.locationLike.assign(l)})},t.prototype.completeAuthorizationRequest=function(){var r=this;return this.storageBackend.getItem(pp).then(function(n){return n?r.storageBackend.getItem(hp(n)).then(function(o){return JSON.parse(o)}).then(function(o){return new o6.AuthorizationRequest(o)}).then(function(o){var s="".concat(r.locationLike.origin).concat(r.locationLike.pathname),a=r.utils.parse(r.locationLike,!0),l=a.state,f=a.code,p=a.error;(0,vf.log)("Potential authorization request ",s,a,l,f,p);var w=l===o.state,A=null,_=null;if(w){if(p){var T=a.error_uri,B=a.error_description;_=new bx.AuthorizationError({error:p,error_description:B,error_uri:T,state:l})}else A=new bx.AuthorizationResponse({code:f,state:l});return Promise.all([r.storageBackend.removeItem(pp),r.storageBackend.removeItem(hp(n)),r.storageBackend.removeItem(vx(n))]).then(function(){return(0,vf.log)("Delivering authorization response"),{request:o,response:A,error:_}})}else return(0,vf.log)("Mismatched request (state and request_uri) dont match."),Promise.resolve(null)}):null})},t}(i6.AuthorizationRequestHandler);tc.RedirectRequestHandler=u6});var xx=ae(wf=>{"use strict";m();g();Object.defineProperty(wf,"__esModule",{value:!0});wf.RevokeTokenRequest=void 0;var l6=function(){function e(t){this.token=t.token,this.tokenTypeHint=t.token_type_hint,this.clientId=t.client_id,this.clientSecret=t.client_secret}return i(e,"RevokeTokenRequest"),e.prototype.toJson=function(){var t={token:this.token};return this.tokenTypeHint&&(t.token_type_hint=this.tokenTypeHint),this.clientId&&(t.client_id=this.clientId),this.clientSecret&&(t.client_secret=this.clientSecret),t},e.prototype.toStringMap=function(){var t=this.toJson();return t},e}();wf.RevokeTokenRequest=l6});var Sx=ae(us=>{"use strict";m();g();Object.defineProperty(us,"__esModule",{value:!0});us.TokenRequest=us.GRANT_TYPE_REFRESH_TOKEN=us.GRANT_TYPE_AUTHORIZATION_CODE=void 0;us.GRANT_TYPE_AUTHORIZATION_CODE="authorization_code";us.GRANT_TYPE_REFRESH_TOKEN="refresh_token";var f6=function(){function e(t){this.clientId=t.client_id,this.redirectUri=t.redirect_uri,this.grantType=t.grant_type,this.code=t.code,this.refreshToken=t.refresh_token,this.extras=t.extras}return i(e,"TokenRequest"),e.prototype.toJson=function(){return{grant_type:this.grantType,code:this.code,refresh_token:this.refreshToken,redirect_uri:this.redirectUri,client_id:this.clientId,extras:this.extras}},e.prototype.toStringMap=function(){var t={grant_type:this.grantType,client_id:this.clientId,redirect_uri:this.redirectUri};if(this.code&&(t.code=this.code),this.refreshToken&&(t.refresh_token=this.refreshToken),this.extras)for(var r in this.extras)this.extras.hasOwnProperty(r)&&!t.hasOwnProperty(r)&&(t[r]=this.extras[r]);return t},e}();us.TokenRequest=f6});var mp=ae(Eo=>{"use strict";m();g();Object.defineProperty(Eo,"__esModule",{value:!0});Eo.TokenError=Eo.TokenResponse=Eo.nowInSeconds=void 0;var d6=10*60*-1,h6=i(function(){return Math.round(new Date().getTime()/1e3)},"nowInSeconds");Eo.nowInSeconds=h6;var p6=function(){function e(t){this.accessToken=t.access_token,this.tokenType=t.token_type||"bearer",t.expires_in&&(this.expiresIn=parseInt(t.expires_in,10)),this.refreshToken=t.refresh_token,this.scope=t.scope,this.idToken=t.id_token,this.issuedAt=t.issued_at||(0,Eo.nowInSeconds)()}return i(e,"TokenResponse"),e.prototype.toJson=function(){var t;return{access_token:this.accessToken,id_token:this.idToken,refresh_token:this.refreshToken,scope:this.scope,token_type:this.tokenType,issued_at:this.issuedAt,expires_in:(t=this.expiresIn)===null||t===void 0?void 0:t.toString()}},e.prototype.isValid=function(t){if(t===void 0&&(t=d6),this.expiresIn){var r=(0,Eo.nowInSeconds)();return r<this.issuedAt+this.expiresIn+t}else return!0},e}();Eo.TokenResponse=p6;var m6=function(){function e(t){this.error=t.error,this.errorDescription=t.error_description,this.errorUri=t.error_uri}return i(e,"TokenError"),e.prototype.toJson=function(){return{error:this.error,error_description:this.errorDescription,error_uri:this.errorUri}},e}();Eo.TokenError=m6});var Ex=ae(xf=>{"use strict";m();g();Object.defineProperty(xf,"__esModule",{value:!0});xf.BaseTokenRequestHandler=void 0;var g6=Qa(),y6=bf(),Ax=mp(),b6=mf(),v6=function(){function e(t,r){t===void 0&&(t=new b6.JQueryRequestor),r===void 0&&(r=new y6.BasicQueryStringUtils),this.requestor=t,this.utils=r}return i(e,"BaseTokenRequestHandler"),e.prototype.isTokenResponse=function(t){return t.error===void 0},e.prototype.performRevokeTokenRequest=function(t,r){var n=this.requestor.xhr({url:t.revocationEndpoint,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.utils.stringify(r.toStringMap())});return n.then(function(o){return!0})},e.prototype.performTokenRequest=function(t,r){var n=this,o=this.requestor.xhr({url:t.tokenEndpoint,method:"POST",dataType:"json",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.utils.stringify(r.toStringMap())});return o.then(function(s){return n.isTokenResponse(s)?new Ax.TokenResponse(s):Promise.reject(new g6.AppAuthError(s.error,new Ax.TokenError(s)))})},e}();xf.BaseTokenRequestHandler=v6});var Mx=ae(_x=>{"use strict";m();g();Object.defineProperty(_x,"__esModule",{value:!0})});var gp=ae(Ut=>{"use strict";m();g();var w6=Ut&&Ut.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:i(function(){return t[r]},"get")}),Object.defineProperty(e,n,o)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),dr=Ut&&Ut.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&w6(t,e,r)};Object.defineProperty(Ut,"__esModule",{value:!0});dr(sp(),Ut);dr(cp(),Ut);dr(up(),Ut);dr(gx(),Ut);dr(ff(),Ut);dr(Qa(),Ut);dr(np(),Ut);dr(Au(),Ut);dr(bf(),Ut);dr(wx(),Ut);dr(xx(),Ut);dr(dp(),Ut);dr(Sx(),Ut);dr(Ex(),Ut);dr(mp(),Ut);dr(Mx(),Ut);dr(mf(),Ut)});var t2=ae(hc=>{"use strict";m();g();Object.defineProperty(hc,"__esModule",{value:!0});hc.testnet=hc.bitcoin=void 0;hc.bitcoin={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128};hc.testnet={messagePrefix:`Bitcoin Signed Message:
`,bech32:"tb",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239}});var r2=ae(At=>{"use strict";m();g();Object.defineProperty(At,"__esModule",{value:!0});At.maybe=At.Boolean=At.Array=At.Buffer256bit=At.Network=At.typeforce=void 0;At.typeforce=eT();At.Network=At.typeforce.compile({messagePrefix:At.typeforce.oneOf(At.typeforce.Buffer,At.typeforce.String),bip32:{public:At.typeforce.UInt32,private:At.typeforce.UInt32},pubKeyHash:At.typeforce.UInt8,scriptHash:At.typeforce.UInt8,wif:At.typeforce.UInt8});At.Buffer256bit=At.typeforce.BufferN(32);At.Array=At.typeforce.Array;At.Boolean=At.typeforce.Boolean;At.maybe=At.typeforce.maybe});var n2=ae(Ed=>{"use strict";m();g();Object.defineProperty(Ed,"__esModule",{value:!0});Ed.testEcc=void 0;var Ae=i(e=>Buffer.from(e,"hex"),"h");function Z4(e){It(e.isPoint(Ae("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),It(!e.isPoint(Ae("030000000000000000000000000000000000000000000000000000000000000005"))),It(e.isPrivate(Ae("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),It(e.isPrivate(Ae("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),It(!e.isPrivate(Ae("0000000000000000000000000000000000000000000000000000000000000000"))),It(!e.isPrivate(Ae("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"))),It(!e.isPrivate(Ae("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364142"))),It(Buffer.from(e.privateAdd(Ae("0000000000000000000000000000000000000000000000000000000000000001"),Ae("0000000000000000000000000000000000000000000000000000000000000000"))).equals(Ae("0000000000000000000000000000000000000000000000000000000000000001"))),It(e.privateAdd(Ae("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413e"),Ae("0000000000000000000000000000000000000000000000000000000000000003"))===null),It(Buffer.from(e.privateAdd(Ae("e211078564db65c3ce7704f08262b1f38f1ef412ad15b5ac2d76657a63b2c500"),Ae("b51fbb69051255d1becbd683de5848242a89c229348dd72896a87ada94ae8665"))).equals(Ae("9730c2ee69edbb958d42db7460bafa18fef9d955325aec99044c81c8282b0a24"))),It(Buffer.from(e.privateNegate(Ae("0000000000000000000000000000000000000000000000000000000000000001"))).equals(Ae("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),It(Buffer.from(e.privateNegate(Ae("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413e"))).equals(Ae("0000000000000000000000000000000000000000000000000000000000000003"))),It(Buffer.from(e.privateNegate(Ae("b1121e4088a66a28f5b6b0f5844943ecd9f610196d7bb83b25214b60452c09af"))).equals(Ae("4eede1bf775995d70a494f0a7bb6bc11e0b8cccd41cce8009ab1132c8b0a3792"))),It(Buffer.from(e.pointCompress(Ae("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"),!0)).equals(Ae("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),It(Buffer.from(e.pointCompress(Ae("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"),!1)).equals(Ae("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"))),It(Buffer.from(e.pointCompress(Ae("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),!0)).equals(Ae("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),It(Buffer.from(e.pointCompress(Ae("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),!1)).equals(Ae("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"))),It(Buffer.from(e.pointFromScalar(Ae("b1121e4088a66a28f5b6b0f5844943ecd9f610196d7bb83b25214b60452c09af"))).equals(Ae("02b07ba9dca9523b7ef4bd97703d43d20399eb698e194704791a25ce77a400df99"))),It(e.xOnlyPointAddTweak(Ae("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Ae("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))===null);let t=e.xOnlyPointAddTweak(Ae("1617d38ed8d8657da4d4761e8057bc396ea9e4b9d29776d4be096016dbd2509b"),Ae("a8397a935f0dfceba6ba9618f6451ef4d80637abf4e6af2669fbc9de6a8fd2ac"));It(Buffer.from(t.xOnlyPubkey).equals(Ae("e478f99dab91052ab39a33ea35fd5e6e4933f4d28023cd597c9a1f6760346adf"))&&t.parity===1),t=e.xOnlyPointAddTweak(Ae("2c0b7cf95324a07d05398b240174dc0c2be444d96b159aa6c7f7b1e668680991"),Ae("823c3cd2142744b075a87eade7e1b8678ba308d566226a0056ca2b7a76f86b47")),It(Buffer.from(t.xOnlyPubkey).equals(Ae("9534f8dc8c6deda2dc007655981c78b49c5d96c778fbf363462a11ec9dfd948c"))&&t.parity===0),It(Buffer.from(e.sign(Ae("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),Ae("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))).equals(Ae("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5"))),It(e.verify(Ae("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),Ae("0379be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Ae("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5"))),e.signSchnorr&&It(Buffer.from(e.signSchnorr(Ae("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),Ae("c90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b14e5c9"),Ae("c87aa53824b4d7ae2eb035a2b5bbbccc080e76cdc6d1692c4b0b62d798e6d906"))).equals(Ae("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7"))),e.verifySchnorr&&It(e.verifySchnorr(Ae("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),Ae("dd308afec5777e13121fa72b9cc1b7cc0139715309b086c960e18fd969774eb8"),Ae("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7")))}i(Z4,"testEcc");Ed.testEcc=Z4;function It(e){if(!e)throw new Error("ecc library invalid")}i(It,"assert")});var i2=ae(pc=>{"use strict";m();g();Object.defineProperty(pc,"__esModule",{value:!0});pc.ECPairFactory=pc.networks=void 0;var ng=t2();pc.networks=ng;var Pr=r2(),Y4=Jv(),o2=XI(),J4=n2(),rg=Pr.typeforce.maybe(Pr.typeforce.compile({compressed:Pr.maybe(Pr.Boolean),network:Pr.maybe(Pr.Network)})),X4=i(e=>e.length===32?e:e.slice(1,33),"toXOnly");function Q4(e){(0,J4.testEcc)(e);function t(l){return e.isPoint(l)}i(t,"isPoint");function r(l,f){if(Pr.typeforce(Pr.Buffer256bit,l),!e.isPrivate(l))throw new TypeError("Private key not in range [1, n)");return Pr.typeforce(rg,f),new a(l,void 0,f)}i(r,"fromPrivateKey");function n(l,f){return Pr.typeforce(e.isPoint,l),Pr.typeforce(rg,f),new a(void 0,l,f)}i(n,"fromPublicKey");function o(l,f){let p=o2.decode(l),w=p.version;if(Pr.Array(f)){if(f=f.filter(A=>w===A.wif).pop(),!f)throw new Error("Unknown network version")}else if(f=f||ng.bitcoin,w!==f.wif)throw new Error("Invalid network version");return r(p.privateKey,{compressed:p.compressed,network:f})}i(o,"fromWIF");function s(l){Pr.typeforce(rg,l),l===void 0&&(l={});let f=l.rng||Y4,p;do p=f(32),Pr.typeforce(Pr.Buffer256bit,p);while(!e.isPrivate(p));return r(p,l)}i(s,"makeRandom");class a{static{i(this,"ECPair")}__D;__Q;compressed;network;lowR;constructor(f,p,w){this.__D=f,this.__Q=p,this.lowR=!1,w===void 0&&(w={}),this.compressed=w.compressed===void 0?!0:w.compressed,this.network=w.network||ng.bitcoin,p!==void 0&&(this.__Q=Buffer.from(e.pointCompress(p,this.compressed)))}get privateKey(){return this.__D}get publicKey(){if(!this.__Q){let f=e.pointFromScalar(this.__D,this.compressed);this.__Q=Buffer.from(f)}return this.__Q}toWIF(){if(!this.__D)throw new Error("Missing private key");return o2.encode(this.network.wif,this.__D,this.compressed)}tweak(f){return this.privateKey?this.tweakFromPrivateKey(f):this.tweakFromPublicKey(f)}sign(f,p){if(!this.__D)throw new Error("Missing private key");if(p===void 0&&(p=this.lowR),p===!1)return Buffer.from(e.sign(f,this.__D));{let w=e.sign(f,this.__D),A=Buffer.alloc(32,0),_=0;for(;w[0]>127;)_++,A.writeUIntLE(_,0,6),w=e.sign(f,this.__D,A);return Buffer.from(w)}}signSchnorr(f){if(!this.privateKey)throw new Error("Missing private key");if(!e.signSchnorr)throw new Error("signSchnorr not supported by ecc library");return Buffer.from(e.signSchnorr(f,this.privateKey))}verify(f,p){return e.verify(f,this.publicKey,p)}verifySchnorr(f,p){if(!e.verifySchnorr)throw new Error("verifySchnorr not supported by ecc library");return e.verifySchnorr(f,this.publicKey.subarray(1,33),p)}tweakFromPublicKey(f){let p=X4(this.publicKey),w=e.xOnlyPointAddTweak(p,f);if(!w||w.xOnlyPubkey===null)throw new Error("Cannot tweak public key!");let A=Buffer.from([w.parity===0?2:3]);return n(Buffer.concat([A,w.xOnlyPubkey]),{network:this.network,compressed:this.compressed})}tweakFromPrivateKey(f){let w=this.publicKey[0]===3||this.publicKey[0]===4&&(this.publicKey[64]&1)===1?e.privateNegate(this.privateKey):this.privateKey,A=e.privateAdd(w,f);if(!A)throw new Error("Invalid tweaked private key!");return r(Buffer.from(A),{network:this.network,compressed:this.compressed})}}return{isPoint:t,fromPrivateKey:r,fromPublicKey:n,fromWIF:o,makeRandom:s}}i(Q4,"ECPairFactory");pc.ECPairFactory=Q4});var s2=ae(bs=>{"use strict";m();g();Object.defineProperty(bs,"__esModule",{value:!0});bs.networks=bs.ECPairFactory=bs.default=void 0;var og=i2();Object.defineProperty(bs,"default",{enumerable:!0,get:i(function(){return og.ECPairFactory},"get")});Object.defineProperty(bs,"ECPairFactory",{enumerable:!0,get:i(function(){return og.ECPairFactory},"get")});Object.defineProperty(bs,"networks",{enumerable:!0,get:i(function(){return og.networks},"get")})});var iS=ae((Poe,oS)=>{m();g();var xt={IMPOSSIBLE_CASE:"Impossible case. Please create issue.",TWEAK_ADD:"The tweak was out of range or the resulted private key is invalid",TWEAK_MUL:"The tweak was out of range or equal to zero",CONTEXT_RANDOMIZE_UNKNOW:"Unknow error on context randomization",SECKEY_INVALID:"Private Key is invalid",PUBKEY_PARSE:"Public Key could not be parsed",PUBKEY_SERIALIZE:"Public Key serialization error",PUBKEY_COMBINE:"The sum of the public keys is not valid",SIG_PARSE:"Signature could not be parsed",SIGN:"The nonce generation function failed, or the private key was invalid",RECOVER:"Public key could not be recover",ECDH:"Scalar was invalid (zero or overflow)"};function _n(e,t){if(!e)throw new Error(t)}i(_n,"assert");function bt(e,t,r){if(_n(t instanceof Uint8Array,`Expected ${e} to be an Uint8Array`),r!==void 0)if(Array.isArray(r)){let n=r.join(", "),o=`Expected ${e} to be an Uint8Array with length [${n}]`;_n(r.includes(t.length),o)}else{let n=`Expected ${e} to be an Uint8Array with length ${r}`;_n(t.length===r,n)}}i(bt,"isUint8Array");function sa(e){_n(xc(e)==="Boolean","Expected compressed to be a Boolean")}i(sa,"isCompressed");function oo(e=r=>new Uint8Array(r),t){return typeof e=="function"&&(e=e(t)),bt("output",e,t),e}i(oo,"getAssertedOutput");function xc(e){return Object.prototype.toString.call(e).slice(8,-1)}i(xc,"toTypeString");oS.exports=e=>({contextRandomize(t){switch(_n(t===null||t instanceof Uint8Array,"Expected seed to be an Uint8Array or null"),t!==null&&bt("seed",t,32),e.contextRandomize(t)){case 1:throw new Error(xt.CONTEXT_RANDOMIZE_UNKNOW)}},privateKeyVerify(t){return bt("private key",t,32),e.privateKeyVerify(t)===0},privateKeyNegate(t){switch(bt("private key",t,32),e.privateKeyNegate(t)){case 0:return t;case 1:throw new Error(xt.IMPOSSIBLE_CASE)}},privateKeyTweakAdd(t,r){switch(bt("private key",t,32),bt("tweak",r,32),e.privateKeyTweakAdd(t,r)){case 0:return t;case 1:throw new Error(xt.TWEAK_ADD)}},privateKeyTweakMul(t,r){switch(bt("private key",t,32),bt("tweak",r,32),e.privateKeyTweakMul(t,r)){case 0:return t;case 1:throw new Error(xt.TWEAK_MUL)}},publicKeyVerify(t){return bt("public key",t,[33,65]),e.publicKeyVerify(t)===0},publicKeyCreate(t,r=!0,n){switch(bt("private key",t,32),sa(r),n=oo(n,r?33:65),e.publicKeyCreate(n,t)){case 0:return n;case 1:throw new Error(xt.SECKEY_INVALID);case 2:throw new Error(xt.PUBKEY_SERIALIZE)}},publicKeyConvert(t,r=!0,n){switch(bt("public key",t,[33,65]),sa(r),n=oo(n,r?33:65),e.publicKeyConvert(n,t)){case 0:return n;case 1:throw new Error(xt.PUBKEY_PARSE);case 2:throw new Error(xt.PUBKEY_SERIALIZE)}},publicKeyNegate(t,r=!0,n){switch(bt("public key",t,[33,65]),sa(r),n=oo(n,r?33:65),e.publicKeyNegate(n,t)){case 0:return n;case 1:throw new Error(xt.PUBKEY_PARSE);case 2:throw new Error(xt.IMPOSSIBLE_CASE);case 3:throw new Error(xt.PUBKEY_SERIALIZE)}},publicKeyCombine(t,r=!0,n){_n(Array.isArray(t),"Expected public keys to be an Array"),_n(t.length>0,"Expected public keys array will have more than zero items");for(let o of t)bt("public key",o,[33,65]);switch(sa(r),n=oo(n,r?33:65),e.publicKeyCombine(n,t)){case 0:return n;case 1:throw new Error(xt.PUBKEY_PARSE);case 2:throw new Error(xt.PUBKEY_COMBINE);case 3:throw new Error(xt.PUBKEY_SERIALIZE)}},publicKeyTweakAdd(t,r,n=!0,o){switch(bt("public key",t,[33,65]),bt("tweak",r,32),sa(n),o=oo(o,n?33:65),e.publicKeyTweakAdd(o,t,r)){case 0:return o;case 1:throw new Error(xt.PUBKEY_PARSE);case 2:throw new Error(xt.TWEAK_ADD)}},publicKeyTweakMul(t,r,n=!0,o){switch(bt("public key",t,[33,65]),bt("tweak",r,32),sa(n),o=oo(o,n?33:65),e.publicKeyTweakMul(o,t,r)){case 0:return o;case 1:throw new Error(xt.PUBKEY_PARSE);case 2:throw new Error(xt.TWEAK_MUL)}},signatureNormalize(t){switch(bt("signature",t,64),e.signatureNormalize(t)){case 0:return t;case 1:throw new Error(xt.SIG_PARSE)}},signatureExport(t,r){bt("signature",t,64),r=oo(r,72);let n={output:r,outputlen:72};switch(e.signatureExport(n,t)){case 0:return r.slice(0,n.outputlen);case 1:throw new Error(xt.SIG_PARSE);case 2:throw new Error(xt.IMPOSSIBLE_CASE)}},signatureImport(t,r){switch(bt("signature",t),r=oo(r,64),e.signatureImport(r,t)){case 0:return r;case 1:throw new Error(xt.SIG_PARSE);case 2:throw new Error(xt.IMPOSSIBLE_CASE)}},ecdsaSign(t,r,n={},o){bt("message",t,32),bt("private key",r,32),_n(xc(n)==="Object","Expected options to be an Object"),n.data!==void 0&&bt("options.data",n.data),n.noncefn!==void 0&&_n(xc(n.noncefn)==="Function","Expected options.noncefn to be a Function"),o=oo(o,64);let s={signature:o,recid:null};switch(e.ecdsaSign(s,t,r,n.data,n.noncefn)){case 0:return s;case 1:throw new Error(xt.SIGN);case 2:throw new Error(xt.IMPOSSIBLE_CASE)}},ecdsaVerify(t,r,n){switch(bt("signature",t,64),bt("message",r,32),bt("public key",n,[33,65]),e.ecdsaVerify(t,r,n)){case 0:return!0;case 3:return!1;case 1:throw new Error(xt.SIG_PARSE);case 2:throw new Error(xt.PUBKEY_PARSE)}},ecdsaRecover(t,r,n,o=!0,s){switch(bt("signature",t,64),_n(xc(r)==="Number"&&r>=0&&r<=3,"Expected recovery id to be a Number within interval [0, 3]"),bt("message",n,32),sa(o),s=oo(s,o?33:65),e.ecdsaRecover(s,t,r,n)){case 0:return s;case 1:throw new Error(xt.SIG_PARSE);case 2:throw new Error(xt.RECOVER);case 3:throw new Error(xt.IMPOSSIBLE_CASE)}},ecdh(t,r,n={},o){switch(bt("public key",t,[33,65]),bt("private key",r,32),_n(xc(n)==="Object","Expected options to be an Object"),n.data!==void 0&&bt("options.data",n.data),n.hashfn!==void 0?(_n(xc(n.hashfn)==="Function","Expected options.hashfn to be a Function"),n.xbuf!==void 0&&bt("options.xbuf",n.xbuf,32),n.ybuf!==void 0&&bt("options.ybuf",n.ybuf,32),bt("output",o)):o=oo(o,32),e.ecdh(o,t,r,n.data,n.hashfn,n.xbuf,n.ybuf)){case 0:return o;case 1:throw new Error(xt.PUBKEY_PARSE);case 2:throw new Error(xt.ECDH)}}})});var aS=ae((Roe,sS)=>{m();g();var Z8=ew().ec,ko=new Z8("secp256k1"),gt=ko.curve,Et=gt.n.constructor;function Y8(e,t){let r=new Et(t);if(r.cmp(gt.p)>=0)return null;r=r.toRed(gt.red);let n=r.redSqr().redIMul(r).redIAdd(gt.b).redSqrt();return e===3!==n.isOdd()&&(n=n.redNeg()),ko.keyPair({pub:{x:r,y:n}})}i(Y8,"loadCompressedPublicKey");function J8(e,t,r){let n=new Et(t),o=new Et(r);if(n.cmp(gt.p)>=0||o.cmp(gt.p)>=0||(n=n.toRed(gt.red),o=o.toRed(gt.red),(e===6||e===7)&&o.isOdd()!==(e===7)))return null;let s=n.redSqr().redIMul(n);return o.redSqr().redISub(s.redIAdd(gt.b)).isZero()?ko.keyPair({pub:{x:n,y:o}}):null}i(J8,"loadUncompressedPublicKey");function ws(e){let t=e[0];switch(t){case 2:case 3:return e.length!==33?null:Y8(t,e.subarray(1,33));case 4:case 6:case 7:return e.length!==65?null:J8(t,e.subarray(1,33),e.subarray(33,65));default:return null}}i(ws,"loadPublicKey");function aa(e,t){let r=t.encode(null,e.length===33);for(let n=0;n<e.length;++n)e[n]=r[n]}i(aa,"savePublicKey");sS.exports={contextRandomize(){return 0},privateKeyVerify(e){let t=new Et(e);return t.cmp(gt.n)<0&&!t.isZero()?0:1},privateKeyNegate(e){let t=new Et(e),r=gt.n.sub(t).umod(gt.n).toArrayLike(Uint8Array,"be",32);return e.set(r),0},privateKeyTweakAdd(e,t){let r=new Et(t);if(r.cmp(gt.n)>=0||(r.iadd(new Et(e)),r.cmp(gt.n)>=0&&r.isub(gt.n),r.isZero()))return 1;let n=r.toArrayLike(Uint8Array,"be",32);return e.set(n),0},privateKeyTweakMul(e,t){let r=new Et(t);if(r.cmp(gt.n)>=0||r.isZero())return 1;r.imul(new Et(e)),r.cmp(gt.n)>=0&&(r=r.umod(gt.n));let n=r.toArrayLike(Uint8Array,"be",32);return e.set(n),0},publicKeyVerify(e){return ws(e)===null?1:0},publicKeyCreate(e,t){let r=new Et(t);if(r.cmp(gt.n)>=0||r.isZero())return 1;let n=ko.keyFromPrivate(t).getPublic();return aa(e,n),0},publicKeyConvert(e,t){let r=ws(t);if(r===null)return 1;let n=r.getPublic();return aa(e,n),0},publicKeyNegate(e,t){let r=ws(t);if(r===null)return 1;let n=r.getPublic();return n.y=n.y.redNeg(),aa(e,n),0},publicKeyCombine(e,t){let r=new Array(t.length);for(let o=0;o<t.length;++o)if(r[o]=ws(t[o]),r[o]===null)return 1;let n=r[0].getPublic();for(let o=1;o<r.length;++o)n=n.add(r[o].pub);return n.isInfinity()?2:(aa(e,n),0)},publicKeyTweakAdd(e,t,r){let n=ws(t);if(n===null)return 1;if(r=new Et(r),r.cmp(gt.n)>=0)return 2;let o=n.getPublic().add(gt.g.mul(r));return o.isInfinity()?2:(aa(e,o),0)},publicKeyTweakMul(e,t,r){let n=ws(t);if(n===null)return 1;if(r=new Et(r),r.cmp(gt.n)>=0||r.isZero())return 2;let o=n.getPublic().mul(r);return aa(e,o),0},signatureNormalize(e){let t=new Et(e.subarray(0,32)),r=new Et(e.subarray(32,64));return t.cmp(gt.n)>=0||r.cmp(gt.n)>=0?1:(r.cmp(ko.nh)===1&&e.set(gt.n.sub(r).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(e,t){let r=t.subarray(0,32),n=t.subarray(32,64);if(new Et(r).cmp(gt.n)>=0||new Et(n).cmp(gt.n)>=0)return 1;let{output:o}=e,s=o.subarray(4,37);s[0]=0,s.set(r,1);let a=33,l=0;for(;a>1&&s[l]===0&&!(s[l+1]&128);--a,++l);if(s=s.subarray(l),s[0]&128||a>1&&s[0]===0&&!(s[1]&128))return 1;let f=o.subarray(39,72);f[0]=0,f.set(n,1);let p=33,w=0;for(;p>1&&f[w]===0&&!(f[w+1]&128);--p,++w);return f=f.subarray(w),f[0]&128||p>1&&f[0]===0&&!(f[1]&128)?1:(e.outputlen=6+a+p,o[0]=48,o[1]=e.outputlen-2,o[2]=2,o[3]=s.length,o.set(s,4),o[4+a]=2,o[5+a]=f.length,o.set(f,6+a),0)},signatureImport(e,t){if(t.length<8||t.length>72||t[0]!==48||t[1]!==t.length-2||t[2]!==2)return 1;let r=t[3];if(r===0||5+r>=t.length||t[4+r]!==2)return 1;let n=t[5+r];if(n===0||6+r+n!==t.length||t[4]&128||r>1&&t[4]===0&&!(t[5]&128)||t[r+6]&128||n>1&&t[r+6]===0&&!(t[r+7]&128))return 1;let o=t.subarray(4,4+r);if(o.length===33&&o[0]===0&&(o=o.subarray(1)),o.length>32)return 1;let s=t.subarray(6+r);if(s.length===33&&s[0]===0&&(s=s.slice(1)),s.length>32)throw new Error("S length is too long");let a=new Et(o);a.cmp(gt.n)>=0&&(a=new Et(0));let l=new Et(t.subarray(6+r));return l.cmp(gt.n)>=0&&(l=new Et(0)),e.set(a.toArrayLike(Uint8Array,"be",32),0),e.set(l.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(e,t,r,n,o){if(o){let l=o;o=i(f=>{let p=l(t,r,null,n,f);if(!(p instanceof Uint8Array&&p.length===32))throw new Error("This is the way");return new Et(p)},"noncefn")}let s=new Et(r);if(s.cmp(gt.n)>=0||s.isZero())return 1;let a;try{a=ko.sign(t,r,{canonical:!0,k:o,pers:n})}catch{return 1}return e.signature.set(a.r.toArrayLike(Uint8Array,"be",32),0),e.signature.set(a.s.toArrayLike(Uint8Array,"be",32),32),e.recid=a.recoveryParam,0},ecdsaVerify(e,t,r){let n={r:e.subarray(0,32),s:e.subarray(32,64)},o=new Et(n.r),s=new Et(n.s);if(o.cmp(gt.n)>=0||s.cmp(gt.n)>=0)return 1;if(s.cmp(ko.nh)===1||o.isZero()||s.isZero())return 3;let a=ws(r);if(a===null)return 2;let l=a.getPublic();return ko.verify(t,n,l)?0:3},ecdsaRecover(e,t,r,n){let o={r:t.slice(0,32),s:t.slice(32,64)},s=new Et(o.r),a=new Et(o.s);if(s.cmp(gt.n)>=0||a.cmp(gt.n)>=0)return 1;if(s.isZero()||a.isZero())return 2;let l;try{l=ko.recoverPubKey(n,o,r)}catch{return 2}return aa(e,l),0},ecdh(e,t,r,n,o,s,a){let l=ws(t);if(l===null)return 1;let f=new Et(r);if(f.cmp(gt.n)>=0||f.isZero())return 2;let p=l.getPublic().mul(f);if(o===void 0){let w=p.encode(null,!0),A=ko.hash().update(w).digest();for(let _=0;_<32;++_)e[_]=A[_]}else{s||(s=new Uint8Array(32));let w=p.getX().toArray("be",32);for(let B=0;B<32;++B)s[B]=w[B];a||(a=new Uint8Array(32));let A=p.getY().toArray("be",32);for(let B=0;B<32;++B)a[B]=A[B];let _=o(s,a,n);if(!(_ instanceof Uint8Array&&_.length===e.length))return 2;e.set(_)}return 0}}});var Ig=ae((Doe,cS)=>{m();g();cS.exports=iS()(aS())});var lS=ae(Kd=>{"use strict";m();g();Object.defineProperty(Kd,"__esModule",{value:!0});var uS=Jv();function X8(e){return new Promise(function(t,r){uS(e,function(n,o){if(n){r(n);return}t(o)})})}i(X8,"getRandomBytes");Kd.getRandomBytes=X8;function Q8(e){return uS(e)}i(Q8,"getRandomBytesSync");Kd.getRandomBytesSync=Q8});var pS=ae(Po=>{"use strict";m();g();var e5=Po&&Po.__awaiter||function(e,t,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return i(o,"adopt"),new(r||(r=Promise))(function(s,a){function l(w){try{p(n.next(w))}catch(A){a(A)}}i(l,"fulfilled");function f(w){try{p(n.throw(w))}catch(A){a(A)}}i(f,"rejected");function p(w){w.done?s(w.value):o(w.value).then(l,f)}i(p,"step"),p((n=n.apply(e,t||[])).next())})},t5=Po&&Po.__generator||function(e,t){var r={label:0,sent:i(function(){if(s[0]&1)throw s[1];return s[1]},"sent"),trys:[],ops:[]},n,o,s,a;return a={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(p){return function(w){return f([p,w])}}function f(p){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=p[0]&2?o.return:p[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,p[1])).done)return s;switch(o=0,s&&(p=[p[0]&2,s.value]),p[0]){case 0:case 1:s=p;break;case 4:return r.label++,{value:p[1],done:!1};case 5:r.label++,o=p[1],p=[0];continue;case 7:p=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(p[0]===6||p[0]===2)){r=0;continue}if(p[0]===3&&(!s||p[1]>s[0]&&p[1]<s[3])){r.label=p[1];break}if(p[0]===6&&r.label<s[1]){r.label=s[1],s=p;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(p);break}s[2]&&r.ops.pop(),r.trys.pop();continue}p=t.call(e,r)}catch(w){p=[6,w],o=0}finally{n=s=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}};function r5(e){for(var t in e)Po.hasOwnProperty(t)||(Po[t]=e[t])}i(r5,"__export");Object.defineProperty(Po,"__esModule",{value:!0});var fS=Ig(),dS=lS(),hS=32;function n5(){return e5(this,void 0,void 0,function(){var e;return t5(this,function(t){switch(t.label){case 0:return[4,dS.getRandomBytes(hS)];case 1:return e=t.sent(),fS.privateKeyVerify(e)?[2,e]:[3,0];case 2:return[2]}})})}i(n5,"createPrivateKey");Po.createPrivateKey=n5;function o5(){for(;;){var e=dS.getRandomBytesSync(hS);if(fS.privateKeyVerify(e))return e}}i(o5,"createPrivateKeySync");Po.createPrivateKeySync=o5;r5(Ig())});var ca=ae((mS,Tg)=>{m();g();(function(e,t){"use strict";function r(E,c){if(!E)throw new Error(c||"Assertion failed")}i(r,"assert");function n(E,c){E.super_=c;var d=i(function(){},"TempCtor");d.prototype=c.prototype,E.prototype=new d,E.prototype.constructor=E}i(n,"inherits");function o(E,c,d){if(o.isBN(E))return E;this.negative=0,this.words=null,this.length=0,this.red=null,E!==null&&((c==="le"||c==="be")&&(d=c,c=10),this._init(E||0,c||10,d||"be"))}i(o,"BN"),typeof e=="object"?e.exports=o:t.BN=o,o.BN=o,o.wordSize=26;var s;try{typeof self<"u"&&typeof self.Buffer<"u"?s=self.Buffer:s=Qv().Buffer}catch{}o.isBN=i(function(c){return c instanceof o?!0:c!==null&&typeof c=="object"&&c.constructor.wordSize===o.wordSize&&Array.isArray(c.words)},"isBN"),o.max=i(function(c,d){return c.cmp(d)>0?c:d},"max"),o.min=i(function(c,d){return c.cmp(d)<0?c:d},"min"),o.prototype._init=i(function(c,d,h){if(typeof c=="number")return this._initNumber(c,d,h);if(typeof c=="object")return this._initArray(c,d,h);d==="hex"&&(d=16),r(d===(d|0)&&d>=2&&d<=36),c=c.toString().replace(/\s+/g,"");var y=0;c[0]==="-"&&(y++,this.negative=1),y<c.length&&(d===16?this._parseHex(c,y,h):(this._parseBase(c,d,y),h==="le"&&this._initArray(this.toArray(),d,h)))},"init"),o.prototype._initNumber=i(function(c,d,h){c<0&&(this.negative=1,c=-c),c<67108864?(this.words=[c&67108863],this.length=1):c<4503599627370496?(this.words=[c&67108863,c/67108864&67108863],this.length=2):(r(c<9007199254740992),this.words=[c&67108863,c/67108864&67108863,1],this.length=3),h==="le"&&this._initArray(this.toArray(),d,h)},"_initNumber"),o.prototype._initArray=i(function(c,d,h){if(r(typeof c.length=="number"),c.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(c.length/3),this.words=new Array(this.length);for(var y=0;y<this.length;y++)this.words[y]=0;var b,M,I=0;if(h==="be")for(y=c.length-1,b=0;y>=0;y-=3)M=c[y]|c[y-1]<<8|c[y-2]<<16,this.words[b]|=M<<I&67108863,this.words[b+1]=M>>>26-I&67108863,I+=24,I>=26&&(I-=26,b++);else if(h==="le")for(y=0,b=0;y<c.length;y+=3)M=c[y]|c[y+1]<<8|c[y+2]<<16,this.words[b]|=M<<I&67108863,this.words[b+1]=M>>>26-I&67108863,I+=24,I>=26&&(I-=26,b++);return this.strip()},"_initArray");function a(E,c){var d=E.charCodeAt(c);return d>=65&&d<=70?d-55:d>=97&&d<=102?d-87:d-48&15}i(a,"parseHex4Bits");function l(E,c,d){var h=a(E,d);return d-1>=c&&(h|=a(E,d-1)<<4),h}i(l,"parseHexByte"),o.prototype._parseHex=i(function(c,d,h){this.length=Math.ceil((c.length-d)/6),this.words=new Array(this.length);for(var y=0;y<this.length;y++)this.words[y]=0;var b=0,M=0,I;if(h==="be")for(y=c.length-1;y>=d;y-=2)I=l(c,d,y)<<b,this.words[M]|=I&67108863,b>=18?(b-=18,M+=1,this.words[M]|=I>>>26):b+=8;else{var x=c.length-d;for(y=x%2===0?d+1:d;y<c.length;y+=2)I=l(c,d,y)<<b,this.words[M]|=I&67108863,b>=18?(b-=18,M+=1,this.words[M]|=I>>>26):b+=8}this.strip()},"_parseHex");function f(E,c,d,h){for(var y=0,b=Math.min(E.length,d),M=c;M<b;M++){var I=E.charCodeAt(M)-48;y*=h,I>=49?y+=I-49+10:I>=17?y+=I-17+10:y+=I}return y}i(f,"parseBase"),o.prototype._parseBase=i(function(c,d,h){this.words=[0],this.length=1;for(var y=0,b=1;b<=67108863;b*=d)y++;y--,b=b/d|0;for(var M=c.length-h,I=M%y,x=Math.min(M,M-I)+h,u=0,S=h;S<x;S+=y)u=f(c,S,S+y,d),this.imuln(b),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u);if(I!==0){var V=1;for(u=f(c,S,c.length,d),S=0;S<I;S++)V*=d;this.imuln(V),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u)}this.strip()},"_parseBase"),o.prototype.copy=i(function(c){c.words=new Array(this.length);for(var d=0;d<this.length;d++)c.words[d]=this.words[d];c.length=this.length,c.negative=this.negative,c.red=this.red},"copy"),o.prototype.clone=i(function(){var c=new o(null);return this.copy(c),c},"clone"),o.prototype._expand=i(function(c){for(;this.length<c;)this.words[this.length++]=0;return this},"_expand"),o.prototype.strip=i(function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},"strip"),o.prototype._normSign=i(function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},"_normSign"),o.prototype.inspect=i(function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"},"inspect");var p=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],w=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],A=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];o.prototype.toString=i(function(c,d){c=c||10,d=d|0||1;var h;if(c===16||c==="hex"){h="";for(var y=0,b=0,M=0;M<this.length;M++){var I=this.words[M],x=((I<<y|b)&16777215).toString(16);b=I>>>24-y&16777215,b!==0||M!==this.length-1?h=p[6-x.length]+x+h:h=x+h,y+=2,y>=26&&(y-=26,M--)}for(b!==0&&(h=b.toString(16)+h);h.length%d!==0;)h="0"+h;return this.negative!==0&&(h="-"+h),h}if(c===(c|0)&&c>=2&&c<=36){var u=w[c],S=A[c];h="";var V=this.clone();for(V.negative=0;!V.isZero();){var q=V.modn(S).toString(c);V=V.idivn(S),V.isZero()?h=q+h:h=p[u-q.length]+q+h}for(this.isZero()&&(h="0"+h);h.length%d!==0;)h="0"+h;return this.negative!==0&&(h="-"+h),h}r(!1,"Base should be between 2 and 36")},"toString"),o.prototype.toNumber=i(function(){var c=this.words[0];return this.length===2?c+=this.words[1]*67108864:this.length===3&&this.words[2]===1?c+=4503599627370496+this.words[1]*67108864:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-c:c},"toNumber"),o.prototype.toJSON=i(function(){return this.toString(16)},"toJSON"),o.prototype.toBuffer=i(function(c,d){return r(typeof s<"u"),this.toArrayLike(s,c,d)},"toBuffer"),o.prototype.toArray=i(function(c,d){return this.toArrayLike(Array,c,d)},"toArray"),o.prototype.toArrayLike=i(function(c,d,h){var y=this.byteLength(),b=h||Math.max(1,y);r(y<=b,"byte array longer than desired length"),r(b>0,"Requested array length <= 0"),this.strip();var M=d==="le",I=new c(b),x,u,S=this.clone();if(M){for(u=0;!S.isZero();u++)x=S.andln(255),S.iushrn(8),I[u]=x;for(;u<b;u++)I[u]=0}else{for(u=0;u<b-y;u++)I[u]=0;for(u=0;!S.isZero();u++)x=S.andln(255),S.iushrn(8),I[b-u-1]=x}return I},"toArrayLike"),Math.clz32?o.prototype._countBits=i(function(c){return 32-Math.clz32(c)},"_countBits"):o.prototype._countBits=i(function(c){var d=c,h=0;return d>=4096&&(h+=13,d>>>=13),d>=64&&(h+=7,d>>>=7),d>=8&&(h+=4,d>>>=4),d>=2&&(h+=2,d>>>=2),h+d},"_countBits"),o.prototype._zeroBits=i(function(c){if(c===0)return 26;var d=c,h=0;return d&8191||(h+=13,d>>>=13),d&127||(h+=7,d>>>=7),d&15||(h+=4,d>>>=4),d&3||(h+=2,d>>>=2),d&1||h++,h},"_zeroBits"),o.prototype.bitLength=i(function(){var c=this.words[this.length-1],d=this._countBits(c);return(this.length-1)*26+d},"bitLength");function _(E){for(var c=new Array(E.bitLength()),d=0;d<c.length;d++){var h=d/26|0,y=d%26;c[d]=(E.words[h]&1<<y)>>>y}return c}i(_,"toBitArray"),o.prototype.zeroBits=i(function(){if(this.isZero())return 0;for(var c=0,d=0;d<this.length;d++){var h=this._zeroBits(this.words[d]);if(c+=h,h!==26)break}return c},"zeroBits"),o.prototype.byteLength=i(function(){return Math.ceil(this.bitLength()/8)},"byteLength"),o.prototype.toTwos=i(function(c){return this.negative!==0?this.abs().inotn(c).iaddn(1):this.clone()},"toTwos"),o.prototype.fromTwos=i(function(c){return this.testn(c-1)?this.notn(c).iaddn(1).ineg():this.clone()},"fromTwos"),o.prototype.isNeg=i(function(){return this.negative!==0},"isNeg"),o.prototype.neg=i(function(){return this.clone().ineg()},"neg"),o.prototype.ineg=i(function(){return this.isZero()||(this.negative^=1),this},"ineg"),o.prototype.iuor=i(function(c){for(;this.length<c.length;)this.words[this.length++]=0;for(var d=0;d<c.length;d++)this.words[d]=this.words[d]|c.words[d];return this.strip()},"iuor"),o.prototype.ior=i(function(c){return r((this.negative|c.negative)===0),this.iuor(c)},"ior"),o.prototype.or=i(function(c){return this.length>c.length?this.clone().ior(c):c.clone().ior(this)},"or"),o.prototype.uor=i(function(c){return this.length>c.length?this.clone().iuor(c):c.clone().iuor(this)},"uor"),o.prototype.iuand=i(function(c){var d;this.length>c.length?d=c:d=this;for(var h=0;h<d.length;h++)this.words[h]=this.words[h]&c.words[h];return this.length=d.length,this.strip()},"iuand"),o.prototype.iand=i(function(c){return r((this.negative|c.negative)===0),this.iuand(c)},"iand"),o.prototype.and=i(function(c){return this.length>c.length?this.clone().iand(c):c.clone().iand(this)},"and"),o.prototype.uand=i(function(c){return this.length>c.length?this.clone().iuand(c):c.clone().iuand(this)},"uand"),o.prototype.iuxor=i(function(c){var d,h;this.length>c.length?(d=this,h=c):(d=c,h=this);for(var y=0;y<h.length;y++)this.words[y]=d.words[y]^h.words[y];if(this!==d)for(;y<d.length;y++)this.words[y]=d.words[y];return this.length=d.length,this.strip()},"iuxor"),o.prototype.ixor=i(function(c){return r((this.negative|c.negative)===0),this.iuxor(c)},"ixor"),o.prototype.xor=i(function(c){return this.length>c.length?this.clone().ixor(c):c.clone().ixor(this)},"xor"),o.prototype.uxor=i(function(c){return this.length>c.length?this.clone().iuxor(c):c.clone().iuxor(this)},"uxor"),o.prototype.inotn=i(function(c){r(typeof c=="number"&&c>=0);var d=Math.ceil(c/26)|0,h=c%26;this._expand(d),h>0&&d--;for(var y=0;y<d;y++)this.words[y]=~this.words[y]&67108863;return h>0&&(this.words[y]=~this.words[y]&67108863>>26-h),this.strip()},"inotn"),o.prototype.notn=i(function(c){return this.clone().inotn(c)},"notn"),o.prototype.setn=i(function(c,d){r(typeof c=="number"&&c>=0);var h=c/26|0,y=c%26;return this._expand(h+1),d?this.words[h]=this.words[h]|1<<y:this.words[h]=this.words[h]&~(1<<y),this.strip()},"setn"),o.prototype.iadd=i(function(c){var d;if(this.negative!==0&&c.negative===0)return this.negative=0,d=this.isub(c),this.negative^=1,this._normSign();if(this.negative===0&&c.negative!==0)return c.negative=0,d=this.isub(c),c.negative=1,d._normSign();var h,y;this.length>c.length?(h=this,y=c):(h=c,y=this);for(var b=0,M=0;M<y.length;M++)d=(h.words[M]|0)+(y.words[M]|0)+b,this.words[M]=d&67108863,b=d>>>26;for(;b!==0&&M<h.length;M++)d=(h.words[M]|0)+b,this.words[M]=d&67108863,b=d>>>26;if(this.length=h.length,b!==0)this.words[this.length]=b,this.length++;else if(h!==this)for(;M<h.length;M++)this.words[M]=h.words[M];return this},"iadd"),o.prototype.add=i(function(c){var d;return c.negative!==0&&this.negative===0?(c.negative=0,d=this.sub(c),c.negative^=1,d):c.negative===0&&this.negative!==0?(this.negative=0,d=c.sub(this),this.negative=1,d):this.length>c.length?this.clone().iadd(c):c.clone().iadd(this)},"add"),o.prototype.isub=i(function(c){if(c.negative!==0){c.negative=0;var d=this.iadd(c);return c.negative=1,d._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(c),this.negative=1,this._normSign();var h=this.cmp(c);if(h===0)return this.negative=0,this.length=1,this.words[0]=0,this;var y,b;h>0?(y=this,b=c):(y=c,b=this);for(var M=0,I=0;I<b.length;I++)d=(y.words[I]|0)-(b.words[I]|0)+M,M=d>>26,this.words[I]=d&67108863;for(;M!==0&&I<y.length;I++)d=(y.words[I]|0)+M,M=d>>26,this.words[I]=d&67108863;if(M===0&&I<y.length&&y!==this)for(;I<y.length;I++)this.words[I]=y.words[I];return this.length=Math.max(this.length,I),y!==this&&(this.negative=1),this.strip()},"isub"),o.prototype.sub=i(function(c){return this.clone().isub(c)},"sub");function T(E,c,d){d.negative=c.negative^E.negative;var h=E.length+c.length|0;d.length=h,h=h-1|0;var y=E.words[0]|0,b=c.words[0]|0,M=y*b,I=M&67108863,x=M/67108864|0;d.words[0]=I;for(var u=1;u<h;u++){for(var S=x>>>26,V=x&67108863,q=Math.min(u,c.length-1),F=Math.max(0,u-E.length+1);F<=q;F++){var ee=u-F|0;y=E.words[ee]|0,b=c.words[F]|0,M=y*b+V,S+=M/67108864|0,V=M&67108863}d.words[u]=V|0,x=S|0}return x!==0?d.words[u]=x|0:d.length--,d.strip()}i(T,"smallMulTo");var B=i(function(c,d,h){var y=c.words,b=d.words,M=h.words,I=0,x,u,S,V=y[0]|0,q=V&8191,F=V>>>13,ee=y[1]|0,ie=ee&8191,ce=ee>>>13,ye=y[2]|0,ue=ye&8191,N=ye>>>13,G=y[3]|0,W=G&8191,ne=G>>>13,le=y[4]|0,te=le&8191,se=le>>>13,dt=y[5]|0,Se=dt&8191,Ie=dt>>>13,gn=y[6]|0,Ke=gn&8191,Pe=gn>>>13,bo=y[7]|0,Ce=bo&8191,it=bo>>>13,Qi=y[8]|0,st=Qi&8191,at=Qi>>>13,ci=y[9]|0,Ne=ci&8191,Le=ci>>>13,ui=b[0]|0,De=ui&8191,Ve=ui>>>13,li=b[1]|0,qe=li&8191,He=li>>>13,fi=b[2]|0,je=fi&8191,ze=fi>>>13,di=b[3]|0,Fe=di&8191,We=di>>>13,hi=b[4]|0,$e=hi&8191,Ge=hi>>>13,pi=b[5]|0,Ze=pi&8191,Ye=pi>>>13,mi=b[6]|0,Je=mi&8191,Xe=mi>>>13,gi=b[7]|0,Qe=gi&8191,et=gi>>>13,yi=b[8]|0,tt=yi&8191,rt=yi>>>13,bi=b[9]|0,nt=bi&8191,ot=bi>>>13;h.negative=c.negative^d.negative,h.length=19,x=Math.imul(q,De),u=Math.imul(q,Ve),u=u+Math.imul(F,De)|0,S=Math.imul(F,Ve);var On=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(On>>>26)|0,On&=67108863,x=Math.imul(ie,De),u=Math.imul(ie,Ve),u=u+Math.imul(ce,De)|0,S=Math.imul(ce,Ve),x=x+Math.imul(q,qe)|0,u=u+Math.imul(q,He)|0,u=u+Math.imul(F,qe)|0,S=S+Math.imul(F,He)|0;var Kn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Kn>>>26)|0,Kn&=67108863,x=Math.imul(ue,De),u=Math.imul(ue,Ve),u=u+Math.imul(N,De)|0,S=Math.imul(N,Ve),x=x+Math.imul(ie,qe)|0,u=u+Math.imul(ie,He)|0,u=u+Math.imul(ce,qe)|0,S=S+Math.imul(ce,He)|0,x=x+Math.imul(q,je)|0,u=u+Math.imul(q,ze)|0,u=u+Math.imul(F,je)|0,S=S+Math.imul(F,ze)|0;var Rn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Rn>>>26)|0,Rn&=67108863,x=Math.imul(W,De),u=Math.imul(W,Ve),u=u+Math.imul(ne,De)|0,S=Math.imul(ne,Ve),x=x+Math.imul(ue,qe)|0,u=u+Math.imul(ue,He)|0,u=u+Math.imul(N,qe)|0,S=S+Math.imul(N,He)|0,x=x+Math.imul(ie,je)|0,u=u+Math.imul(ie,ze)|0,u=u+Math.imul(ce,je)|0,S=S+Math.imul(ce,ze)|0,x=x+Math.imul(q,Fe)|0,u=u+Math.imul(q,We)|0,u=u+Math.imul(F,Fe)|0,S=S+Math.imul(F,We)|0;var Un=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Un>>>26)|0,Un&=67108863,x=Math.imul(te,De),u=Math.imul(te,Ve),u=u+Math.imul(se,De)|0,S=Math.imul(se,Ve),x=x+Math.imul(W,qe)|0,u=u+Math.imul(W,He)|0,u=u+Math.imul(ne,qe)|0,S=S+Math.imul(ne,He)|0,x=x+Math.imul(ue,je)|0,u=u+Math.imul(ue,ze)|0,u=u+Math.imul(N,je)|0,S=S+Math.imul(N,ze)|0,x=x+Math.imul(ie,Fe)|0,u=u+Math.imul(ie,We)|0,u=u+Math.imul(ce,Fe)|0,S=S+Math.imul(ce,We)|0,x=x+Math.imul(q,$e)|0,u=u+Math.imul(q,Ge)|0,u=u+Math.imul(F,$e)|0,S=S+Math.imul(F,Ge)|0;var Nn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Nn>>>26)|0,Nn&=67108863,x=Math.imul(Se,De),u=Math.imul(Se,Ve),u=u+Math.imul(Ie,De)|0,S=Math.imul(Ie,Ve),x=x+Math.imul(te,qe)|0,u=u+Math.imul(te,He)|0,u=u+Math.imul(se,qe)|0,S=S+Math.imul(se,He)|0,x=x+Math.imul(W,je)|0,u=u+Math.imul(W,ze)|0,u=u+Math.imul(ne,je)|0,S=S+Math.imul(ne,ze)|0,x=x+Math.imul(ue,Fe)|0,u=u+Math.imul(ue,We)|0,u=u+Math.imul(N,Fe)|0,S=S+Math.imul(N,We)|0,x=x+Math.imul(ie,$e)|0,u=u+Math.imul(ie,Ge)|0,u=u+Math.imul(ce,$e)|0,S=S+Math.imul(ce,Ge)|0,x=x+Math.imul(q,Ze)|0,u=u+Math.imul(q,Ye)|0,u=u+Math.imul(F,Ze)|0,S=S+Math.imul(F,Ye)|0;var Ln=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Ln>>>26)|0,Ln&=67108863,x=Math.imul(Ke,De),u=Math.imul(Ke,Ve),u=u+Math.imul(Pe,De)|0,S=Math.imul(Pe,Ve),x=x+Math.imul(Se,qe)|0,u=u+Math.imul(Se,He)|0,u=u+Math.imul(Ie,qe)|0,S=S+Math.imul(Ie,He)|0,x=x+Math.imul(te,je)|0,u=u+Math.imul(te,ze)|0,u=u+Math.imul(se,je)|0,S=S+Math.imul(se,ze)|0,x=x+Math.imul(W,Fe)|0,u=u+Math.imul(W,We)|0,u=u+Math.imul(ne,Fe)|0,S=S+Math.imul(ne,We)|0,x=x+Math.imul(ue,$e)|0,u=u+Math.imul(ue,Ge)|0,u=u+Math.imul(N,$e)|0,S=S+Math.imul(N,Ge)|0,x=x+Math.imul(ie,Ze)|0,u=u+Math.imul(ie,Ye)|0,u=u+Math.imul(ce,Ze)|0,S=S+Math.imul(ce,Ye)|0,x=x+Math.imul(q,Je)|0,u=u+Math.imul(q,Xe)|0,u=u+Math.imul(F,Je)|0,S=S+Math.imul(F,Xe)|0;var Dn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Dn>>>26)|0,Dn&=67108863,x=Math.imul(Ce,De),u=Math.imul(Ce,Ve),u=u+Math.imul(it,De)|0,S=Math.imul(it,Ve),x=x+Math.imul(Ke,qe)|0,u=u+Math.imul(Ke,He)|0,u=u+Math.imul(Pe,qe)|0,S=S+Math.imul(Pe,He)|0,x=x+Math.imul(Se,je)|0,u=u+Math.imul(Se,ze)|0,u=u+Math.imul(Ie,je)|0,S=S+Math.imul(Ie,ze)|0,x=x+Math.imul(te,Fe)|0,u=u+Math.imul(te,We)|0,u=u+Math.imul(se,Fe)|0,S=S+Math.imul(se,We)|0,x=x+Math.imul(W,$e)|0,u=u+Math.imul(W,Ge)|0,u=u+Math.imul(ne,$e)|0,S=S+Math.imul(ne,Ge)|0,x=x+Math.imul(ue,Ze)|0,u=u+Math.imul(ue,Ye)|0,u=u+Math.imul(N,Ze)|0,S=S+Math.imul(N,Ye)|0,x=x+Math.imul(ie,Je)|0,u=u+Math.imul(ie,Xe)|0,u=u+Math.imul(ce,Je)|0,S=S+Math.imul(ce,Xe)|0,x=x+Math.imul(q,Qe)|0,u=u+Math.imul(q,et)|0,u=u+Math.imul(F,Qe)|0,S=S+Math.imul(F,et)|0;var Vn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Vn>>>26)|0,Vn&=67108863,x=Math.imul(st,De),u=Math.imul(st,Ve),u=u+Math.imul(at,De)|0,S=Math.imul(at,Ve),x=x+Math.imul(Ce,qe)|0,u=u+Math.imul(Ce,He)|0,u=u+Math.imul(it,qe)|0,S=S+Math.imul(it,He)|0,x=x+Math.imul(Ke,je)|0,u=u+Math.imul(Ke,ze)|0,u=u+Math.imul(Pe,je)|0,S=S+Math.imul(Pe,ze)|0,x=x+Math.imul(Se,Fe)|0,u=u+Math.imul(Se,We)|0,u=u+Math.imul(Ie,Fe)|0,S=S+Math.imul(Ie,We)|0,x=x+Math.imul(te,$e)|0,u=u+Math.imul(te,Ge)|0,u=u+Math.imul(se,$e)|0,S=S+Math.imul(se,Ge)|0,x=x+Math.imul(W,Ze)|0,u=u+Math.imul(W,Ye)|0,u=u+Math.imul(ne,Ze)|0,S=S+Math.imul(ne,Ye)|0,x=x+Math.imul(ue,Je)|0,u=u+Math.imul(ue,Xe)|0,u=u+Math.imul(N,Je)|0,S=S+Math.imul(N,Xe)|0,x=x+Math.imul(ie,Qe)|0,u=u+Math.imul(ie,et)|0,u=u+Math.imul(ce,Qe)|0,S=S+Math.imul(ce,et)|0,x=x+Math.imul(q,tt)|0,u=u+Math.imul(q,rt)|0,u=u+Math.imul(F,tt)|0,S=S+Math.imul(F,rt)|0;var qn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(qn>>>26)|0,qn&=67108863,x=Math.imul(Ne,De),u=Math.imul(Ne,Ve),u=u+Math.imul(Le,De)|0,S=Math.imul(Le,Ve),x=x+Math.imul(st,qe)|0,u=u+Math.imul(st,He)|0,u=u+Math.imul(at,qe)|0,S=S+Math.imul(at,He)|0,x=x+Math.imul(Ce,je)|0,u=u+Math.imul(Ce,ze)|0,u=u+Math.imul(it,je)|0,S=S+Math.imul(it,ze)|0,x=x+Math.imul(Ke,Fe)|0,u=u+Math.imul(Ke,We)|0,u=u+Math.imul(Pe,Fe)|0,S=S+Math.imul(Pe,We)|0,x=x+Math.imul(Se,$e)|0,u=u+Math.imul(Se,Ge)|0,u=u+Math.imul(Ie,$e)|0,S=S+Math.imul(Ie,Ge)|0,x=x+Math.imul(te,Ze)|0,u=u+Math.imul(te,Ye)|0,u=u+Math.imul(se,Ze)|0,S=S+Math.imul(se,Ye)|0,x=x+Math.imul(W,Je)|0,u=u+Math.imul(W,Xe)|0,u=u+Math.imul(ne,Je)|0,S=S+Math.imul(ne,Xe)|0,x=x+Math.imul(ue,Qe)|0,u=u+Math.imul(ue,et)|0,u=u+Math.imul(N,Qe)|0,S=S+Math.imul(N,et)|0,x=x+Math.imul(ie,tt)|0,u=u+Math.imul(ie,rt)|0,u=u+Math.imul(ce,tt)|0,S=S+Math.imul(ce,rt)|0,x=x+Math.imul(q,nt)|0,u=u+Math.imul(q,ot)|0,u=u+Math.imul(F,nt)|0,S=S+Math.imul(F,ot)|0;var Hn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Hn>>>26)|0,Hn&=67108863,x=Math.imul(Ne,qe),u=Math.imul(Ne,He),u=u+Math.imul(Le,qe)|0,S=Math.imul(Le,He),x=x+Math.imul(st,je)|0,u=u+Math.imul(st,ze)|0,u=u+Math.imul(at,je)|0,S=S+Math.imul(at,ze)|0,x=x+Math.imul(Ce,Fe)|0,u=u+Math.imul(Ce,We)|0,u=u+Math.imul(it,Fe)|0,S=S+Math.imul(it,We)|0,x=x+Math.imul(Ke,$e)|0,u=u+Math.imul(Ke,Ge)|0,u=u+Math.imul(Pe,$e)|0,S=S+Math.imul(Pe,Ge)|0,x=x+Math.imul(Se,Ze)|0,u=u+Math.imul(Se,Ye)|0,u=u+Math.imul(Ie,Ze)|0,S=S+Math.imul(Ie,Ye)|0,x=x+Math.imul(te,Je)|0,u=u+Math.imul(te,Xe)|0,u=u+Math.imul(se,Je)|0,S=S+Math.imul(se,Xe)|0,x=x+Math.imul(W,Qe)|0,u=u+Math.imul(W,et)|0,u=u+Math.imul(ne,Qe)|0,S=S+Math.imul(ne,et)|0,x=x+Math.imul(ue,tt)|0,u=u+Math.imul(ue,rt)|0,u=u+Math.imul(N,tt)|0,S=S+Math.imul(N,rt)|0,x=x+Math.imul(ie,nt)|0,u=u+Math.imul(ie,ot)|0,u=u+Math.imul(ce,nt)|0,S=S+Math.imul(ce,ot)|0;var jn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(jn>>>26)|0,jn&=67108863,x=Math.imul(Ne,je),u=Math.imul(Ne,ze),u=u+Math.imul(Le,je)|0,S=Math.imul(Le,ze),x=x+Math.imul(st,Fe)|0,u=u+Math.imul(st,We)|0,u=u+Math.imul(at,Fe)|0,S=S+Math.imul(at,We)|0,x=x+Math.imul(Ce,$e)|0,u=u+Math.imul(Ce,Ge)|0,u=u+Math.imul(it,$e)|0,S=S+Math.imul(it,Ge)|0,x=x+Math.imul(Ke,Ze)|0,u=u+Math.imul(Ke,Ye)|0,u=u+Math.imul(Pe,Ze)|0,S=S+Math.imul(Pe,Ye)|0,x=x+Math.imul(Se,Je)|0,u=u+Math.imul(Se,Xe)|0,u=u+Math.imul(Ie,Je)|0,S=S+Math.imul(Ie,Xe)|0,x=x+Math.imul(te,Qe)|0,u=u+Math.imul(te,et)|0,u=u+Math.imul(se,Qe)|0,S=S+Math.imul(se,et)|0,x=x+Math.imul(W,tt)|0,u=u+Math.imul(W,rt)|0,u=u+Math.imul(ne,tt)|0,S=S+Math.imul(ne,rt)|0,x=x+Math.imul(ue,nt)|0,u=u+Math.imul(ue,ot)|0,u=u+Math.imul(N,nt)|0,S=S+Math.imul(N,ot)|0;var zn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(zn>>>26)|0,zn&=67108863,x=Math.imul(Ne,Fe),u=Math.imul(Ne,We),u=u+Math.imul(Le,Fe)|0,S=Math.imul(Le,We),x=x+Math.imul(st,$e)|0,u=u+Math.imul(st,Ge)|0,u=u+Math.imul(at,$e)|0,S=S+Math.imul(at,Ge)|0,x=x+Math.imul(Ce,Ze)|0,u=u+Math.imul(Ce,Ye)|0,u=u+Math.imul(it,Ze)|0,S=S+Math.imul(it,Ye)|0,x=x+Math.imul(Ke,Je)|0,u=u+Math.imul(Ke,Xe)|0,u=u+Math.imul(Pe,Je)|0,S=S+Math.imul(Pe,Xe)|0,x=x+Math.imul(Se,Qe)|0,u=u+Math.imul(Se,et)|0,u=u+Math.imul(Ie,Qe)|0,S=S+Math.imul(Ie,et)|0,x=x+Math.imul(te,tt)|0,u=u+Math.imul(te,rt)|0,u=u+Math.imul(se,tt)|0,S=S+Math.imul(se,rt)|0,x=x+Math.imul(W,nt)|0,u=u+Math.imul(W,ot)|0,u=u+Math.imul(ne,nt)|0,S=S+Math.imul(ne,ot)|0;var Fn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Fn>>>26)|0,Fn&=67108863,x=Math.imul(Ne,$e),u=Math.imul(Ne,Ge),u=u+Math.imul(Le,$e)|0,S=Math.imul(Le,Ge),x=x+Math.imul(st,Ze)|0,u=u+Math.imul(st,Ye)|0,u=u+Math.imul(at,Ze)|0,S=S+Math.imul(at,Ye)|0,x=x+Math.imul(Ce,Je)|0,u=u+Math.imul(Ce,Xe)|0,u=u+Math.imul(it,Je)|0,S=S+Math.imul(it,Xe)|0,x=x+Math.imul(Ke,Qe)|0,u=u+Math.imul(Ke,et)|0,u=u+Math.imul(Pe,Qe)|0,S=S+Math.imul(Pe,et)|0,x=x+Math.imul(Se,tt)|0,u=u+Math.imul(Se,rt)|0,u=u+Math.imul(Ie,tt)|0,S=S+Math.imul(Ie,rt)|0,x=x+Math.imul(te,nt)|0,u=u+Math.imul(te,ot)|0,u=u+Math.imul(se,nt)|0,S=S+Math.imul(se,ot)|0;var Wn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Wn>>>26)|0,Wn&=67108863,x=Math.imul(Ne,Ze),u=Math.imul(Ne,Ye),u=u+Math.imul(Le,Ze)|0,S=Math.imul(Le,Ye),x=x+Math.imul(st,Je)|0,u=u+Math.imul(st,Xe)|0,u=u+Math.imul(at,Je)|0,S=S+Math.imul(at,Xe)|0,x=x+Math.imul(Ce,Qe)|0,u=u+Math.imul(Ce,et)|0,u=u+Math.imul(it,Qe)|0,S=S+Math.imul(it,et)|0,x=x+Math.imul(Ke,tt)|0,u=u+Math.imul(Ke,rt)|0,u=u+Math.imul(Pe,tt)|0,S=S+Math.imul(Pe,rt)|0,x=x+Math.imul(Se,nt)|0,u=u+Math.imul(Se,ot)|0,u=u+Math.imul(Ie,nt)|0,S=S+Math.imul(Ie,ot)|0;var $n=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+($n>>>26)|0,$n&=67108863,x=Math.imul(Ne,Je),u=Math.imul(Ne,Xe),u=u+Math.imul(Le,Je)|0,S=Math.imul(Le,Xe),x=x+Math.imul(st,Qe)|0,u=u+Math.imul(st,et)|0,u=u+Math.imul(at,Qe)|0,S=S+Math.imul(at,et)|0,x=x+Math.imul(Ce,tt)|0,u=u+Math.imul(Ce,rt)|0,u=u+Math.imul(it,tt)|0,S=S+Math.imul(it,rt)|0,x=x+Math.imul(Ke,nt)|0,u=u+Math.imul(Ke,ot)|0,u=u+Math.imul(Pe,nt)|0,S=S+Math.imul(Pe,ot)|0;var Gn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Gn>>>26)|0,Gn&=67108863,x=Math.imul(Ne,Qe),u=Math.imul(Ne,et),u=u+Math.imul(Le,Qe)|0,S=Math.imul(Le,et),x=x+Math.imul(st,tt)|0,u=u+Math.imul(st,rt)|0,u=u+Math.imul(at,tt)|0,S=S+Math.imul(at,rt)|0,x=x+Math.imul(Ce,nt)|0,u=u+Math.imul(Ce,ot)|0,u=u+Math.imul(it,nt)|0,S=S+Math.imul(it,ot)|0;var Zn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Zn>>>26)|0,Zn&=67108863,x=Math.imul(Ne,tt),u=Math.imul(Ne,rt),u=u+Math.imul(Le,tt)|0,S=Math.imul(Le,rt),x=x+Math.imul(st,nt)|0,u=u+Math.imul(st,ot)|0,u=u+Math.imul(at,nt)|0,S=S+Math.imul(at,ot)|0;var Hs=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Hs>>>26)|0,Hs&=67108863,x=Math.imul(Ne,nt),u=Math.imul(Ne,ot),u=u+Math.imul(Le,nt)|0,S=Math.imul(Le,ot);var js=(I+x|0)+((u&8191)<<13)|0;return I=(S+(u>>>13)|0)+(js>>>26)|0,js&=67108863,M[0]=On,M[1]=Kn,M[2]=Rn,M[3]=Un,M[4]=Nn,M[5]=Ln,M[6]=Dn,M[7]=Vn,M[8]=qn,M[9]=Hn,M[10]=jn,M[11]=zn,M[12]=Fn,M[13]=Wn,M[14]=$n,M[15]=Gn,M[16]=Zn,M[17]=Hs,M[18]=js,I!==0&&(M[19]=I,h.length++),h},"comb10MulTo");Math.imul||(B=T);function P(E,c,d){d.negative=c.negative^E.negative,d.length=E.length+c.length;for(var h=0,y=0,b=0;b<d.length-1;b++){var M=y;y=0;for(var I=h&67108863,x=Math.min(b,c.length-1),u=Math.max(0,b-E.length+1);u<=x;u++){var S=b-u,V=E.words[S]|0,q=c.words[u]|0,F=V*q,ee=F&67108863;M=M+(F/67108864|0)|0,ee=ee+I|0,I=ee&67108863,M=M+(ee>>>26)|0,y+=M>>>26,M&=67108863}d.words[b]=I,h=M,M=y}return h!==0?d.words[b]=h:d.length--,d.strip()}i(P,"bigMulTo");function C(E,c,d){var h=new O;return h.mulp(E,c,d)}i(C,"jumboMulTo"),o.prototype.mulTo=i(function(c,d){var h,y=this.length+c.length;return this.length===10&&c.length===10?h=B(this,c,d):y<63?h=T(this,c,d):y<1024?h=P(this,c,d):h=C(this,c,d),h},"mulTo");function O(E,c){this.x=E,this.y=c}i(O,"FFTM"),O.prototype.makeRBT=i(function(c){for(var d=new Array(c),h=o.prototype._countBits(c)-1,y=0;y<c;y++)d[y]=this.revBin(y,h,c);return d},"makeRBT"),O.prototype.revBin=i(function(c,d,h){if(c===0||c===h-1)return c;for(var y=0,b=0;b<d;b++)y|=(c&1)<<d-b-1,c>>=1;return y},"revBin"),O.prototype.permute=i(function(c,d,h,y,b,M){for(var I=0;I<M;I++)y[I]=d[c[I]],b[I]=h[c[I]]},"permute"),O.prototype.transform=i(function(c,d,h,y,b,M){this.permute(M,c,d,h,y,b);for(var I=1;I<b;I<<=1)for(var x=I<<1,u=Math.cos(2*Math.PI/x),S=Math.sin(2*Math.PI/x),V=0;V<b;V+=x)for(var q=u,F=S,ee=0;ee<I;ee++){var ie=h[V+ee],ce=y[V+ee],ye=h[V+ee+I],ue=y[V+ee+I],N=q*ye-F*ue;ue=q*ue+F*ye,ye=N,h[V+ee]=ie+ye,y[V+ee]=ce+ue,h[V+ee+I]=ie-ye,y[V+ee+I]=ce-ue,ee!==x&&(N=u*q-S*F,F=u*F+S*q,q=N)}},"transform"),O.prototype.guessLen13b=i(function(c,d){var h=Math.max(d,c)|1,y=h&1,b=0;for(h=h/2|0;h;h=h>>>1)b++;return 1<<b+1+y},"guessLen13b"),O.prototype.conjugate=i(function(c,d,h){if(!(h<=1))for(var y=0;y<h/2;y++){var b=c[y];c[y]=c[h-y-1],c[h-y-1]=b,b=d[y],d[y]=-d[h-y-1],d[h-y-1]=-b}},"conjugate"),O.prototype.normalize13b=i(function(c,d){for(var h=0,y=0;y<d/2;y++){var b=Math.round(c[2*y+1]/d)*8192+Math.round(c[2*y]/d)+h;c[y]=b&67108863,b<67108864?h=0:h=b/67108864|0}return c},"normalize13b"),O.prototype.convert13b=i(function(c,d,h,y){for(var b=0,M=0;M<d;M++)b=b+(c[M]|0),h[2*M]=b&8191,b=b>>>13,h[2*M+1]=b&8191,b=b>>>13;for(M=2*d;M<y;++M)h[M]=0;r(b===0),r((b&-8192)===0)},"convert13b"),O.prototype.stub=i(function(c){for(var d=new Array(c),h=0;h<c;h++)d[h]=0;return d},"stub"),O.prototype.mulp=i(function(c,d,h){var y=2*this.guessLen13b(c.length,d.length),b=this.makeRBT(y),M=this.stub(y),I=new Array(y),x=new Array(y),u=new Array(y),S=new Array(y),V=new Array(y),q=new Array(y),F=h.words;F.length=y,this.convert13b(c.words,c.length,I,y),this.convert13b(d.words,d.length,S,y),this.transform(I,M,x,u,y,b),this.transform(S,M,V,q,y,b);for(var ee=0;ee<y;ee++){var ie=x[ee]*V[ee]-u[ee]*q[ee];u[ee]=x[ee]*q[ee]+u[ee]*V[ee],x[ee]=ie}return this.conjugate(x,u,y),this.transform(x,u,F,M,y,b),this.conjugate(F,M,y),this.normalize13b(F,y),h.negative=c.negative^d.negative,h.length=c.length+d.length,h.strip()},"mulp"),o.prototype.mul=i(function(c){var d=new o(null);return d.words=new Array(this.length+c.length),this.mulTo(c,d)},"mul"),o.prototype.mulf=i(function(c){var d=new o(null);return d.words=new Array(this.length+c.length),C(this,c,d)},"mulf"),o.prototype.imul=i(function(c){return this.clone().mulTo(c,this)},"imul"),o.prototype.imuln=i(function(c){r(typeof c=="number"),r(c<67108864);for(var d=0,h=0;h<this.length;h++){var y=(this.words[h]|0)*c,b=(y&67108863)+(d&67108863);d>>=26,d+=y/67108864|0,d+=b>>>26,this.words[h]=b&67108863}return d!==0&&(this.words[h]=d,this.length++),this},"imuln"),o.prototype.muln=i(function(c){return this.clone().imuln(c)},"muln"),o.prototype.sqr=i(function(){return this.mul(this)},"sqr"),o.prototype.isqr=i(function(){return this.imul(this.clone())},"isqr"),o.prototype.pow=i(function(c){var d=_(c);if(d.length===0)return new o(1);for(var h=this,y=0;y<d.length&&d[y]===0;y++,h=h.sqr());if(++y<d.length)for(var b=h.sqr();y<d.length;y++,b=b.sqr())d[y]!==0&&(h=h.mul(b));return h},"pow"),o.prototype.iushln=i(function(c){r(typeof c=="number"&&c>=0);var d=c%26,h=(c-d)/26,y=67108863>>>26-d<<26-d,b;if(d!==0){var M=0;for(b=0;b<this.length;b++){var I=this.words[b]&y,x=(this.words[b]|0)-I<<d;this.words[b]=x|M,M=I>>>26-d}M&&(this.words[b]=M,this.length++)}if(h!==0){for(b=this.length-1;b>=0;b--)this.words[b+h]=this.words[b];for(b=0;b<h;b++)this.words[b]=0;this.length+=h}return this.strip()},"iushln"),o.prototype.ishln=i(function(c){return r(this.negative===0),this.iushln(c)},"ishln"),o.prototype.iushrn=i(function(c,d,h){r(typeof c=="number"&&c>=0);var y;d?y=(d-d%26)/26:y=0;var b=c%26,M=Math.min((c-b)/26,this.length),I=67108863^67108863>>>b<<b,x=h;if(y-=M,y=Math.max(0,y),x){for(var u=0;u<M;u++)x.words[u]=this.words[u];x.length=M}if(M!==0)if(this.length>M)for(this.length-=M,u=0;u<this.length;u++)this.words[u]=this.words[u+M];else this.words[0]=0,this.length=1;var S=0;for(u=this.length-1;u>=0&&(S!==0||u>=y);u--){var V=this.words[u]|0;this.words[u]=S<<26-b|V>>>b,S=V&I}return x&&S!==0&&(x.words[x.length++]=S),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},"iushrn"),o.prototype.ishrn=i(function(c,d,h){return r(this.negative===0),this.iushrn(c,d,h)},"ishrn"),o.prototype.shln=i(function(c){return this.clone().ishln(c)},"shln"),o.prototype.ushln=i(function(c){return this.clone().iushln(c)},"ushln"),o.prototype.shrn=i(function(c){return this.clone().ishrn(c)},"shrn"),o.prototype.ushrn=i(function(c){return this.clone().iushrn(c)},"ushrn"),o.prototype.testn=i(function(c){r(typeof c=="number"&&c>=0);var d=c%26,h=(c-d)/26,y=1<<d;if(this.length<=h)return!1;var b=this.words[h];return!!(b&y)},"testn"),o.prototype.imaskn=i(function(c){r(typeof c=="number"&&c>=0);var d=c%26,h=(c-d)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=h)return this;if(d!==0&&h++,this.length=Math.min(h,this.length),d!==0){var y=67108863^67108863>>>d<<d;this.words[this.length-1]&=y}return this.strip()},"imaskn"),o.prototype.maskn=i(function(c){return this.clone().imaskn(c)},"maskn"),o.prototype.iaddn=i(function(c){return r(typeof c=="number"),r(c<67108864),c<0?this.isubn(-c):this.negative!==0?this.length===1&&(this.words[0]|0)<c?(this.words[0]=c-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(c),this.negative=1,this):this._iaddn(c)},"iaddn"),o.prototype._iaddn=i(function(c){this.words[0]+=c;for(var d=0;d<this.length&&this.words[d]>=67108864;d++)this.words[d]-=67108864,d===this.length-1?this.words[d+1]=1:this.words[d+1]++;return this.length=Math.max(this.length,d+1),this},"_iaddn"),o.prototype.isubn=i(function(c){if(r(typeof c=="number"),r(c<67108864),c<0)return this.iaddn(-c);if(this.negative!==0)return this.negative=0,this.iaddn(c),this.negative=1,this;if(this.words[0]-=c,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var d=0;d<this.length&&this.words[d]<0;d++)this.words[d]+=67108864,this.words[d+1]-=1;return this.strip()},"isubn"),o.prototype.addn=i(function(c){return this.clone().iaddn(c)},"addn"),o.prototype.subn=i(function(c){return this.clone().isubn(c)},"subn"),o.prototype.iabs=i(function(){return this.negative=0,this},"iabs"),o.prototype.abs=i(function(){return this.clone().iabs()},"abs"),o.prototype._ishlnsubmul=i(function(c,d,h){var y=c.length+h,b;this._expand(y);var M,I=0;for(b=0;b<c.length;b++){M=(this.words[b+h]|0)+I;var x=(c.words[b]|0)*d;M-=x&67108863,I=(M>>26)-(x/67108864|0),this.words[b+h]=M&67108863}for(;b<this.length-h;b++)M=(this.words[b+h]|0)+I,I=M>>26,this.words[b+h]=M&67108863;if(I===0)return this.strip();for(r(I===-1),I=0,b=0;b<this.length;b++)M=-(this.words[b]|0)+I,I=M>>26,this.words[b]=M&67108863;return this.negative=1,this.strip()},"_ishlnsubmul"),o.prototype._wordDiv=i(function(c,d){var h=this.length-c.length,y=this.clone(),b=c,M=b.words[b.length-1]|0,I=this._countBits(M);h=26-I,h!==0&&(b=b.ushln(h),y.iushln(h),M=b.words[b.length-1]|0);var x=y.length-b.length,u;if(d!=="mod"){u=new o(null),u.length=x+1,u.words=new Array(u.length);for(var S=0;S<u.length;S++)u.words[S]=0}var V=y.clone()._ishlnsubmul(b,1,x);V.negative===0&&(y=V,u&&(u.words[x]=1));for(var q=x-1;q>=0;q--){var F=(y.words[b.length+q]|0)*67108864+(y.words[b.length+q-1]|0);for(F=Math.min(F/M|0,67108863),y._ishlnsubmul(b,F,q);y.negative!==0;)F--,y.negative=0,y._ishlnsubmul(b,1,q),y.isZero()||(y.negative^=1);u&&(u.words[q]=F)}return u&&u.strip(),y.strip(),d!=="div"&&h!==0&&y.iushrn(h),{div:u||null,mod:y}},"_wordDiv"),o.prototype.divmod=i(function(c,d,h){if(r(!c.isZero()),this.isZero())return{div:new o(0),mod:new o(0)};var y,b,M;return this.negative!==0&&c.negative===0?(M=this.neg().divmod(c,d),d!=="mod"&&(y=M.div.neg()),d!=="div"&&(b=M.mod.neg(),h&&b.negative!==0&&b.iadd(c)),{div:y,mod:b}):this.negative===0&&c.negative!==0?(M=this.divmod(c.neg(),d),d!=="mod"&&(y=M.div.neg()),{div:y,mod:M.mod}):this.negative&c.negative?(M=this.neg().divmod(c.neg(),d),d!=="div"&&(b=M.mod.neg(),h&&b.negative!==0&&b.isub(c)),{div:M.div,mod:b}):c.length>this.length||this.cmp(c)<0?{div:new o(0),mod:this}:c.length===1?d==="div"?{div:this.divn(c.words[0]),mod:null}:d==="mod"?{div:null,mod:new o(this.modn(c.words[0]))}:{div:this.divn(c.words[0]),mod:new o(this.modn(c.words[0]))}:this._wordDiv(c,d)},"divmod"),o.prototype.div=i(function(c){return this.divmod(c,"div",!1).div},"div"),o.prototype.mod=i(function(c){return this.divmod(c,"mod",!1).mod},"mod"),o.prototype.umod=i(function(c){return this.divmod(c,"mod",!0).mod},"umod"),o.prototype.divRound=i(function(c){var d=this.divmod(c);if(d.mod.isZero())return d.div;var h=d.div.negative!==0?d.mod.isub(c):d.mod,y=c.ushrn(1),b=c.andln(1),M=h.cmp(y);return M<0||b===1&&M===0?d.div:d.div.negative!==0?d.div.isubn(1):d.div.iaddn(1)},"divRound"),o.prototype.modn=i(function(c){r(c<=67108863);for(var d=(1<<26)%c,h=0,y=this.length-1;y>=0;y--)h=(d*h+(this.words[y]|0))%c;return h},"modn"),o.prototype.idivn=i(function(c){r(c<=67108863);for(var d=0,h=this.length-1;h>=0;h--){var y=(this.words[h]|0)+d*67108864;this.words[h]=y/c|0,d=y%c}return this.strip()},"idivn"),o.prototype.divn=i(function(c){return this.clone().idivn(c)},"divn"),o.prototype.egcd=i(function(c){r(c.negative===0),r(!c.isZero());var d=this,h=c.clone();d.negative!==0?d=d.umod(c):d=d.clone();for(var y=new o(1),b=new o(0),M=new o(0),I=new o(1),x=0;d.isEven()&&h.isEven();)d.iushrn(1),h.iushrn(1),++x;for(var u=h.clone(),S=d.clone();!d.isZero();){for(var V=0,q=1;!(d.words[0]&q)&&V<26;++V,q<<=1);if(V>0)for(d.iushrn(V);V-- >0;)(y.isOdd()||b.isOdd())&&(y.iadd(u),b.isub(S)),y.iushrn(1),b.iushrn(1);for(var F=0,ee=1;!(h.words[0]&ee)&&F<26;++F,ee<<=1);if(F>0)for(h.iushrn(F);F-- >0;)(M.isOdd()||I.isOdd())&&(M.iadd(u),I.isub(S)),M.iushrn(1),I.iushrn(1);d.cmp(h)>=0?(d.isub(h),y.isub(M),b.isub(I)):(h.isub(d),M.isub(y),I.isub(b))}return{a:M,b:I,gcd:h.iushln(x)}},"egcd"),o.prototype._invmp=i(function(c){r(c.negative===0),r(!c.isZero());var d=this,h=c.clone();d.negative!==0?d=d.umod(c):d=d.clone();for(var y=new o(1),b=new o(0),M=h.clone();d.cmpn(1)>0&&h.cmpn(1)>0;){for(var I=0,x=1;!(d.words[0]&x)&&I<26;++I,x<<=1);if(I>0)for(d.iushrn(I);I-- >0;)y.isOdd()&&y.iadd(M),y.iushrn(1);for(var u=0,S=1;!(h.words[0]&S)&&u<26;++u,S<<=1);if(u>0)for(h.iushrn(u);u-- >0;)b.isOdd()&&b.iadd(M),b.iushrn(1);d.cmp(h)>=0?(d.isub(h),y.isub(b)):(h.isub(d),b.isub(y))}var V;return d.cmpn(1)===0?V=y:V=b,V.cmpn(0)<0&&V.iadd(c),V},"_invmp"),o.prototype.gcd=i(function(c){if(this.isZero())return c.abs();if(c.isZero())return this.abs();var d=this.clone(),h=c.clone();d.negative=0,h.negative=0;for(var y=0;d.isEven()&&h.isEven();y++)d.iushrn(1),h.iushrn(1);do{for(;d.isEven();)d.iushrn(1);for(;h.isEven();)h.iushrn(1);var b=d.cmp(h);if(b<0){var M=d;d=h,h=M}else if(b===0||h.cmpn(1)===0)break;d.isub(h)}while(!0);return h.iushln(y)},"gcd"),o.prototype.invm=i(function(c){return this.egcd(c).a.umod(c)},"invm"),o.prototype.isEven=i(function(){return(this.words[0]&1)===0},"isEven"),o.prototype.isOdd=i(function(){return(this.words[0]&1)===1},"isOdd"),o.prototype.andln=i(function(c){return this.words[0]&c},"andln"),o.prototype.bincn=i(function(c){r(typeof c=="number");var d=c%26,h=(c-d)/26,y=1<<d;if(this.length<=h)return this._expand(h+1),this.words[h]|=y,this;for(var b=y,M=h;b!==0&&M<this.length;M++){var I=this.words[M]|0;I+=b,b=I>>>26,I&=67108863,this.words[M]=I}return b!==0&&(this.words[M]=b,this.length++),this},"bincn"),o.prototype.isZero=i(function(){return this.length===1&&this.words[0]===0},"isZero"),o.prototype.cmpn=i(function(c){var d=c<0;if(this.negative!==0&&!d)return-1;if(this.negative===0&&d)return 1;this.strip();var h;if(this.length>1)h=1;else{d&&(c=-c),r(c<=67108863,"Number is too big");var y=this.words[0]|0;h=y===c?0:y<c?-1:1}return this.negative!==0?-h|0:h},"cmpn"),o.prototype.cmp=i(function(c){if(this.negative!==0&&c.negative===0)return-1;if(this.negative===0&&c.negative!==0)return 1;var d=this.ucmp(c);return this.negative!==0?-d|0:d},"cmp"),o.prototype.ucmp=i(function(c){if(this.length>c.length)return 1;if(this.length<c.length)return-1;for(var d=0,h=this.length-1;h>=0;h--){var y=this.words[h]|0,b=c.words[h]|0;if(y!==b){y<b?d=-1:y>b&&(d=1);break}}return d},"ucmp"),o.prototype.gtn=i(function(c){return this.cmpn(c)===1},"gtn"),o.prototype.gt=i(function(c){return this.cmp(c)===1},"gt"),o.prototype.gten=i(function(c){return this.cmpn(c)>=0},"gten"),o.prototype.gte=i(function(c){return this.cmp(c)>=0},"gte"),o.prototype.ltn=i(function(c){return this.cmpn(c)===-1},"ltn"),o.prototype.lt=i(function(c){return this.cmp(c)===-1},"lt"),o.prototype.lten=i(function(c){return this.cmpn(c)<=0},"lten"),o.prototype.lte=i(function(c){return this.cmp(c)<=0},"lte"),o.prototype.eqn=i(function(c){return this.cmpn(c)===0},"eqn"),o.prototype.eq=i(function(c){return this.cmp(c)===0},"eq"),o.red=i(function(c){return new z(c)},"red"),o.prototype.toRed=i(function(c){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),c.convertTo(this)._forceRed(c)},"toRed"),o.prototype.fromRed=i(function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},"fromRed"),o.prototype._forceRed=i(function(c){return this.red=c,this},"_forceRed"),o.prototype.forceRed=i(function(c){return r(!this.red,"Already a number in reduction context"),this._forceRed(c)},"forceRed"),o.prototype.redAdd=i(function(c){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,c)},"redAdd"),o.prototype.redIAdd=i(function(c){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,c)},"redIAdd"),o.prototype.redSub=i(function(c){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,c)},"redSub"),o.prototype.redISub=i(function(c){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,c)},"redISub"),o.prototype.redShl=i(function(c){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,c)},"redShl"),o.prototype.redMul=i(function(c){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,c),this.red.mul(this,c)},"redMul"),o.prototype.redIMul=i(function(c){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,c),this.red.imul(this,c)},"redIMul"),o.prototype.redSqr=i(function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},"redSqr"),o.prototype.redISqr=i(function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},"redISqr"),o.prototype.redSqrt=i(function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},"redSqrt"),o.prototype.redInvm=i(function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},"redInvm"),o.prototype.redNeg=i(function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},"redNeg"),o.prototype.redPow=i(function(c){return r(this.red&&!c.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,c)},"redPow");var L={k256:null,p224:null,p192:null,p25519:null};function R(E,c){this.name=E,this.p=new o(c,16),this.n=this.p.bitLength(),this.k=new o(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}i(R,"MPrime"),R.prototype._tmp=i(function(){var c=new o(null);return c.words=new Array(Math.ceil(this.n/13)),c},"_tmp"),R.prototype.ireduce=i(function(c){var d=c,h;do this.split(d,this.tmp),d=this.imulK(d),d=d.iadd(this.tmp),h=d.bitLength();while(h>this.n);var y=h<this.n?-1:d.ucmp(this.p);return y===0?(d.words[0]=0,d.length=1):y>0?d.isub(this.p):d.strip!==void 0?d.strip():d._strip(),d},"ireduce"),R.prototype.split=i(function(c,d){c.iushrn(this.n,0,d)},"split"),R.prototype.imulK=i(function(c){return c.imul(this.k)},"imulK");function j(){R.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}i(j,"K256"),n(j,R),j.prototype.split=i(function(c,d){for(var h=4194303,y=Math.min(c.length,9),b=0;b<y;b++)d.words[b]=c.words[b];if(d.length=y,c.length<=9){c.words[0]=0,c.length=1;return}var M=c.words[9];for(d.words[d.length++]=M&h,b=10;b<c.length;b++){var I=c.words[b]|0;c.words[b-10]=(I&h)<<4|M>>>22,M=I}M>>>=22,c.words[b-10]=M,M===0&&c.length>10?c.length-=10:c.length-=9},"split"),j.prototype.imulK=i(function(c){c.words[c.length]=0,c.words[c.length+1]=0,c.length+=2;for(var d=0,h=0;h<c.length;h++){var y=c.words[h]|0;d+=y*977,c.words[h]=d&67108863,d=y*64+(d/67108864|0)}return c.words[c.length-1]===0&&(c.length--,c.words[c.length-1]===0&&c.length--),c},"imulK");function Z(){R.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}i(Z,"P224"),n(Z,R);function X(){R.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}i(X,"P192"),n(X,R);function Q(){R.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}i(Q,"P25519"),n(Q,R),Q.prototype.imulK=i(function(c){for(var d=0,h=0;h<c.length;h++){var y=(c.words[h]|0)*19+d,b=y&67108863;y>>>=26,c.words[h]=b,d=y}return d!==0&&(c.words[c.length++]=d),c},"imulK"),o._prime=i(function(c){if(L[c])return L[c];var d;if(c==="k256")d=new j;else if(c==="p224")d=new Z;else if(c==="p192")d=new X;else if(c==="p25519")d=new Q;else throw new Error("Unknown prime "+c);return L[c]=d,d},"prime");function z(E){if(typeof E=="string"){var c=o._prime(E);this.m=c.p,this.prime=c}else r(E.gtn(1),"modulus must be greater than 1"),this.m=E,this.prime=null}i(z,"Red"),z.prototype._verify1=i(function(c){r(c.negative===0,"red works only with positives"),r(c.red,"red works only with red numbers")},"_verify1"),z.prototype._verify2=i(function(c,d){r((c.negative|d.negative)===0,"red works only with positives"),r(c.red&&c.red===d.red,"red works only with red numbers")},"_verify2"),z.prototype.imod=i(function(c){return this.prime?this.prime.ireduce(c)._forceRed(this):c.umod(this.m)._forceRed(this)},"imod"),z.prototype.neg=i(function(c){return c.isZero()?c.clone():this.m.sub(c)._forceRed(this)},"neg"),z.prototype.add=i(function(c,d){this._verify2(c,d);var h=c.add(d);return h.cmp(this.m)>=0&&h.isub(this.m),h._forceRed(this)},"add"),z.prototype.iadd=i(function(c,d){this._verify2(c,d);var h=c.iadd(d);return h.cmp(this.m)>=0&&h.isub(this.m),h},"iadd"),z.prototype.sub=i(function(c,d){this._verify2(c,d);var h=c.sub(d);return h.cmpn(0)<0&&h.iadd(this.m),h._forceRed(this)},"sub"),z.prototype.isub=i(function(c,d){this._verify2(c,d);var h=c.isub(d);return h.cmpn(0)<0&&h.iadd(this.m),h},"isub"),z.prototype.shl=i(function(c,d){return this._verify1(c),this.imod(c.ushln(d))},"shl"),z.prototype.imul=i(function(c,d){return this._verify2(c,d),this.imod(c.imul(d))},"imul"),z.prototype.mul=i(function(c,d){return this._verify2(c,d),this.imod(c.mul(d))},"mul"),z.prototype.isqr=i(function(c){return this.imul(c,c.clone())},"isqr"),z.prototype.sqr=i(function(c){return this.mul(c,c)},"sqr"),z.prototype.sqrt=i(function(c){if(c.isZero())return c.clone();var d=this.m.andln(3);if(r(d%2===1),d===3){var h=this.m.add(new o(1)).iushrn(2);return this.pow(c,h)}for(var y=this.m.subn(1),b=0;!y.isZero()&&y.andln(1)===0;)b++,y.iushrn(1);r(!y.isZero());var M=new o(1).toRed(this),I=M.redNeg(),x=this.m.subn(1).iushrn(1),u=this.m.bitLength();for(u=new o(2*u*u).toRed(this);this.pow(u,x).cmp(I)!==0;)u.redIAdd(I);for(var S=this.pow(u,y),V=this.pow(c,y.addn(1).iushrn(1)),q=this.pow(c,y),F=b;q.cmp(M)!==0;){for(var ee=q,ie=0;ee.cmp(M)!==0;ie++)ee=ee.redSqr();r(ie<F);var ce=this.pow(S,new o(1).iushln(F-ie-1));V=V.redMul(ce),S=ce.redSqr(),q=q.redMul(S),F=ie}return V},"sqrt"),z.prototype.invm=i(function(c){var d=c._invmp(this.m);return d.negative!==0?(d.negative=0,this.imod(d).redNeg()):this.imod(d)},"invm"),z.prototype.pow=i(function(c,d){if(d.isZero())return new o(1).toRed(this);if(d.cmpn(1)===0)return c.clone();var h=4,y=new Array(1<<h);y[0]=new o(1).toRed(this),y[1]=c;for(var b=2;b<y.length;b++)y[b]=this.mul(y[b-1],c);var M=y[0],I=0,x=0,u=d.bitLength()%26;for(u===0&&(u=26),b=d.length-1;b>=0;b--){for(var S=d.words[b],V=u-1;V>=0;V--){var q=S>>V&1;if(M!==y[0]&&(M=this.sqr(M)),q===0&&I===0){x=0;continue}I<<=1,I|=q,x++,!(x!==h&&(b!==0||V!==0))&&(M=this.mul(M,y[I]),x=0,I=0)}u=26}return M},"pow"),z.prototype.convertTo=i(function(c){var d=c.umod(this.m);return d===c?d.clone():d},"convertTo"),z.prototype.convertFrom=i(function(c){var d=c.clone();return d.red=null,d},"convertFrom"),o.mont=i(function(c){return new H(c)},"mont");function H(E){z.call(this,E),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new o(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}i(H,"Mont"),n(H,z),H.prototype.convertTo=i(function(c){return this.imod(c.ushln(this.shift))},"convertTo"),H.prototype.convertFrom=i(function(c){var d=this.imod(c.mul(this.rinv));return d.red=null,d},"convertFrom"),H.prototype.imul=i(function(c,d){if(c.isZero()||d.isZero())return c.words[0]=0,c.length=1,c;var h=c.imul(d),y=h.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),b=h.isub(y).iushrn(this.shift),M=b;return b.cmp(this.m)>=0?M=b.isub(this.m):b.cmpn(0)<0&&(M=b.iadd(this.m)),M._forceRed(this)},"imul"),H.prototype.mul=i(function(c,d){if(c.isZero()||d.isZero())return new o(0)._forceRed(this);var h=c.mul(d),y=h.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),b=h.isub(y).iushrn(this.shift),M=b;return b.cmp(this.m)>=0?M=b.isub(this.m):b.cmpn(0)<0&&(M=b.iadd(this.m)),M._forceRed(this)},"mul"),H.prototype.invm=i(function(c){var d=this.imod(c._invmp(this.m).mul(this.r2));return d._forceRed(this)},"invm")})(typeof Tg>"u"||Tg,mS)});var yS=ae(Ac=>{"use strict";m();g();Object.defineProperty(Ac,"__esModule",{value:!0});var ua=ca(),i5=ew().ec,Bg=new i5("secp256k1"),Sc=Bg.curve;Ac.privateKeyExport=function(e,t){t===void 0&&(t=!0);var r=new ua(e);if(r.ucmp(Sc.n)>=0)throw new Error("couldn't export to DER format");var n=Bg.g.mul(r);return gS(n.getX(),n.getY(),t)};Ac.privateKeyModInverse=function(e){var t=new ua(e);if(t.ucmp(Sc.n)>=0||t.isZero())throw new Error("private key range is invalid");return t.invm(Sc.n).toArrayLike(Buffer,"be",32)};Ac.signatureImport=function(e){var t=new ua(e.r);t.ucmp(Sc.n)>=0&&(t=new ua(0));var r=new ua(e.s);return r.ucmp(Sc.n)>=0&&(r=new ua(0)),Buffer.concat([t.toArrayLike(Buffer,"be",32),r.toArrayLike(Buffer,"be",32)])};Ac.ecdhUnsafe=function(e,t,r){r===void 0&&(r=!0);var n=Bg.keyFromPublic(e),o=new ua(t);if(o.ucmp(Sc.n)>=0||o.isZero())throw new Error("scalar was invalid (zero or overflow)");var s=n.pub.mul(o);return gS(s.getX(),s.getY(),r)};var gS=i(function(e,t,r){var n;return r?(n=Buffer.alloc(33),n[0]=t.isOdd()?3:2,e.toArrayLike(Buffer,"be",32).copy(n,1)):(n=Buffer.alloc(65),n[0]=4,e.toArrayLike(Buffer,"be",32).copy(n,1),t.toArrayLike(Buffer,"be",32).copy(n,33)),n},"toPublicKey")});var bS=ae($u=>{"use strict";m();g();Object.defineProperty($u,"__esModule",{value:!0});var{Buffer:Wu}=vo(),s5=Wu.from([48,129,211,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,133,48,129,130,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,33,2,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,36,3,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),a5=Wu.from([48,130,1,19,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,165,48,129,162,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,65,4,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,72,58,218,119,38,163,196,101,93,164,251,252,14,17,8,168,253,23,180,72,166,133,84,25,156,71,208,143,251,16,212,184,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,68,3,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);$u.privateKeyExport=function(e,t,r){r===void 0&&(r=!0);var n=Wu.from(r?s5:a5);return e.copy(n,r?8:9),t.copy(n,r?181:214),n};$u.privateKeyImport=function(e){var t=e.length,r=0;if(t<r+1||e[r]!==48||(r+=1,t<r+1||!(e[r]&128)))return null;var n=e[r]&127;if(r+=1,n<1||n>2||t<r+n)return null;var o=e[r+n-1]|(n>1?e[r+n-2]<<8:0);return r+=n,t<r+o||t<r+3||e[r]!==2||e[r+1]!==1||e[r+2]!==1||(r+=3,t<r+2||e[r]!==4||e[r+1]>32||t<r+2+e[r+1])?null:e.slice(r+2,r+2+e[r+1])};$u.signatureImportLax=function(e){var t=Wu.alloc(32,0),r=Wu.alloc(32,0),n=e.length,o=0;if(e[o++]!==48)return null;var s=e[o++];if(s&128&&(o+=s-128,o>n)||e[o++]!==2)return null;var a=e[o++];if(a&128){if(s=a-128,o+s>n)return null;for(;s>0&&e[o]===0;o+=1,s-=1);for(a=0;s>0;o+=1,s-=1)a=(a<<8)+e[o]}if(a>n-o)return null;var l=o;if(o+=a,e[o++]!==2)return null;var f=e[o++];if(f&128){if(s=f-128,o+s>n)return null;for(;s>0&&e[o]===0;o+=1,s-=1);for(f=0;s>0;o+=1,s-=1)f=(f<<8)+e[o]}if(f>n-o)return null;var p=o;for(o+=f;a>0&&e[l]===0;a-=1,l+=1);if(a>32)return null;var w=e.slice(l,l+a);for(w.copy(t,32-w.length);f>0&&e[p]===0;f-=1,p+=1);if(f>32)return null;var A=e.slice(p,p+f);return A.copy(r,32-A.length),{r:t,s:r}}});var Ud=ae(Oe=>{"use strict";m();g();Object.defineProperty(Oe,"__esModule",{value:!0});Oe.ecdhUnsafe=Oe.ecdh=Oe.recover=Oe.verify=Oe.sign=Oe.signatureImportLax=Oe.signatureImport=Oe.signatureExport=Oe.signatureNormalize=Oe.publicKeyCombine=Oe.publicKeyTweakMul=Oe.publicKeyTweakAdd=Oe.publicKeyVerify=Oe.publicKeyConvert=Oe.publicKeyCreate=Oe.privateKeyTweakMul=Oe.privateKeyTweakAdd=Oe.privateKeyModInverse=Oe.privateKeyNegate=Oe.privateKeyImport=Oe.privateKeyExport=Oe.privateKeyVerify=void 0;var hr=pS(),Rd=yS(),kg=bS();Oe.privateKeyVerify=function(e){return e.length!==32?!1:hr.privateKeyVerify(Uint8Array.from(e))};Oe.privateKeyExport=function(e,t){if(e.length!==32)throw new RangeError("private key length is invalid");var r=Rd.privateKeyExport(e,t);return kg.privateKeyExport(e,r,t)};Oe.privateKeyImport=function(e){if(e=kg.privateKeyImport(e),e!==null&&e.length===32&&Oe.privateKeyVerify(e))return e;throw new Error("couldn't import from DER format")};Oe.privateKeyNegate=function(e){return Buffer.from(hr.privateKeyNegate(Uint8Array.from(e)))};Oe.privateKeyModInverse=function(e){if(e.length!==32)throw new Error("private key length is invalid");return Buffer.from(Rd.privateKeyModInverse(Uint8Array.from(e)))};Oe.privateKeyTweakAdd=function(e,t){return Buffer.from(hr.privateKeyTweakAdd(Uint8Array.from(e),t))};Oe.privateKeyTweakMul=function(e,t){return Buffer.from(hr.privateKeyTweakMul(Uint8Array.from(e),Uint8Array.from(t)))};Oe.publicKeyCreate=function(e,t){return Buffer.from(hr.publicKeyCreate(Uint8Array.from(e),t))};Oe.publicKeyConvert=function(e,t){return Buffer.from(hr.publicKeyConvert(Uint8Array.from(e),t))};Oe.publicKeyVerify=function(e){return e.length!==33&&e.length!==65?!1:hr.publicKeyVerify(Uint8Array.from(e))};Oe.publicKeyTweakAdd=function(e,t,r){return Buffer.from(hr.publicKeyTweakAdd(Uint8Array.from(e),Uint8Array.from(t),r))};Oe.publicKeyTweakMul=function(e,t,r){return Buffer.from(hr.publicKeyTweakMul(Uint8Array.from(e),Uint8Array.from(t),r))};Oe.publicKeyCombine=function(e,t){var r=[];return e.forEach(function(n){r.push(Uint8Array.from(n))}),Buffer.from(hr.publicKeyCombine(r,t))};Oe.signatureNormalize=function(e){return Buffer.from(hr.signatureNormalize(Uint8Array.from(e)))};Oe.signatureExport=function(e){return Buffer.from(hr.signatureExport(Uint8Array.from(e)))};Oe.signatureImport=function(e){return Buffer.from(hr.signatureImport(Uint8Array.from(e)))};Oe.signatureImportLax=function(e){if(e.length===0)throw new RangeError("signature length is invalid");var t=kg.signatureImportLax(e);if(t===null)throw new Error("couldn't parse DER signature");return Rd.signatureImport(t)};Oe.sign=function(e,t,r){if(r===null)throw new TypeError("options should be an Object");var n=void 0;if(r){if(n={},r.data===null)throw new TypeError("options.data should be a Buffer");if(r.data){if(r.data.length!=32)throw new RangeError("options.data length is invalid");n.data=new Uint8Array(r.data)}if(r.noncefn===null)throw new TypeError("options.noncefn should be a Function");r.noncefn&&(n.noncefn=function(s,a,l,f,p){var w=l!=null?Buffer.from(l):null,A=f!=null?Buffer.from(f):null,_=Buffer.from("");return r.noncefn&&(_=r.noncefn(Buffer.from(s),Buffer.from(a),w,A,p)),new Uint8Array(_)})}var o=hr.ecdsaSign(Uint8Array.from(e),Uint8Array.from(t),n);return{signature:Buffer.from(o.signature),recovery:o.recid}};Oe.verify=function(e,t,r){return hr.ecdsaVerify(Uint8Array.from(t),Uint8Array.from(e),r)};Oe.recover=function(e,t,r,n){return Buffer.from(hr.ecdsaRecover(Uint8Array.from(t),r,Uint8Array.from(e),n))};Oe.ecdh=function(e,t){return Buffer.from(hr.ecdh(Uint8Array.from(e),Uint8Array.from(t),{}))};Oe.ecdhUnsafe=function(e,t,r){if(e.length!==33&&e.length!==65)throw new RangeError("public key length is invalid");if(t.length!==32)throw new RangeError("private key length is invalid");return Buffer.from(Rd.ecdhUnsafe(Uint8Array.from(e),Uint8Array.from(t),r))}});var Pg=ae((uie,vS)=>{m();g();vS.exports=i(function(t){if(typeof t!="string")throw new Error("[is-hex-prefixed] value must be type 'string', is currently type "+typeof t+", while checking isHexPrefixed.");return t.slice(0,2)==="0x"},"isHexPrefixed")});var xS=ae((hie,wS)=>{m();g();var c5=Pg();wS.exports=i(function(t){return typeof t!="string"?t:c5(t)?t.slice(2):t},"stripHexPrefix")});var la=ae((yie,ES)=>{"use strict";m();g();var u5=Pg(),SS=xS();function Nd(e){var t=e;if(typeof t!="string")throw new Error("[ethjs-util] while padding to even, value must be string, is currently "+typeof t+", while padToEven.");return t.length%2&&(t="0"+t),t}i(Nd,"padToEven");function AS(e){var t=e.toString(16);return"0x"+t}i(AS,"intToHex");function l5(e){var t=AS(e);return new Buffer(Nd(t.slice(2)),"hex")}i(l5,"intToBuffer");function f5(e){if(typeof e!="string")throw new Error("[ethjs-util] while getting binary size, method getBinarySize requires input 'str' to be type String, got '"+typeof e+"'.");return Buffer.byteLength(e,"utf8")}i(f5,"getBinarySize");function d5(e,t,r){if(Array.isArray(e)!==!0)throw new Error("[ethjs-util] method arrayContainsArray requires input 'superset' to be an array got type '"+typeof e+"'");if(Array.isArray(t)!==!0)throw new Error("[ethjs-util] method arrayContainsArray requires input 'subset' to be an array got type '"+typeof t+"'");return t[!!r&&"some"||"every"](function(n){return e.indexOf(n)>=0})}i(d5,"arrayContainsArray");function h5(e){var t=new Buffer(Nd(SS(e).replace(/^0+|0+$/g,"")),"hex");return t.toString("utf8")}i(h5,"toUtf8");function p5(e){var t="",r=0,n=e.length;for(e.substring(0,2)==="0x"&&(r=2);r<n;r+=2){var o=parseInt(e.substr(r,2),16);t+=String.fromCharCode(o)}return t}i(p5,"toAscii");function m5(e){var t=new Buffer(e,"utf8");return"0x"+Nd(t.toString("hex")).replace(/^0+|0+$/g,"")}i(m5,"fromUtf8");function g5(e){for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r),o=n.toString(16);t+=o.length<2?"0"+o:o}return"0x"+t}i(g5,"fromAscii");function y5(e,t,r){if(!Array.isArray(e))throw new Error("[ethjs-util] method getKeys expecting type Array as 'params' input, got '"+typeof e+"'");if(typeof t!="string")throw new Error("[ethjs-util] method getKeys expecting type String for input 'key' got '"+typeof t+"'.");for(var n=[],o=0;o<e.length;o++){var s=e[o][t];if(r&&!s)s="";else if(typeof s!="string")throw new Error("invalid abi");n.push(s)}return n}i(y5,"getKeys");function b5(e,t){return!(typeof e!="string"||!e.match(/^0x[0-9A-Fa-f]*$/)||t&&e.length!==2+2*t)}i(b5,"isHexString");ES.exports={arrayContainsArray:d5,intToBuffer:l5,getBinarySize:f5,isHexPrefixed:u5,stripHexPrefix:SS,padToEven:Nd,intToHex:AS,fromAscii:g5,fromUtf8:m5,toAscii:p5,toUtf8:h5,getKeys:y5,isHexString:b5}});var Ld=ae(Co=>{"use strict";m();g();var v5=Co&&Co.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Co,"__esModule",{value:!0});Co.getLength=Co.decode=Co.encode=void 0;var w5=v5(GI());function MS(e){if(Array.isArray(e)){for(var t=[],r=0;r<e.length;r++)t.push(MS(e[r]));var n=Buffer.concat(t);return Buffer.concat([_S(n.length,192),n])}else{var o=Rg(e);return o.length===1&&o[0]<128?o:Buffer.concat([_S(o.length,128),o])}}i(MS,"encode");Co.encode=MS;function Cg(e,t){if(e[0]==="0"&&e[1]==="0")throw new Error("invalid RLP: extra zeros");return parseInt(e,t)}i(Cg,"safeParseInt");function _S(e,t){if(e<56)return Buffer.from([e+t]);var r=Kg(e),n=r.length/2,o=Kg(t+55+n);return Buffer.from(o+r,"hex")}i(_S,"encodeLength");function x5(e,t){if(t===void 0&&(t=!1),!e||e.length===0)return Buffer.from([]);var r=Rg(e),n=Og(r);if(t)return n;if(n.remainder.length!==0)throw new Error("invalid remainder");return n.data}i(x5,"decode");Co.decode=x5;function S5(e){if(!e||e.length===0)return Buffer.from([]);var t=Rg(e),r=t[0];if(r<=127)return t.length;if(r<=183)return r-127;if(r<=191)return r-182;if(r<=247)return r-191;var n=r-246,o=Cg(t.slice(1,n).toString("hex"),16);return n+o}i(S5,"getLength");Co.getLength=S5;function Og(e){var t,r,n,o,s,a=[],l=e[0];if(l<=127)return{data:e.slice(0,1),remainder:e.slice(1)};if(l<=183){if(t=l-127,l===128?n=Buffer.from([]):n=e.slice(1,t),t===2&&n[0]<128)throw new Error("invalid rlp encoding: byte must be less 0x80");return{data:n,remainder:e.slice(t)}}else if(l<=191){if(r=l-182,e.length-1<r)throw new Error("invalid RLP: not enough bytes for string length");if(t=Cg(e.slice(1,r).toString("hex"),16),t<=55)throw new Error("invalid RLP: expected string length to be greater than 55");if(n=e.slice(r,t+r),n.length<t)throw new Error("invalid RLP: not enough bytes for string");return{data:n,remainder:e.slice(t+r)}}else if(l<=247){for(t=l-191,o=e.slice(1,t);o.length;)s=Og(o),a.push(s.data),o=s.remainder;return{data:a,remainder:e.slice(t)}}else{r=l-246,t=Cg(e.slice(1,r).toString("hex"),16);var f=r+t;if(f>e.length)throw new Error("invalid rlp: total length is larger than the data");if(o=e.slice(r,f),o.length===0)throw new Error("invalid rlp, List has a invalid length");for(;o.length;)s=Og(o),a.push(s.data),o=s.remainder;return{data:a,remainder:e.slice(f)}}}i(Og,"_decode");function IS(e){return e.slice(0,2)==="0x"}i(IS,"isHexPrefixed");function A5(e){return typeof e!="string"?e:IS(e)?e.slice(2):e}i(A5,"stripHexPrefix");function Kg(e){if(e<0)throw new Error("Invalid integer as argument, must be unsigned!");var t=e.toString(16);return t.length%2?"0"+t:t}i(Kg,"intToHex");function E5(e){return e.length%2?"0"+e:e}i(E5,"padToEven");function _5(e){var t=Kg(e);return Buffer.from(t,"hex")}i(_5,"intToBuffer");function Rg(e){if(!Buffer.isBuffer(e)){if(typeof e=="string")return IS(e)?Buffer.from(E5(A5(e)),"hex"):Buffer.from(e);if(typeof e=="number"||typeof e=="bigint")return e?_5(e):Buffer.from([]);if(e==null)return Buffer.from([]);if(e instanceof Uint8Array)return Buffer.from(e);if(w5.default.isBN(e))return Buffer.from(e.toArray());throw new Error("invalid type")}return e}i(Rg,"toBuffer")});var BS=ae(jt=>{"use strict";m();g();Object.defineProperty(jt,"__esModule",{value:!0});jt.KECCAK256_RLP=jt.KECCAK256_RLP_S=jt.KECCAK256_RLP_ARRAY=jt.KECCAK256_RLP_ARRAY_S=jt.KECCAK256_NULL=jt.KECCAK256_NULL_S=jt.TWO_POW256=jt.MAX_INTEGER=void 0;var TS=ca(),{Buffer:Ug}=vo();jt.MAX_INTEGER=new TS("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",16);jt.TWO_POW256=new TS("10000000000000000000000000000000000000000000000000000000000000000",16);jt.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470";jt.KECCAK256_NULL=Ug.from(jt.KECCAK256_NULL_S,"hex");jt.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347";jt.KECCAK256_RLP_ARRAY=Ug.from(jt.KECCAK256_RLP_ARRAY_S,"hex");jt.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421";jt.KECCAK256_RLP=Ug.from(jt.KECCAK256_RLP_S,"hex")});var _c=ae(mt=>{"use strict";m();g();Object.defineProperty(mt,"__esModule",{value:!0});mt.baToJSON=mt.addHexPrefix=mt.toUnsigned=mt.fromSigned=mt.bufferToHex=mt.bufferToInt=mt.toBuffer=mt.stripZeros=mt.unpad=mt.setLengthRight=mt.setLength=mt.setLengthLeft=mt.zeros=void 0;var Ec=la(),Ng=ca();mt.zeros=function(e){return Buffer.allocUnsafe(e).fill(0)};mt.setLengthLeft=function(e,t,r){r===void 0&&(r=!1);var n=mt.zeros(t);return e=mt.toBuffer(e),r?e.length<t?(e.copy(n),n):e.slice(0,t):e.length<t?(e.copy(n,t-e.length),n):e.slice(-t)};mt.setLength=mt.setLengthLeft;mt.setLengthRight=function(e,t){return mt.setLength(e,t,!0)};mt.unpad=function(e){e=Ec.stripHexPrefix(e);for(var t=e[0];e.length>0&&t.toString()==="0";)e=e.slice(1),t=e[0];return e};mt.stripZeros=mt.unpad;mt.toBuffer=function(e){if(!Buffer.isBuffer(e))if(Array.isArray(e))e=Buffer.from(e);else if(typeof e=="string")if(Ec.isHexString(e))e=Buffer.from(Ec.padToEven(Ec.stripHexPrefix(e)),"hex");else throw new Error("Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: "+e);else if(typeof e=="number")e=Ec.intToBuffer(e);else if(e==null)e=Buffer.allocUnsafe(0);else if(Ng.isBN(e))e=e.toArrayLike(Buffer);else if(e.toArray)e=Buffer.from(e.toArray());else throw new Error("invalid type");return e};mt.bufferToInt=function(e){return new Ng(mt.toBuffer(e)).toNumber()};mt.bufferToHex=function(e){return e=mt.toBuffer(e),"0x"+e.toString("hex")};mt.fromSigned=function(e){return new Ng(e).fromTwos(256)};mt.toUnsigned=function(e){return Buffer.from(e.toTwos(256).toArray())};mt.addHexPrefix=function(e){return typeof e!="string"||Ec.isHexPrefixed(e)?e:"0x"+e};mt.baToJSON=function(e){if(Buffer.isBuffer(e))return"0x"+e.toString("hex");if(e instanceof Array){for(var t=[],r=0;r<e.length;r++)t.push(mt.baToJSON(e[r]));return t}}});var kS=ae(Lg=>{"use strict";m();g();Object.defineProperty(Lg,"__esModule",{value:!0});function M5(e){return function(t){var r=e();return r.update(t),Buffer.from(r.digest())}}i(M5,"createHashFunction");Lg.createHashFunction=M5});var OS=ae((Rie,CS)=>{m();g();var{Transform:I5}=Xv();CS.exports=e=>class PS extends I5{static{i(this,"Keccak")}constructor(r,n,o,s,a){super(a),this._rate=r,this._capacity=n,this._delimitedSuffix=o,this._hashBitLength=s,this._options=a,this._state=new e,this._state.initialize(r,n),this._finalized=!1}_transform(r,n,o){let s=null;try{this.update(r,n)}catch(a){s=a}o(s)}_flush(r){let n=null;try{this.push(this.digest())}catch(o){n=o}r(n)}update(r,n){if(!Buffer.isBuffer(r)&&typeof r!="string")throw new TypeError("Data must be a string or a buffer");if(this._finalized)throw new Error("Digest already called");return Buffer.isBuffer(r)||(r=Buffer.from(r,n)),this._state.absorb(r),this}digest(r){if(this._finalized)throw new Error("Digest already called");this._finalized=!0,this._delimitedSuffix&&this._state.absorbLastFewBits(this._delimitedSuffix);let n=this._state.squeeze(this._hashBitLength/8);return r!==void 0&&(n=n.toString(r)),this._resetState(),n}_resetState(){return this._state.initialize(this._rate,this._capacity),this}_clone(){let r=new PS(this._rate,this._capacity,this._delimitedSuffix,this._hashBitLength,this._options);return this._state.copy(r._state),r._finalized=this._finalized,r}}});var US=ae((Die,RS)=>{m();g();var{Transform:T5}=Xv();RS.exports=e=>class KS extends T5{static{i(this,"Shake")}constructor(r,n,o,s){super(s),this._rate=r,this._capacity=n,this._delimitedSuffix=o,this._options=s,this._state=new e,this._state.initialize(r,n),this._finalized=!1}_transform(r,n,o){let s=null;try{this.update(r,n)}catch(a){s=a}o(s)}_flush(){}_read(r){this.push(this.squeeze(r))}update(r,n){if(!Buffer.isBuffer(r)&&typeof r!="string")throw new TypeError("Data must be a string or a buffer");if(this._finalized)throw new Error("Squeeze already called");return Buffer.isBuffer(r)||(r=Buffer.from(r,n)),this._state.absorb(r),this}squeeze(r,n){this._finalized||(this._finalized=!0,this._state.absorbLastFewBits(this._delimitedSuffix));let o=this._state.squeeze(r);return n!==void 0&&(o=o.toString(n)),o}_resetState(){return this._state.initialize(this._rate,this._capacity),this}_clone(){let r=new KS(this._rate,this._capacity,this._delimitedSuffix,this._options);return this._state.copy(r._state),r._finalized=this._finalized,r}}});var LS=ae((jie,NS)=>{m();g();var B5=OS(),k5=US();NS.exports=function(e){let t=B5(e),r=k5(e);return function(n,o){switch(typeof n=="string"?n.toLowerCase():n){case"keccak224":return new t(1152,448,null,224,o);case"keccak256":return new t(1088,512,null,256,o);case"keccak384":return new t(832,768,null,384,o);case"keccak512":return new t(576,1024,null,512,o);case"sha3-224":return new t(1152,448,6,224,o);case"sha3-256":return new t(1088,512,6,256,o);case"sha3-384":return new t(832,768,6,384,o);case"sha3-512":return new t(576,1024,6,512,o);case"shake128":return new r(1344,256,31,o);case"shake256":return new r(1088,512,31,o);default:throw new Error("Invald algorithm: "+n)}}}});var qS=ae(VS=>{m();g();var DS=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648];VS.p1600=function(e){for(let t=0;t<24;++t){let r=e[0]^e[10]^e[20]^e[30]^e[40],n=e[1]^e[11]^e[21]^e[31]^e[41],o=e[2]^e[12]^e[22]^e[32]^e[42],s=e[3]^e[13]^e[23]^e[33]^e[43],a=e[4]^e[14]^e[24]^e[34]^e[44],l=e[5]^e[15]^e[25]^e[35]^e[45],f=e[6]^e[16]^e[26]^e[36]^e[46],p=e[7]^e[17]^e[27]^e[37]^e[47],w=e[8]^e[18]^e[28]^e[38]^e[48],A=e[9]^e[19]^e[29]^e[39]^e[49],_=w^(o<<1|s>>>31),T=A^(s<<1|o>>>31),B=e[0]^_,P=e[1]^T,C=e[10]^_,O=e[11]^T,L=e[20]^_,R=e[21]^T,j=e[30]^_,Z=e[31]^T,X=e[40]^_,Q=e[41]^T;_=r^(a<<1|l>>>31),T=n^(l<<1|a>>>31);let z=e[2]^_,H=e[3]^T,E=e[12]^_,c=e[13]^T,d=e[22]^_,h=e[23]^T,y=e[32]^_,b=e[33]^T,M=e[42]^_,I=e[43]^T;_=o^(f<<1|p>>>31),T=s^(p<<1|f>>>31);let x=e[4]^_,u=e[5]^T,S=e[14]^_,V=e[15]^T,q=e[24]^_,F=e[25]^T,ee=e[34]^_,ie=e[35]^T,ce=e[44]^_,ye=e[45]^T;_=a^(w<<1|A>>>31),T=l^(A<<1|w>>>31);let ue=e[6]^_,N=e[7]^T,G=e[16]^_,W=e[17]^T,ne=e[26]^_,le=e[27]^T,te=e[36]^_,se=e[37]^T,dt=e[46]^_,Se=e[47]^T;_=f^(r<<1|n>>>31),T=p^(n<<1|r>>>31);let Ie=e[8]^_,gn=e[9]^T,Ke=e[18]^_,Pe=e[19]^T,bo=e[28]^_,Ce=e[29]^T,it=e[38]^_,Qi=e[39]^T,st=e[48]^_,at=e[49]^T,ci=B,Ne=P,Le=O<<4|C>>>28,ui=C<<4|O>>>28,De=L<<3|R>>>29,Ve=R<<3|L>>>29,li=Z<<9|j>>>23,qe=j<<9|Z>>>23,He=X<<18|Q>>>14,fi=Q<<18|X>>>14,je=z<<1|H>>>31,ze=H<<1|z>>>31,di=c<<12|E>>>20,Fe=E<<12|c>>>20,We=d<<10|h>>>22,hi=h<<10|d>>>22,$e=b<<13|y>>>19,Ge=y<<13|b>>>19,pi=M<<2|I>>>30,Ze=I<<2|M>>>30,Ye=u<<30|x>>>2,mi=x<<30|u>>>2,Je=S<<6|V>>>26,Xe=V<<6|S>>>26,gi=F<<11|q>>>21,Qe=q<<11|F>>>21,et=ee<<15|ie>>>17,yi=ie<<15|ee>>>17,tt=ye<<29|ce>>>3,rt=ce<<29|ye>>>3,bi=ue<<28|N>>>4,nt=N<<28|ue>>>4,ot=W<<23|G>>>9,On=G<<23|W>>>9,Kn=ne<<25|le>>>7,Rn=le<<25|ne>>>7,Un=te<<21|se>>>11,Nn=se<<21|te>>>11,Ln=Se<<24|dt>>>8,Dn=dt<<24|Se>>>8,Vn=Ie<<27|gn>>>5,qn=gn<<27|Ie>>>5,Hn=Ke<<20|Pe>>>12,jn=Pe<<20|Ke>>>12,zn=Ce<<7|bo>>>25,Fn=bo<<7|Ce>>>25,Wn=it<<8|Qi>>>24,$n=Qi<<8|it>>>24,Gn=st<<14|at>>>18,Zn=at<<14|st>>>18;e[0]=ci^~di&gi,e[1]=Ne^~Fe&Qe,e[10]=bi^~Hn&De,e[11]=nt^~jn&Ve,e[20]=je^~Je&Kn,e[21]=ze^~Xe&Rn,e[30]=Vn^~Le&We,e[31]=qn^~ui&hi,e[40]=Ye^~ot&zn,e[41]=mi^~On&Fn,e[2]=di^~gi&Un,e[3]=Fe^~Qe&Nn,e[12]=Hn^~De&$e,e[13]=jn^~Ve&Ge,e[22]=Je^~Kn&Wn,e[23]=Xe^~Rn&$n,e[32]=Le^~We&et,e[33]=ui^~hi&yi,e[42]=ot^~zn&li,e[43]=On^~Fn&qe,e[4]=gi^~Un&Gn,e[5]=Qe^~Nn&Zn,e[14]=De^~$e&tt,e[15]=Ve^~Ge&rt,e[24]=Kn^~Wn&He,e[25]=Rn^~$n&fi,e[34]=We^~et&Ln,e[35]=hi^~yi&Dn,e[44]=zn^~li&pi,e[45]=Fn^~qe&Ze,e[6]=Un^~Gn&ci,e[7]=Nn^~Zn&Ne,e[16]=$e^~tt&bi,e[17]=Ge^~rt&nt,e[26]=Wn^~He&je,e[27]=$n^~fi&ze,e[36]=et^~Ln&Vn,e[37]=yi^~Dn&qn,e[46]=li^~pi&Ye,e[47]=qe^~Ze&mi,e[8]=Gn^~ci&di,e[9]=Zn^~Ne&Fe,e[18]=tt^~bi&Hn,e[19]=rt^~nt&jn,e[28]=He^~je&Je,e[29]=fi^~ze&Xe,e[38]=Ln^~Vn&Le,e[39]=Dn^~qn&ui,e[48]=pi^~Ye&ot,e[49]=Ze^~mi&On,e[0]^=DS[t*2],e[1]^=DS[t*2+1]}}});var jS=ae((Zie,HS)=>{m();g();var Dd=qS();function Mc(){this.state=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.blockSize=null,this.count=0,this.squeezing=!1}i(Mc,"Keccak");Mc.prototype.initialize=function(e,t){for(let r=0;r<50;++r)this.state[r]=0;this.blockSize=e/8,this.count=0,this.squeezing=!1};Mc.prototype.absorb=function(e){for(let t=0;t<e.length;++t)this.state[~~(this.count/4)]^=e[t]<<8*(this.count%4),this.count+=1,this.count===this.blockSize&&(Dd.p1600(this.state),this.count=0)};Mc.prototype.absorbLastFewBits=function(e){this.state[~~(this.count/4)]^=e<<8*(this.count%4),e&128&&this.count===this.blockSize-1&&Dd.p1600(this.state),this.state[~~((this.blockSize-1)/4)]^=128<<8*((this.blockSize-1)%4),Dd.p1600(this.state),this.count=0,this.squeezing=!0};Mc.prototype.squeeze=function(e){this.squeezing||this.absorbLastFewBits(1);let t=Buffer.alloc(e);for(let r=0;r<e;++r)t[r]=this.state[~~(this.count/4)]>>>8*(this.count%4)&255,this.count+=1,this.count===this.blockSize&&(Dd.p1600(this.state),this.count=0);return t};Mc.prototype.copy=function(e){for(let t=0;t<50;++t)e.state[t]=this.state[t];e.blockSize=this.blockSize,e.count=this.count,e.squeezing=this.squeezing};HS.exports=Mc});var FS=ae((Qie,zS)=>{m();g();zS.exports=LS()(jS())});var WS=ae(Ic=>{"use strict";m();g();Object.defineProperty(Ic,"__esModule",{value:!0});var Vd=kS(),qd=FS();Ic.keccak224=Vd.createHashFunction(function(){return qd("keccak224")});Ic.keccak256=Vd.createHashFunction(function(){return qd("keccak256")});Ic.keccak384=Vd.createHashFunction(function(){return qd("keccak384")});Ic.keccak512=Vd.createHashFunction(function(){return qd("keccak512")})});var zd=ae(Wr=>{"use strict";m();g();Object.defineProperty(Wr,"__esModule",{value:!0});Wr.rlphash=Wr.ripemd160=Wr.sha256=Wr.keccak256=Wr.keccak=void 0;var jd=WS(),P5=jd.keccak224,C5=jd.keccak384,O5=jd.keccak256,K5=jd.keccak512,$S=$I(),R5=la(),U5=Ld(),Hd=_c();Wr.keccak=function(e,t){switch(t===void 0&&(t=256),typeof e=="string"&&!R5.isHexString(e)?e=Buffer.from(e,"utf8"):e=Hd.toBuffer(e),t||(t=256),t){case 224:return P5(e);case 256:return O5(e);case 384:return C5(e);case 512:return K5(e);default:throw new Error("Invald algorithm: keccak"+t)}};Wr.keccak256=function(e){return Wr.keccak(e)};Wr.sha256=function(e){return e=Hd.toBuffer(e),$S("sha256").update(e).digest()};Wr.ripemd160=function(e,t){e=Hd.toBuffer(e);var r=$S("rmd160").update(e).digest();return t===!0?Hd.setLength(r,32):r};Wr.rlphash=function(e){return Wr.keccak(U5.encode(e))}});var GS=ae(ht=>{"use strict";m();g();Object.defineProperty(ht,"__esModule",{value:!0});ht.importPublic=ht.privateToPublic=ht.privateToAddress=ht.publicToAddress=ht.pubToAddress=ht.isValidPublic=ht.isValidPrivate=ht.isPrecompiled=ht.generateAddress2=ht.generateAddress=ht.isValidChecksumAddress=ht.toChecksumAddress=ht.isZeroAddress=ht.isValidAddress=ht.zeroAddress=void 0;var Dg=zw(),N5=la(),Tc=Ud(),L5=ca(),io=_c(),Bc=zd();ht.zeroAddress=function(){var e=20,t=io.zeros(e);return io.bufferToHex(t)};ht.isValidAddress=function(e){return/^0x[0-9a-fA-F]{40}$/.test(e)};ht.isZeroAddress=function(e){var t=ht.zeroAddress();return t===io.addHexPrefix(e)};ht.toChecksumAddress=function(e,t){e=N5.stripHexPrefix(e).toLowerCase();for(var r=t!==void 0?t.toString()+"0x":"",n=Bc.keccak(r+e).toString("hex"),o="0x",s=0;s<e.length;s++)parseInt(n[s],16)>=8?o+=e[s].toUpperCase():o+=e[s];return o};ht.isValidChecksumAddress=function(e,t){return ht.isValidAddress(e)&&ht.toChecksumAddress(e,t)===e};ht.generateAddress=function(e,t){e=io.toBuffer(e);var r=new L5(t);return r.isZero()?Bc.rlphash([e,null]).slice(-20):Bc.rlphash([e,Buffer.from(r.toArray())]).slice(-20)};ht.generateAddress2=function(e,t,r){var n=io.toBuffer(e),o=io.toBuffer(t),s=io.toBuffer(r);Dg(n.length===20),Dg(o.length===32);var a=Bc.keccak256(Buffer.concat([Buffer.from("ff","hex"),n,o,Bc.keccak256(s)]));return a.slice(-20)};ht.isPrecompiled=function(e){var t=io.unpad(e);return t.length===1&&t[0]>=1&&t[0]<=8};ht.isValidPrivate=function(e){return Tc.privateKeyVerify(e)};ht.isValidPublic=function(e,t){return t===void 0&&(t=!1),e.length===64?Tc.publicKeyVerify(Buffer.concat([Buffer.from([4]),e])):t?Tc.publicKeyVerify(e):!1};ht.pubToAddress=function(e,t){return t===void 0&&(t=!1),e=io.toBuffer(e),t&&e.length!==64&&(e=Tc.publicKeyConvert(e,!1).slice(1)),Dg(e.length===64),Bc.keccak(e).slice(-20)};ht.publicToAddress=ht.pubToAddress;ht.privateToAddress=function(e){return ht.publicToAddress(ht.privateToPublic(e))};ht.privateToPublic=function(e){return e=io.toBuffer(e),Tc.publicKeyCreate(e,!1).slice(1)};ht.importPublic=function(e){return e=io.toBuffer(e),e.length!==64&&(e=Tc.publicKeyConvert(e,!1).slice(1)),e}});var ZS=ae($r=>{"use strict";m();g();Object.defineProperty($r,"__esModule",{value:!0});$r.hashPersonalMessage=$r.isValidSignature=$r.fromRpcSig=$r.toRpcSig=$r.ecrecover=$r.ecsign=void 0;var Vg=Ud(),Fd=ca(),fa=_c(),D5=zd();$r.ecsign=function(e,t,r){var n=Vg.sign(e,t),o=n.recovery,s={r:n.signature.slice(0,32),s:n.signature.slice(32,64),v:r?o+(r*2+35):o+27};return s};$r.ecrecover=function(e,t,r,n,o){var s=Buffer.concat([fa.setLength(r,32),fa.setLength(n,32)],64),a=qg(t,o);if(!Hg(a))throw new Error("Invalid signature v value");var l=Vg.recover(e,s,a);return Vg.publicKeyConvert(l,!1).slice(1)};$r.toRpcSig=function(e,t,r,n){var o=qg(e,n);if(!Hg(o))throw new Error("Invalid signature v value");return fa.bufferToHex(Buffer.concat([fa.setLengthLeft(t,32),fa.setLengthLeft(r,32),fa.toBuffer(e)]))};$r.fromRpcSig=function(e){var t=fa.toBuffer(e);if(t.length!==65)throw new Error("Invalid signature length");var r=t[64];return r<27&&(r+=27),{v:r,r:t.slice(0,32),s:t.slice(32,64)}};$r.isValidSignature=function(e,t,r,n,o){n===void 0&&(n=!0);var s=new Fd("7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0",16),a=new Fd("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",16);if(t.length!==32||r.length!==32||!Hg(qg(e,o)))return!1;var l=new Fd(t),f=new Fd(r);return!(l.isZero()||l.gt(a)||f.isZero()||f.gt(a)||n&&f.cmp(s)===1)};$r.hashPersonalMessage=function(e){var t=Buffer.from(`Ethereum Signed Message:
`+e.length.toString(),"utf-8");return D5.keccak(Buffer.concat([t,e]))};function qg(e,t){return t?e-(2*t+35):e-27}i(qg,"calculateSigRecovery");function Hg(e){return e===0||e===1}i(Hg,"isValidSigRecovery")});var XS=ae($d=>{"use strict";m();g();Object.defineProperty($d,"__esModule",{value:!0});$d.defineProperties=void 0;var YS=zw(),V5=la(),JS=Ld(),Wd=_c();$d.defineProperties=function(e,t,r){if(e.raw=[],e._fields=[],e.toJSON=function(o){if(o===void 0&&(o=!1),o){var s={};return e._fields.forEach(function(a){s[a]="0x"+e[a].toString("hex")}),s}return Wd.baToJSON(e.raw)},e.serialize=i(function(){return JS.encode(e.raw)},"serialize"),t.forEach(function(o,s){e._fields.push(o.name);function a(){return e.raw[s]}i(a,"getter");function l(f){f=Wd.toBuffer(f),f.toString("hex")==="00"&&!o.allowZero&&(f=Buffer.allocUnsafe(0)),o.allowLess&&o.length?(f=Wd.stripZeros(f),YS(o.length>=f.length,"The field "+o.name+" must not have more "+o.length+" bytes")):!(o.allowZero&&f.length===0)&&o.length&&YS(o.length===f.length,"The field "+o.name+" must have byte length of "+o.length),e.raw[s]=f}i(l,"setter"),Object.defineProperty(e,o.name,{enumerable:!0,configurable:!0,get:a,set:l}),o.default&&(e[o.name]=o.default),o.alias&&Object.defineProperty(e,o.alias,{enumerable:!1,configurable:!0,set:l,get:a})}),r)if(typeof r=="string"&&(r=Buffer.from(V5.stripHexPrefix(r),"hex")),Buffer.isBuffer(r)&&(r=JS.decode(r)),Array.isArray(r)){if(r.length>e._fields.length)throw new Error("wrong number of fields in data");r.forEach(function(o,s){e[e._fields[s]]=Wd.toBuffer(o)})}else if(typeof r=="object"){var n=Object.keys(r);t.forEach(function(o){n.indexOf(o.name)!==-1&&(e[o.name]=r[o.name]),n.indexOf(o.alias)!==-1&&(e[o.alias]=r[o.alias])})}else throw new Error("invalid data")}});var Gu=ae(Xt=>{"use strict";m();g();var q5=Xt&&Xt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:i(function(){return t[r]},"get")})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),kc=Xt&&Xt.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&q5(t,e,r)};Object.defineProperty(Xt,"__esModule",{value:!0});Xt.secp256k1=Xt.rlp=Xt.BN=void 0;var H5=Ud();Xt.secp256k1=H5;var j5=la(),z5=ca();Xt.BN=z5;var F5=Ld();Xt.rlp=F5;Object.assign(Xt,j5);kc(BS(),Xt);kc(GS(),Xt);kc(zd(),Xt);kc(ZS(),Xt);kc(_c(),Xt);kc(XS(),Xt)});var Zu=ae(Gr=>{"use strict";m();g();Object.defineProperty(Gr,"__esModule",{value:!0});Gr.normalize=Gr.recoverPublicKey=Gr.concatSig=Gr.legacyToBuffer=Gr.isNullish=Gr.padWithZeroes=void 0;var Mn=Gu(),jg=la();function zg(e,t){if(e!==""&&!/^[a-f0-9]+$/iu.test(e))throw new Error(`Expected an unprefixed hex string. Received: ${e}`);if(t<0)throw new Error(`Expected a non-negative integer target length. Received: ${t}`);return String.prototype.padStart.call(e,t,"0")}i(zg,"padWithZeroes");Gr.padWithZeroes=zg;function W5(e){return e==null}i(W5,"isNullish");Gr.isNullish=W5;function $5(e){return typeof e=="string"&&!jg.isHexString(e)?Buffer.from(e):Mn.toBuffer(e)}i($5,"legacyToBuffer");Gr.legacyToBuffer=$5;function G5(e,t,r){let n=Mn.fromSigned(t),o=Mn.fromSigned(r),s=Mn.bufferToInt(e),a=zg(Mn.toUnsigned(n).toString("hex"),64),l=zg(Mn.toUnsigned(o).toString("hex"),64),f=jg.stripHexPrefix(jg.intToHex(s));return Mn.addHexPrefix(a.concat(l,f))}i(G5,"concatSig");Gr.concatSig=G5;function Z5(e,t){let r=Mn.fromRpcSig(t);return Mn.ecrecover(e,r.v,r.r,r.s)}i(Z5,"recoverPublicKey");Gr.recoverPublicKey=Z5;function Y5(e){if(e){if(typeof e=="number"){let t=Mn.toBuffer(e);e=Mn.bufferToHex(t)}if(typeof e!="string"){let t="eth-sig-util.normalize() requires hex string or integer input.";throw t+=` received ${typeof e}: ${e}`,new Error(t)}return Mn.addHexPrefix(e.toLowerCase())}}i(Y5,"normalize");Gr.normalize=Y5});var eA=ae(xs=>{"use strict";m();g();Object.defineProperty(xs,"__esModule",{value:!0});xs.extractPublicKey=xs.recoverPersonalSignature=xs.personalSign=void 0;var Pc=Gu(),Oo=Zu();function J5({privateKey:e,data:t}){if(Oo.isNullish(t))throw new Error("Missing data parameter");if(Oo.isNullish(e))throw new Error("Missing privateKey parameter");let r=Oo.legacyToBuffer(t),n=Pc.hashPersonalMessage(r),o=Pc.ecsign(n,e);return Oo.concatSig(Pc.toBuffer(o.v),o.r,o.s)}i(J5,"personalSign");xs.personalSign=J5;function X5({data:e,signature:t}){if(Oo.isNullish(e))throw new Error("Missing data parameter");if(Oo.isNullish(t))throw new Error("Missing signature parameter");let r=QS(e,t),n=Pc.publicToAddress(r);return Pc.bufferToHex(n)}i(X5,"recoverPersonalSignature");xs.recoverPersonalSignature=X5;function Q5({data:e,signature:t}){if(Oo.isNullish(e))throw new Error("Missing data parameter");if(Oo.isNullish(t))throw new Error("Missing signature parameter");return`0x${QS(e,t).toString("hex")}`}i(Q5,"extractPublicKey");xs.extractPublicKey=Q5;function QS(e,t){let r=Pc.hashPersonalMessage(Oo.legacyToBuffer(e));return Oo.recoverPublicKey(r,t)}i(QS,"getPublicKeyFor")});var rA=ae((tA,Fg)=>{m();g();(function(e,t){"use strict";function r(E,c){if(!E)throw new Error(c||"Assertion failed")}i(r,"assert");function n(E,c){E.super_=c;var d=i(function(){},"TempCtor");d.prototype=c.prototype,E.prototype=new d,E.prototype.constructor=E}i(n,"inherits");function o(E,c,d){if(o.isBN(E))return E;this.negative=0,this.words=null,this.length=0,this.red=null,E!==null&&((c==="le"||c==="be")&&(d=c,c=10),this._init(E||0,c||10,d||"be"))}i(o,"BN"),typeof e=="object"?e.exports=o:t.BN=o,o.BN=o,o.wordSize=26;var s;try{typeof self<"u"&&typeof self.Buffer<"u"?s=self.Buffer:s=Qv().Buffer}catch{}o.isBN=i(function(c){return c instanceof o?!0:c!==null&&typeof c=="object"&&c.constructor.wordSize===o.wordSize&&Array.isArray(c.words)},"isBN"),o.max=i(function(c,d){return c.cmp(d)>0?c:d},"max"),o.min=i(function(c,d){return c.cmp(d)<0?c:d},"min"),o.prototype._init=i(function(c,d,h){if(typeof c=="number")return this._initNumber(c,d,h);if(typeof c=="object")return this._initArray(c,d,h);d==="hex"&&(d=16),r(d===(d|0)&&d>=2&&d<=36),c=c.toString().replace(/\s+/g,"");var y=0;c[0]==="-"&&(y++,this.negative=1),y<c.length&&(d===16?this._parseHex(c,y,h):(this._parseBase(c,d,y),h==="le"&&this._initArray(this.toArray(),d,h)))},"init"),o.prototype._initNumber=i(function(c,d,h){c<0&&(this.negative=1,c=-c),c<67108864?(this.words=[c&67108863],this.length=1):c<4503599627370496?(this.words=[c&67108863,c/67108864&67108863],this.length=2):(r(c<9007199254740992),this.words=[c&67108863,c/67108864&67108863,1],this.length=3),h==="le"&&this._initArray(this.toArray(),d,h)},"_initNumber"),o.prototype._initArray=i(function(c,d,h){if(r(typeof c.length=="number"),c.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(c.length/3),this.words=new Array(this.length);for(var y=0;y<this.length;y++)this.words[y]=0;var b,M,I=0;if(h==="be")for(y=c.length-1,b=0;y>=0;y-=3)M=c[y]|c[y-1]<<8|c[y-2]<<16,this.words[b]|=M<<I&67108863,this.words[b+1]=M>>>26-I&67108863,I+=24,I>=26&&(I-=26,b++);else if(h==="le")for(y=0,b=0;y<c.length;y+=3)M=c[y]|c[y+1]<<8|c[y+2]<<16,this.words[b]|=M<<I&67108863,this.words[b+1]=M>>>26-I&67108863,I+=24,I>=26&&(I-=26,b++);return this.strip()},"_initArray");function a(E,c){var d=E.charCodeAt(c);return d>=65&&d<=70?d-55:d>=97&&d<=102?d-87:d-48&15}i(a,"parseHex4Bits");function l(E,c,d){var h=a(E,d);return d-1>=c&&(h|=a(E,d-1)<<4),h}i(l,"parseHexByte"),o.prototype._parseHex=i(function(c,d,h){this.length=Math.ceil((c.length-d)/6),this.words=new Array(this.length);for(var y=0;y<this.length;y++)this.words[y]=0;var b=0,M=0,I;if(h==="be")for(y=c.length-1;y>=d;y-=2)I=l(c,d,y)<<b,this.words[M]|=I&67108863,b>=18?(b-=18,M+=1,this.words[M]|=I>>>26):b+=8;else{var x=c.length-d;for(y=x%2===0?d+1:d;y<c.length;y+=2)I=l(c,d,y)<<b,this.words[M]|=I&67108863,b>=18?(b-=18,M+=1,this.words[M]|=I>>>26):b+=8}this.strip()},"_parseHex");function f(E,c,d,h){for(var y=0,b=Math.min(E.length,d),M=c;M<b;M++){var I=E.charCodeAt(M)-48;y*=h,I>=49?y+=I-49+10:I>=17?y+=I-17+10:y+=I}return y}i(f,"parseBase"),o.prototype._parseBase=i(function(c,d,h){this.words=[0],this.length=1;for(var y=0,b=1;b<=67108863;b*=d)y++;y--,b=b/d|0;for(var M=c.length-h,I=M%y,x=Math.min(M,M-I)+h,u=0,S=h;S<x;S+=y)u=f(c,S,S+y,d),this.imuln(b),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u);if(I!==0){var V=1;for(u=f(c,S,c.length,d),S=0;S<I;S++)V*=d;this.imuln(V),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u)}this.strip()},"_parseBase"),o.prototype.copy=i(function(c){c.words=new Array(this.length);for(var d=0;d<this.length;d++)c.words[d]=this.words[d];c.length=this.length,c.negative=this.negative,c.red=this.red},"copy"),o.prototype.clone=i(function(){var c=new o(null);return this.copy(c),c},"clone"),o.prototype._expand=i(function(c){for(;this.length<c;)this.words[this.length++]=0;return this},"_expand"),o.prototype.strip=i(function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},"strip"),o.prototype._normSign=i(function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},"_normSign"),o.prototype.inspect=i(function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"},"inspect");var p=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],w=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],A=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];o.prototype.toString=i(function(c,d){c=c||10,d=d|0||1;var h;if(c===16||c==="hex"){h="";for(var y=0,b=0,M=0;M<this.length;M++){var I=this.words[M],x=((I<<y|b)&16777215).toString(16);b=I>>>24-y&16777215,b!==0||M!==this.length-1?h=p[6-x.length]+x+h:h=x+h,y+=2,y>=26&&(y-=26,M--)}for(b!==0&&(h=b.toString(16)+h);h.length%d!==0;)h="0"+h;return this.negative!==0&&(h="-"+h),h}if(c===(c|0)&&c>=2&&c<=36){var u=w[c],S=A[c];h="";var V=this.clone();for(V.negative=0;!V.isZero();){var q=V.modn(S).toString(c);V=V.idivn(S),V.isZero()?h=q+h:h=p[u-q.length]+q+h}for(this.isZero()&&(h="0"+h);h.length%d!==0;)h="0"+h;return this.negative!==0&&(h="-"+h),h}r(!1,"Base should be between 2 and 36")},"toString"),o.prototype.toNumber=i(function(){var c=this.words[0];return this.length===2?c+=this.words[1]*67108864:this.length===3&&this.words[2]===1?c+=4503599627370496+this.words[1]*67108864:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-c:c},"toNumber"),o.prototype.toJSON=i(function(){return this.toString(16)},"toJSON"),o.prototype.toBuffer=i(function(c,d){return r(typeof s<"u"),this.toArrayLike(s,c,d)},"toBuffer"),o.prototype.toArray=i(function(c,d){return this.toArrayLike(Array,c,d)},"toArray"),o.prototype.toArrayLike=i(function(c,d,h){var y=this.byteLength(),b=h||Math.max(1,y);r(y<=b,"byte array longer than desired length"),r(b>0,"Requested array length <= 0"),this.strip();var M=d==="le",I=new c(b),x,u,S=this.clone();if(M){for(u=0;!S.isZero();u++)x=S.andln(255),S.iushrn(8),I[u]=x;for(;u<b;u++)I[u]=0}else{for(u=0;u<b-y;u++)I[u]=0;for(u=0;!S.isZero();u++)x=S.andln(255),S.iushrn(8),I[b-u-1]=x}return I},"toArrayLike"),Math.clz32?o.prototype._countBits=i(function(c){return 32-Math.clz32(c)},"_countBits"):o.prototype._countBits=i(function(c){var d=c,h=0;return d>=4096&&(h+=13,d>>>=13),d>=64&&(h+=7,d>>>=7),d>=8&&(h+=4,d>>>=4),d>=2&&(h+=2,d>>>=2),h+d},"_countBits"),o.prototype._zeroBits=i(function(c){if(c===0)return 26;var d=c,h=0;return d&8191||(h+=13,d>>>=13),d&127||(h+=7,d>>>=7),d&15||(h+=4,d>>>=4),d&3||(h+=2,d>>>=2),d&1||h++,h},"_zeroBits"),o.prototype.bitLength=i(function(){var c=this.words[this.length-1],d=this._countBits(c);return(this.length-1)*26+d},"bitLength");function _(E){for(var c=new Array(E.bitLength()),d=0;d<c.length;d++){var h=d/26|0,y=d%26;c[d]=(E.words[h]&1<<y)>>>y}return c}i(_,"toBitArray"),o.prototype.zeroBits=i(function(){if(this.isZero())return 0;for(var c=0,d=0;d<this.length;d++){var h=this._zeroBits(this.words[d]);if(c+=h,h!==26)break}return c},"zeroBits"),o.prototype.byteLength=i(function(){return Math.ceil(this.bitLength()/8)},"byteLength"),o.prototype.toTwos=i(function(c){return this.negative!==0?this.abs().inotn(c).iaddn(1):this.clone()},"toTwos"),o.prototype.fromTwos=i(function(c){return this.testn(c-1)?this.notn(c).iaddn(1).ineg():this.clone()},"fromTwos"),o.prototype.isNeg=i(function(){return this.negative!==0},"isNeg"),o.prototype.neg=i(function(){return this.clone().ineg()},"neg"),o.prototype.ineg=i(function(){return this.isZero()||(this.negative^=1),this},"ineg"),o.prototype.iuor=i(function(c){for(;this.length<c.length;)this.words[this.length++]=0;for(var d=0;d<c.length;d++)this.words[d]=this.words[d]|c.words[d];return this.strip()},"iuor"),o.prototype.ior=i(function(c){return r((this.negative|c.negative)===0),this.iuor(c)},"ior"),o.prototype.or=i(function(c){return this.length>c.length?this.clone().ior(c):c.clone().ior(this)},"or"),o.prototype.uor=i(function(c){return this.length>c.length?this.clone().iuor(c):c.clone().iuor(this)},"uor"),o.prototype.iuand=i(function(c){var d;this.length>c.length?d=c:d=this;for(var h=0;h<d.length;h++)this.words[h]=this.words[h]&c.words[h];return this.length=d.length,this.strip()},"iuand"),o.prototype.iand=i(function(c){return r((this.negative|c.negative)===0),this.iuand(c)},"iand"),o.prototype.and=i(function(c){return this.length>c.length?this.clone().iand(c):c.clone().iand(this)},"and"),o.prototype.uand=i(function(c){return this.length>c.length?this.clone().iuand(c):c.clone().iuand(this)},"uand"),o.prototype.iuxor=i(function(c){var d,h;this.length>c.length?(d=this,h=c):(d=c,h=this);for(var y=0;y<h.length;y++)this.words[y]=d.words[y]^h.words[y];if(this!==d)for(;y<d.length;y++)this.words[y]=d.words[y];return this.length=d.length,this.strip()},"iuxor"),o.prototype.ixor=i(function(c){return r((this.negative|c.negative)===0),this.iuxor(c)},"ixor"),o.prototype.xor=i(function(c){return this.length>c.length?this.clone().ixor(c):c.clone().ixor(this)},"xor"),o.prototype.uxor=i(function(c){return this.length>c.length?this.clone().iuxor(c):c.clone().iuxor(this)},"uxor"),o.prototype.inotn=i(function(c){r(typeof c=="number"&&c>=0);var d=Math.ceil(c/26)|0,h=c%26;this._expand(d),h>0&&d--;for(var y=0;y<d;y++)this.words[y]=~this.words[y]&67108863;return h>0&&(this.words[y]=~this.words[y]&67108863>>26-h),this.strip()},"inotn"),o.prototype.notn=i(function(c){return this.clone().inotn(c)},"notn"),o.prototype.setn=i(function(c,d){r(typeof c=="number"&&c>=0);var h=c/26|0,y=c%26;return this._expand(h+1),d?this.words[h]=this.words[h]|1<<y:this.words[h]=this.words[h]&~(1<<y),this.strip()},"setn"),o.prototype.iadd=i(function(c){var d;if(this.negative!==0&&c.negative===0)return this.negative=0,d=this.isub(c),this.negative^=1,this._normSign();if(this.negative===0&&c.negative!==0)return c.negative=0,d=this.isub(c),c.negative=1,d._normSign();var h,y;this.length>c.length?(h=this,y=c):(h=c,y=this);for(var b=0,M=0;M<y.length;M++)d=(h.words[M]|0)+(y.words[M]|0)+b,this.words[M]=d&67108863,b=d>>>26;for(;b!==0&&M<h.length;M++)d=(h.words[M]|0)+b,this.words[M]=d&67108863,b=d>>>26;if(this.length=h.length,b!==0)this.words[this.length]=b,this.length++;else if(h!==this)for(;M<h.length;M++)this.words[M]=h.words[M];return this},"iadd"),o.prototype.add=i(function(c){var d;return c.negative!==0&&this.negative===0?(c.negative=0,d=this.sub(c),c.negative^=1,d):c.negative===0&&this.negative!==0?(this.negative=0,d=c.sub(this),this.negative=1,d):this.length>c.length?this.clone().iadd(c):c.clone().iadd(this)},"add"),o.prototype.isub=i(function(c){if(c.negative!==0){c.negative=0;var d=this.iadd(c);return c.negative=1,d._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(c),this.negative=1,this._normSign();var h=this.cmp(c);if(h===0)return this.negative=0,this.length=1,this.words[0]=0,this;var y,b;h>0?(y=this,b=c):(y=c,b=this);for(var M=0,I=0;I<b.length;I++)d=(y.words[I]|0)-(b.words[I]|0)+M,M=d>>26,this.words[I]=d&67108863;for(;M!==0&&I<y.length;I++)d=(y.words[I]|0)+M,M=d>>26,this.words[I]=d&67108863;if(M===0&&I<y.length&&y!==this)for(;I<y.length;I++)this.words[I]=y.words[I];return this.length=Math.max(this.length,I),y!==this&&(this.negative=1),this.strip()},"isub"),o.prototype.sub=i(function(c){return this.clone().isub(c)},"sub");function T(E,c,d){d.negative=c.negative^E.negative;var h=E.length+c.length|0;d.length=h,h=h-1|0;var y=E.words[0]|0,b=c.words[0]|0,M=y*b,I=M&67108863,x=M/67108864|0;d.words[0]=I;for(var u=1;u<h;u++){for(var S=x>>>26,V=x&67108863,q=Math.min(u,c.length-1),F=Math.max(0,u-E.length+1);F<=q;F++){var ee=u-F|0;y=E.words[ee]|0,b=c.words[F]|0,M=y*b+V,S+=M/67108864|0,V=M&67108863}d.words[u]=V|0,x=S|0}return x!==0?d.words[u]=x|0:d.length--,d.strip()}i(T,"smallMulTo");var B=i(function(c,d,h){var y=c.words,b=d.words,M=h.words,I=0,x,u,S,V=y[0]|0,q=V&8191,F=V>>>13,ee=y[1]|0,ie=ee&8191,ce=ee>>>13,ye=y[2]|0,ue=ye&8191,N=ye>>>13,G=y[3]|0,W=G&8191,ne=G>>>13,le=y[4]|0,te=le&8191,se=le>>>13,dt=y[5]|0,Se=dt&8191,Ie=dt>>>13,gn=y[6]|0,Ke=gn&8191,Pe=gn>>>13,bo=y[7]|0,Ce=bo&8191,it=bo>>>13,Qi=y[8]|0,st=Qi&8191,at=Qi>>>13,ci=y[9]|0,Ne=ci&8191,Le=ci>>>13,ui=b[0]|0,De=ui&8191,Ve=ui>>>13,li=b[1]|0,qe=li&8191,He=li>>>13,fi=b[2]|0,je=fi&8191,ze=fi>>>13,di=b[3]|0,Fe=di&8191,We=di>>>13,hi=b[4]|0,$e=hi&8191,Ge=hi>>>13,pi=b[5]|0,Ze=pi&8191,Ye=pi>>>13,mi=b[6]|0,Je=mi&8191,Xe=mi>>>13,gi=b[7]|0,Qe=gi&8191,et=gi>>>13,yi=b[8]|0,tt=yi&8191,rt=yi>>>13,bi=b[9]|0,nt=bi&8191,ot=bi>>>13;h.negative=c.negative^d.negative,h.length=19,x=Math.imul(q,De),u=Math.imul(q,Ve),u=u+Math.imul(F,De)|0,S=Math.imul(F,Ve);var On=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(On>>>26)|0,On&=67108863,x=Math.imul(ie,De),u=Math.imul(ie,Ve),u=u+Math.imul(ce,De)|0,S=Math.imul(ce,Ve),x=x+Math.imul(q,qe)|0,u=u+Math.imul(q,He)|0,u=u+Math.imul(F,qe)|0,S=S+Math.imul(F,He)|0;var Kn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Kn>>>26)|0,Kn&=67108863,x=Math.imul(ue,De),u=Math.imul(ue,Ve),u=u+Math.imul(N,De)|0,S=Math.imul(N,Ve),x=x+Math.imul(ie,qe)|0,u=u+Math.imul(ie,He)|0,u=u+Math.imul(ce,qe)|0,S=S+Math.imul(ce,He)|0,x=x+Math.imul(q,je)|0,u=u+Math.imul(q,ze)|0,u=u+Math.imul(F,je)|0,S=S+Math.imul(F,ze)|0;var Rn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Rn>>>26)|0,Rn&=67108863,x=Math.imul(W,De),u=Math.imul(W,Ve),u=u+Math.imul(ne,De)|0,S=Math.imul(ne,Ve),x=x+Math.imul(ue,qe)|0,u=u+Math.imul(ue,He)|0,u=u+Math.imul(N,qe)|0,S=S+Math.imul(N,He)|0,x=x+Math.imul(ie,je)|0,u=u+Math.imul(ie,ze)|0,u=u+Math.imul(ce,je)|0,S=S+Math.imul(ce,ze)|0,x=x+Math.imul(q,Fe)|0,u=u+Math.imul(q,We)|0,u=u+Math.imul(F,Fe)|0,S=S+Math.imul(F,We)|0;var Un=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Un>>>26)|0,Un&=67108863,x=Math.imul(te,De),u=Math.imul(te,Ve),u=u+Math.imul(se,De)|0,S=Math.imul(se,Ve),x=x+Math.imul(W,qe)|0,u=u+Math.imul(W,He)|0,u=u+Math.imul(ne,qe)|0,S=S+Math.imul(ne,He)|0,x=x+Math.imul(ue,je)|0,u=u+Math.imul(ue,ze)|0,u=u+Math.imul(N,je)|0,S=S+Math.imul(N,ze)|0,x=x+Math.imul(ie,Fe)|0,u=u+Math.imul(ie,We)|0,u=u+Math.imul(ce,Fe)|0,S=S+Math.imul(ce,We)|0,x=x+Math.imul(q,$e)|0,u=u+Math.imul(q,Ge)|0,u=u+Math.imul(F,$e)|0,S=S+Math.imul(F,Ge)|0;var Nn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Nn>>>26)|0,Nn&=67108863,x=Math.imul(Se,De),u=Math.imul(Se,Ve),u=u+Math.imul(Ie,De)|0,S=Math.imul(Ie,Ve),x=x+Math.imul(te,qe)|0,u=u+Math.imul(te,He)|0,u=u+Math.imul(se,qe)|0,S=S+Math.imul(se,He)|0,x=x+Math.imul(W,je)|0,u=u+Math.imul(W,ze)|0,u=u+Math.imul(ne,je)|0,S=S+Math.imul(ne,ze)|0,x=x+Math.imul(ue,Fe)|0,u=u+Math.imul(ue,We)|0,u=u+Math.imul(N,Fe)|0,S=S+Math.imul(N,We)|0,x=x+Math.imul(ie,$e)|0,u=u+Math.imul(ie,Ge)|0,u=u+Math.imul(ce,$e)|0,S=S+Math.imul(ce,Ge)|0,x=x+Math.imul(q,Ze)|0,u=u+Math.imul(q,Ye)|0,u=u+Math.imul(F,Ze)|0,S=S+Math.imul(F,Ye)|0;var Ln=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Ln>>>26)|0,Ln&=67108863,x=Math.imul(Ke,De),u=Math.imul(Ke,Ve),u=u+Math.imul(Pe,De)|0,S=Math.imul(Pe,Ve),x=x+Math.imul(Se,qe)|0,u=u+Math.imul(Se,He)|0,u=u+Math.imul(Ie,qe)|0,S=S+Math.imul(Ie,He)|0,x=x+Math.imul(te,je)|0,u=u+Math.imul(te,ze)|0,u=u+Math.imul(se,je)|0,S=S+Math.imul(se,ze)|0,x=x+Math.imul(W,Fe)|0,u=u+Math.imul(W,We)|0,u=u+Math.imul(ne,Fe)|0,S=S+Math.imul(ne,We)|0,x=x+Math.imul(ue,$e)|0,u=u+Math.imul(ue,Ge)|0,u=u+Math.imul(N,$e)|0,S=S+Math.imul(N,Ge)|0,x=x+Math.imul(ie,Ze)|0,u=u+Math.imul(ie,Ye)|0,u=u+Math.imul(ce,Ze)|0,S=S+Math.imul(ce,Ye)|0,x=x+Math.imul(q,Je)|0,u=u+Math.imul(q,Xe)|0,u=u+Math.imul(F,Je)|0,S=S+Math.imul(F,Xe)|0;var Dn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Dn>>>26)|0,Dn&=67108863,x=Math.imul(Ce,De),u=Math.imul(Ce,Ve),u=u+Math.imul(it,De)|0,S=Math.imul(it,Ve),x=x+Math.imul(Ke,qe)|0,u=u+Math.imul(Ke,He)|0,u=u+Math.imul(Pe,qe)|0,S=S+Math.imul(Pe,He)|0,x=x+Math.imul(Se,je)|0,u=u+Math.imul(Se,ze)|0,u=u+Math.imul(Ie,je)|0,S=S+Math.imul(Ie,ze)|0,x=x+Math.imul(te,Fe)|0,u=u+Math.imul(te,We)|0,u=u+Math.imul(se,Fe)|0,S=S+Math.imul(se,We)|0,x=x+Math.imul(W,$e)|0,u=u+Math.imul(W,Ge)|0,u=u+Math.imul(ne,$e)|0,S=S+Math.imul(ne,Ge)|0,x=x+Math.imul(ue,Ze)|0,u=u+Math.imul(ue,Ye)|0,u=u+Math.imul(N,Ze)|0,S=S+Math.imul(N,Ye)|0,x=x+Math.imul(ie,Je)|0,u=u+Math.imul(ie,Xe)|0,u=u+Math.imul(ce,Je)|0,S=S+Math.imul(ce,Xe)|0,x=x+Math.imul(q,Qe)|0,u=u+Math.imul(q,et)|0,u=u+Math.imul(F,Qe)|0,S=S+Math.imul(F,et)|0;var Vn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Vn>>>26)|0,Vn&=67108863,x=Math.imul(st,De),u=Math.imul(st,Ve),u=u+Math.imul(at,De)|0,S=Math.imul(at,Ve),x=x+Math.imul(Ce,qe)|0,u=u+Math.imul(Ce,He)|0,u=u+Math.imul(it,qe)|0,S=S+Math.imul(it,He)|0,x=x+Math.imul(Ke,je)|0,u=u+Math.imul(Ke,ze)|0,u=u+Math.imul(Pe,je)|0,S=S+Math.imul(Pe,ze)|0,x=x+Math.imul(Se,Fe)|0,u=u+Math.imul(Se,We)|0,u=u+Math.imul(Ie,Fe)|0,S=S+Math.imul(Ie,We)|0,x=x+Math.imul(te,$e)|0,u=u+Math.imul(te,Ge)|0,u=u+Math.imul(se,$e)|0,S=S+Math.imul(se,Ge)|0,x=x+Math.imul(W,Ze)|0,u=u+Math.imul(W,Ye)|0,u=u+Math.imul(ne,Ze)|0,S=S+Math.imul(ne,Ye)|0,x=x+Math.imul(ue,Je)|0,u=u+Math.imul(ue,Xe)|0,u=u+Math.imul(N,Je)|0,S=S+Math.imul(N,Xe)|0,x=x+Math.imul(ie,Qe)|0,u=u+Math.imul(ie,et)|0,u=u+Math.imul(ce,Qe)|0,S=S+Math.imul(ce,et)|0,x=x+Math.imul(q,tt)|0,u=u+Math.imul(q,rt)|0,u=u+Math.imul(F,tt)|0,S=S+Math.imul(F,rt)|0;var qn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(qn>>>26)|0,qn&=67108863,x=Math.imul(Ne,De),u=Math.imul(Ne,Ve),u=u+Math.imul(Le,De)|0,S=Math.imul(Le,Ve),x=x+Math.imul(st,qe)|0,u=u+Math.imul(st,He)|0,u=u+Math.imul(at,qe)|0,S=S+Math.imul(at,He)|0,x=x+Math.imul(Ce,je)|0,u=u+Math.imul(Ce,ze)|0,u=u+Math.imul(it,je)|0,S=S+Math.imul(it,ze)|0,x=x+Math.imul(Ke,Fe)|0,u=u+Math.imul(Ke,We)|0,u=u+Math.imul(Pe,Fe)|0,S=S+Math.imul(Pe,We)|0,x=x+Math.imul(Se,$e)|0,u=u+Math.imul(Se,Ge)|0,u=u+Math.imul(Ie,$e)|0,S=S+Math.imul(Ie,Ge)|0,x=x+Math.imul(te,Ze)|0,u=u+Math.imul(te,Ye)|0,u=u+Math.imul(se,Ze)|0,S=S+Math.imul(se,Ye)|0,x=x+Math.imul(W,Je)|0,u=u+Math.imul(W,Xe)|0,u=u+Math.imul(ne,Je)|0,S=S+Math.imul(ne,Xe)|0,x=x+Math.imul(ue,Qe)|0,u=u+Math.imul(ue,et)|0,u=u+Math.imul(N,Qe)|0,S=S+Math.imul(N,et)|0,x=x+Math.imul(ie,tt)|0,u=u+Math.imul(ie,rt)|0,u=u+Math.imul(ce,tt)|0,S=S+Math.imul(ce,rt)|0,x=x+Math.imul(q,nt)|0,u=u+Math.imul(q,ot)|0,u=u+Math.imul(F,nt)|0,S=S+Math.imul(F,ot)|0;var Hn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Hn>>>26)|0,Hn&=67108863,x=Math.imul(Ne,qe),u=Math.imul(Ne,He),u=u+Math.imul(Le,qe)|0,S=Math.imul(Le,He),x=x+Math.imul(st,je)|0,u=u+Math.imul(st,ze)|0,u=u+Math.imul(at,je)|0,S=S+Math.imul(at,ze)|0,x=x+Math.imul(Ce,Fe)|0,u=u+Math.imul(Ce,We)|0,u=u+Math.imul(it,Fe)|0,S=S+Math.imul(it,We)|0,x=x+Math.imul(Ke,$e)|0,u=u+Math.imul(Ke,Ge)|0,u=u+Math.imul(Pe,$e)|0,S=S+Math.imul(Pe,Ge)|0,x=x+Math.imul(Se,Ze)|0,u=u+Math.imul(Se,Ye)|0,u=u+Math.imul(Ie,Ze)|0,S=S+Math.imul(Ie,Ye)|0,x=x+Math.imul(te,Je)|0,u=u+Math.imul(te,Xe)|0,u=u+Math.imul(se,Je)|0,S=S+Math.imul(se,Xe)|0,x=x+Math.imul(W,Qe)|0,u=u+Math.imul(W,et)|0,u=u+Math.imul(ne,Qe)|0,S=S+Math.imul(ne,et)|0,x=x+Math.imul(ue,tt)|0,u=u+Math.imul(ue,rt)|0,u=u+Math.imul(N,tt)|0,S=S+Math.imul(N,rt)|0,x=x+Math.imul(ie,nt)|0,u=u+Math.imul(ie,ot)|0,u=u+Math.imul(ce,nt)|0,S=S+Math.imul(ce,ot)|0;var jn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(jn>>>26)|0,jn&=67108863,x=Math.imul(Ne,je),u=Math.imul(Ne,ze),u=u+Math.imul(Le,je)|0,S=Math.imul(Le,ze),x=x+Math.imul(st,Fe)|0,u=u+Math.imul(st,We)|0,u=u+Math.imul(at,Fe)|0,S=S+Math.imul(at,We)|0,x=x+Math.imul(Ce,$e)|0,u=u+Math.imul(Ce,Ge)|0,u=u+Math.imul(it,$e)|0,S=S+Math.imul(it,Ge)|0,x=x+Math.imul(Ke,Ze)|0,u=u+Math.imul(Ke,Ye)|0,u=u+Math.imul(Pe,Ze)|0,S=S+Math.imul(Pe,Ye)|0,x=x+Math.imul(Se,Je)|0,u=u+Math.imul(Se,Xe)|0,u=u+Math.imul(Ie,Je)|0,S=S+Math.imul(Ie,Xe)|0,x=x+Math.imul(te,Qe)|0,u=u+Math.imul(te,et)|0,u=u+Math.imul(se,Qe)|0,S=S+Math.imul(se,et)|0,x=x+Math.imul(W,tt)|0,u=u+Math.imul(W,rt)|0,u=u+Math.imul(ne,tt)|0,S=S+Math.imul(ne,rt)|0,x=x+Math.imul(ue,nt)|0,u=u+Math.imul(ue,ot)|0,u=u+Math.imul(N,nt)|0,S=S+Math.imul(N,ot)|0;var zn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(zn>>>26)|0,zn&=67108863,x=Math.imul(Ne,Fe),u=Math.imul(Ne,We),u=u+Math.imul(Le,Fe)|0,S=Math.imul(Le,We),x=x+Math.imul(st,$e)|0,u=u+Math.imul(st,Ge)|0,u=u+Math.imul(at,$e)|0,S=S+Math.imul(at,Ge)|0,x=x+Math.imul(Ce,Ze)|0,u=u+Math.imul(Ce,Ye)|0,u=u+Math.imul(it,Ze)|0,S=S+Math.imul(it,Ye)|0,x=x+Math.imul(Ke,Je)|0,u=u+Math.imul(Ke,Xe)|0,u=u+Math.imul(Pe,Je)|0,S=S+Math.imul(Pe,Xe)|0,x=x+Math.imul(Se,Qe)|0,u=u+Math.imul(Se,et)|0,u=u+Math.imul(Ie,Qe)|0,S=S+Math.imul(Ie,et)|0,x=x+Math.imul(te,tt)|0,u=u+Math.imul(te,rt)|0,u=u+Math.imul(se,tt)|0,S=S+Math.imul(se,rt)|0,x=x+Math.imul(W,nt)|0,u=u+Math.imul(W,ot)|0,u=u+Math.imul(ne,nt)|0,S=S+Math.imul(ne,ot)|0;var Fn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Fn>>>26)|0,Fn&=67108863,x=Math.imul(Ne,$e),u=Math.imul(Ne,Ge),u=u+Math.imul(Le,$e)|0,S=Math.imul(Le,Ge),x=x+Math.imul(st,Ze)|0,u=u+Math.imul(st,Ye)|0,u=u+Math.imul(at,Ze)|0,S=S+Math.imul(at,Ye)|0,x=x+Math.imul(Ce,Je)|0,u=u+Math.imul(Ce,Xe)|0,u=u+Math.imul(it,Je)|0,S=S+Math.imul(it,Xe)|0,x=x+Math.imul(Ke,Qe)|0,u=u+Math.imul(Ke,et)|0,u=u+Math.imul(Pe,Qe)|0,S=S+Math.imul(Pe,et)|0,x=x+Math.imul(Se,tt)|0,u=u+Math.imul(Se,rt)|0,u=u+Math.imul(Ie,tt)|0,S=S+Math.imul(Ie,rt)|0,x=x+Math.imul(te,nt)|0,u=u+Math.imul(te,ot)|0,u=u+Math.imul(se,nt)|0,S=S+Math.imul(se,ot)|0;var Wn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Wn>>>26)|0,Wn&=67108863,x=Math.imul(Ne,Ze),u=Math.imul(Ne,Ye),u=u+Math.imul(Le,Ze)|0,S=Math.imul(Le,Ye),x=x+Math.imul(st,Je)|0,u=u+Math.imul(st,Xe)|0,u=u+Math.imul(at,Je)|0,S=S+Math.imul(at,Xe)|0,x=x+Math.imul(Ce,Qe)|0,u=u+Math.imul(Ce,et)|0,u=u+Math.imul(it,Qe)|0,S=S+Math.imul(it,et)|0,x=x+Math.imul(Ke,tt)|0,u=u+Math.imul(Ke,rt)|0,u=u+Math.imul(Pe,tt)|0,S=S+Math.imul(Pe,rt)|0,x=x+Math.imul(Se,nt)|0,u=u+Math.imul(Se,ot)|0,u=u+Math.imul(Ie,nt)|0,S=S+Math.imul(Ie,ot)|0;var $n=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+($n>>>26)|0,$n&=67108863,x=Math.imul(Ne,Je),u=Math.imul(Ne,Xe),u=u+Math.imul(Le,Je)|0,S=Math.imul(Le,Xe),x=x+Math.imul(st,Qe)|0,u=u+Math.imul(st,et)|0,u=u+Math.imul(at,Qe)|0,S=S+Math.imul(at,et)|0,x=x+Math.imul(Ce,tt)|0,u=u+Math.imul(Ce,rt)|0,u=u+Math.imul(it,tt)|0,S=S+Math.imul(it,rt)|0,x=x+Math.imul(Ke,nt)|0,u=u+Math.imul(Ke,ot)|0,u=u+Math.imul(Pe,nt)|0,S=S+Math.imul(Pe,ot)|0;var Gn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Gn>>>26)|0,Gn&=67108863,x=Math.imul(Ne,Qe),u=Math.imul(Ne,et),u=u+Math.imul(Le,Qe)|0,S=Math.imul(Le,et),x=x+Math.imul(st,tt)|0,u=u+Math.imul(st,rt)|0,u=u+Math.imul(at,tt)|0,S=S+Math.imul(at,rt)|0,x=x+Math.imul(Ce,nt)|0,u=u+Math.imul(Ce,ot)|0,u=u+Math.imul(it,nt)|0,S=S+Math.imul(it,ot)|0;var Zn=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Zn>>>26)|0,Zn&=67108863,x=Math.imul(Ne,tt),u=Math.imul(Ne,rt),u=u+Math.imul(Le,tt)|0,S=Math.imul(Le,rt),x=x+Math.imul(st,nt)|0,u=u+Math.imul(st,ot)|0,u=u+Math.imul(at,nt)|0,S=S+Math.imul(at,ot)|0;var Hs=(I+x|0)+((u&8191)<<13)|0;I=(S+(u>>>13)|0)+(Hs>>>26)|0,Hs&=67108863,x=Math.imul(Ne,nt),u=Math.imul(Ne,ot),u=u+Math.imul(Le,nt)|0,S=Math.imul(Le,ot);var js=(I+x|0)+((u&8191)<<13)|0;return I=(S+(u>>>13)|0)+(js>>>26)|0,js&=67108863,M[0]=On,M[1]=Kn,M[2]=Rn,M[3]=Un,M[4]=Nn,M[5]=Ln,M[6]=Dn,M[7]=Vn,M[8]=qn,M[9]=Hn,M[10]=jn,M[11]=zn,M[12]=Fn,M[13]=Wn,M[14]=$n,M[15]=Gn,M[16]=Zn,M[17]=Hs,M[18]=js,I!==0&&(M[19]=I,h.length++),h},"comb10MulTo");Math.imul||(B=T);function P(E,c,d){d.negative=c.negative^E.negative,d.length=E.length+c.length;for(var h=0,y=0,b=0;b<d.length-1;b++){var M=y;y=0;for(var I=h&67108863,x=Math.min(b,c.length-1),u=Math.max(0,b-E.length+1);u<=x;u++){var S=b-u,V=E.words[S]|0,q=c.words[u]|0,F=V*q,ee=F&67108863;M=M+(F/67108864|0)|0,ee=ee+I|0,I=ee&67108863,M=M+(ee>>>26)|0,y+=M>>>26,M&=67108863}d.words[b]=I,h=M,M=y}return h!==0?d.words[b]=h:d.length--,d.strip()}i(P,"bigMulTo");function C(E,c,d){var h=new O;return h.mulp(E,c,d)}i(C,"jumboMulTo"),o.prototype.mulTo=i(function(c,d){var h,y=this.length+c.length;return this.length===10&&c.length===10?h=B(this,c,d):y<63?h=T(this,c,d):y<1024?h=P(this,c,d):h=C(this,c,d),h},"mulTo");function O(E,c){this.x=E,this.y=c}i(O,"FFTM"),O.prototype.makeRBT=i(function(c){for(var d=new Array(c),h=o.prototype._countBits(c)-1,y=0;y<c;y++)d[y]=this.revBin(y,h,c);return d},"makeRBT"),O.prototype.revBin=i(function(c,d,h){if(c===0||c===h-1)return c;for(var y=0,b=0;b<d;b++)y|=(c&1)<<d-b-1,c>>=1;return y},"revBin"),O.prototype.permute=i(function(c,d,h,y,b,M){for(var I=0;I<M;I++)y[I]=d[c[I]],b[I]=h[c[I]]},"permute"),O.prototype.transform=i(function(c,d,h,y,b,M){this.permute(M,c,d,h,y,b);for(var I=1;I<b;I<<=1)for(var x=I<<1,u=Math.cos(2*Math.PI/x),S=Math.sin(2*Math.PI/x),V=0;V<b;V+=x)for(var q=u,F=S,ee=0;ee<I;ee++){var ie=h[V+ee],ce=y[V+ee],ye=h[V+ee+I],ue=y[V+ee+I],N=q*ye-F*ue;ue=q*ue+F*ye,ye=N,h[V+ee]=ie+ye,y[V+ee]=ce+ue,h[V+ee+I]=ie-ye,y[V+ee+I]=ce-ue,ee!==x&&(N=u*q-S*F,F=u*F+S*q,q=N)}},"transform"),O.prototype.guessLen13b=i(function(c,d){var h=Math.max(d,c)|1,y=h&1,b=0;for(h=h/2|0;h;h=h>>>1)b++;return 1<<b+1+y},"guessLen13b"),O.prototype.conjugate=i(function(c,d,h){if(!(h<=1))for(var y=0;y<h/2;y++){var b=c[y];c[y]=c[h-y-1],c[h-y-1]=b,b=d[y],d[y]=-d[h-y-1],d[h-y-1]=-b}},"conjugate"),O.prototype.normalize13b=i(function(c,d){for(var h=0,y=0;y<d/2;y++){var b=Math.round(c[2*y+1]/d)*8192+Math.round(c[2*y]/d)+h;c[y]=b&67108863,b<67108864?h=0:h=b/67108864|0}return c},"normalize13b"),O.prototype.convert13b=i(function(c,d,h,y){for(var b=0,M=0;M<d;M++)b=b+(c[M]|0),h[2*M]=b&8191,b=b>>>13,h[2*M+1]=b&8191,b=b>>>13;for(M=2*d;M<y;++M)h[M]=0;r(b===0),r((b&-8192)===0)},"convert13b"),O.prototype.stub=i(function(c){for(var d=new Array(c),h=0;h<c;h++)d[h]=0;return d},"stub"),O.prototype.mulp=i(function(c,d,h){var y=2*this.guessLen13b(c.length,d.length),b=this.makeRBT(y),M=this.stub(y),I=new Array(y),x=new Array(y),u=new Array(y),S=new Array(y),V=new Array(y),q=new Array(y),F=h.words;F.length=y,this.convert13b(c.words,c.length,I,y),this.convert13b(d.words,d.length,S,y),this.transform(I,M,x,u,y,b),this.transform(S,M,V,q,y,b);for(var ee=0;ee<y;ee++){var ie=x[ee]*V[ee]-u[ee]*q[ee];u[ee]=x[ee]*q[ee]+u[ee]*V[ee],x[ee]=ie}return this.conjugate(x,u,y),this.transform(x,u,F,M,y,b),this.conjugate(F,M,y),this.normalize13b(F,y),h.negative=c.negative^d.negative,h.length=c.length+d.length,h.strip()},"mulp"),o.prototype.mul=i(function(c){var d=new o(null);return d.words=new Array(this.length+c.length),this.mulTo(c,d)},"mul"),o.prototype.mulf=i(function(c){var d=new o(null);return d.words=new Array(this.length+c.length),C(this,c,d)},"mulf"),o.prototype.imul=i(function(c){return this.clone().mulTo(c,this)},"imul"),o.prototype.imuln=i(function(c){r(typeof c=="number"),r(c<67108864);for(var d=0,h=0;h<this.length;h++){var y=(this.words[h]|0)*c,b=(y&67108863)+(d&67108863);d>>=26,d+=y/67108864|0,d+=b>>>26,this.words[h]=b&67108863}return d!==0&&(this.words[h]=d,this.length++),this},"imuln"),o.prototype.muln=i(function(c){return this.clone().imuln(c)},"muln"),o.prototype.sqr=i(function(){return this.mul(this)},"sqr"),o.prototype.isqr=i(function(){return this.imul(this.clone())},"isqr"),o.prototype.pow=i(function(c){var d=_(c);if(d.length===0)return new o(1);for(var h=this,y=0;y<d.length&&d[y]===0;y++,h=h.sqr());if(++y<d.length)for(var b=h.sqr();y<d.length;y++,b=b.sqr())d[y]!==0&&(h=h.mul(b));return h},"pow"),o.prototype.iushln=i(function(c){r(typeof c=="number"&&c>=0);var d=c%26,h=(c-d)/26,y=67108863>>>26-d<<26-d,b;if(d!==0){var M=0;for(b=0;b<this.length;b++){var I=this.words[b]&y,x=(this.words[b]|0)-I<<d;this.words[b]=x|M,M=I>>>26-d}M&&(this.words[b]=M,this.length++)}if(h!==0){for(b=this.length-1;b>=0;b--)this.words[b+h]=this.words[b];for(b=0;b<h;b++)this.words[b]=0;this.length+=h}return this.strip()},"iushln"),o.prototype.ishln=i(function(c){return r(this.negative===0),this.iushln(c)},"ishln"),o.prototype.iushrn=i(function(c,d,h){r(typeof c=="number"&&c>=0);var y;d?y=(d-d%26)/26:y=0;var b=c%26,M=Math.min((c-b)/26,this.length),I=67108863^67108863>>>b<<b,x=h;if(y-=M,y=Math.max(0,y),x){for(var u=0;u<M;u++)x.words[u]=this.words[u];x.length=M}if(M!==0)if(this.length>M)for(this.length-=M,u=0;u<this.length;u++)this.words[u]=this.words[u+M];else this.words[0]=0,this.length=1;var S=0;for(u=this.length-1;u>=0&&(S!==0||u>=y);u--){var V=this.words[u]|0;this.words[u]=S<<26-b|V>>>b,S=V&I}return x&&S!==0&&(x.words[x.length++]=S),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},"iushrn"),o.prototype.ishrn=i(function(c,d,h){return r(this.negative===0),this.iushrn(c,d,h)},"ishrn"),o.prototype.shln=i(function(c){return this.clone().ishln(c)},"shln"),o.prototype.ushln=i(function(c){return this.clone().iushln(c)},"ushln"),o.prototype.shrn=i(function(c){return this.clone().ishrn(c)},"shrn"),o.prototype.ushrn=i(function(c){return this.clone().iushrn(c)},"ushrn"),o.prototype.testn=i(function(c){r(typeof c=="number"&&c>=0);var d=c%26,h=(c-d)/26,y=1<<d;if(this.length<=h)return!1;var b=this.words[h];return!!(b&y)},"testn"),o.prototype.imaskn=i(function(c){r(typeof c=="number"&&c>=0);var d=c%26,h=(c-d)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=h)return this;if(d!==0&&h++,this.length=Math.min(h,this.length),d!==0){var y=67108863^67108863>>>d<<d;this.words[this.length-1]&=y}return this.strip()},"imaskn"),o.prototype.maskn=i(function(c){return this.clone().imaskn(c)},"maskn"),o.prototype.iaddn=i(function(c){return r(typeof c=="number"),r(c<67108864),c<0?this.isubn(-c):this.negative!==0?this.length===1&&(this.words[0]|0)<c?(this.words[0]=c-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(c),this.negative=1,this):this._iaddn(c)},"iaddn"),o.prototype._iaddn=i(function(c){this.words[0]+=c;for(var d=0;d<this.length&&this.words[d]>=67108864;d++)this.words[d]-=67108864,d===this.length-1?this.words[d+1]=1:this.words[d+1]++;return this.length=Math.max(this.length,d+1),this},"_iaddn"),o.prototype.isubn=i(function(c){if(r(typeof c=="number"),r(c<67108864),c<0)return this.iaddn(-c);if(this.negative!==0)return this.negative=0,this.iaddn(c),this.negative=1,this;if(this.words[0]-=c,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var d=0;d<this.length&&this.words[d]<0;d++)this.words[d]+=67108864,this.words[d+1]-=1;return this.strip()},"isubn"),o.prototype.addn=i(function(c){return this.clone().iaddn(c)},"addn"),o.prototype.subn=i(function(c){return this.clone().isubn(c)},"subn"),o.prototype.iabs=i(function(){return this.negative=0,this},"iabs"),o.prototype.abs=i(function(){return this.clone().iabs()},"abs"),o.prototype._ishlnsubmul=i(function(c,d,h){var y=c.length+h,b;this._expand(y);var M,I=0;for(b=0;b<c.length;b++){M=(this.words[b+h]|0)+I;var x=(c.words[b]|0)*d;M-=x&67108863,I=(M>>26)-(x/67108864|0),this.words[b+h]=M&67108863}for(;b<this.length-h;b++)M=(this.words[b+h]|0)+I,I=M>>26,this.words[b+h]=M&67108863;if(I===0)return this.strip();for(r(I===-1),I=0,b=0;b<this.length;b++)M=-(this.words[b]|0)+I,I=M>>26,this.words[b]=M&67108863;return this.negative=1,this.strip()},"_ishlnsubmul"),o.prototype._wordDiv=i(function(c,d){var h=this.length-c.length,y=this.clone(),b=c,M=b.words[b.length-1]|0,I=this._countBits(M);h=26-I,h!==0&&(b=b.ushln(h),y.iushln(h),M=b.words[b.length-1]|0);var x=y.length-b.length,u;if(d!=="mod"){u=new o(null),u.length=x+1,u.words=new Array(u.length);for(var S=0;S<u.length;S++)u.words[S]=0}var V=y.clone()._ishlnsubmul(b,1,x);V.negative===0&&(y=V,u&&(u.words[x]=1));for(var q=x-1;q>=0;q--){var F=(y.words[b.length+q]|0)*67108864+(y.words[b.length+q-1]|0);for(F=Math.min(F/M|0,67108863),y._ishlnsubmul(b,F,q);y.negative!==0;)F--,y.negative=0,y._ishlnsubmul(b,1,q),y.isZero()||(y.negative^=1);u&&(u.words[q]=F)}return u&&u.strip(),y.strip(),d!=="div"&&h!==0&&y.iushrn(h),{div:u||null,mod:y}},"_wordDiv"),o.prototype.divmod=i(function(c,d,h){if(r(!c.isZero()),this.isZero())return{div:new o(0),mod:new o(0)};var y,b,M;return this.negative!==0&&c.negative===0?(M=this.neg().divmod(c,d),d!=="mod"&&(y=M.div.neg()),d!=="div"&&(b=M.mod.neg(),h&&b.negative!==0&&b.iadd(c)),{div:y,mod:b}):this.negative===0&&c.negative!==0?(M=this.divmod(c.neg(),d),d!=="mod"&&(y=M.div.neg()),{div:y,mod:M.mod}):this.negative&c.negative?(M=this.neg().divmod(c.neg(),d),d!=="div"&&(b=M.mod.neg(),h&&b.negative!==0&&b.isub(c)),{div:M.div,mod:b}):c.length>this.length||this.cmp(c)<0?{div:new o(0),mod:this}:c.length===1?d==="div"?{div:this.divn(c.words[0]),mod:null}:d==="mod"?{div:null,mod:new o(this.modn(c.words[0]))}:{div:this.divn(c.words[0]),mod:new o(this.modn(c.words[0]))}:this._wordDiv(c,d)},"divmod"),o.prototype.div=i(function(c){return this.divmod(c,"div",!1).div},"div"),o.prototype.mod=i(function(c){return this.divmod(c,"mod",!1).mod},"mod"),o.prototype.umod=i(function(c){return this.divmod(c,"mod",!0).mod},"umod"),o.prototype.divRound=i(function(c){var d=this.divmod(c);if(d.mod.isZero())return d.div;var h=d.div.negative!==0?d.mod.isub(c):d.mod,y=c.ushrn(1),b=c.andln(1),M=h.cmp(y);return M<0||b===1&&M===0?d.div:d.div.negative!==0?d.div.isubn(1):d.div.iaddn(1)},"divRound"),o.prototype.modn=i(function(c){r(c<=67108863);for(var d=(1<<26)%c,h=0,y=this.length-1;y>=0;y--)h=(d*h+(this.words[y]|0))%c;return h},"modn"),o.prototype.idivn=i(function(c){r(c<=67108863);for(var d=0,h=this.length-1;h>=0;h--){var y=(this.words[h]|0)+d*67108864;this.words[h]=y/c|0,d=y%c}return this.strip()},"idivn"),o.prototype.divn=i(function(c){return this.clone().idivn(c)},"divn"),o.prototype.egcd=i(function(c){r(c.negative===0),r(!c.isZero());var d=this,h=c.clone();d.negative!==0?d=d.umod(c):d=d.clone();for(var y=new o(1),b=new o(0),M=new o(0),I=new o(1),x=0;d.isEven()&&h.isEven();)d.iushrn(1),h.iushrn(1),++x;for(var u=h.clone(),S=d.clone();!d.isZero();){for(var V=0,q=1;!(d.words[0]&q)&&V<26;++V,q<<=1);if(V>0)for(d.iushrn(V);V-- >0;)(y.isOdd()||b.isOdd())&&(y.iadd(u),b.isub(S)),y.iushrn(1),b.iushrn(1);for(var F=0,ee=1;!(h.words[0]&ee)&&F<26;++F,ee<<=1);if(F>0)for(h.iushrn(F);F-- >0;)(M.isOdd()||I.isOdd())&&(M.iadd(u),I.isub(S)),M.iushrn(1),I.iushrn(1);d.cmp(h)>=0?(d.isub(h),y.isub(M),b.isub(I)):(h.isub(d),M.isub(y),I.isub(b))}return{a:M,b:I,gcd:h.iushln(x)}},"egcd"),o.prototype._invmp=i(function(c){r(c.negative===0),r(!c.isZero());var d=this,h=c.clone();d.negative!==0?d=d.umod(c):d=d.clone();for(var y=new o(1),b=new o(0),M=h.clone();d.cmpn(1)>0&&h.cmpn(1)>0;){for(var I=0,x=1;!(d.words[0]&x)&&I<26;++I,x<<=1);if(I>0)for(d.iushrn(I);I-- >0;)y.isOdd()&&y.iadd(M),y.iushrn(1);for(var u=0,S=1;!(h.words[0]&S)&&u<26;++u,S<<=1);if(u>0)for(h.iushrn(u);u-- >0;)b.isOdd()&&b.iadd(M),b.iushrn(1);d.cmp(h)>=0?(d.isub(h),y.isub(b)):(h.isub(d),b.isub(y))}var V;return d.cmpn(1)===0?V=y:V=b,V.cmpn(0)<0&&V.iadd(c),V},"_invmp"),o.prototype.gcd=i(function(c){if(this.isZero())return c.abs();if(c.isZero())return this.abs();var d=this.clone(),h=c.clone();d.negative=0,h.negative=0;for(var y=0;d.isEven()&&h.isEven();y++)d.iushrn(1),h.iushrn(1);do{for(;d.isEven();)d.iushrn(1);for(;h.isEven();)h.iushrn(1);var b=d.cmp(h);if(b<0){var M=d;d=h,h=M}else if(b===0||h.cmpn(1)===0)break;d.isub(h)}while(!0);return h.iushln(y)},"gcd"),o.prototype.invm=i(function(c){return this.egcd(c).a.umod(c)},"invm"),o.prototype.isEven=i(function(){return(this.words[0]&1)===0},"isEven"),o.prototype.isOdd=i(function(){return(this.words[0]&1)===1},"isOdd"),o.prototype.andln=i(function(c){return this.words[0]&c},"andln"),o.prototype.bincn=i(function(c){r(typeof c=="number");var d=c%26,h=(c-d)/26,y=1<<d;if(this.length<=h)return this._expand(h+1),this.words[h]|=y,this;for(var b=y,M=h;b!==0&&M<this.length;M++){var I=this.words[M]|0;I+=b,b=I>>>26,I&=67108863,this.words[M]=I}return b!==0&&(this.words[M]=b,this.length++),this},"bincn"),o.prototype.isZero=i(function(){return this.length===1&&this.words[0]===0},"isZero"),o.prototype.cmpn=i(function(c){var d=c<0;if(this.negative!==0&&!d)return-1;if(this.negative===0&&d)return 1;this.strip();var h;if(this.length>1)h=1;else{d&&(c=-c),r(c<=67108863,"Number is too big");var y=this.words[0]|0;h=y===c?0:y<c?-1:1}return this.negative!==0?-h|0:h},"cmpn"),o.prototype.cmp=i(function(c){if(this.negative!==0&&c.negative===0)return-1;if(this.negative===0&&c.negative!==0)return 1;var d=this.ucmp(c);return this.negative!==0?-d|0:d},"cmp"),o.prototype.ucmp=i(function(c){if(this.length>c.length)return 1;if(this.length<c.length)return-1;for(var d=0,h=this.length-1;h>=0;h--){var y=this.words[h]|0,b=c.words[h]|0;if(y!==b){y<b?d=-1:y>b&&(d=1);break}}return d},"ucmp"),o.prototype.gtn=i(function(c){return this.cmpn(c)===1},"gtn"),o.prototype.gt=i(function(c){return this.cmp(c)===1},"gt"),o.prototype.gten=i(function(c){return this.cmpn(c)>=0},"gten"),o.prototype.gte=i(function(c){return this.cmp(c)>=0},"gte"),o.prototype.ltn=i(function(c){return this.cmpn(c)===-1},"ltn"),o.prototype.lt=i(function(c){return this.cmp(c)===-1},"lt"),o.prototype.lten=i(function(c){return this.cmpn(c)<=0},"lten"),o.prototype.lte=i(function(c){return this.cmp(c)<=0},"lte"),o.prototype.eqn=i(function(c){return this.cmpn(c)===0},"eqn"),o.prototype.eq=i(function(c){return this.cmp(c)===0},"eq"),o.red=i(function(c){return new z(c)},"red"),o.prototype.toRed=i(function(c){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),c.convertTo(this)._forceRed(c)},"toRed"),o.prototype.fromRed=i(function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},"fromRed"),o.prototype._forceRed=i(function(c){return this.red=c,this},"_forceRed"),o.prototype.forceRed=i(function(c){return r(!this.red,"Already a number in reduction context"),this._forceRed(c)},"forceRed"),o.prototype.redAdd=i(function(c){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,c)},"redAdd"),o.prototype.redIAdd=i(function(c){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,c)},"redIAdd"),o.prototype.redSub=i(function(c){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,c)},"redSub"),o.prototype.redISub=i(function(c){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,c)},"redISub"),o.prototype.redShl=i(function(c){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,c)},"redShl"),o.prototype.redMul=i(function(c){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,c),this.red.mul(this,c)},"redMul"),o.prototype.redIMul=i(function(c){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,c),this.red.imul(this,c)},"redIMul"),o.prototype.redSqr=i(function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},"redSqr"),o.prototype.redISqr=i(function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},"redISqr"),o.prototype.redSqrt=i(function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},"redSqrt"),o.prototype.redInvm=i(function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},"redInvm"),o.prototype.redNeg=i(function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},"redNeg"),o.prototype.redPow=i(function(c){return r(this.red&&!c.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,c)},"redPow");var L={k256:null,p224:null,p192:null,p25519:null};function R(E,c){this.name=E,this.p=new o(c,16),this.n=this.p.bitLength(),this.k=new o(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}i(R,"MPrime"),R.prototype._tmp=i(function(){var c=new o(null);return c.words=new Array(Math.ceil(this.n/13)),c},"_tmp"),R.prototype.ireduce=i(function(c){var d=c,h;do this.split(d,this.tmp),d=this.imulK(d),d=d.iadd(this.tmp),h=d.bitLength();while(h>this.n);var y=h<this.n?-1:d.ucmp(this.p);return y===0?(d.words[0]=0,d.length=1):y>0?d.isub(this.p):d.strip!==void 0?d.strip():d._strip(),d},"ireduce"),R.prototype.split=i(function(c,d){c.iushrn(this.n,0,d)},"split"),R.prototype.imulK=i(function(c){return c.imul(this.k)},"imulK");function j(){R.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}i(j,"K256"),n(j,R),j.prototype.split=i(function(c,d){for(var h=4194303,y=Math.min(c.length,9),b=0;b<y;b++)d.words[b]=c.words[b];if(d.length=y,c.length<=9){c.words[0]=0,c.length=1;return}var M=c.words[9];for(d.words[d.length++]=M&h,b=10;b<c.length;b++){var I=c.words[b]|0;c.words[b-10]=(I&h)<<4|M>>>22,M=I}M>>>=22,c.words[b-10]=M,M===0&&c.length>10?c.length-=10:c.length-=9},"split"),j.prototype.imulK=i(function(c){c.words[c.length]=0,c.words[c.length+1]=0,c.length+=2;for(var d=0,h=0;h<c.length;h++){var y=c.words[h]|0;d+=y*977,c.words[h]=d&67108863,d=y*64+(d/67108864|0)}return c.words[c.length-1]===0&&(c.length--,c.words[c.length-1]===0&&c.length--),c},"imulK");function Z(){R.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}i(Z,"P224"),n(Z,R);function X(){R.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}i(X,"P192"),n(X,R);function Q(){R.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}i(Q,"P25519"),n(Q,R),Q.prototype.imulK=i(function(c){for(var d=0,h=0;h<c.length;h++){var y=(c.words[h]|0)*19+d,b=y&67108863;y>>>=26,c.words[h]=b,d=y}return d!==0&&(c.words[c.length++]=d),c},"imulK"),o._prime=i(function(c){if(L[c])return L[c];var d;if(c==="k256")d=new j;else if(c==="p224")d=new Z;else if(c==="p192")d=new X;else if(c==="p25519")d=new Q;else throw new Error("Unknown prime "+c);return L[c]=d,d},"prime");function z(E){if(typeof E=="string"){var c=o._prime(E);this.m=c.p,this.prime=c}else r(E.gtn(1),"modulus must be greater than 1"),this.m=E,this.prime=null}i(z,"Red"),z.prototype._verify1=i(function(c){r(c.negative===0,"red works only with positives"),r(c.red,"red works only with red numbers")},"_verify1"),z.prototype._verify2=i(function(c,d){r((c.negative|d.negative)===0,"red works only with positives"),r(c.red&&c.red===d.red,"red works only with red numbers")},"_verify2"),z.prototype.imod=i(function(c){return this.prime?this.prime.ireduce(c)._forceRed(this):c.umod(this.m)._forceRed(this)},"imod"),z.prototype.neg=i(function(c){return c.isZero()?c.clone():this.m.sub(c)._forceRed(this)},"neg"),z.prototype.add=i(function(c,d){this._verify2(c,d);var h=c.add(d);return h.cmp(this.m)>=0&&h.isub(this.m),h._forceRed(this)},"add"),z.prototype.iadd=i(function(c,d){this._verify2(c,d);var h=c.iadd(d);return h.cmp(this.m)>=0&&h.isub(this.m),h},"iadd"),z.prototype.sub=i(function(c,d){this._verify2(c,d);var h=c.sub(d);return h.cmpn(0)<0&&h.iadd(this.m),h._forceRed(this)},"sub"),z.prototype.isub=i(function(c,d){this._verify2(c,d);var h=c.isub(d);return h.cmpn(0)<0&&h.iadd(this.m),h},"isub"),z.prototype.shl=i(function(c,d){return this._verify1(c),this.imod(c.ushln(d))},"shl"),z.prototype.imul=i(function(c,d){return this._verify2(c,d),this.imod(c.imul(d))},"imul"),z.prototype.mul=i(function(c,d){return this._verify2(c,d),this.imod(c.mul(d))},"mul"),z.prototype.isqr=i(function(c){return this.imul(c,c.clone())},"isqr"),z.prototype.sqr=i(function(c){return this.mul(c,c)},"sqr"),z.prototype.sqrt=i(function(c){if(c.isZero())return c.clone();var d=this.m.andln(3);if(r(d%2===1),d===3){var h=this.m.add(new o(1)).iushrn(2);return this.pow(c,h)}for(var y=this.m.subn(1),b=0;!y.isZero()&&y.andln(1)===0;)b++,y.iushrn(1);r(!y.isZero());var M=new o(1).toRed(this),I=M.redNeg(),x=this.m.subn(1).iushrn(1),u=this.m.bitLength();for(u=new o(2*u*u).toRed(this);this.pow(u,x).cmp(I)!==0;)u.redIAdd(I);for(var S=this.pow(u,y),V=this.pow(c,y.addn(1).iushrn(1)),q=this.pow(c,y),F=b;q.cmp(M)!==0;){for(var ee=q,ie=0;ee.cmp(M)!==0;ie++)ee=ee.redSqr();r(ie<F);var ce=this.pow(S,new o(1).iushln(F-ie-1));V=V.redMul(ce),S=ce.redSqr(),q=q.redMul(S),F=ie}return V},"sqrt"),z.prototype.invm=i(function(c){var d=c._invmp(this.m);return d.negative!==0?(d.negative=0,this.imod(d).redNeg()):this.imod(d)},"invm"),z.prototype.pow=i(function(c,d){if(d.isZero())return new o(1).toRed(this);if(d.cmpn(1)===0)return c.clone();var h=4,y=new Array(1<<h);y[0]=new o(1).toRed(this),y[1]=c;for(var b=2;b<y.length;b++)y[b]=this.mul(y[b-1],c);var M=y[0],I=0,x=0,u=d.bitLength()%26;for(u===0&&(u=26),b=d.length-1;b>=0;b--){for(var S=d.words[b],V=u-1;V>=0;V--){var q=S>>V&1;if(M!==y[0]&&(M=this.sqr(M)),q===0&&I===0){x=0;continue}I<<=1,I|=q,x++,!(x!==h&&(b!==0||V!==0))&&(M=this.mul(M,y[I]),x=0,I=0)}u=26}return M},"pow"),z.prototype.convertTo=i(function(c){var d=c.umod(this.m);return d===c?d.clone():d},"convertTo"),z.prototype.convertFrom=i(function(c){var d=c.clone();return d.red=null,d},"convertFrom"),o.mont=i(function(c){return new H(c)},"mont");function H(E){z.call(this,E),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new o(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}i(H,"Mont"),n(H,z),H.prototype.convertTo=i(function(c){return this.imod(c.ushln(this.shift))},"convertTo"),H.prototype.convertFrom=i(function(c){var d=this.imod(c.mul(this.rinv));return d.red=null,d},"convertFrom"),H.prototype.imul=i(function(c,d){if(c.isZero()||d.isZero())return c.words[0]=0,c.length=1,c;var h=c.imul(d),y=h.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),b=h.isub(y).iushrn(this.shift),M=b;return b.cmp(this.m)>=0?M=b.isub(this.m):b.cmpn(0)<0&&(M=b.iadd(this.m)),M._forceRed(this)},"imul"),H.prototype.mul=i(function(c,d){if(c.isZero()||d.isZero())return new o(0)._forceRed(this);var h=c.mul(d),y=h.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),b=h.isub(y).iushrn(this.shift),M=b;return b.cmp(this.m)>=0?M=b.isub(this.m):b.cmpn(0)<0&&(M=b.iadd(this.m)),M._forceRed(this)},"mul"),H.prototype.invm=i(function(c){var d=this.imod(c._invmp(this.m).mul(this.r2));return d._forceRed(this)},"invm")})(typeof Fg>"u"||Fg,tA)});var sA=ae((Kse,iA)=>{m();g();var Ro=Gu(),Zr=rA(),Ct=i(function(){},"ABI");function Gd(e){return e.startsWith("int[")?"int256"+e.slice(3):e==="int"?"int256":e.startsWith("uint[")?"uint256"+e.slice(4):e==="uint"?"uint256":e.startsWith("fixed[")?"fixed128x128"+e.slice(5):e==="fixed"?"fixed128x128":e.startsWith("ufixed[")?"ufixed128x128"+e.slice(6):e==="ufixed"?"ufixed128x128":e}i(Gd,"elementaryName");Ct.eventID=function(e,t){var r=e+"("+t.map(Gd).join(",")+")";return Ro.keccak256(Buffer.from(r))};Ct.methodID=function(e,t){return Ct.eventID(e,t).slice(0,4)};function Ss(e){return parseInt(/^\D+(\d+)$/.exec(e)[1],10)}i(Ss,"parseTypeN");function Wg(e){var t=/^\D+(\d+)x(\d+)$/.exec(e);return[parseInt(t[1],10),parseInt(t[2],10)]}i(Wg,"parseTypeNxM");function Ju(e){var t=e.match(/(.*)\[(.*?)\]$/);return t?t[2]===""?"dynamic":parseInt(t[2],10):null}i(Ju,"parseTypeArray");function da(e){var t=typeof e;if(t==="string")return Ro.isHexPrefixed(e)?new Zr(Ro.stripHexPrefix(e),16):new Zr(e,10);if(t==="number")return new Zr(e);if(e.toArray)return e;throw new Error("Argument is not a number")}i(da,"parseNumber");function oA(e){var t=/^(\w+)\((.*)\)$/.exec(e);if(t.length!==3)throw new Error("Invalid method signature");var r=/^(.+)\):\((.+)$/.exec(t[2]);if(r!==null&&r.length===3)return{method:t[1],args:r[1].split(","),retargs:r[2].split(",")};var n=t[2].split(",");return n.length===1&&n[0]===""&&(n=[]),{method:t[1],args:n}}i(oA,"parseSignature");function Ko(e,t){var r,n,o,s;if(e==="address")return Ko("uint160",da(t));if(e==="bool")return Ko("uint8",t?1:0);if(e==="string")return Ko("bytes",Buffer.from(t,"utf8"));if(Yu(e)){if(typeof t.length>"u")throw new Error("Not an array?");if(r=Ju(e),r!=="dynamic"&&r!==0&&t.length>r)throw new Error("Elements exceed array size: "+r);o=[],e=e.slice(0,e.lastIndexOf("[")),typeof t=="string"&&(t=JSON.parse(t));for(s in t)o.push(Ko(e,t[s]));if(r==="dynamic"){var a=Ko("uint256",t.length);o.unshift(a)}return Buffer.concat(o)}else{if(e==="bytes")return t=Buffer.from(t),o=Buffer.concat([Ko("uint256",t.length),t]),t.length%32!==0&&(o=Buffer.concat([o,Ro.zeros(32-t.length%32)])),o;if(e.startsWith("bytes")){if(r=Ss(e),r<1||r>32)throw new Error("Invalid bytes<N> width: "+r);return Ro.setLengthRight(t,32)}else if(e.startsWith("uint")){if(r=Ss(e),r%8||r<8||r>256)throw new Error("Invalid uint<N> width: "+r);if(n=da(t),n.bitLength()>r)throw new Error("Supplied uint exceeds width: "+r+" vs "+n.bitLength());if(n<0)throw new Error("Supplied uint is negative");return n.toArrayLike(Buffer,"be",32)}else if(e.startsWith("int")){if(r=Ss(e),r%8||r<8||r>256)throw new Error("Invalid int<N> width: "+r);if(n=da(t),n.bitLength()>r)throw new Error("Supplied int exceeds width: "+r+" vs "+n.bitLength());return n.toTwos(256).toArrayLike(Buffer,"be",32)}else if(e.startsWith("ufixed")){if(r=Wg(e),n=da(t),n<0)throw new Error("Supplied ufixed is negative");return Ko("uint256",n.mul(new Zr(2).pow(new Zr(r[1]))))}else if(e.startsWith("fixed"))return r=Wg(e),Ko("int256",da(t).mul(new Zr(2).pow(new Zr(r[1]))))}throw new Error("Unsupported or invalid type: "+e)}i(Ko,"encodeSingle");function so(e,t,r){typeof e=="string"&&(e=$g(e));var n,o,s,a;if(e.name==="address")return so(e.rawType,t,r).toArrayLike(Buffer,"be",20).toString("hex");if(e.name==="bool")return so(e.rawType,t,r).toString()===new Zr(1).toString();if(e.name==="string"){var l=so(e.rawType,t,r);return Buffer.from(l,"utf8").toString()}else if(e.isArray){for(s=[],n=e.size,e.size==="dynamic"&&(r=so("uint256",t,r).toNumber(),n=so("uint256",t,r).toNumber(),r=r+32),a=0;a<n;a++){var f=so(e.subArray,t,r);s.push(f),r+=e.subArray.memoryUsage}return s}else{if(e.name==="bytes")return r=so("uint256",t,r).toNumber(),n=so("uint256",t,r).toNumber(),t.slice(r+32,r+32+n);if(e.name.startsWith("bytes"))return t.slice(r,r+e.size);if(e.name.startsWith("uint")){if(o=new Zr(t.slice(r,r+32),16,"be"),o.bitLength()>e.size)throw new Error("Decoded int exceeds width: "+e.size+" vs "+o.bitLength());return o}else if(e.name.startsWith("int")){if(o=new Zr(t.slice(r,r+32),16,"be").fromTwos(256),o.bitLength()>e.size)throw new Error("Decoded uint exceeds width: "+e.size+" vs "+o.bitLength());return o}else if(e.name.startsWith("ufixed")){if(n=new Zr(2).pow(new Zr(e.size[1])),o=so("uint256",t,r),!o.mod(n).isZero())throw new Error("Decimals not supported yet");return o.div(n)}else if(e.name.startsWith("fixed")){if(n=new Zr(2).pow(new Zr(e.size[1])),o=so("int256",t,r),!o.mod(n).isZero())throw new Error("Decimals not supported yet");return o.div(n)}}throw new Error("Unsupported or invalid type: "+e.name)}i(so,"decodeSingle");function $g(e){var t,r;if(Yu(e)){t=Ju(e);var n=e.slice(0,e.lastIndexOf("["));return n=$g(n),r={isArray:!0,name:e,size:t,memoryUsage:t==="dynamic"?32:n.memoryUsage*t,subArray:n},r}else{var o;switch(e){case"address":o="uint160";break;case"bool":o="uint8";break;case"string":o="bytes";break}if(r={rawType:o,name:e,memoryUsage:32},e.startsWith("bytes")&&e!=="bytes"||e.startsWith("uint")||e.startsWith("int")?r.size=Ss(e):(e.startsWith("ufixed")||e.startsWith("fixed"))&&(r.size=Wg(e)),e.startsWith("bytes")&&e!=="bytes"&&(r.size<1||r.size>32))throw new Error("Invalid bytes<N> width: "+r.size);if((e.startsWith("uint")||e.startsWith("int"))&&(r.size%8||r.size<8||r.size>256))throw new Error("Invalid int/uint<N> width: "+r.size);return r}}i($g,"parseType");function ek(e){return e==="string"||e==="bytes"||Ju(e)==="dynamic"}i(ek,"isDynamic");function Yu(e){return e.lastIndexOf("]")===e.length-1}i(Yu,"isArray");Ct.rawEncode=function(e,t){var r=[],n=[],o=0;e.forEach(function(p){if(Yu(p)){var w=Ju(p);w!=="dynamic"?o+=32*w:o+=32}else o+=32});for(var s=0;s<e.length;s++){var a=Gd(e[s]),l=t[s],f=Ko(a,l);ek(a)?(r.push(Ko("uint256",o)),n.push(f),o+=f.length):r.push(f)}return Buffer.concat(r.concat(n))};Ct.rawDecode=function(e,t){var r=[];t=Buffer.from(t);for(var n=0,o=0;o<e.length;o++){var s=Gd(e[o]),a=$g(s,t,n),l=so(a,t,n);n+=a.memoryUsage,r.push(l)}return r};Ct.simpleEncode=function(e){var t=Array.prototype.slice.call(arguments).slice(1),r=oA(e);if(t.length!==r.args.length)throw new Error("Argument count mismatch");return Buffer.concat([Ct.methodID(r.method,r.args),Ct.rawEncode(r.args,t)])};Ct.simpleDecode=function(e,t){var r=oA(e);if(!r.retargs)throw new Error("No return values in method");return Ct.rawDecode(r.retargs,t)};function nA(e,t){return e.startsWith("address")||e.startsWith("bytes")?"0x"+t.toString("hex"):t.toString()}i(nA,"stringify");Ct.stringify=function(e,t){var r=[];for(var n in e){var o=e[n],s=t[n];/^[^\[]+\[.*\]$/.test(o)?s=s.map(function(a){return nA(o,a)}).join(", "):s=nA(o,s),r.push(s)}return r};Ct.solidityHexValue=function(e,t,r){var n,o;if(Yu(e)){var s=e.replace(/\[.*?\]/,"");if(!Yu(s)){var a=Ju(e);if(a!=="dynamic"&&a!==0&&t.length>a)throw new Error("Elements exceed array size: "+a)}var l=t.map(function(w){return Ct.solidityHexValue(s,w,256)});return Buffer.concat(l)}else{if(e==="bytes")return t;if(e==="string")return Buffer.from(t,"utf8");if(e==="bool"){r=r||8;var f=Array(r/4).join("0");return Buffer.from(t?f+"1":f+"0","hex")}else if(e==="address"){var p=20;return r&&(p=r/8),Ro.setLengthLeft(t,p)}else if(e.startsWith("bytes")){if(n=Ss(e),n<1||n>32)throw new Error("Invalid bytes<N> width: "+n);return Ro.setLengthRight(t,n)}else if(e.startsWith("uint")){if(n=Ss(e),n%8||n<8||n>256)throw new Error("Invalid uint<N> width: "+n);if(o=da(t),o.bitLength()>n)throw new Error("Supplied uint exceeds width: "+n+" vs "+o.bitLength());return r=r||n,o.toArrayLike(Buffer,"be",r/8)}else if(e.startsWith("int")){if(n=Ss(e),n%8||n<8||n>256)throw new Error("Invalid int<N> width: "+n);if(o=da(t),o.bitLength()>n)throw new Error("Supplied int exceeds width: "+n+" vs "+o.bitLength());return r=r||n,o.toTwos(n).toArrayLike(Buffer,"be",r/8)}else throw new Error("Unsupported or invalid type: "+e)}};Ct.solidityPack=function(e,t){if(e.length!==t.length)throw new Error("Number of types are not matching the values");for(var r=[],n=0;n<e.length;n++){var o=Gd(e[n]),s=t[n];r.push(Ct.solidityHexValue(o,s,null))}return Buffer.concat(r)};Ct.soliditySHA3=function(e,t){return Ro.keccak256(Ct.solidityPack(e,t))};Ct.soliditySHA256=function(e,t){return Ro.sha256(Ct.solidityPack(e,t))};Ct.solidityRIPEMD160=function(e,t){return Ro.ripemd160(Ct.solidityPack(e,t),!0)};function tk(e){return e>="0"&&e<="9"}i(tk,"isNumeric");Ct.fromSerpent=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];if(n==="s")t.push("bytes");else if(n==="b"){for(var o="bytes",s=r+1;s<e.length&&tk(e[s]);)o+=e[s]-"0",s++;r=s-1,t.push(o)}else if(n==="i")t.push("int256");else if(n==="a")t.push("int256[]");else throw new Error("Unsupported or invalid type: "+n)}return t};Ct.toSerpent=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];if(n==="bytes")t.push("s");else if(n.startsWith("bytes"))t.push("b"+Ss(n));else if(n==="int256")t.push("i");else if(n==="int256[]")t.push("a");else throw new Error("Unsupported or invalid type: "+n)}return t.join("")};iA.exports=Ct});var cA=ae((Lse,aA)=>{m();g();aA.exports=sA()});var hA=ae(ar=>{"use strict";m();g();Object.defineProperty(ar,"__esModule",{value:!0});ar.recoverTypedSignature=ar.signTypedData=ar.typedSignatureHash=ar.TypedDataUtils=ar.TYPED_MESSAGE_SCHEMA=ar.SignTypedDataVersion=void 0;var In=Gu(),Xu=cA(),ha=Zu(),Cr;(function(e){e.V1="V1",e.V3="V3",e.V4="V4"})(Cr=ar.SignTypedDataVersion||(ar.SignTypedDataVersion={}));ar.TYPED_MESSAGE_SCHEMA={type:"object",properties:{types:{type:"object",additionalProperties:{type:"array",items:{type:"object",properties:{name:{type:"string"},type:{type:"string"}},required:["name","type"]}}},primaryType:{type:"string"},domain:{type:"object"},message:{type:"object"}},required:["types","primaryType","domain","message"]};function Cc(e,t){if(Object.keys(Cr).includes(e)){if(t&&!t.includes(e))throw new Error(`SignTypedDataVersion not allowed: '${e}'. Allowed versions are: ${t.join(", ")}`)}else throw new Error(`Invalid version: '${e}'`)}i(Cc,"validateVersion");function uA(e,t,r,n,o){if(Cc(o,[Cr.V3,Cr.V4]),e[r]!==void 0)return["bytes32",o===Cr.V4&&n==null?"0x0000000000000000000000000000000000000000000000000000000000000000":In.keccak(Zg(r,n,e,o))];if(n===void 0)throw new Error(`missing value for field ${t} of type ${r}`);if(r==="bytes")return["bytes32",In.keccak(n)];if(r==="string")return typeof n=="string"&&(n=Buffer.from(n,"utf8")),["bytes32",In.keccak(n)];if(r.lastIndexOf("]")===r.length-1){if(o===Cr.V3)throw new Error("Arrays are unimplemented in encodeData; use V4 extension");let s=r.slice(0,r.lastIndexOf("[")),a=n.map(l=>uA(e,t,s,l,o));return["bytes32",In.keccak(Xu.rawEncode(a.map(([l])=>l),a.map(([,l])=>l)))]}return[r,n]}i(uA,"encodeField");function Zg(e,t,r,n){Cc(n,[Cr.V3,Cr.V4]);let o=["bytes32"],s=[fA(e,r)];for(let a of r[e]){if(n===Cr.V3&&t[a.name]===void 0)continue;let[l,f]=uA(r,a.name,a.type,t[a.name],n);o.push(l),s.push(f)}return Xu.rawEncode(o,s)}i(Zg,"encodeData");function lA(e,t){let r="",n=Yg(e,t);n.delete(e);let o=[e,...Array.from(n).sort()];for(let s of o){if(!t[s])throw new Error(`No type definition specified: ${s}`);r+=`${s}(${t[s].map(({name:l,type:f})=>`${f} ${l}`).join(",")})`}return r}i(lA,"encodeType");function Yg(e,t,r=new Set){if([e]=e.match(/^\w*/u),r.has(e)||t[e]===void 0)return r;r.add(e);for(let n of t[e])Yg(n.type,t,r);return r}i(Yg,"findTypeDependencies");function Gg(e,t,r,n){return Cc(n,[Cr.V3,Cr.V4]),In.keccak(Zg(e,t,r,n))}i(Gg,"hashStruct");function fA(e,t){return In.keccak(lA(e,t))}i(fA,"hashType");function dA(e){let t={};for(let r in ar.TYPED_MESSAGE_SCHEMA.properties)e[r]&&(t[r]=e[r]);return"types"in t&&(t.types=Object.assign({EIP712Domain:[]},t.types)),t}i(dA,"sanitizeData");function rk(e,t){Cc(t,[Cr.V3,Cr.V4]);let r=dA(e),n=[Buffer.from("1901","hex")];return n.push(Gg("EIP712Domain",r.domain,r.types,t)),r.primaryType!=="EIP712Domain"&&n.push(Gg(r.primaryType,r.message,r.types,t)),In.keccak(Buffer.concat(n))}i(rk,"eip712Hash");ar.TypedDataUtils={encodeData:Zg,encodeType:lA,findTypeDependencies:Yg,hashStruct:Gg,hashType:fA,sanitizeData:dA,eip712Hash:rk};function nk(e){let t=Jg(e);return In.bufferToHex(t)}i(nk,"typedSignatureHash");ar.typedSignatureHash=nk;function Jg(e){let t=new Error("Expect argument to be non-empty array");if(typeof e!="object"||!("length"in e)||!e.length)throw t;let r=e.map(function(s){return s.type!=="bytes"?s.value:ha.legacyToBuffer(s.value)}),n=e.map(function(s){return s.type}),o=e.map(function(s){if(!s.name)throw t;return`${s.type} ${s.name}`});return Xu.soliditySHA3(["bytes32","bytes32"],[Xu.soliditySHA3(new Array(e.length).fill("string"),o),Xu.soliditySHA3(n,r)])}i(Jg,"_typedSignatureHash");function ok({privateKey:e,data:t,version:r}){if(Cc(r),ha.isNullish(t))throw new Error("Missing data parameter");if(ha.isNullish(e))throw new Error("Missing private key parameter");let n=r===Cr.V1?Jg(t):ar.TypedDataUtils.eip712Hash(t,r),o=In.ecsign(n,e);return ha.concatSig(In.toBuffer(o.v),o.r,o.s)}i(ok,"signTypedData");ar.signTypedData=ok;function ik({data:e,signature:t,version:r}){if(Cc(r),ha.isNullish(e))throw new Error("Missing data parameter");if(ha.isNullish(t))throw new Error("Missing signature parameter");let n=r===Cr.V1?Jg(e):ar.TypedDataUtils.eip712Hash(e,r),o=ha.recoverPublicKey(n,t),s=In.publicToAddress(o);return In.bufferToHex(s)}i(ik,"recoverTypedSignature");ar.recoverTypedSignature=ik});var mA=ae((pA,Zd)=>{m();g();(function(e,t){"use strict";typeof Zd<"u"&&Zd.exports?Zd.exports=t():(e.nacl||(e.nacl={}),e.nacl.util=t())})(pA,function(){"use strict";var e={};function t(r){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(r))throw new TypeError("invalid encoding")}return i(t,"validateBase64"),e.decodeUTF8=function(r){if(typeof r!="string")throw new TypeError("expected string");var n,o=unescape(encodeURIComponent(r)),s=new Uint8Array(o.length);for(n=0;n<o.length;n++)s[n]=o.charCodeAt(n);return s},e.encodeUTF8=function(r){var n,o=[];for(n=0;n<r.length;n++)o.push(String.fromCharCode(r[n]));return decodeURIComponent(escape(o.join("")))},typeof atob>"u"?typeof Buffer.from<"u"?(e.encodeBase64=function(r){return Buffer.from(r).toString("base64")},e.decodeBase64=function(r){return t(r),new Uint8Array(Array.prototype.slice.call(Buffer.from(r,"base64"),0))}):(e.encodeBase64=function(r){return new Buffer(r).toString("base64")},e.decodeBase64=function(r){return t(r),new Uint8Array(Array.prototype.slice.call(new Buffer(r,"base64"),0))}):(e.encodeBase64=function(r){var n,o=[],s=r.length;for(n=0;n<s;n++)o.push(String.fromCharCode(r[n]));return btoa(o.join(""))},e.decodeBase64=function(r){t(r);var n,o=atob(r),s=new Uint8Array(o.length);for(n=0;n<o.length;n++)s[n]=o.charCodeAt(n);return s}),e})});var wA=ae(cr=>{"use strict";m();g();var sk=cr&&cr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:i(function(){return t[r]},"get")})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),ak=cr&&cr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),gA=cr&&cr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&sk(t,e,r);return ak(t,e),t};Object.defineProperty(cr,"__esModule",{value:!0});cr.getEncryptionPublicKey=cr.decryptSafely=cr.decrypt=cr.encryptSafely=cr.encrypt=void 0;var pa=gA(es()),ao=gA(mA()),Uo=Zu();function yA({publicKey:e,data:t,version:r}){if(Uo.isNullish(e))throw new Error("Missing publicKey parameter");if(Uo.isNullish(t))throw new Error("Missing data parameter");if(Uo.isNullish(r))throw new Error("Missing version parameter");switch(r){case"x25519-xsalsa20-poly1305":{if(typeof t!="string")throw new Error("Message data must be given as a string");let n=pa.box.keyPair(),o;try{o=ao.decodeBase64(e)}catch{throw new Error("Bad public key")}let s=ao.decodeUTF8(t),a=pa.randomBytes(pa.box.nonceLength),l=pa.box(s,a,o,n.secretKey);return{version:"x25519-xsalsa20-poly1305",nonce:ao.encodeBase64(a),ephemPublicKey:ao.encodeBase64(n.publicKey),ciphertext:ao.encodeBase64(l)}}default:throw new Error("Encryption type/version not supported")}}i(yA,"encrypt");cr.encrypt=yA;function ck({publicKey:e,data:t,version:r}){if(Uo.isNullish(e))throw new Error("Missing publicKey parameter");if(Uo.isNullish(t))throw new Error("Missing data parameter");if(Uo.isNullish(r))throw new Error("Missing version parameter");let n=2**11,o=16;if(typeof t=="object"&&"toJSON"in t)throw new Error("Cannot encrypt with toJSON property.  Please remove toJSON property");let s={data:t,padding:""},l=Buffer.byteLength(JSON.stringify(s),"utf-8")%n,f=0;l>0&&(f=n-l-o),s.padding="0".repeat(f);let p=JSON.stringify(s);return yA({publicKey:e,data:p,version:r})}i(ck,"encryptSafely");cr.encryptSafely=ck;function bA({encryptedData:e,privateKey:t}){if(Uo.isNullish(e))throw new Error("Missing encryptedData parameter");if(Uo.isNullish(t))throw new Error("Missing privateKey parameter");switch(e.version){case"x25519-xsalsa20-poly1305":{let r=vA(t),n=pa.box.keyPair.fromSecretKey(r).secretKey,o=ao.decodeBase64(e.nonce),s=ao.decodeBase64(e.ciphertext),a=ao.decodeBase64(e.ephemPublicKey),l=pa.box.open(s,o,a,n),f;try{f=ao.encodeUTF8(l)}catch{throw new Error("Decryption failed.")}if(f)return f;throw new Error("Decryption failed.")}default:throw new Error("Encryption type/version not supported.")}}i(bA,"decrypt");cr.decrypt=bA;function uk({encryptedData:e,privateKey:t}){if(Uo.isNullish(e))throw new Error("Missing encryptedData parameter");if(Uo.isNullish(t))throw new Error("Missing privateKey parameter");return JSON.parse(bA({encryptedData:e,privateKey:t})).data}i(uk,"decryptSafely");cr.decryptSafely=uk;function lk(e){let t=vA(e),r=pa.box.keyPair.fromSecretKey(t).publicKey;return ao.encodeBase64(r)}i(lk,"getEncryptionPublicKey");cr.getEncryptionPublicKey=lk;function vA(e){let t=Buffer.from(e,"hex").toString("base64");return ao.decodeBase64(t)}i(vA,"nacl_decodeHex")});var SA=ae(sn=>{"use strict";m();g();var fk=sn&&sn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:i(function(){return t[r]},"get")})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Xg=sn&&sn.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&fk(t,e,r)};Object.defineProperty(sn,"__esModule",{value:!0});sn.normalize=sn.concatSig=void 0;Xg(eA(),sn);Xg(hA(),sn);Xg(wA(),sn);var xA=Zu();Object.defineProperty(sn,"concatSig",{enumerable:!0,get:i(function(){return xA.concatSig},"get")});Object.defineProperty(sn,"normalize",{enumerable:!0,get:i(function(){return xA.normalize},"get")})});var un=ae(lt=>{"use strict";m();g();Object.defineProperty(lt,"__esModule",{value:!0});lt.wrapCipher=lt.Hash=lt.nextTick=lt.isLE=void 0;lt.isBytes=Wy;lt.abool=KE;lt.anumber=jy;lt.abytes=ho;lt.ahash=lP;lt.aexists=fP;lt.aoutput=dP;lt.u8=hP;lt.u32=pP;lt.clean=mP;lt.createView=RE;lt.bytesToHex=NE;lt.hexToBytes=LE;lt.hexToNumber=DE;lt.bytesToNumberBE=yP;lt.numberToBytesBE=bP;lt.utf8ToBytes=VE;lt.bytesToUtf8=wP;lt.toBytes=xP;lt.overlapBytes=qE;lt.complexOverlapBytes=SP;lt.concatBytes=AP;lt.checkOpts=EP;lt.equalBytes=_P;lt.getOutput=IP;lt.setBigUint64=Fy;lt.u64Lengths=TP;lt.isAligned32=HE;lt.copyBytes=jE;function Wy(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}i(Wy,"isBytes");function KE(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}i(KE,"abool");function jy(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}i(jy,"anumber");function ho(e,...t){if(!Wy(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}i(ho,"abytes");function lP(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");jy(e.outputLen),jy(e.blockLen)}i(lP,"ahash");function fP(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}i(fP,"aexists");function dP(e,t){ho(e);let r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}i(dP,"aoutput");function hP(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}i(hP,"u8");function pP(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}i(pP,"u32");function mP(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}i(mP,"clean");function RE(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}i(RE,"createView");lt.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;var UE=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",gP=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function NE(e){if(ho(e),UE)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=gP[e[r]];return t}i(NE,"bytesToHex");var qi={_0:48,_9:57,A:65,F:70,a:97,f:102};function OE(e){if(e>=qi._0&&e<=qi._9)return e-qi._0;if(e>=qi.A&&e<=qi.F)return e-(qi.A-10);if(e>=qi.a&&e<=qi.f)return e-(qi.a-10)}i(OE,"asciiToBase16");function LE(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(UE)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(r);for(let o=0,s=0;o<r;o++,s+=2){let a=OE(e.charCodeAt(s)),l=OE(e.charCodeAt(s+1));if(a===void 0||l===void 0){let f=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+s)}n[o]=a*16+l}return n}i(LE,"hexToBytes");function DE(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":"0x"+e)}i(DE,"hexToNumber");function yP(e){return DE(NE(e))}i(yP,"bytesToNumberBE");function bP(e,t){return LE(e.toString(16).padStart(t*2,"0"))}i(bP,"numberToBytesBE");var vP=i(async()=>{},"nextTick");lt.nextTick=vP;function VE(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}i(VE,"utf8ToBytes");function wP(e){return new TextDecoder().decode(e)}i(wP,"bytesToUtf8");function xP(e){if(typeof e=="string")e=VE(e);else if(Wy(e))e=jE(e);else throw new Error("Uint8Array expected, got "+typeof e);return e}i(xP,"toBytes");function qE(e,t){return e.buffer===t.buffer&&e.byteOffset<t.byteOffset+t.byteLength&&t.byteOffset<e.byteOffset+e.byteLength}i(qE,"overlapBytes");function SP(e,t){if(qE(e,t)&&e.byteOffset<t.byteOffset)throw new Error("complex overlap of input and output is not supported")}i(SP,"complexOverlapBytes");function AP(...e){let t=0;for(let n=0;n<e.length;n++){let o=e[n];ho(o),t+=o.length}let r=new Uint8Array(t);for(let n=0,o=0;n<e.length;n++){let s=e[n];r.set(s,o),o+=s.length}return r}i(AP,"concatBytes");function EP(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}i(EP,"checkOpts");function _P(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return r===0}i(_P,"equalBytes");var zy=class{static{i(this,"Hash")}};lt.Hash=zy;var MP=i((e,t)=>{function r(n,...o){if(ho(n),!lt.isLE)throw new Error("Non little-endian hardware is not yet supported");if(e.nonceLength!==void 0){let w=o[0];if(!w)throw new Error("nonce / iv required");e.varSizeNonce?ho(w):ho(w,e.nonceLength)}let s=e.tagLength;s&&o[1]!==void 0&&ho(o[1]);let a=t(n,...o),l=i((w,A)=>{if(A!==void 0){if(w!==2)throw new Error("cipher output not supported");ho(A)}},"checkOutput"),f=!1;return{encrypt(w,A){if(f)throw new Error("cannot encrypt() twice with same key + nonce");return f=!0,ho(w),l(a.encrypt.length,A),a.encrypt(w,A)},decrypt(w,A){if(ho(w),s&&w.length<s)throw new Error("invalid ciphertext length: smaller than tagLength="+s);return l(a.decrypt.length,A),a.decrypt(w,A)}}}return i(r,"wrappedCipher"),Object.assign(r,e),r},"wrapCipher");lt.wrapCipher=MP;function IP(e,t,r=!0){if(t===void 0)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(r&&!HE(t))throw new Error("invalid output, must be aligned");return t}i(IP,"getOutput");function Fy(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let o=BigInt(32),s=BigInt(4294967295),a=Number(r>>o&s),l=Number(r&s),f=n?4:0,p=n?0:4;e.setUint32(t+f,a,n),e.setUint32(t+p,l,n)}i(Fy,"setBigUint64");function TP(e,t,r){KE(r);let n=new Uint8Array(16),o=RE(n);return Fy(o,0,BigInt(t),r),Fy(o,8,BigInt(e),r),n}i(TP,"u64Lengths");function HE(e){return e.byteOffset%4===0}i(HE,"isAligned32");function jE(e){return Uint8Array.from(e)}i(jE,"copyBytes")});var _h=ae(_r=>{"use strict";m();g();Object.defineProperty(_r,"__esModule",{value:!0});_r.AEAD_TAG_LENGTH=_r.XCHACHA20_NONCE_LENGTH=_r.CURVE25519_PUBLIC_KEY_SIZE=_r.ETH_PUBLIC_KEY_SIZE=_r.UNCOMPRESSED_PUBLIC_KEY_SIZE=_r.COMPRESSED_PUBLIC_KEY_SIZE=_r.SECRET_KEY_LENGTH=void 0;_r.SECRET_KEY_LENGTH=32;_r.COMPRESSED_PUBLIC_KEY_SIZE=33;_r.UNCOMPRESSED_PUBLIC_KEY_SIZE=65;_r.ETH_PUBLIC_KEY_SIZE=64;_r.CURVE25519_PUBLIC_KEY_SIZE=32;_r.XCHACHA20_NONCE_LENGTH=24;_r.AEAD_TAG_LENGTH=16});var ul=ae(Ot=>{"use strict";m();g();Object.defineProperty(Ot,"__esModule",{value:!0});Ot.ephemeralKeySize=Ot.symmetricNonceLength=Ot.symmetricAlgorithm=Ot.isHkdfKeyCompressed=Ot.isEphemeralKeyCompressed=Ot.ellipticCurve=Ot.ECIES_CONFIG=void 0;var Mh=_h(),BP=function(){function e(){this.ellipticCurve="secp256k1",this.isEphemeralKeyCompressed=!1,this.isHkdfKeyCompressed=!1,this.symmetricAlgorithm="aes-256-gcm",this.symmetricNonceLength=16}return i(e,"Config"),e}();Ot.ECIES_CONFIG=new BP;var kP=i(function(){return Ot.ECIES_CONFIG.ellipticCurve},"ellipticCurve");Ot.ellipticCurve=kP;var PP=i(function(){return Ot.ECIES_CONFIG.isEphemeralKeyCompressed},"isEphemeralKeyCompressed");Ot.isEphemeralKeyCompressed=PP;var CP=i(function(){return Ot.ECIES_CONFIG.isHkdfKeyCompressed},"isHkdfKeyCompressed");Ot.isHkdfKeyCompressed=CP;var OP=i(function(){return Ot.ECIES_CONFIG.symmetricAlgorithm},"symmetricAlgorithm");Ot.symmetricAlgorithm=OP;var KP=i(function(){return Ot.ECIES_CONFIG.symmetricNonceLength},"symmetricNonceLength");Ot.symmetricNonceLength=KP;var RP=i(function(){var e={secp256k1:Ot.ECIES_CONFIG.isEphemeralKeyCompressed?Mh.COMPRESSED_PUBLIC_KEY_SIZE:Mh.UNCOMPRESSED_PUBLIC_KEY_SIZE,x25519:Mh.CURVE25519_PUBLIC_KEY_SIZE,ed25519:Mh.CURVE25519_PUBLIC_KEY_SIZE};if(Ot.ECIES_CONFIG.ellipticCurve in e)return e[Ot.ECIES_CONFIG.ellipticCurve];throw new Error("Not implemented")},"ephemeralKeySize");Ot.ephemeralKeySize=RP});var zE=ae(Ih=>{"use strict";m();g();Object.defineProperty(Ih,"__esModule",{value:!0});Ih.crypto=void 0;Ih.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var Zy=ae(Or=>{"use strict";m();g();Object.defineProperty(Or,"__esModule",{value:!0});Or.gcm=Or.ctr=Or.cbc=Or.utils=void 0;Or.randomBytes=FE;Or.getWebcryptoSubtle=$y;Or.managedNonce=UP;var zo=zE(),Lc=un();function FE(e=32){if(zo.crypto&&typeof zo.crypto.getRandomValues=="function")return zo.crypto.getRandomValues(new Uint8Array(e));if(zo.crypto&&typeof zo.crypto.randomBytes=="function")return Uint8Array.from(zo.crypto.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}i(FE,"randomBytes");function $y(){if(zo.crypto&&typeof zo.crypto.subtle=="object"&&zo.crypto.subtle!=null)return zo.crypto.subtle;throw new Error("crypto.subtle must be defined")}i($y,"getWebcryptoSubtle");function UP(e){let{nonceLength:t}=e;return(0,Lc.anumber)(t),(r,...n)=>({encrypt(o,...s){let a=FE(t),l=e(r,a,...n).encrypt(o,...s),f=(0,Lc.concatBytes)(a,l);return l.fill(0),f},decrypt(o,...s){let a=o.subarray(0,t),l=o.subarray(t);return e(r,a,...n).decrypt(l,...s)}})}i(UP,"managedNonce");Or.utils={async encrypt(e,t,r,n){let o=$y(),s=await o.importKey("raw",e,t,!0,["encrypt"]),a=await o.encrypt(r,s,n);return new Uint8Array(a)},async decrypt(e,t,r,n){let o=$y(),s=await o.importKey("raw",e,t,!0,["decrypt"]),a=await o.decrypt(r,s,n);return new Uint8Array(a)}};var jo={CBC:"AES-CBC",CTR:"AES-CTR",GCM:"AES-GCM"};function NP(e,t,r){if(e===jo.CBC)return{name:jo.CBC,iv:t};if(e===jo.CTR)return{name:jo.CTR,counter:t,length:64};if(e===jo.GCM)return r?{name:jo.GCM,iv:t,additionalData:r}:{name:jo.GCM,iv:t};throw new Error("unknown aes block mode")}i(NP,"getCryptParams");function Gy(e){return(t,r,n)=>{(0,Lc.abytes)(t),(0,Lc.abytes)(r);let o={name:e,length:t.length*8},s=NP(e,r,n),a=!1;return{encrypt(l){if((0,Lc.abytes)(l),a)throw new Error("Cannot encrypt() twice with same key / nonce");return a=!0,Or.utils.encrypt(t,o,s,l)},decrypt(l){return(0,Lc.abytes)(l),Or.utils.decrypt(t,o,s,l)}}}}i(Gy,"generate");Or.cbc=Gy(jo.CBC);Or.ctr=Gy(jo.CTR);Or.gcm=Gy(jo.GCM)});var WE=ae(Th=>{"use strict";m();g();Object.defineProperty(Th,"__esModule",{value:!0});Th.crypto=void 0;Th.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var Fo=ae(_e=>{"use strict";m();g();Object.defineProperty(_e,"__esModule",{value:!0});_e.wrapXOFConstructorWithOpts=_e.wrapConstructorWithOpts=_e.wrapConstructor=_e.Hash=_e.nextTick=_e.swap32IfBE=_e.byteSwapIfBE=_e.swap8IfBE=_e.isLE=void 0;_e.isBytes=GE;_e.anumber=Yy;_e.abytes=Vc;_e.ahash=LP;_e.aexists=DP;_e.aoutput=VP;_e.u8=qP;_e.u32=HP;_e.clean=jP;_e.createView=zP;_e.rotr=FP;_e.rotl=WP;_e.byteSwap=Xy;_e.byteSwap32=ZE;_e.bytesToHex=GP;_e.hexToBytes=ZP;_e.asyncLoop=JP;_e.utf8ToBytes=Qy;_e.bytesToUtf8=XP;_e.toBytes=Bh;_e.kdfInputToBytes=QP;_e.concatBytes=eC;_e.checkOpts=tC;_e.createHasher=JE;_e.createOptHasher=XE;_e.createXOFer=QE;_e.randomBytes=rC;var Dc=WE();function GE(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}i(GE,"isBytes");function Yy(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}i(Yy,"anumber");function Vc(e,...t){if(!GE(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}i(Vc,"abytes");function LP(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Yy(e.outputLen),Yy(e.blockLen)}i(LP,"ahash");function DP(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}i(DP,"aexists");function VP(e,t){Vc(e);let r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}i(VP,"aoutput");function qP(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}i(qP,"u8");function HP(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}i(HP,"u32");function jP(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}i(jP,"clean");function zP(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}i(zP,"createView");function FP(e,t){return e<<32-t|e>>>t}i(FP,"rotr");function WP(e,t){return e<<t|e>>>32-t>>>0}i(WP,"rotl");_e.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Xy(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}i(Xy,"byteSwap");_e.swap8IfBE=_e.isLE?e=>e:e=>Xy(e);_e.byteSwapIfBE=_e.swap8IfBE;function ZE(e){for(let t=0;t<e.length;t++)e[t]=Xy(e[t]);return e}i(ZE,"byteSwap32");_e.swap32IfBE=_e.isLE?e=>e:ZE;var YE=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",$P=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function GP(e){if(Vc(e),YE)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=$P[e[r]];return t}i(GP,"bytesToHex");var Hi={_0:48,_9:57,A:65,F:70,a:97,f:102};function $E(e){if(e>=Hi._0&&e<=Hi._9)return e-Hi._0;if(e>=Hi.A&&e<=Hi.F)return e-(Hi.A-10);if(e>=Hi.a&&e<=Hi.f)return e-(Hi.a-10)}i($E,"asciiToBase16");function ZP(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(YE)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(r);for(let o=0,s=0;o<r;o++,s+=2){let a=$E(e.charCodeAt(s)),l=$E(e.charCodeAt(s+1));if(a===void 0||l===void 0){let f=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+s)}n[o]=a*16+l}return n}i(ZP,"hexToBytes");var YP=i(async()=>{},"nextTick");_e.nextTick=YP;async function JP(e,t,r){let n=Date.now();for(let o=0;o<e;o++){r(o);let s=Date.now()-n;s>=0&&s<t||(await(0,_e.nextTick)(),n+=s)}}i(JP,"asyncLoop");function Qy(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}i(Qy,"utf8ToBytes");function XP(e){return new TextDecoder().decode(e)}i(XP,"bytesToUtf8");function Bh(e){return typeof e=="string"&&(e=Qy(e)),Vc(e),e}i(Bh,"toBytes");function QP(e){return typeof e=="string"&&(e=Qy(e)),Vc(e),e}i(QP,"kdfInputToBytes");function eC(...e){let t=0;for(let n=0;n<e.length;n++){let o=e[n];Vc(o),t+=o.length}let r=new Uint8Array(t);for(let n=0,o=0;n<e.length;n++){let s=e[n];r.set(s,o),o+=s.length}return r}i(eC,"concatBytes");function tC(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("options should be object or undefined");return Object.assign(e,t)}i(tC,"checkOpts");var Jy=class{static{i(this,"Hash")}};_e.Hash=Jy;function JE(e){let t=i(n=>e().update(Bh(n)).digest(),"hashC"),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}i(JE,"createHasher");function XE(e){let t=i((n,o)=>e(o).update(Bh(n)).digest(),"hashC"),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}i(XE,"createOptHasher");function QE(e){let t=i((n,o)=>e(o).update(Bh(n)).digest(),"hashC"),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}i(QE,"createXOFer");_e.wrapConstructor=JE;_e.wrapConstructorWithOpts=XE;_e.wrapXOFConstructorWithOpts=QE;function rC(e=32){if(Dc.crypto&&typeof Dc.crypto.getRandomValues=="function")return Dc.crypto.getRandomValues(new Uint8Array(e));if(Dc.crypto&&typeof Dc.crypto.randomBytes=="function")return Uint8Array.from(Dc.crypto.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}i(rC,"randomBytes")});var t_=ae(Kr=>{"use strict";m();g();Object.defineProperty(Kr,"__esModule",{value:!0});Kr.SHA512_IV=Kr.SHA384_IV=Kr.SHA224_IV=Kr.SHA256_IV=Kr.HashMD=void 0;Kr.setBigUint64=e_;Kr.Chi=nC;Kr.Maj=oC;var Wo=Fo();function e_(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let o=BigInt(32),s=BigInt(4294967295),a=Number(r>>o&s),l=Number(r&s),f=n?4:0,p=n?0:4;e.setUint32(t+f,a,n),e.setUint32(t+p,l,n)}i(e_,"setBigUint64");function nC(e,t,r){return e&t^~e&r}i(nC,"Chi");function oC(e,t,r){return e&t^e&r^t&r}i(oC,"Maj");var eb=class extends Wo.Hash{static{i(this,"HashMD")}constructor(t,r,n,o){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.buffer=new Uint8Array(t),this.view=(0,Wo.createView)(this.buffer)}update(t){(0,Wo.aexists)(this),t=(0,Wo.toBytes)(t),(0,Wo.abytes)(t);let{view:r,buffer:n,blockLen:o}=this,s=t.length;for(let a=0;a<s;){let l=Math.min(o-this.pos,s-a);if(l===o){let f=(0,Wo.createView)(t);for(;o<=s-a;a+=o)this.process(f,a);continue}n.set(t.subarray(a,a+l),this.pos),this.pos+=l,a+=l,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,Wo.aexists)(this),(0,Wo.aoutput)(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:o,isLE:s}=this,{pos:a}=this;r[a++]=128,(0,Wo.clean)(this.buffer.subarray(a)),this.padOffset>o-a&&(this.process(n,0),a=0);for(let A=a;A<o;A++)r[A]=0;e_(n,o-8,BigInt(this.length*8),s),this.process(n,0);let l=(0,Wo.createView)(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let p=f/4,w=this.get();if(p>w.length)throw new Error("_sha2: outputLen bigger than state");for(let A=0;A<p;A++)l.setUint32(4*A,w[A],s)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:o,finished:s,destroyed:a,pos:l}=this;return t.destroyed=a,t.finished=s,t.length=o,t.pos=l,o%r&&t.buffer.set(n),t}clone(){return this._cloneInto()}};Kr.HashMD=eb;Kr.SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);Kr.SHA224_IV=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]);Kr.SHA384_IV=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]);Kr.SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209])});var A_=ae(ct=>{"use strict";m();g();Object.defineProperty(ct,"__esModule",{value:!0});ct.toBig=ct.shrSL=ct.shrSH=ct.rotrSL=ct.rotrSH=ct.rotrBL=ct.rotrBH=ct.rotr32L=ct.rotr32H=ct.rotlSL=ct.rotlSH=ct.rotlBL=ct.rotlBH=ct.add5L=ct.add5H=ct.add4L=ct.add4H=ct.add3L=ct.add3H=void 0;ct.add=g_;ct.fromBig=rb;ct.split=r_;var kh=BigInt(2**32-1),tb=BigInt(32);function rb(e,t=!1){return t?{h:Number(e&kh),l:Number(e>>tb&kh)}:{h:Number(e>>tb&kh)|0,l:Number(e&kh)|0}}i(rb,"fromBig");function r_(e,t=!1){let r=e.length,n=new Uint32Array(r),o=new Uint32Array(r);for(let s=0;s<r;s++){let{h:a,l}=rb(e[s],t);[n[s],o[s]]=[a,l]}return[n,o]}i(r_,"split");var n_=i((e,t)=>BigInt(e>>>0)<<tb|BigInt(t>>>0),"toBig");ct.toBig=n_;var o_=i((e,t,r)=>e>>>r,"shrSH");ct.shrSH=o_;var i_=i((e,t,r)=>e<<32-r|t>>>r,"shrSL");ct.shrSL=i_;var s_=i((e,t,r)=>e>>>r|t<<32-r,"rotrSH");ct.rotrSH=s_;var a_=i((e,t,r)=>e<<32-r|t>>>r,"rotrSL");ct.rotrSL=a_;var c_=i((e,t,r)=>e<<64-r|t>>>r-32,"rotrBH");ct.rotrBH=c_;var u_=i((e,t,r)=>e>>>r-32|t<<64-r,"rotrBL");ct.rotrBL=u_;var l_=i((e,t)=>t,"rotr32H");ct.rotr32H=l_;var f_=i((e,t)=>e,"rotr32L");ct.rotr32L=f_;var d_=i((e,t,r)=>e<<r|t>>>32-r,"rotlSH");ct.rotlSH=d_;var h_=i((e,t,r)=>t<<r|e>>>32-r,"rotlSL");ct.rotlSL=h_;var p_=i((e,t,r)=>t<<r-32|e>>>64-r,"rotlBH");ct.rotlBH=p_;var m_=i((e,t,r)=>e<<r-32|t>>>64-r,"rotlBL");ct.rotlBL=m_;function g_(e,t,r,n){let o=(t>>>0)+(n>>>0);return{h:e+r+(o/2**32|0)|0,l:o|0}}i(g_,"add");var y_=i((e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),"add3L");ct.add3L=y_;var b_=i((e,t,r,n)=>t+r+n+(e/2**32|0)|0,"add3H");ct.add3H=b_;var v_=i((e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),"add4L");ct.add4L=v_;var w_=i((e,t,r,n,o)=>t+r+n+o+(e/2**32|0)|0,"add4H");ct.add4H=w_;var x_=i((e,t,r,n,o)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(o>>>0),"add5L");ct.add5L=x_;var S_=i((e,t,r,n,o,s)=>t+r+n+o+s+(e/2**32|0)|0,"add5H");ct.add5H=S_;var iC={fromBig:rb,split:r_,toBig:n_,shrSH:o_,shrSL:i_,rotrSH:s_,rotrSL:a_,rotrBH:c_,rotrBL:u_,rotr32H:l_,rotr32L:f_,rotlSH:d_,rotlSL:h_,rotlBH:p_,rotlBL:m_,add:g_,add3L:y_,add3H:b_,add4L:v_,add4H:w_,add5H:S_,add5L:x_};ct.default=iC});var Rh=ae(_t=>{"use strict";m();g();Object.defineProperty(_t,"__esModule",{value:!0});_t.sha512_224=_t.sha512_256=_t.sha384=_t.sha512=_t.sha224=_t.sha256=_t.SHA512_256=_t.SHA512_224=_t.SHA384=_t.SHA512=_t.SHA224=_t.SHA256=void 0;var Ee=t_(),ft=A_(),Gt=Fo(),sC=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Bs=new Uint32Array(64),ll=class extends Ee.HashMD{static{i(this,"SHA256")}constructor(t=32){super(64,t,8,!1),this.A=Ee.SHA256_IV[0]|0,this.B=Ee.SHA256_IV[1]|0,this.C=Ee.SHA256_IV[2]|0,this.D=Ee.SHA256_IV[3]|0,this.E=Ee.SHA256_IV[4]|0,this.F=Ee.SHA256_IV[5]|0,this.G=Ee.SHA256_IV[6]|0,this.H=Ee.SHA256_IV[7]|0}get(){let{A:t,B:r,C:n,D:o,E:s,F:a,G:l,H:f}=this;return[t,r,n,o,s,a,l,f]}set(t,r,n,o,s,a,l,f){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=s|0,this.F=a|0,this.G=l|0,this.H=f|0}process(t,r){for(let A=0;A<16;A++,r+=4)Bs[A]=t.getUint32(r,!1);for(let A=16;A<64;A++){let _=Bs[A-15],T=Bs[A-2],B=(0,Gt.rotr)(_,7)^(0,Gt.rotr)(_,18)^_>>>3,P=(0,Gt.rotr)(T,17)^(0,Gt.rotr)(T,19)^T>>>10;Bs[A]=P+Bs[A-7]+B+Bs[A-16]|0}let{A:n,B:o,C:s,D:a,E:l,F:f,G:p,H:w}=this;for(let A=0;A<64;A++){let _=(0,Gt.rotr)(l,6)^(0,Gt.rotr)(l,11)^(0,Gt.rotr)(l,25),T=w+_+(0,Ee.Chi)(l,f,p)+sC[A]+Bs[A]|0,P=((0,Gt.rotr)(n,2)^(0,Gt.rotr)(n,13)^(0,Gt.rotr)(n,22))+(0,Ee.Maj)(n,o,s)|0;w=p,p=f,f=l,l=a+T|0,a=s,s=o,o=n,n=T+P|0}n=n+this.A|0,o=o+this.B|0,s=s+this.C|0,a=a+this.D|0,l=l+this.E|0,f=f+this.F|0,p=p+this.G|0,w=w+this.H|0,this.set(n,o,s,a,l,f,p,w)}roundClean(){(0,Gt.clean)(Bs)}destroy(){this.set(0,0,0,0,0,0,0,0),(0,Gt.clean)(this.buffer)}};_t.SHA256=ll;var Ph=class extends ll{static{i(this,"SHA224")}constructor(){super(28),this.A=Ee.SHA224_IV[0]|0,this.B=Ee.SHA224_IV[1]|0,this.C=Ee.SHA224_IV[2]|0,this.D=Ee.SHA224_IV[3]|0,this.E=Ee.SHA224_IV[4]|0,this.F=Ee.SHA224_IV[5]|0,this.G=Ee.SHA224_IV[6]|0,this.H=Ee.SHA224_IV[7]|0}};_t.SHA224=Ph;var E_=ft.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),aC=E_[0],cC=E_[1],ks=new Uint32Array(80),Ps=new Uint32Array(80),xa=class extends Ee.HashMD{static{i(this,"SHA512")}constructor(t=64){super(128,t,16,!1),this.Ah=Ee.SHA512_IV[0]|0,this.Al=Ee.SHA512_IV[1]|0,this.Bh=Ee.SHA512_IV[2]|0,this.Bl=Ee.SHA512_IV[3]|0,this.Ch=Ee.SHA512_IV[4]|0,this.Cl=Ee.SHA512_IV[5]|0,this.Dh=Ee.SHA512_IV[6]|0,this.Dl=Ee.SHA512_IV[7]|0,this.Eh=Ee.SHA512_IV[8]|0,this.El=Ee.SHA512_IV[9]|0,this.Fh=Ee.SHA512_IV[10]|0,this.Fl=Ee.SHA512_IV[11]|0,this.Gh=Ee.SHA512_IV[12]|0,this.Gl=Ee.SHA512_IV[13]|0,this.Hh=Ee.SHA512_IV[14]|0,this.Hl=Ee.SHA512_IV[15]|0}get(){let{Ah:t,Al:r,Bh:n,Bl:o,Ch:s,Cl:a,Dh:l,Dl:f,Eh:p,El:w,Fh:A,Fl:_,Gh:T,Gl:B,Hh:P,Hl:C}=this;return[t,r,n,o,s,a,l,f,p,w,A,_,T,B,P,C]}set(t,r,n,o,s,a,l,f,p,w,A,_,T,B,P,C){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=o|0,this.Ch=s|0,this.Cl=a|0,this.Dh=l|0,this.Dl=f|0,this.Eh=p|0,this.El=w|0,this.Fh=A|0,this.Fl=_|0,this.Gh=T|0,this.Gl=B|0,this.Hh=P|0,this.Hl=C|0}process(t,r){for(let R=0;R<16;R++,r+=4)ks[R]=t.getUint32(r),Ps[R]=t.getUint32(r+=4);for(let R=16;R<80;R++){let j=ks[R-15]|0,Z=Ps[R-15]|0,X=ft.rotrSH(j,Z,1)^ft.rotrSH(j,Z,8)^ft.shrSH(j,Z,7),Q=ft.rotrSL(j,Z,1)^ft.rotrSL(j,Z,8)^ft.shrSL(j,Z,7),z=ks[R-2]|0,H=Ps[R-2]|0,E=ft.rotrSH(z,H,19)^ft.rotrBH(z,H,61)^ft.shrSH(z,H,6),c=ft.rotrSL(z,H,19)^ft.rotrBL(z,H,61)^ft.shrSL(z,H,6),d=ft.add4L(Q,c,Ps[R-7],Ps[R-16]),h=ft.add4H(d,X,E,ks[R-7],ks[R-16]);ks[R]=h|0,Ps[R]=d|0}let{Ah:n,Al:o,Bh:s,Bl:a,Ch:l,Cl:f,Dh:p,Dl:w,Eh:A,El:_,Fh:T,Fl:B,Gh:P,Gl:C,Hh:O,Hl:L}=this;for(let R=0;R<80;R++){let j=ft.rotrSH(A,_,14)^ft.rotrSH(A,_,18)^ft.rotrBH(A,_,41),Z=ft.rotrSL(A,_,14)^ft.rotrSL(A,_,18)^ft.rotrBL(A,_,41),X=A&T^~A&P,Q=_&B^~_&C,z=ft.add5L(L,Z,Q,cC[R],Ps[R]),H=ft.add5H(z,O,j,X,aC[R],ks[R]),E=z|0,c=ft.rotrSH(n,o,28)^ft.rotrBH(n,o,34)^ft.rotrBH(n,o,39),d=ft.rotrSL(n,o,28)^ft.rotrBL(n,o,34)^ft.rotrBL(n,o,39),h=n&s^n&l^s&l,y=o&a^o&f^a&f;O=P|0,L=C|0,P=T|0,C=B|0,T=A|0,B=_|0,{h:A,l:_}=ft.add(p|0,w|0,H|0,E|0),p=l|0,w=f|0,l=s|0,f=a|0,s=n|0,a=o|0;let b=ft.add3L(E,d,y);n=ft.add3H(b,H,c,h),o=b|0}({h:n,l:o}=ft.add(this.Ah|0,this.Al|0,n|0,o|0)),{h:s,l:a}=ft.add(this.Bh|0,this.Bl|0,s|0,a|0),{h:l,l:f}=ft.add(this.Ch|0,this.Cl|0,l|0,f|0),{h:p,l:w}=ft.add(this.Dh|0,this.Dl|0,p|0,w|0),{h:A,l:_}=ft.add(this.Eh|0,this.El|0,A|0,_|0),{h:T,l:B}=ft.add(this.Fh|0,this.Fl|0,T|0,B|0),{h:P,l:C}=ft.add(this.Gh|0,this.Gl|0,P|0,C|0),{h:O,l:L}=ft.add(this.Hh|0,this.Hl|0,O|0,L|0),this.set(n,o,s,a,l,f,p,w,A,_,T,B,P,C,O,L)}roundClean(){(0,Gt.clean)(ks,Ps)}destroy(){(0,Gt.clean)(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};_t.SHA512=xa;var Ch=class extends xa{static{i(this,"SHA384")}constructor(){super(48),this.Ah=Ee.SHA384_IV[0]|0,this.Al=Ee.SHA384_IV[1]|0,this.Bh=Ee.SHA384_IV[2]|0,this.Bl=Ee.SHA384_IV[3]|0,this.Ch=Ee.SHA384_IV[4]|0,this.Cl=Ee.SHA384_IV[5]|0,this.Dh=Ee.SHA384_IV[6]|0,this.Dl=Ee.SHA384_IV[7]|0,this.Eh=Ee.SHA384_IV[8]|0,this.El=Ee.SHA384_IV[9]|0,this.Fh=Ee.SHA384_IV[10]|0,this.Fl=Ee.SHA384_IV[11]|0,this.Gh=Ee.SHA384_IV[12]|0,this.Gl=Ee.SHA384_IV[13]|0,this.Hh=Ee.SHA384_IV[14]|0,this.Hl=Ee.SHA384_IV[15]|0}};_t.SHA384=Ch;var Mr=Uint32Array.from([2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561]),Ir=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]),Oh=class extends xa{static{i(this,"SHA512_224")}constructor(){super(28),this.Ah=Mr[0]|0,this.Al=Mr[1]|0,this.Bh=Mr[2]|0,this.Bl=Mr[3]|0,this.Ch=Mr[4]|0,this.Cl=Mr[5]|0,this.Dh=Mr[6]|0,this.Dl=Mr[7]|0,this.Eh=Mr[8]|0,this.El=Mr[9]|0,this.Fh=Mr[10]|0,this.Fl=Mr[11]|0,this.Gh=Mr[12]|0,this.Gl=Mr[13]|0,this.Hh=Mr[14]|0,this.Hl=Mr[15]|0}};_t.SHA512_224=Oh;var Kh=class extends xa{static{i(this,"SHA512_256")}constructor(){super(32),this.Ah=Ir[0]|0,this.Al=Ir[1]|0,this.Bh=Ir[2]|0,this.Bl=Ir[3]|0,this.Ch=Ir[4]|0,this.Cl=Ir[5]|0,this.Dh=Ir[6]|0,this.Dl=Ir[7]|0,this.Eh=Ir[8]|0,this.El=Ir[9]|0,this.Fh=Ir[10]|0,this.Fl=Ir[11]|0,this.Gh=Ir[12]|0,this.Gl=Ir[13]|0,this.Hh=Ir[14]|0,this.Hl=Ir[15]|0}};_t.SHA512_256=Kh;_t.sha256=(0,Gt.createHasher)(()=>new ll);_t.sha224=(0,Gt.createHasher)(()=>new Ph);_t.sha512=(0,Gt.createHasher)(()=>new xa);_t.sha384=(0,Gt.createHasher)(()=>new Ch);_t.sha512_256=(0,Gt.createHasher)(()=>new Kh);_t.sha512_224=(0,Gt.createHasher)(()=>new Oh)});var zi=ae(ke=>{"use strict";m();g();Object.defineProperty(ke,"__esModule",{value:!0});ke.notImplemented=ke.bitMask=ke.utf8ToBytes=ke.randomBytes=ke.isBytes=ke.hexToBytes=ke.concatBytes=ke.bytesToUtf8=ke.bytesToHex=ke.anumber=ke.abytes=void 0;ke.abool=uC;ke._abool2=lC;ke._abytes2=fC;ke.numberToHexUnpadded=__;ke.hexToNumber=ob;ke.bytesToNumberBE=dC;ke.bytesToNumberLE=hC;ke.numberToBytesBE=M_;ke.numberToBytesLE=pC;ke.numberToVarBytesBE=mC;ke.ensureBytes=gC;ke.equalBytes=yC;ke.copyBytes=bC;ke.asciiToBytes=vC;ke.inRange=I_;ke.aInRange=wC;ke.bitLen=xC;ke.bitGet=SC;ke.bitSet=AC;ke.createHmacDrbg=_C;ke.validateObject=IC;ke.isHash=TC;ke._validateObject=BC;ke.memoized=PC;var $o=Fo(),ji=Fo();Object.defineProperty(ke,"abytes",{enumerable:!0,get:i(function(){return ji.abytes},"get")});Object.defineProperty(ke,"anumber",{enumerable:!0,get:i(function(){return ji.anumber},"get")});Object.defineProperty(ke,"bytesToHex",{enumerable:!0,get:i(function(){return ji.bytesToHex},"get")});Object.defineProperty(ke,"bytesToUtf8",{enumerable:!0,get:i(function(){return ji.bytesToUtf8},"get")});Object.defineProperty(ke,"concatBytes",{enumerable:!0,get:i(function(){return ji.concatBytes},"get")});Object.defineProperty(ke,"hexToBytes",{enumerable:!0,get:i(function(){return ji.hexToBytes},"get")});Object.defineProperty(ke,"isBytes",{enumerable:!0,get:i(function(){return ji.isBytes},"get")});Object.defineProperty(ke,"randomBytes",{enumerable:!0,get:i(function(){return ji.randomBytes},"get")});Object.defineProperty(ke,"utf8ToBytes",{enumerable:!0,get:i(function(){return ji.utf8ToBytes},"get")});var Uh=BigInt(0),fl=BigInt(1);function uC(e,t){if(typeof t!="boolean")throw new Error(e+" boolean expected, got "+t)}i(uC,"abool");function lC(e,t=""){if(typeof e!="boolean"){let r=t&&`"${t}"`;throw new Error(r+"expected boolean, got type="+typeof e)}return e}i(lC,"_abool2");function fC(e,t,r=""){let n=(0,$o.isBytes)(e),o=e?.length,s=t!==void 0;if(!n||s&&o!==t){let a=r&&`"${r}" `,l=s?` of length ${t}`:"",f=n?`length=${o}`:`type=${typeof e}`;throw new Error(a+"expected Uint8Array"+l+", got "+f)}return e}i(fC,"_abytes2");function __(e){let t=e.toString(16);return t.length&1?"0"+t:t}i(__,"numberToHexUnpadded");function ob(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?Uh:BigInt("0x"+e)}i(ob,"hexToNumber");function dC(e){return ob((0,$o.bytesToHex)(e))}i(dC,"bytesToNumberBE");function hC(e){return(0,$o.abytes)(e),ob((0,$o.bytesToHex)(Uint8Array.from(e).reverse()))}i(hC,"bytesToNumberLE");function M_(e,t){return(0,$o.hexToBytes)(e.toString(16).padStart(t*2,"0"))}i(M_,"numberToBytesBE");function pC(e,t){return M_(e,t).reverse()}i(pC,"numberToBytesLE");function mC(e){return(0,$o.hexToBytes)(__(e))}i(mC,"numberToVarBytesBE");function gC(e,t,r){let n;if(typeof t=="string")try{n=(0,$o.hexToBytes)(t)}catch(s){throw new Error(e+" must be hex string or Uint8Array, cause: "+s)}else if((0,$o.isBytes)(t))n=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");let o=n.length;if(typeof r=="number"&&o!==r)throw new Error(e+" of length "+r+" expected, got "+o);return n}i(gC,"ensureBytes");function yC(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return r===0}i(yC,"equalBytes");function bC(e){return Uint8Array.from(e)}i(bC,"copyBytes");function vC(e){return Uint8Array.from(e,(t,r)=>{let n=t.charCodeAt(0);if(t.length!==1||n>127)throw new Error(`string contains non-ASCII character "${e[r]}" with code ${n} at position ${r}`);return n})}i(vC,"asciiToBytes");var nb=i(e=>typeof e=="bigint"&&Uh<=e,"isPosBig");function I_(e,t,r){return nb(e)&&nb(t)&&nb(r)&&t<=e&&e<r}i(I_,"inRange");function wC(e,t,r,n){if(!I_(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}i(wC,"aInRange");function xC(e){let t;for(t=0;e>Uh;e>>=fl,t+=1);return t}i(xC,"bitLen");function SC(e,t){return e>>BigInt(t)&fl}i(SC,"bitGet");function AC(e,t,r){return e|(r?fl:Uh)<<BigInt(t)}i(AC,"bitSet");var EC=i(e=>(fl<<BigInt(e))-fl,"bitMask");ke.bitMask=EC;function _C(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=i(T=>new Uint8Array(T),"u8n"),o=i(T=>Uint8Array.of(T),"u8of"),s=n(e),a=n(e),l=0,f=i(()=>{s.fill(1),a.fill(0),l=0},"reset"),p=i((...T)=>r(a,s,...T),"h"),w=i((T=n(0))=>{a=p(o(0),T),s=p(),T.length!==0&&(a=p(o(1),T),s=p())},"reseed"),A=i(()=>{if(l++>=1e3)throw new Error("drbg: tried 1000 values");let T=0,B=[];for(;T<t;){s=p();let P=s.slice();B.push(P),T+=s.length}return(0,$o.concatBytes)(...B)},"gen");return i((T,B)=>{f(),w(T);let P;for(;!(P=B(A()));)w();return f(),P},"genUntil")}i(_C,"createHmacDrbg");var MC={bigint:i(e=>typeof e=="bigint","bigint"),function:i(e=>typeof e=="function","function"),boolean:i(e=>typeof e=="boolean","boolean"),string:i(e=>typeof e=="string","string"),stringOrUint8Array:i(e=>typeof e=="string"||(0,$o.isBytes)(e),"stringOrUint8Array"),isSafeInteger:i(e=>Number.isSafeInteger(e),"isSafeInteger"),array:i(e=>Array.isArray(e),"array"),field:i((e,t)=>t.Fp.isValid(e),"field"),hash:i(e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen),"hash")};function IC(e,t,r={}){let n=i((o,s,a)=>{let l=MC[s];if(typeof l!="function")throw new Error("invalid validator function");let f=e[o];if(!(a&&f===void 0)&&!l(f,e))throw new Error("param "+String(o)+" is invalid. Expected "+s+", got "+f)},"checkField");for(let[o,s]of Object.entries(t))n(o,s,!1);for(let[o,s]of Object.entries(r))n(o,s,!0);return e}i(IC,"validateObject");function TC(e){return typeof e=="function"&&Number.isSafeInteger(e.outputLen)}i(TC,"isHash");function BC(e,t,r={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function n(o,s,a){let l=e[o];if(a&&l===void 0)return;let f=typeof l;if(f!==s||l===null)throw new Error(`param "${o}" is invalid: expected ${s}, got ${f}`)}i(n,"checkField"),Object.entries(t).forEach(([o,s])=>n(o,s,!1)),Object.entries(r).forEach(([o,s])=>n(o,s,!0))}i(BC,"_validateObject");var kC=i(()=>{throw new Error("not implemented")},"notImplemented");ke.notImplemented=kC;function PC(e){let t=new WeakMap;return(r,...n)=>{let o=t.get(r);if(o!==void 0)return o;let s=e(r,...n);return t.set(r,s),s}}i(PC,"memoized")});var Cs=ae(Kt=>{"use strict";m();g();Object.defineProperty(Kt,"__esModule",{value:!0});Kt.isNegativeLE=void 0;Kt.mod=Jr;Kt.pow=KC;Kt.pow2=RC;Kt.invert=Nh;Kt.tonelliShanks=sb;Kt.FpSqrt=K_;Kt.validateField=VC;Kt.FpPow=ab;Kt.FpInvertBatch=R_;Kt.FpDiv=qC;Kt.FpLegendre=Lh;Kt.FpIsSquare=HC;Kt.nLength=cb;Kt.Field=Dh;Kt.FpSqrtOdd=jC;Kt.FpSqrtEven=zC;Kt.hashToPrivateScalar=FC;Kt.getFieldBytesLength=ub;Kt.getMinHashLength=U_;Kt.mapHashToField=WC;var Xr=zi(),Rr=BigInt(0),Zt=BigInt(1),Sa=BigInt(2),T_=BigInt(3),B_=BigInt(4),k_=BigInt(5),CC=BigInt(7),P_=BigInt(8),OC=BigInt(9),C_=BigInt(16);function Jr(e,t){let r=e%t;return r>=Rr?r:t+r}i(Jr,"mod");function KC(e,t,r){return ab(Dh(r),e,t)}i(KC,"pow");function RC(e,t,r){let n=e;for(;t-- >Rr;)n*=n,n%=r;return n}i(RC,"pow2");function Nh(e,t){if(e===Rr)throw new Error("invert: expected non-zero number");if(t<=Rr)throw new Error("invert: expected positive modulus, got "+t);let r=Jr(e,t),n=t,o=Rr,s=Zt,a=Zt,l=Rr;for(;r!==Rr;){let p=n/r,w=n%r,A=o-a*p,_=s-l*p;n=r,r=w,o=a,s=l,a=A,l=_}if(n!==Zt)throw new Error("invert: does not exist");return Jr(o,t)}i(Nh,"invert");function ib(e,t,r){if(!e.eql(e.sqr(t),r))throw new Error("Cannot find square root")}i(ib,"assertIsSquare");function O_(e,t){let r=(e.ORDER+Zt)/B_,n=e.pow(t,r);return ib(e,n,t),n}i(O_,"sqrt3mod4");function UC(e,t){let r=(e.ORDER-k_)/P_,n=e.mul(t,Sa),o=e.pow(n,r),s=e.mul(t,o),a=e.mul(e.mul(s,Sa),o),l=e.mul(s,e.sub(a,e.ONE));return ib(e,l,t),l}i(UC,"sqrt5mod8");function NC(e){let t=Dh(e),r=sb(e),n=r(t,t.neg(t.ONE)),o=r(t,n),s=r(t,t.neg(n)),a=(e+CC)/C_;return(l,f)=>{let p=l.pow(f,a),w=l.mul(p,n),A=l.mul(p,o),_=l.mul(p,s),T=l.eql(l.sqr(w),f),B=l.eql(l.sqr(A),f);p=l.cmov(p,w,T),w=l.cmov(_,A,B);let P=l.eql(l.sqr(w),f),C=l.cmov(p,w,P);return ib(l,C,f),C}}i(NC,"sqrt9mod16");function sb(e){if(e<T_)throw new Error("sqrt is not defined for small field");let t=e-Zt,r=0;for(;t%Sa===Rr;)t/=Sa,r++;let n=Sa,o=Dh(e);for(;Lh(o,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return O_;let s=o.pow(n,t),a=(t+Zt)/Sa;return i(function(f,p){if(f.is0(p))return p;if(Lh(f,p)!==1)throw new Error("Cannot find square root");let w=r,A=f.mul(f.ONE,s),_=f.pow(p,t),T=f.pow(p,a);for(;!f.eql(_,f.ONE);){if(f.is0(_))return f.ZERO;let B=1,P=f.sqr(_);for(;!f.eql(P,f.ONE);)if(B++,P=f.sqr(P),B===w)throw new Error("Cannot find square root");let C=Zt<<BigInt(w-B-1),O=f.pow(A,C);w=B,A=f.sqr(O),_=f.mul(_,A),T=f.mul(T,O)}return T},"tonelliSlow")}i(sb,"tonelliShanks");function K_(e){return e%B_===T_?O_:e%P_===k_?UC:e%C_===OC?NC(e):sb(e)}i(K_,"FpSqrt");var LC=i((e,t)=>(Jr(e,t)&Zt)===Zt,"isNegativeLE");Kt.isNegativeLE=LC;var DC=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function VC(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},r=DC.reduce((n,o)=>(n[o]="function",n),t);return(0,Xr._validateObject)(e,r),e}i(VC,"validateField");function ab(e,t,r){if(r<Rr)throw new Error("invalid exponent, negatives unsupported");if(r===Rr)return e.ONE;if(r===Zt)return t;let n=e.ONE,o=t;for(;r>Rr;)r&Zt&&(n=e.mul(n,o)),o=e.sqr(o),r>>=Zt;return n}i(ab,"FpPow");function R_(e,t,r=!1){let n=new Array(t.length).fill(r?e.ZERO:void 0),o=t.reduce((a,l,f)=>e.is0(l)?a:(n[f]=a,e.mul(a,l)),e.ONE),s=e.inv(o);return t.reduceRight((a,l,f)=>e.is0(l)?a:(n[f]=e.mul(a,n[f]),e.mul(a,l)),s),n}i(R_,"FpInvertBatch");function qC(e,t,r){return e.mul(t,typeof r=="bigint"?Nh(r,e.ORDER):e.inv(r))}i(qC,"FpDiv");function Lh(e,t){let r=(e.ORDER-Zt)/Sa,n=e.pow(t,r),o=e.eql(n,e.ONE),s=e.eql(n,e.ZERO),a=e.eql(n,e.neg(e.ONE));if(!o&&!s&&!a)throw new Error("invalid Legendre symbol result");return o?1:s?0:-1}i(Lh,"FpLegendre");function HC(e,t){return Lh(e,t)===1}i(HC,"FpIsSquare");function cb(e,t){t!==void 0&&(0,Xr.anumber)(t);let r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}i(cb,"nLength");function Dh(e,t,r=!1,n={}){if(e<=Rr)throw new Error("invalid field: expected ORDER > 0, got "+e);let o,s,a=!1,l;if(typeof t=="object"&&t!=null){if(n.sqrt||r)throw new Error("cannot specify opts in two arguments");let _=t;_.BITS&&(o=_.BITS),_.sqrt&&(s=_.sqrt),typeof _.isLE=="boolean"&&(r=_.isLE),typeof _.modFromBytes=="boolean"&&(a=_.modFromBytes),l=_.allowedLengths}else typeof t=="number"&&(o=t),n.sqrt&&(s=n.sqrt);let{nBitLength:f,nByteLength:p}=cb(e,o);if(p>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let w,A=Object.freeze({ORDER:e,isLE:r,BITS:f,BYTES:p,MASK:(0,Xr.bitMask)(f),ZERO:Rr,ONE:Zt,allowedLengths:l,create:i(_=>Jr(_,e),"create"),isValid:i(_=>{if(typeof _!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof _);return Rr<=_&&_<e},"isValid"),is0:i(_=>_===Rr,"is0"),isValidNot0:i(_=>!A.is0(_)&&A.isValid(_),"isValidNot0"),isOdd:i(_=>(_&Zt)===Zt,"isOdd"),neg:i(_=>Jr(-_,e),"neg"),eql:i((_,T)=>_===T,"eql"),sqr:i(_=>Jr(_*_,e),"sqr"),add:i((_,T)=>Jr(_+T,e),"add"),sub:i((_,T)=>Jr(_-T,e),"sub"),mul:i((_,T)=>Jr(_*T,e),"mul"),pow:i((_,T)=>ab(A,_,T),"pow"),div:i((_,T)=>Jr(_*Nh(T,e),e),"div"),sqrN:i(_=>_*_,"sqrN"),addN:i((_,T)=>_+T,"addN"),subN:i((_,T)=>_-T,"subN"),mulN:i((_,T)=>_*T,"mulN"),inv:i(_=>Nh(_,e),"inv"),sqrt:s||(_=>(w||(w=K_(e)),w(A,_))),toBytes:i(_=>r?(0,Xr.numberToBytesLE)(_,p):(0,Xr.numberToBytesBE)(_,p),"toBytes"),fromBytes:i((_,T=!0)=>{if(l){if(!l.includes(_.length)||_.length>p)throw new Error("Field.fromBytes: expected "+l+" bytes, got "+_.length);let P=new Uint8Array(p);P.set(_,r?0:P.length-_.length),_=P}if(_.length!==p)throw new Error("Field.fromBytes: expected "+p+" bytes, got "+_.length);let B=r?(0,Xr.bytesToNumberLE)(_):(0,Xr.bytesToNumberBE)(_);if(a&&(B=Jr(B,e)),!T&&!A.isValid(B))throw new Error("invalid field element: outside of range 0..ORDER");return B},"fromBytes"),invertBatch:i(_=>R_(A,_),"invertBatch"),cmov:i((_,T,B)=>B?T:_,"cmov")});return Object.freeze(A)}i(Dh,"Field");function jC(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?r:e.neg(r)}i(jC,"FpSqrtOdd");function zC(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?e.neg(r):r}i(zC,"FpSqrtEven");function FC(e,t,r=!1){e=(0,Xr.ensureBytes)("privateHash",e);let n=e.length,o=cb(t).nByteLength+8;if(o<24||n<o||n>1024)throw new Error("hashToPrivateScalar: expected "+o+"-1024 bytes of input, got "+n);let s=r?(0,Xr.bytesToNumberLE)(e):(0,Xr.bytesToNumberBE)(e);return Jr(s,t-Zt)+Zt}i(FC,"hashToPrivateScalar");function ub(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}i(ub,"getFieldBytesLength");function U_(e){let t=ub(e);return t+Math.ceil(t/2)}i(U_,"getMinHashLength");function WC(e,t,r=!1){let n=e.length,o=ub(t),s=U_(t);if(n<16||n<s||n>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+n);let a=r?(0,Xr.bytesToNumberLE)(e):(0,Xr.bytesToNumberBE)(e),l=Jr(a,t-Zt)+Zt;return r?(0,Xr.numberToBytesLE)(l,o):(0,Xr.numberToBytesBE)(l,o)}i(WC,"mapHashToField")});var Vh=ae(po=>{"use strict";m();g();Object.defineProperty(po,"__esModule",{value:!0});po.wNAF=void 0;po.negateCt=hb;po.normalizeZ=$C;po.mulEndoUnsafe=GC;po.pippenger=ZC;po.precomputeMSMUnsafe=YC;po.validateBasic=JC;po._createCurveFields=XC;var dl=zi(),hl=Cs(),qc=BigInt(0),Aa=BigInt(1);function hb(e,t){let r=t.negate();return e?r:t}i(hb,"negateCt");function $C(e,t){let r=(0,hl.FpInvertBatch)(e.Fp,t.map(n=>n.Z));return t.map((n,o)=>e.fromAffine(n.toAffine(r[o])))}i($C,"normalizeZ");function mb(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}i(mb,"validateW");function lb(e,t){mb(e,t);let r=Math.ceil(t/e)+1,n=2**(e-1),o=2**e,s=(0,dl.bitMask)(e),a=BigInt(e);return{windows:r,windowSize:n,mask:s,maxNumber:o,shiftBy:a}}i(lb,"calcWOpts");function N_(e,t,r){let{windowSize:n,mask:o,maxNumber:s,shiftBy:a}=r,l=Number(e&o),f=e>>a;l>n&&(l-=s,f+=Aa);let p=t*n,w=p+Math.abs(l)-1,A=l===0,_=l<0,T=t%2!==0;return{nextN:f,offset:w,isZero:A,isNeg:_,isNegF:T,offsetF:p}}i(N_,"calcOffsets");function V_(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((r,n)=>{if(!(r instanceof t))throw new Error("invalid point at index "+n)})}i(V_,"validateMSMPoints");function q_(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((r,n)=>{if(!t.isValid(r))throw new Error("invalid scalar at index "+n)})}i(q_,"validateMSMScalars");var fb=new WeakMap,H_=new WeakMap;function db(e){return H_.get(e)||1}i(db,"getW");function L_(e){if(e!==qc)throw new Error("invalid wNAF")}i(L_,"assert0");var pb=class{static{i(this,"wNAF")}constructor(t,r){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=r}_unsafeLadder(t,r,n=this.ZERO){let o=t;for(;r>qc;)r&Aa&&(n=n.add(o)),o=o.double(),r>>=Aa;return n}precomputeWindow(t,r){let{windows:n,windowSize:o}=lb(r,this.bits),s=[],a=t,l=a;for(let f=0;f<n;f++){l=a,s.push(l);for(let p=1;p<o;p++)l=l.add(a),s.push(l);a=l.double()}return s}wNAF(t,r,n){if(!this.Fn.isValid(n))throw new Error("invalid scalar");let o=this.ZERO,s=this.BASE,a=lb(t,this.bits);for(let l=0;l<a.windows;l++){let{nextN:f,offset:p,isZero:w,isNeg:A,isNegF:_,offsetF:T}=N_(n,l,a);n=f,w?s=s.add(hb(_,r[T])):o=o.add(hb(A,r[p]))}return L_(n),{p:o,f:s}}wNAFUnsafe(t,r,n,o=this.ZERO){let s=lb(t,this.bits);for(let a=0;a<s.windows&&n!==qc;a++){let{nextN:l,offset:f,isZero:p,isNeg:w}=N_(n,a,s);if(n=l,!p){let A=r[f];o=o.add(w?A.negate():A)}}return L_(n),o}getPrecomputes(t,r,n){let o=fb.get(r);return o||(o=this.precomputeWindow(r,t),t!==1&&(typeof n=="function"&&(o=n(o)),fb.set(r,o))),o}cached(t,r,n){let o=db(t);return this.wNAF(o,this.getPrecomputes(o,t,n),r)}unsafe(t,r,n,o){let s=db(t);return s===1?this._unsafeLadder(t,r,o):this.wNAFUnsafe(s,this.getPrecomputes(s,t,n),r,o)}createCache(t,r){mb(r,this.bits),H_.set(t,r),fb.delete(t)}hasCache(t){return db(t)!==1}};po.wNAF=pb;function GC(e,t,r,n){let o=t,s=e.ZERO,a=e.ZERO;for(;r>qc||n>qc;)r&Aa&&(s=s.add(o)),n&Aa&&(a=a.add(o)),o=o.double(),r>>=Aa,n>>=Aa;return{p1:s,p2:a}}i(GC,"mulEndoUnsafe");function ZC(e,t,r,n){V_(r,e),q_(n,t);let o=r.length,s=n.length;if(o!==s)throw new Error("arrays of points and scalars must have equal length");let a=e.ZERO,l=(0,dl.bitLen)(BigInt(o)),f=1;l>12?f=l-3:l>4?f=l-2:l>0&&(f=2);let p=(0,dl.bitMask)(f),w=new Array(Number(p)+1).fill(a),A=Math.floor((t.BITS-1)/f)*f,_=a;for(let T=A;T>=0;T-=f){w.fill(a);for(let P=0;P<s;P++){let C=n[P],O=Number(C>>BigInt(T)&p);w[O]=w[O].add(r[P])}let B=a;for(let P=w.length-1,C=a;P>0;P--)C=C.add(w[P]),B=B.add(C);if(_=_.add(B),T!==0)for(let P=0;P<f;P++)_=_.double()}return _}i(ZC,"pippenger");function YC(e,t,r,n){mb(n,t.BITS),V_(r,e);let o=e.ZERO,s=2**n-1,a=Math.ceil(t.BITS/n),l=(0,dl.bitMask)(n),f=r.map(p=>{let w=[];for(let A=0,_=p;A<s;A++)w.push(_),_=_.add(p);return w});return p=>{if(q_(p,t),p.length>r.length)throw new Error("array of scalars must be smaller than array of points");let w=o;for(let A=0;A<a;A++){if(w!==o)for(let T=0;T<n;T++)w=w.double();let _=BigInt(a*n-(A+1)*n);for(let T=0;T<p.length;T++){let B=p[T],P=Number(B>>_&l);P&&(w=w.add(f[T][P-1]))}}return w}}i(YC,"precomputeMSMUnsafe");function JC(e){return(0,hl.validateField)(e.Fp),(0,dl.validateObject)(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,hl.nLength)(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}i(JC,"validateBasic");function D_(e,t,r){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return(0,hl.validateField)(t),t}else return(0,hl.Field)(e,{isLE:r})}i(D_,"createField");function XC(e,t,r={},n){if(n===void 0&&(n=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(let f of["p","n","h"]){let p=t[f];if(!(typeof p=="bigint"&&p>qc))throw new Error(`CURVE.${f} must be positive bigint`)}let o=D_(t.p,r.Fp,n),s=D_(t.n,r.Fn,n),l=["Gx","Gy","a",e==="weierstrass"?"b":"d"];for(let f of l)if(!o.isValid(t[f]))throw new Error(`CURVE.${f} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:o,Fn:s}}i(XC,"_createCurveFields")});var F_=ae(_a=>{"use strict";m();g();Object.defineProperty(_a,"__esModule",{value:!0});_a.PrimeEdwardsPoint=void 0;_a.edwards=j_;_a.eddsa=z_;_a.twistedEdwards=oO;var vt=zi(),Ea=Vh(),QC=Cs(),Os=BigInt(0),ur=BigInt(1),gb=BigInt(2),eO=BigInt(8);function tO(e,t,r,n){let o=e.sqr(r),s=e.sqr(n),a=e.add(e.mul(t.a,o),s),l=e.add(e.ONE,e.mul(t.d,e.mul(o,s)));return e.eql(a,l)}i(tO,"isEdValidXY");function j_(e,t={}){let r=(0,Ea._createCurveFields)("edwards",e,t,t.FpFnLE),{Fp:n,Fn:o}=r,s=r.CURVE,{h:a}=s;(0,vt._validateObject)(t,{},{uvRatio:"function"});let l=gb<<BigInt(o.BYTES*8)-ur,f=i(C=>n.create(C),"modP"),p=t.uvRatio||((C,O)=>{try{return{isValid:!0,value:n.sqrt(n.div(C,O))}}catch{return{isValid:!1,value:Os}}});if(!tO(n,s,s.Gx,s.Gy))throw new Error("bad curve params: generator point");function w(C,O,L=!1){let R=L?ur:Os;return(0,vt.aInRange)("coordinate "+C,O,R,l),O}i(w,"acoord");function A(C){if(!(C instanceof B))throw new Error("ExtendedPoint expected")}i(A,"aextpoint");let _=(0,vt.memoized)((C,O)=>{let{X:L,Y:R,Z:j}=C,Z=C.is0();O==null&&(O=Z?eO:n.inv(j));let X=f(L*O),Q=f(R*O),z=n.mul(j,O);if(Z)return{x:Os,y:ur};if(z!==ur)throw new Error("invZ was invalid");return{x:X,y:Q}}),T=(0,vt.memoized)(C=>{let{a:O,d:L}=s;if(C.is0())throw new Error("bad point: ZERO");let{X:R,Y:j,Z,T:X}=C,Q=f(R*R),z=f(j*j),H=f(Z*Z),E=f(H*H),c=f(Q*O),d=f(H*f(c+z)),h=f(E+f(L*f(Q*z)));if(d!==h)throw new Error("bad point: equation left != right (1)");let y=f(R*j),b=f(Z*X);if(y!==b)throw new Error("bad point: equation left != right (2)");return!0});class B{static{i(this,"Point")}constructor(O,L,R,j){this.X=w("x",O),this.Y=w("y",L),this.Z=w("z",R,!0),this.T=w("t",j),Object.freeze(this)}static CURVE(){return s}static fromAffine(O){if(O instanceof B)throw new Error("extended point not allowed");let{x:L,y:R}=O||{};return w("x",L),w("y",R),new B(L,R,ur,f(L*R))}static fromBytes(O,L=!1){let R=n.BYTES,{a:j,d:Z}=s;O=(0,vt.copyBytes)((0,vt._abytes2)(O,R,"point")),(0,vt._abool2)(L,"zip215");let X=(0,vt.copyBytes)(O),Q=O[R-1];X[R-1]=Q&-129;let z=(0,vt.bytesToNumberLE)(X),H=L?l:n.ORDER;(0,vt.aInRange)("point.y",z,Os,H);let E=f(z*z),c=f(E-ur),d=f(Z*E-j),{isValid:h,value:y}=p(c,d);if(!h)throw new Error("bad point: invalid y coordinate");let b=(y&ur)===ur,M=(Q&128)!==0;if(!L&&y===Os&&M)throw new Error("bad point: x=0 and x_0=1");return M!==b&&(y=f(-y)),B.fromAffine({x:y,y:z})}static fromHex(O,L=!1){return B.fromBytes((0,vt.ensureBytes)("point",O),L)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(O=8,L=!0){return P.createCache(this,O),L||this.multiply(gb),this}assertValidity(){T(this)}equals(O){A(O);let{X:L,Y:R,Z:j}=this,{X:Z,Y:X,Z:Q}=O,z=f(L*Q),H=f(Z*j),E=f(R*Q),c=f(X*j);return z===H&&E===c}is0(){return this.equals(B.ZERO)}negate(){return new B(f(-this.X),this.Y,this.Z,f(-this.T))}double(){let{a:O}=s,{X:L,Y:R,Z:j}=this,Z=f(L*L),X=f(R*R),Q=f(gb*f(j*j)),z=f(O*Z),H=L+R,E=f(f(H*H)-Z-X),c=z+X,d=c-Q,h=z-X,y=f(E*d),b=f(c*h),M=f(E*h),I=f(d*c);return new B(y,b,I,M)}add(O){A(O);let{a:L,d:R}=s,{X:j,Y:Z,Z:X,T:Q}=this,{X:z,Y:H,Z:E,T:c}=O,d=f(j*z),h=f(Z*H),y=f(Q*R*c),b=f(X*E),M=f((j+Z)*(z+H)-d-h),I=b-y,x=b+y,u=f(h-L*d),S=f(M*I),V=f(x*u),q=f(M*u),F=f(I*x);return new B(S,V,F,q)}subtract(O){return this.add(O.negate())}multiply(O){if(!o.isValidNot0(O))throw new Error("invalid scalar: expected 1 <= sc < curve.n");let{p:L,f:R}=P.cached(this,O,j=>(0,Ea.normalizeZ)(B,j));return(0,Ea.normalizeZ)(B,[L,R])[0]}multiplyUnsafe(O,L=B.ZERO){if(!o.isValid(O))throw new Error("invalid scalar: expected 0 <= sc < curve.n");return O===Os?B.ZERO:this.is0()||O===ur?this:P.unsafe(this,O,R=>(0,Ea.normalizeZ)(B,R),L)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}isTorsionFree(){return P.unsafe(this,s.n).is0()}toAffine(O){return _(this,O)}clearCofactor(){return a===ur?this:this.multiplyUnsafe(a)}toBytes(){let{x:O,y:L}=this.toAffine(),R=n.toBytes(L);return R[R.length-1]|=O&ur?128:0,R}toHex(){return(0,vt.bytesToHex)(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get ex(){return this.X}get ey(){return this.Y}get ez(){return this.Z}get et(){return this.T}static normalizeZ(O){return(0,Ea.normalizeZ)(B,O)}static msm(O,L){return(0,Ea.pippenger)(B,o,O,L)}_setWindowSize(O){this.precompute(O)}toRawBytes(){return this.toBytes()}}B.BASE=new B(s.Gx,s.Gy,ur,f(s.Gx*s.Gy)),B.ZERO=new B(Os,ur,ur,Os),B.Fp=n,B.Fn=o;let P=new Ea.wNAF(B,o.BITS);return B.BASE.precompute(8),B}i(j_,"edwards");var yb=class{static{i(this,"PrimeEdwardsPoint")}constructor(t){this.ep=t}static fromBytes(t){(0,vt.notImplemented)()}static fromHex(t){(0,vt.notImplemented)()}get x(){return this.toAffine().x}get y(){return this.toAffine().y}clearCofactor(){return this}assertValidity(){this.ep.assertValidity()}toAffine(t){return this.ep.toAffine(t)}toHex(){return(0,vt.bytesToHex)(this.toBytes())}toString(){return this.toHex()}isTorsionFree(){return!0}isSmallOrder(){return!1}add(t){return this.assertSame(t),this.init(this.ep.add(t.ep))}subtract(t){return this.assertSame(t),this.init(this.ep.subtract(t.ep))}multiply(t){return this.init(this.ep.multiply(t))}multiplyUnsafe(t){return this.init(this.ep.multiplyUnsafe(t))}double(){return this.init(this.ep.double())}negate(){return this.init(this.ep.negate())}precompute(t,r){return this.init(this.ep.precompute(t,r))}toRawBytes(){return this.toBytes()}};_a.PrimeEdwardsPoint=yb;function z_(e,t,r={}){if(typeof t!="function")throw new Error('"hash" function param is required');(0,vt._validateObject)(r,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});let{prehash:n}=r,{BASE:o,Fp:s,Fn:a}=e,l=r.randomBytes||vt.randomBytes,f=r.adjustScalarBytes||(H=>H),p=r.domain||((H,E,c)=>{if((0,vt._abool2)(c,"phflag"),E.length||c)throw new Error("Contexts/pre-hash are not supported");return H});function w(H){return a.create((0,vt.bytesToNumberLE)(H))}i(w,"modN_LE");function A(H){let E=R.secretKey;H=(0,vt.ensureBytes)("private key",H,E);let c=(0,vt.ensureBytes)("hashed private key",t(H),2*E),d=f(c.slice(0,E)),h=c.slice(E,2*E),y=w(d);return{head:d,prefix:h,scalar:y}}i(A,"getPrivateScalar");function _(H){let{head:E,prefix:c,scalar:d}=A(H),h=o.multiply(d),y=h.toBytes();return{head:E,prefix:c,scalar:d,point:h,pointBytes:y}}i(_,"getExtendedPublicKey");function T(H){return _(H).pointBytes}i(T,"getPublicKey");function B(H=Uint8Array.of(),...E){let c=(0,vt.concatBytes)(...E);return w(t(p(c,(0,vt.ensureBytes)("context",H),!!n)))}i(B,"hashDomainToScalar");function P(H,E,c={}){H=(0,vt.ensureBytes)("message",H),n&&(H=n(H));let{prefix:d,scalar:h,pointBytes:y}=_(E),b=B(c.context,d,H),M=o.multiply(b).toBytes(),I=B(c.context,M,y,H),x=a.create(b+I*h);if(!a.isValid(x))throw new Error("sign failed: invalid s");let u=(0,vt.concatBytes)(M,a.toBytes(x));return(0,vt._abytes2)(u,R.signature,"result")}i(P,"sign");let C={zip215:!0};function O(H,E,c,d=C){let{context:h,zip215:y}=d,b=R.signature;H=(0,vt.ensureBytes)("signature",H,b),E=(0,vt.ensureBytes)("message",E),c=(0,vt.ensureBytes)("publicKey",c,R.publicKey),y!==void 0&&(0,vt._abool2)(y,"zip215"),n&&(E=n(E));let M=b/2,I=H.subarray(0,M),x=(0,vt.bytesToNumberLE)(H.subarray(M,b)),u,S,V;try{u=e.fromBytes(c,y),S=e.fromBytes(I,y),V=o.multiplyUnsafe(x)}catch{return!1}if(!y&&u.isSmallOrder())return!1;let q=B(h,S.toBytes(),u.toBytes(),E);return S.add(u.multiplyUnsafe(q)).subtract(V).clearCofactor().is0()}i(O,"verify");let L=s.BYTES,R={secretKey:L,publicKey:L,signature:2*L,seed:L};function j(H=l(R.seed)){return(0,vt._abytes2)(H,R.seed,"seed")}i(j,"randomSecretKey");function Z(H){let E=z.randomSecretKey(H);return{secretKey:E,publicKey:T(E)}}i(Z,"keygen");function X(H){return(0,vt.isBytes)(H)&&H.length===a.BYTES}i(X,"isValidSecretKey");function Q(H,E){try{return!!e.fromBytes(H,E)}catch{return!1}}i(Q,"isValidPublicKey");let z={getExtendedPublicKey:_,randomSecretKey:j,isValidSecretKey:X,isValidPublicKey:Q,toMontgomery(H){let{y:E}=e.fromBytes(H),c=R.publicKey,d=c===32;if(!d&&c!==57)throw new Error("only defined for 25519 and 448");let h=d?s.div(ur+E,ur-E):s.div(E-ur,E+ur);return s.toBytes(h)},toMontgomerySecret(H){let E=R.secretKey;(0,vt._abytes2)(H,E);let c=t(H.subarray(0,E));return f(c).subarray(0,E)},randomPrivateKey:j,precompute(H=8,E=e.BASE){return E.precompute(H,!1)}};return Object.freeze({keygen:Z,getPublicKey:T,sign:P,verify:O,utils:z,Point:e,lengths:R})}i(z_,"eddsa");function rO(e){let t={a:e.a,d:e.d,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r=e.Fp,n=(0,QC.Field)(t.n,e.nBitLength,!0),o={Fp:r,Fn:n,uvRatio:e.uvRatio},s={randomBytes:e.randomBytes,adjustScalarBytes:e.adjustScalarBytes,domain:e.domain,prehash:e.prehash,mapToCurve:e.mapToCurve};return{CURVE:t,curveOpts:o,hash:e.hash,eddsaOpts:s}}i(rO,"_eddsa_legacy_opts_to_new");function nO(e,t){let r=t.Point;return Object.assign({},t,{ExtendedPoint:r,CURVE:e,nBitLength:r.Fn.BITS,nByteLength:r.Fn.BYTES})}i(nO,"_eddsa_new_output_to_legacy");function oO(e){let{CURVE:t,curveOpts:r,hash:n,eddsaOpts:o}=rO(e),s=j_(t,r),a=z_(s,n,o);return nO(e,a)}i(oO,"twistedEdwards")});var bb=ae(Go=>{"use strict";m();g();Object.defineProperty(Go,"__esModule",{value:!0});Go._DST_scalar=void 0;Go.expand_message_xmd=G_;Go.expand_message_xof=Z_;Go.hash_to_field=qh;Go.isogenyMap=aO;Go.createHasher=cO;var mr=zi(),W_=Cs(),iO=mr.bytesToNumberBE;function Ks(e,t){if(pl(e),pl(t),e<0||e>=1<<8*t)throw new Error("invalid I2OSP input: "+e);let r=Array.from({length:t}).fill(0);for(let n=t-1;n>=0;n--)r[n]=e&255,e>>>=8;return new Uint8Array(r)}i(Ks,"i2osp");function sO(e,t){let r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]^t[n];return r}i(sO,"strxor");function pl(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}i(pl,"anum");function $_(e){if(!(0,mr.isBytes)(e)&&typeof e!="string")throw new Error("DST must be Uint8Array or string");return typeof e=="string"?(0,mr.utf8ToBytes)(e):e}i($_,"normDST");function G_(e,t,r,n){(0,mr.abytes)(e),pl(r),t=$_(t),t.length>255&&(t=n((0,mr.concatBytes)((0,mr.utf8ToBytes)("H2C-OVERSIZE-DST-"),t)));let{outputLen:o,blockLen:s}=n,a=Math.ceil(r/o);if(r>65535||a>255)throw new Error("expand_message_xmd: invalid lenInBytes");let l=(0,mr.concatBytes)(t,Ks(t.length,1)),f=Ks(0,s),p=Ks(r,2),w=new Array(a),A=n((0,mr.concatBytes)(f,e,p,Ks(0,1),l));w[0]=n((0,mr.concatBytes)(A,Ks(1,1),l));for(let T=1;T<=a;T++){let B=[sO(A,w[T-1]),Ks(T+1,1),l];w[T]=n((0,mr.concatBytes)(...B))}return(0,mr.concatBytes)(...w).slice(0,r)}i(G_,"expand_message_xmd");function Z_(e,t,r,n,o){if((0,mr.abytes)(e),pl(r),t=$_(t),t.length>255){let s=Math.ceil(2*n/8);t=o.create({dkLen:s}).update((0,mr.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(t).digest()}if(r>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return o.create({dkLen:r}).update(e).update(Ks(r,2)).update(t).update(Ks(t.length,1)).digest()}i(Z_,"expand_message_xof");function qh(e,t,r){(0,mr._validateObject)(r,{p:"bigint",m:"number",k:"number",hash:"function"});let{p:n,k:o,m:s,hash:a,expand:l,DST:f}=r;if(!(0,mr.isHash)(r.hash))throw new Error("expected valid hash");(0,mr.abytes)(e),pl(t);let p=n.toString(2).length,w=Math.ceil((p+o)/8),A=t*s*w,_;if(l==="xmd")_=G_(e,f,A,a);else if(l==="xof")_=Z_(e,f,A,o,a);else if(l==="_internal_pass")_=e;else throw new Error('expand must be "xmd" or "xof"');let T=new Array(t);for(let B=0;B<t;B++){let P=new Array(s);for(let C=0;C<s;C++){let O=w*(C+B*s),L=_.subarray(O,O+w);P[C]=(0,W_.mod)(iO(L),n)}T[B]=P}return T}i(qh,"hash_to_field");function aO(e,t){let r=t.map(n=>Array.from(n).reverse());return(n,o)=>{let[s,a,l,f]=r.map(A=>A.reduce((_,T)=>e.add(e.mul(_,n),T))),[p,w]=(0,W_.FpInvertBatch)(e,[a,f],!0);return n=e.mul(s,p),o=e.mul(o,e.mul(l,w)),{x:n,y:o}}}i(aO,"isogenyMap");Go._DST_scalar=(0,mr.utf8ToBytes)("HashToScalar-");function cO(e,t,r){if(typeof t!="function")throw new Error("mapToCurve() must be defined");function n(s){return e.fromAffine(t(s))}i(n,"map");function o(s){let a=s.clearCofactor();return a.equals(e.ZERO)?e.ZERO:(a.assertValidity(),a)}return i(o,"clear"),{defaults:r,hashToCurve(s,a){let l=Object.assign({},r,a),f=qh(s,2,l),p=n(f[0]),w=n(f[1]);return o(p.add(w))},encodeToCurve(s,a){let l=r.encodeDST?{DST:r.encodeDST}:{},f=Object.assign({},r,l,a),p=qh(s,1,f),w=n(p[0]);return o(w)},mapToCurve(s){if(!Array.isArray(s))throw new Error("expected array of bigints");for(let a of s)if(typeof a!="bigint")throw new Error("expected array of bigints");return o(n(s))},hashToScalar(s,a){let l=e.Fn.ORDER,f=Object.assign({},r,{p:l,m:1,DST:Go._DST_scalar},a);return qh(s,1,f)[0][0]}}}i(cO,"createHasher")});var Y_=ae(vb=>{"use strict";m();g();Object.defineProperty(vb,"__esModule",{value:!0});vb.montgomery=fO;var Zo=zi(),uO=Cs(),ml=BigInt(0),Hc=BigInt(1),Hh=BigInt(2);function lO(e){return(0,Zo._validateObject)(e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...e})}i(lO,"validateOpts");function fO(e){let t=lO(e),{P:r,type:n,adjustScalarBytes:o,powPminus2:s,randomBytes:a}=t,l=n==="x25519";if(!l&&n!=="x448")throw new Error("invalid type");let f=a||Zo.randomBytes,p=l?255:448,w=l?32:56,A=BigInt(l?9:5),_=BigInt(l?121665:39081),T=l?Hh**BigInt(254):Hh**BigInt(447),B=l?BigInt(8)*Hh**BigInt(251)-Hc:BigInt(4)*Hh**BigInt(445)-Hc,P=T+B+Hc,C=i(h=>(0,uO.mod)(h,r),"modP"),O=L(A);function L(h){return(0,Zo.numberToBytesLE)(C(h),w)}i(L,"encodeU");function R(h){let y=(0,Zo.ensureBytes)("u coordinate",h,w);return l&&(y[31]&=127),C((0,Zo.bytesToNumberLE)(y))}i(R,"decodeU");function j(h){return(0,Zo.bytesToNumberLE)(o((0,Zo.ensureBytes)("scalar",h,w)))}i(j,"decodeScalar");function Z(h,y){let b=z(R(y),j(h));if(b===ml)throw new Error("invalid private or public key received");return L(b)}i(Z,"scalarMult");function X(h){return Z(h,O)}i(X,"scalarMultBase");function Q(h,y,b){let M=C(h*(y-b));return y=C(y-M),b=C(b+M),{x_2:y,x_3:b}}i(Q,"cswap");function z(h,y){(0,Zo.aInRange)("u",h,ml,r),(0,Zo.aInRange)("scalar",y,T,P);let b=y,M=h,I=Hc,x=ml,u=h,S=Hc,V=ml;for(let F=BigInt(p-1);F>=ml;F--){let ee=b>>F&Hc;V^=ee,{x_2:I,x_3:u}=Q(V,I,u),{x_2:x,x_3:S}=Q(V,x,S),V=ee;let ie=I+x,ce=C(ie*ie),ye=I-x,ue=C(ye*ye),N=ce-ue,G=u+S,W=u-S,ne=C(W*ie),le=C(G*ye),te=ne+le,se=ne-le;u=C(te*te),S=C(M*C(se*se)),I=C(ce*ue),x=C(N*(ce+C(_*N)))}({x_2:I,x_3:u}=Q(V,I,u)),{x_2:x,x_3:S}=Q(V,x,S);let q=s(x);return C(I*q)}i(z,"montgomeryLadder");let H={secretKey:w,publicKey:w,seed:w},E=i((h=f(w))=>((0,Zo.abytes)(h,H.seed),h),"randomSecretKey");function c(h){let y=E(h);return{secretKey:y,publicKey:X(y)}}return i(c,"keygen"),{keygen:c,getSharedSecret:i((h,y)=>Z(h,y),"getSharedSecret"),getPublicKey:i(h=>X(h),"getPublicKey"),scalarMult:Z,scalarMultBase:X,utils:{randomSecretKey:E,randomPrivateKey:E},GuBytes:O.slice(),lengths:H}}i(fO,"montgomery")});var cM=ae(Ue=>{"use strict";m();g();Object.defineProperty(Ue,"__esModule",{value:!0});Ue.hash_to_ristretto255=Ue.hashToRistretto255=Ue.encodeToCurve=Ue.hashToCurve=Ue.RistrettoPoint=Ue.edwardsToMontgomery=Ue.ED25519_TORSION_SUBGROUP=Ue.ristretto255_hasher=Ue.ristretto255=Ue.ed25519_hasher=Ue.x25519=Ue.ed25519ph=Ue.ed25519ctx=Ue.ed25519=void 0;Ue.edwardsToMontgomeryPub=aM;Ue.edwardsToMontgomeryPriv=_O;var gl=Rh(),zh=Fo(),dO=Vh(),Wh=F_(),jh=bb(),St=Cs(),hO=Y_(),Ma=zi(),pO=BigInt(0),Yo=BigInt(1),Fh=BigInt(2),eM=BigInt(3),tM=BigInt(5),Ab=BigInt(8),Fi=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),yl={p:Fi,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:Ab,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function rM(e){let t=BigInt(10),r=BigInt(20),n=BigInt(40),o=BigInt(80),s=Fi,l=e*e%s*e%s,f=(0,St.pow2)(l,Fh,s)*l%s,p=(0,St.pow2)(f,Yo,s)*e%s,w=(0,St.pow2)(p,tM,s)*p%s,A=(0,St.pow2)(w,t,s)*w%s,_=(0,St.pow2)(A,r,s)*A%s,T=(0,St.pow2)(_,n,s)*_%s,B=(0,St.pow2)(T,o,s)*T%s,P=(0,St.pow2)(B,o,s)*T%s,C=(0,St.pow2)(P,t,s)*w%s;return{pow_p_5_8:(0,St.pow2)(C,Fh,s)*e%s,b2:l}}i(rM,"ed25519_pow_2_252_3");function nM(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}i(nM,"adjustScalarBytes");var wb=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function Eb(e,t){let r=Fi,n=(0,St.mod)(t*t*t,r),o=(0,St.mod)(n*n*t,r),s=rM(e*o).pow_p_5_8,a=(0,St.mod)(e*n*s,r),l=(0,St.mod)(t*a*a,r),f=a,p=(0,St.mod)(a*wb,r),w=l===e,A=l===(0,St.mod)(-e,r),_=l===(0,St.mod)(-e*wb,r);return w&&(a=f),(A||_)&&(a=p),(0,St.isNegativeLE)(a,r)&&(a=(0,St.mod)(-a,r)),{isValid:w||A,value:a}}i(Eb,"uvRatio");var fe=(0,St.Field)(yl.p,{isLE:!0}),oM=(0,St.Field)(yl.n,{isLE:!0}),_b={...yl,Fp:fe,hash:gl.sha512,adjustScalarBytes:nM,uvRatio:Eb};Ue.ed25519=(0,Wh.twistedEdwards)(_b);function iM(e,t,r){if(t.length>255)throw new Error("Context is too big");return(0,zh.concatBytes)((0,zh.utf8ToBytes)("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,t.length]),t,e)}i(iM,"ed25519_domain");Ue.ed25519ctx=(0,Wh.twistedEdwards)({..._b,domain:iM});Ue.ed25519ph=(0,Wh.twistedEdwards)(Object.assign({},_b,{domain:iM,prehash:gl.sha512}));Ue.x25519=(()=>{let e=fe.ORDER;return(0,hO.montgomery)({P:e,type:"x25519",powPminus2:i(t=>{let{pow_p_5_8:r,b2:n}=rM(t);return(0,St.mod)((0,St.pow2)(r,eM,e)*n,e)},"powPminus2"),adjustScalarBytes:nM})})();var mO=(Fi+eM)/Ab,gO=fe.pow(Fh,mO),J_=fe.sqrt(fe.neg(fe.ONE));function yO(e){let t=(Fi-tM)/Ab,r=BigInt(486662),n=fe.sqr(e);n=fe.mul(n,Fh);let o=fe.add(n,fe.ONE),s=fe.neg(r),a=fe.sqr(o),l=fe.mul(a,o),f=fe.mul(n,r);f=fe.mul(f,s),f=fe.add(f,a),f=fe.mul(f,s);let p=fe.sqr(l);a=fe.sqr(p),p=fe.mul(p,l),p=fe.mul(p,f),a=fe.mul(a,p);let w=fe.pow(a,t);w=fe.mul(w,p);let A=fe.mul(w,J_);a=fe.sqr(w),a=fe.mul(a,l);let _=fe.eql(a,f),T=fe.cmov(A,w,_),B=fe.mul(s,n),P=fe.mul(w,e);P=fe.mul(P,gO);let C=fe.mul(P,J_),O=fe.mul(f,n);a=fe.sqr(P),a=fe.mul(a,l);let L=fe.eql(a,O),R=fe.cmov(C,P,L);a=fe.sqr(T),a=fe.mul(a,l);let j=fe.eql(a,f),Z=fe.cmov(B,s,j),X=fe.cmov(R,T,j),Q=fe.isOdd(X);return X=fe.cmov(X,fe.neg(X),j!==Q),{xMn:Z,xMd:o,yMn:X,yMd:Yo}}i(yO,"map_to_curve_elligator2_curve25519");var bO=(0,St.FpSqrtEven)(fe,fe.neg(BigInt(486664)));function vO(e){let{xMn:t,xMd:r,yMn:n,yMd:o}=yO(e),s=fe.mul(t,o);s=fe.mul(s,bO);let a=fe.mul(r,n),l=fe.sub(t,r),f=fe.add(t,r),p=fe.mul(a,f),w=fe.eql(p,fe.ZERO);s=fe.cmov(s,fe.ZERO,w),a=fe.cmov(a,fe.ONE,w),l=fe.cmov(l,fe.ONE,w),f=fe.cmov(f,fe.ONE,w);let[A,_]=(0,St.FpInvertBatch)(fe,[a,f],!0);return{x:fe.mul(s,A),y:fe.mul(l,_)}}i(vO,"map_to_curve_elligator2_edwards25519");Ue.ed25519_hasher=(0,jh.createHasher)(Ue.ed25519.Point,e=>vO(e[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:Fi,m:1,k:128,expand:"xmd",hash:gl.sha512});var xb=wb,wO=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),xO=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),SO=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),AO=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),X_=i(e=>Eb(Yo,e),"invertSqrt"),EO=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Sb=i(e=>Ue.ed25519.Point.Fp.create((0,Ma.bytesToNumberLE)(e)&EO),"bytes255ToNumberLE");function Q_(e){let{d:t}=yl,r=Fi,n=i(O=>fe.create(O),"mod"),o=n(xb*e*e),s=n((o+Yo)*SO),a=BigInt(-1),l=n((a-t*o)*n(o+t)),{isValid:f,value:p}=Eb(s,l),w=n(p*e);(0,St.isNegativeLE)(w,r)||(w=n(-w)),f||(p=w),f||(a=o);let A=n(a*(o-Yo)*AO-l),_=p*p,T=n((p+p)*l),B=n(A*wO),P=n(Yo-_),C=n(Yo+_);return new Ue.ed25519.Point(n(T*C),n(P*B),n(B*C),n(T*P))}i(Q_,"calcElligatorRistrettoMap");function sM(e){(0,zh.abytes)(e,64);let t=Sb(e.subarray(0,32)),r=Q_(t),n=Sb(e.subarray(32,64)),o=Q_(n);return new mo(r.add(o))}i(sM,"ristretto255_map");var mo=class e extends Wh.PrimeEdwardsPoint{static{i(this,"_RistrettoPoint")}constructor(t){super(t)}static fromAffine(t){return new e(Ue.ed25519.Point.fromAffine(t))}assertSame(t){if(!(t instanceof e))throw new Error("RistrettoPoint expected")}init(t){return new e(t)}static hashToCurve(t){return sM((0,Ma.ensureBytes)("ristrettoHash",t,64))}static fromBytes(t){(0,zh.abytes)(t,32);let{a:r,d:n}=yl,o=Fi,s=i(j=>fe.create(j),"mod"),a=Sb(t);if(!(0,Ma.equalBytes)(fe.toBytes(a),t)||(0,St.isNegativeLE)(a,o))throw new Error("invalid ristretto255 encoding 1");let l=s(a*a),f=s(Yo+r*l),p=s(Yo-r*l),w=s(f*f),A=s(p*p),_=s(r*n*w-A),{isValid:T,value:B}=X_(s(_*A)),P=s(B*p),C=s(B*P*_),O=s((a+a)*P);(0,St.isNegativeLE)(O,o)&&(O=s(-O));let L=s(f*C),R=s(O*L);if(!T||(0,St.isNegativeLE)(R,o)||L===pO)throw new Error("invalid ristretto255 encoding 2");return new e(new Ue.ed25519.Point(O,L,Yo,R))}static fromHex(t){return e.fromBytes((0,Ma.ensureBytes)("ristrettoHex",t,32))}static msm(t,r){return(0,dO.pippenger)(e,Ue.ed25519.Point.Fn,t,r)}toBytes(){let{X:t,Y:r,Z:n,T:o}=this.ep,s=Fi,a=i(C=>fe.create(C),"mod"),l=a(a(n+r)*a(n-r)),f=a(t*r),p=a(f*f),{value:w}=X_(a(l*p)),A=a(w*l),_=a(w*f),T=a(A*_*o),B;if((0,St.isNegativeLE)(o*T,s)){let C=a(r*xb),O=a(t*xb);t=C,r=O,B=a(A*xO)}else B=_;(0,St.isNegativeLE)(t*T,s)&&(r=a(-r));let P=a((n-r)*B);return(0,St.isNegativeLE)(P,s)&&(P=a(-P)),fe.toBytes(P)}equals(t){this.assertSame(t);let{X:r,Y:n}=this.ep,{X:o,Y:s}=t.ep,a=i(p=>fe.create(p),"mod"),l=a(r*s)===a(n*o),f=a(n*s)===a(r*o);return l||f}is0(){return this.equals(e.ZERO)}};mo.BASE=new mo(Ue.ed25519.Point.BASE);mo.ZERO=new mo(Ue.ed25519.Point.ZERO);mo.Fp=fe;mo.Fn=oM;Ue.ristretto255={Point:mo};Ue.ristretto255_hasher={hashToCurve(e,t){let r=t?.DST||"ristretto255_XMD:SHA-512_R255MAP_RO_",n=(0,jh.expand_message_xmd)(e,r,64,gl.sha512);return sM(n)},hashToScalar(e,t={DST:jh._DST_scalar}){let r=(0,jh.expand_message_xmd)(e,t.DST,64,gl.sha512);return oM.create((0,Ma.bytesToNumberLE)(r))}};Ue.ED25519_TORSION_SUBGROUP=["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"];function aM(e){return Ue.ed25519.utils.toMontgomery((0,Ma.ensureBytes)("pub",e))}i(aM,"edwardsToMontgomeryPub");Ue.edwardsToMontgomery=aM;function _O(e){return Ue.ed25519.utils.toMontgomerySecret((0,Ma.ensureBytes)("pub",e))}i(_O,"edwardsToMontgomeryPriv");Ue.RistrettoPoint=mo;Ue.hashToCurve=Ue.ed25519_hasher.hashToCurve;Ue.encodeToCurve=Ue.ed25519_hasher.encodeToCurve;Ue.hashToRistretto255=Ue.ristretto255_hasher.hashToCurve;Ue.hash_to_ristretto255=Ue.ristretto255_hasher.hashToCurve});var Mb=ae(Ta=>{"use strict";m();g();Object.defineProperty(Ta,"__esModule",{value:!0});Ta.hmac=Ta.HMAC=void 0;var Ia=Fo(),bl=class extends Ia.Hash{static{i(this,"HMAC")}constructor(t,r){super(),this.finished=!1,this.destroyed=!1,(0,Ia.ahash)(t);let n=(0,Ia.toBytes)(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,s=new Uint8Array(o);s.set(n.length>o?t.create().update(n).digest():n);for(let a=0;a<s.length;a++)s[a]^=54;this.iHash.update(s),this.oHash=t.create();for(let a=0;a<s.length;a++)s[a]^=106;this.oHash.update(s),(0,Ia.clean)(s)}update(t){return(0,Ia.aexists)(this),this.iHash.update(t),this}digestInto(t){(0,Ia.aexists)(this),(0,Ia.abytes)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:o,destroyed:s,blockLen:a,outputLen:l}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=a,t.outputLen=l,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};Ta.HMAC=bl;var MO=i((e,t,r)=>new bl(e,t).update(r).digest(),"hmac");Ta.hmac=MO;Ta.hmac.create=(e,t)=>new bl(e,t)});var Pb=ae(Bt=>{"use strict";m();g();Object.defineProperty(Bt,"__esModule",{value:!0});Bt.DER=Bt.DERErr=void 0;Bt._splitEndoScalar=lM;Bt._normFnElement=Rs;Bt.weierstrassN=kb;Bt.SWUFpSqrtRatio=dM;Bt.mapToCurveSimpleSWU=BO;Bt.ecdh=pM;Bt.ecdsa=mM;Bt.weierstrassPoints=kO;Bt._legacyHelperEquat=yM;Bt.weierstrass=KO;var IO=Mb(),TO=Fo(),we=zi(),Wi=Vh(),zc=Cs(),uM=i((e,t)=>(e+(e>=0?t:-t)/Jo)/t,"divNearest");function lM(e,t,r){let[[n,o],[s,a]]=t,l=uM(a*e,r),f=uM(-o*e,r),p=e-l*n-f*s,w=-l*o-f*a,A=p<go,_=w<go;A&&(p=-p),_&&(w=-w);let T=(0,we.bitMask)(Math.ceil((0,we.bitLen)(r)/2))+gr;if(p<go||p>=T||w<go||w>=T)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:A,k1:p,k2neg:_,k2:w}}i(lM,"_splitEndoScalar");function Tb(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}i(Tb,"validateSigFormat");function Ib(e,t){let r={};for(let n of Object.keys(t))r[n]=e[n]===void 0?t[n]:e[n];return(0,we._abool2)(r.lowS,"lowS"),(0,we._abool2)(r.prehash,"prehash"),r.format!==void 0&&Tb(r.format),r}i(Ib,"validateSigOpts");var $h=class extends Error{static{i(this,"DERErr")}constructor(t=""){super(t)}};Bt.DERErr=$h;Bt.DER={Err:$h,_tlv:{encode:i((e,t)=>{let{Err:r}=Bt.DER;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length&1)throw new r("tlv.encode: unpadded data");let n=t.length/2,o=(0,we.numberToHexUnpadded)(n);if(o.length/2&128)throw new r("tlv.encode: long form length too big");let s=n>127?(0,we.numberToHexUnpadded)(o.length/2|128):"";return(0,we.numberToHexUnpadded)(e)+s+o+t},"encode"),decode(e,t){let{Err:r}=Bt.DER,n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");let o=t[n++],s=!!(o&128),a=0;if(!s)a=o;else{let f=o&127;if(!f)throw new r("tlv.decode(long): indefinite length not supported");if(f>4)throw new r("tlv.decode(long): byte length is too big");let p=t.subarray(n,n+f);if(p.length!==f)throw new r("tlv.decode: length bytes not complete");if(p[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(let w of p)a=a<<8|w;if(n+=f,a<128)throw new r("tlv.decode(long): not minimal encoding")}let l=t.subarray(n,n+a);if(l.length!==a)throw new r("tlv.decode: wrong value length");return{v:l,l:t.subarray(n+a)}}},_int:{encode(e){let{Err:t}=Bt.DER;if(e<go)throw new t("integer: negative integers are not allowed");let r=(0,we.numberToHexUnpadded)(e);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){let{Err:t}=Bt.DER;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return(0,we.bytesToNumberBE)(e)}},toSig(e){let{Err:t,_int:r,_tlv:n}=Bt.DER,o=(0,we.ensureBytes)("signature",e),{v:s,l:a}=n.decode(48,o);if(a.length)throw new t("invalid signature: left bytes after parsing");let{v:l,l:f}=n.decode(2,s),{v:p,l:w}=n.decode(2,f);if(w.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(l),s:r.decode(p)}},hexFromSig(e){let{_tlv:t,_int:r}=Bt.DER,n=t.encode(2,r.encode(e.r)),o=t.encode(2,r.encode(e.s)),s=n+o;return t.encode(48,s)}};var go=BigInt(0),gr=BigInt(1),Jo=BigInt(2),jc=BigInt(3),Bb=BigInt(4);function Rs(e,t){let{BYTES:r}=e,n;if(typeof t=="bigint")n=t;else{let o=(0,we.ensureBytes)("private key",t);try{n=e.fromBytes(o)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof t}`)}}if(!e.isValidNot0(n))throw new Error("invalid private key: out of range [1..N-1]");return n}i(Rs,"_normFnElement");function kb(e,t={}){let r=(0,Wi._createCurveFields)("weierstrass",e,t),{Fp:n,Fn:o}=r,s=r.CURVE,{h:a,n:l}=s;(0,we._validateObject)(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:f}=t;if(f&&(!n.is0(s.a)||typeof f.beta!="bigint"||!Array.isArray(f.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');let p=hM(n,o);function w(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}i(w,"assertCompressionIsSupported");function A(d,h,y){let{x:b,y:M}=h.toAffine(),I=n.toBytes(b);if((0,we._abool2)(y,"isCompressed"),y){w();let x=!n.isOdd(M);return(0,we.concatBytes)(fM(x),I)}else return(0,we.concatBytes)(Uint8Array.of(4),I,n.toBytes(M))}i(A,"pointToBytes");function _(d){(0,we._abytes2)(d,void 0,"Point");let{publicKey:h,publicKeyUncompressed:y}=p,b=d.length,M=d[0],I=d.subarray(1);if(b===h&&(M===2||M===3)){let x=n.fromBytes(I);if(!n.isValid(x))throw new Error("bad point: is not on curve, wrong x");let u=P(x),S;try{S=n.sqrt(u)}catch(F){let ee=F instanceof Error?": "+F.message:"";throw new Error("bad point: is not on curve, sqrt error"+ee)}w();let V=n.isOdd(S);return(M&1)===1!==V&&(S=n.neg(S)),{x,y:S}}else if(b===y&&M===4){let x=n.BYTES,u=n.fromBytes(I.subarray(0,x)),S=n.fromBytes(I.subarray(x,x*2));if(!C(u,S))throw new Error("bad point: is not on curve");return{x:u,y:S}}else throw new Error(`bad point: got length ${b}, expected compressed=${h} or uncompressed=${y}`)}i(_,"pointFromBytes");let T=t.toBytes||A,B=t.fromBytes||_;function P(d){let h=n.sqr(d),y=n.mul(h,d);return n.add(n.add(y,n.mul(d,s.a)),s.b)}i(P,"weierstrassEquation");function C(d,h){let y=n.sqr(h),b=P(d);return n.eql(y,b)}if(i(C,"isValidXY"),!C(s.Gx,s.Gy))throw new Error("bad curve params: generator point");let O=n.mul(n.pow(s.a,jc),Bb),L=n.mul(n.sqr(s.b),BigInt(27));if(n.is0(n.add(O,L)))throw new Error("bad curve params: a or b");function R(d,h,y=!1){if(!n.isValid(h)||y&&n.is0(h))throw new Error(`bad point coordinate ${d}`);return h}i(R,"acoord");function j(d){if(!(d instanceof H))throw new Error("ProjectivePoint expected")}i(j,"aprjpoint");function Z(d){if(!f||!f.basises)throw new Error("no endo");return lM(d,f.basises,o.ORDER)}i(Z,"splitEndoScalarN");let X=(0,we.memoized)((d,h)=>{let{X:y,Y:b,Z:M}=d;if(n.eql(M,n.ONE))return{x:y,y:b};let I=d.is0();h==null&&(h=I?n.ONE:n.inv(M));let x=n.mul(y,h),u=n.mul(b,h),S=n.mul(M,h);if(I)return{x:n.ZERO,y:n.ZERO};if(!n.eql(S,n.ONE))throw new Error("invZ was invalid");return{x,y:u}}),Q=(0,we.memoized)(d=>{if(d.is0()){if(t.allowInfinityPoint&&!n.is0(d.Y))return;throw new Error("bad point: ZERO")}let{x:h,y}=d.toAffine();if(!n.isValid(h)||!n.isValid(y))throw new Error("bad point: x or y not field elements");if(!C(h,y))throw new Error("bad point: equation left != right");if(!d.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function z(d,h,y,b,M){return y=new H(n.mul(y.X,d),y.Y,y.Z),h=(0,Wi.negateCt)(b,h),y=(0,Wi.negateCt)(M,y),h.add(y)}i(z,"finishEndo");class H{static{i(this,"Point")}constructor(h,y,b){this.X=R("x",h),this.Y=R("y",y,!0),this.Z=R("z",b),Object.freeze(this)}static CURVE(){return s}static fromAffine(h){let{x:y,y:b}=h||{};if(!h||!n.isValid(y)||!n.isValid(b))throw new Error("invalid affine point");if(h instanceof H)throw new Error("projective point not allowed");return n.is0(y)&&n.is0(b)?H.ZERO:new H(y,b,n.ONE)}static fromBytes(h){let y=H.fromAffine(B((0,we._abytes2)(h,void 0,"point")));return y.assertValidity(),y}static fromHex(h){return H.fromBytes((0,we.ensureBytes)("pointHex",h))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(h=8,y=!0){return c.createCache(this,h),y||this.multiply(jc),this}assertValidity(){Q(this)}hasEvenY(){let{y:h}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(h)}equals(h){j(h);let{X:y,Y:b,Z:M}=this,{X:I,Y:x,Z:u}=h,S=n.eql(n.mul(y,u),n.mul(I,M)),V=n.eql(n.mul(b,u),n.mul(x,M));return S&&V}negate(){return new H(this.X,n.neg(this.Y),this.Z)}double(){let{a:h,b:y}=s,b=n.mul(y,jc),{X:M,Y:I,Z:x}=this,u=n.ZERO,S=n.ZERO,V=n.ZERO,q=n.mul(M,M),F=n.mul(I,I),ee=n.mul(x,x),ie=n.mul(M,I);return ie=n.add(ie,ie),V=n.mul(M,x),V=n.add(V,V),u=n.mul(h,V),S=n.mul(b,ee),S=n.add(u,S),u=n.sub(F,S),S=n.add(F,S),S=n.mul(u,S),u=n.mul(ie,u),V=n.mul(b,V),ee=n.mul(h,ee),ie=n.sub(q,ee),ie=n.mul(h,ie),ie=n.add(ie,V),V=n.add(q,q),q=n.add(V,q),q=n.add(q,ee),q=n.mul(q,ie),S=n.add(S,q),ee=n.mul(I,x),ee=n.add(ee,ee),q=n.mul(ee,ie),u=n.sub(u,q),V=n.mul(ee,F),V=n.add(V,V),V=n.add(V,V),new H(u,S,V)}add(h){j(h);let{X:y,Y:b,Z:M}=this,{X:I,Y:x,Z:u}=h,S=n.ZERO,V=n.ZERO,q=n.ZERO,F=s.a,ee=n.mul(s.b,jc),ie=n.mul(y,I),ce=n.mul(b,x),ye=n.mul(M,u),ue=n.add(y,b),N=n.add(I,x);ue=n.mul(ue,N),N=n.add(ie,ce),ue=n.sub(ue,N),N=n.add(y,M);let G=n.add(I,u);return N=n.mul(N,G),G=n.add(ie,ye),N=n.sub(N,G),G=n.add(b,M),S=n.add(x,u),G=n.mul(G,S),S=n.add(ce,ye),G=n.sub(G,S),q=n.mul(F,N),S=n.mul(ee,ye),q=n.add(S,q),S=n.sub(ce,q),q=n.add(ce,q),V=n.mul(S,q),ce=n.add(ie,ie),ce=n.add(ce,ie),ye=n.mul(F,ye),N=n.mul(ee,N),ce=n.add(ce,ye),ye=n.sub(ie,ye),ye=n.mul(F,ye),N=n.add(N,ye),ie=n.mul(ce,N),V=n.add(V,ie),ie=n.mul(G,N),S=n.mul(ue,S),S=n.sub(S,ie),ie=n.mul(ue,ce),q=n.mul(G,q),q=n.add(q,ie),new H(S,V,q)}subtract(h){return this.add(h.negate())}is0(){return this.equals(H.ZERO)}multiply(h){let{endo:y}=t;if(!o.isValidNot0(h))throw new Error("invalid scalar: out of range");let b,M,I=i(x=>c.cached(this,x,u=>(0,Wi.normalizeZ)(H,u)),"mul");if(y){let{k1neg:x,k1:u,k2neg:S,k2:V}=Z(h),{p:q,f:F}=I(u),{p:ee,f:ie}=I(V);M=F.add(ie),b=z(y.beta,q,ee,x,S)}else{let{p:x,f:u}=I(h);b=x,M=u}return(0,Wi.normalizeZ)(H,[b,M])[0]}multiplyUnsafe(h){let{endo:y}=t,b=this;if(!o.isValid(h))throw new Error("invalid scalar: out of range");if(h===go||b.is0())return H.ZERO;if(h===gr)return b;if(c.hasCache(this))return this.multiply(h);if(y){let{k1neg:M,k1:I,k2neg:x,k2:u}=Z(h),{p1:S,p2:V}=(0,Wi.mulEndoUnsafe)(H,b,I,u);return z(y.beta,S,V,M,x)}else return c.unsafe(b,h)}multiplyAndAddUnsafe(h,y,b){let M=this.multiplyUnsafe(y).add(h.multiplyUnsafe(b));return M.is0()?void 0:M}toAffine(h){return X(this,h)}isTorsionFree(){let{isTorsionFree:h}=t;return a===gr?!0:h?h(H,this):c.unsafe(this,l).is0()}clearCofactor(){let{clearCofactor:h}=t;return a===gr?this:h?h(H,this):this.multiplyUnsafe(a)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}toBytes(h=!0){return(0,we._abool2)(h,"isCompressed"),this.assertValidity(),T(H,this,h)}toHex(h=!0){return(0,we.bytesToHex)(this.toBytes(h))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(h=!0){return this.toBytes(h)}_setWindowSize(h){this.precompute(h)}static normalizeZ(h){return(0,Wi.normalizeZ)(H,h)}static msm(h,y){return(0,Wi.pippenger)(H,o,h,y)}static fromPrivateKey(h){return H.BASE.multiply(Rs(o,h))}}H.BASE=new H(s.Gx,s.Gy,n.ONE),H.ZERO=new H(n.ZERO,n.ONE,n.ZERO),H.Fp=n,H.Fn=o;let E=o.BITS,c=new Wi.wNAF(H,t.endo?Math.ceil(E/2):E);return H.BASE.precompute(8),H}i(kb,"weierstrassN");function fM(e){return Uint8Array.of(e?2:3)}i(fM,"pprefix");function dM(e,t){let r=e.ORDER,n=go;for(let B=r-gr;B%Jo===go;B/=Jo)n+=gr;let o=n,s=Jo<<o-gr-gr,a=s*Jo,l=(r-gr)/a,f=(l-gr)/Jo,p=a-gr,w=s,A=e.pow(t,l),_=e.pow(t,(l+gr)/Jo),T=i((B,P)=>{let C=A,O=e.pow(P,p),L=e.sqr(O);L=e.mul(L,P);let R=e.mul(B,L);R=e.pow(R,f),R=e.mul(R,O),O=e.mul(R,P),L=e.mul(R,B);let j=e.mul(L,O);R=e.pow(j,w);let Z=e.eql(R,e.ONE);O=e.mul(L,_),R=e.mul(j,C),L=e.cmov(O,L,Z),j=e.cmov(R,j,Z);for(let X=o;X>gr;X--){let Q=X-Jo;Q=Jo<<Q-gr;let z=e.pow(j,Q),H=e.eql(z,e.ONE);O=e.mul(L,C),C=e.mul(C,C),z=e.mul(j,C),L=e.cmov(O,L,H),j=e.cmov(z,j,H)}return{isValid:Z,value:L}},"sqrtRatio");if(e.ORDER%Bb===jc){let B=(e.ORDER-jc)/Bb,P=e.sqrt(e.neg(t));T=i((C,O)=>{let L=e.sqr(O),R=e.mul(C,O);L=e.mul(L,R);let j=e.pow(L,B);j=e.mul(j,R);let Z=e.mul(j,P),X=e.mul(e.sqr(j),O),Q=e.eql(X,C),z=e.cmov(Z,j,Q);return{isValid:Q,value:z}},"sqrtRatio")}return T}i(dM,"SWUFpSqrtRatio");function BO(e,t){(0,zc.validateField)(e);let{A:r,B:n,Z:o}=t;if(!e.isValid(r)||!e.isValid(n)||!e.isValid(o))throw new Error("mapToCurveSimpleSWU: invalid opts");let s=dM(e,o);if(!e.isOdd)throw new Error("Field does not have .isOdd()");return a=>{let l,f,p,w,A,_,T,B;l=e.sqr(a),l=e.mul(l,o),f=e.sqr(l),f=e.add(f,l),p=e.add(f,e.ONE),p=e.mul(p,n),w=e.cmov(o,e.neg(f),!e.eql(f,e.ZERO)),w=e.mul(w,r),f=e.sqr(p),_=e.sqr(w),A=e.mul(_,r),f=e.add(f,A),f=e.mul(f,p),_=e.mul(_,w),A=e.mul(_,n),f=e.add(f,A),T=e.mul(l,p);let{isValid:P,value:C}=s(f,_);B=e.mul(l,a),B=e.mul(B,C),T=e.cmov(T,p,P),B=e.cmov(B,C,P);let O=e.isOdd(a)===e.isOdd(B);B=e.cmov(e.neg(B),B,O);let L=(0,zc.FpInvertBatch)(e,[w],!0)[0];return T=e.mul(T,L),{x:T,y:B}}}i(BO,"mapToCurveSimpleSWU");function hM(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}i(hM,"getWLengths");function pM(e,t={}){let{Fn:r}=e,n=t.randomBytes||we.randomBytes,o=Object.assign(hM(e.Fp,r),{seed:(0,zc.getMinHashLength)(r.ORDER)});function s(T){try{return!!Rs(r,T)}catch{return!1}}i(s,"isValidSecretKey");function a(T,B){let{publicKey:P,publicKeyUncompressed:C}=o;try{let O=T.length;return B===!0&&O!==P||B===!1&&O!==C?!1:!!e.fromBytes(T)}catch{return!1}}i(a,"isValidPublicKey");function l(T=n(o.seed)){return(0,zc.mapHashToField)((0,we._abytes2)(T,o.seed,"seed"),r.ORDER)}i(l,"randomSecretKey");function f(T,B=!0){return e.BASE.multiply(Rs(r,T)).toBytes(B)}i(f,"getPublicKey");function p(T){let B=l(T);return{secretKey:B,publicKey:f(B)}}i(p,"keygen");function w(T){if(typeof T=="bigint")return!1;if(T instanceof e)return!0;let{secretKey:B,publicKey:P,publicKeyUncompressed:C}=o;if(r.allowedLengths||B===P)return;let O=(0,we.ensureBytes)("key",T).length;return O===P||O===C}i(w,"isProbPub");function A(T,B,P=!0){if(w(T)===!0)throw new Error("first arg must be private key");if(w(B)===!1)throw new Error("second arg must be public key");let C=Rs(r,T);return e.fromHex(B).multiply(C).toBytes(P)}return i(A,"getSharedSecret"),Object.freeze({getPublicKey:f,getSharedSecret:A,keygen:p,Point:e,utils:{isValidSecretKey:s,isValidPublicKey:a,randomSecretKey:l,isValidPrivateKey:s,randomPrivateKey:l,normPrivateKeyToScalar:i(T=>Rs(r,T),"normPrivateKeyToScalar"),precompute(T=8,B=e.BASE){return B.precompute(T,!1)}},lengths:o})}i(pM,"ecdh");function mM(e,t,r={}){(0,TO.ahash)(t),(0,we._validateObject)(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let n=r.randomBytes||we.randomBytes,o=r.hmac||((y,...b)=>(0,IO.hmac)(t,y,(0,we.concatBytes)(...b))),{Fp:s,Fn:a}=e,{ORDER:l,BITS:f}=a,{keygen:p,getPublicKey:w,getSharedSecret:A,utils:_,lengths:T}=pM(e,r),B={prehash:!1,lowS:typeof r.lowS=="boolean"?r.lowS:!1,format:void 0,extraEntropy:!1},P="compact";function C(y){let b=l>>gr;return y>b}i(C,"isBiggerThanHalfOrder");function O(y,b){if(!a.isValidNot0(b))throw new Error(`invalid signature ${y}: out of range 1..Point.Fn.ORDER`);return b}i(O,"validateRS");function L(y,b){Tb(b);let M=T.signature,I=b==="compact"?M:b==="recovered"?M+1:void 0;return(0,we._abytes2)(y,I,`${b} signature`)}i(L,"validateSigLength");class R{static{i(this,"Signature")}constructor(b,M,I){this.r=O("r",b),this.s=O("s",M),I!=null&&(this.recovery=I),Object.freeze(this)}static fromBytes(b,M=P){L(b,M);let I;if(M==="der"){let{r:V,s:q}=Bt.DER.toSig((0,we._abytes2)(b));return new R(V,q)}M==="recovered"&&(I=b[0],M="compact",b=b.subarray(1));let x=a.BYTES,u=b.subarray(0,x),S=b.subarray(x,x*2);return new R(a.fromBytes(u),a.fromBytes(S),I)}static fromHex(b,M){return this.fromBytes((0,we.hexToBytes)(b),M)}addRecoveryBit(b){return new R(this.r,this.s,b)}recoverPublicKey(b){let M=s.ORDER,{r:I,s:x,recovery:u}=this;if(u==null||![0,1,2,3].includes(u))throw new Error("recovery id invalid");if(l*Jo<M&&u>1)throw new Error("recovery id is ambiguous for h>1 curve");let V=u===2||u===3?I+l:I;if(!s.isValid(V))throw new Error("recovery id 2 or 3 invalid");let q=s.toBytes(V),F=e.fromBytes((0,we.concatBytes)(fM((u&1)===0),q)),ee=a.inv(V),ie=Z((0,we.ensureBytes)("msgHash",b)),ce=a.create(-ie*ee),ye=a.create(x*ee),ue=e.BASE.multiplyUnsafe(ce).add(F.multiplyUnsafe(ye));if(ue.is0())throw new Error("point at infinify");return ue.assertValidity(),ue}hasHighS(){return C(this.s)}toBytes(b=P){if(Tb(b),b==="der")return(0,we.hexToBytes)(Bt.DER.hexFromSig(this));let M=a.toBytes(this.r),I=a.toBytes(this.s);if(b==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return(0,we.concatBytes)(Uint8Array.of(this.recovery),M,I)}return(0,we.concatBytes)(M,I)}toHex(b){return(0,we.bytesToHex)(this.toBytes(b))}assertValidity(){}static fromCompact(b){return R.fromBytes((0,we.ensureBytes)("sig",b),"compact")}static fromDER(b){return R.fromBytes((0,we.ensureBytes)("sig",b),"der")}normalizeS(){return this.hasHighS()?new R(this.r,a.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return(0,we.bytesToHex)(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return(0,we.bytesToHex)(this.toBytes("compact"))}}let j=r.bits2int||i(function(b){if(b.length>8192)throw new Error("input is too large");let M=(0,we.bytesToNumberBE)(b),I=b.length*8-f;return I>0?M>>BigInt(I):M},"bits2int_def"),Z=r.bits2int_modN||i(function(b){return a.create(j(b))},"bits2int_modN_def"),X=(0,we.bitMask)(f);function Q(y){return(0,we.aInRange)("num < 2^"+f,y,go,X),a.toBytes(y)}i(Q,"int2octets");function z(y,b){return(0,we._abytes2)(y,void 0,"message"),b?(0,we._abytes2)(t(y),void 0,"prehashed message"):y}i(z,"validateMsgAndHash");function H(y,b,M){if(["recovered","canonical"].some(ce=>ce in M))throw new Error("sign() legacy options not supported");let{lowS:I,prehash:x,extraEntropy:u}=Ib(M,B);y=z(y,x);let S=Z(y),V=Rs(a,b),q=[Q(V),Q(S)];if(u!=null&&u!==!1){let ce=u===!0?n(T.secretKey):u;q.push((0,we.ensureBytes)("extraEntropy",ce))}let F=(0,we.concatBytes)(...q),ee=S;function ie(ce){let ye=j(ce);if(!a.isValidNot0(ye))return;let ue=a.inv(ye),N=e.BASE.multiply(ye).toAffine(),G=a.create(N.x);if(G===go)return;let W=a.create(ue*a.create(ee+G*V));if(W===go)return;let ne=(N.x===G?0:2)|Number(N.y&gr),le=W;return I&&C(W)&&(le=a.neg(W),ne^=1),new R(G,le,ne)}return i(ie,"k2sig"),{seed:F,k2sig:ie}}i(H,"prepSig");function E(y,b,M={}){y=(0,we.ensureBytes)("message",y);let{seed:I,k2sig:x}=H(y,b,M);return(0,we.createHmacDrbg)(t.outputLen,a.BYTES,o)(I,x)}i(E,"sign");function c(y){let b,M=typeof y=="string"||(0,we.isBytes)(y),I=!M&&y!==null&&typeof y=="object"&&typeof y.r=="bigint"&&typeof y.s=="bigint";if(!M&&!I)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(I)b=new R(y.r,y.s);else if(M){try{b=R.fromBytes((0,we.ensureBytes)("sig",y),"der")}catch(x){if(!(x instanceof Bt.DER.Err))throw x}if(!b)try{b=R.fromBytes((0,we.ensureBytes)("sig",y),"compact")}catch{return!1}}return b||!1}i(c,"tryParsingSig");function d(y,b,M,I={}){let{lowS:x,prehash:u,format:S}=Ib(I,B);if(M=(0,we.ensureBytes)("publicKey",M),b=z((0,we.ensureBytes)("message",b),u),"strict"in I)throw new Error("options.strict was renamed to lowS");let V=S===void 0?c(y):R.fromBytes((0,we.ensureBytes)("sig",y),S);if(V===!1)return!1;try{let q=e.fromBytes(M);if(x&&V.hasHighS())return!1;let{r:F,s:ee}=V,ie=Z(b),ce=a.inv(ee),ye=a.create(ie*ce),ue=a.create(F*ce),N=e.BASE.multiplyUnsafe(ye).add(q.multiplyUnsafe(ue));return N.is0()?!1:a.create(N.x)===F}catch{return!1}}i(d,"verify");function h(y,b,M={}){let{prehash:I}=Ib(M,B);return b=z(b,I),R.fromBytes(y,"recovered").recoverPublicKey(b).toBytes()}return i(h,"recoverPublicKey"),Object.freeze({keygen:p,getPublicKey:w,getSharedSecret:A,utils:_,lengths:T,Point:e,sign:E,verify:d,recoverPublicKey:h,Signature:R,hash:t})}i(mM,"ecdsa");function kO(e){let{CURVE:t,curveOpts:r}=gM(e),n=kb(t,r);return CO(e,n)}i(kO,"weierstrassPoints");function gM(e){let t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r=e.Fp,n=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(a=>Math.ceil(a/2)))):void 0,o=(0,zc.Field)(t.n,{BITS:e.nBitLength,allowedLengths:n,modFromBytes:e.wrapPrivateKey}),s={Fp:r,Fn:o,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes};return{CURVE:t,curveOpts:s}}i(gM,"_weierstrass_legacy_opts_to_new");function PO(e){let{CURVE:t,curveOpts:r}=gM(e),n={hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:t,curveOpts:r,hash:e.hash,ecdsaOpts:n}}i(PO,"_ecdsa_legacy_opts_to_new");function yM(e,t,r){function n(o){let s=e.sqr(o),a=e.mul(s,o);return e.add(e.add(a,e.mul(o,t)),r)}return i(n,"weierstrassEquation"),n}i(yM,"_legacyHelperEquat");function CO(e,t){let{Fp:r,Fn:n}=t;function o(a){return(0,we.inRange)(a,gr,n.ORDER)}i(o,"isWithinCurveOrder");let s=yM(r,e.a,e.b);return Object.assign({},{CURVE:e,Point:t,ProjectivePoint:t,normPrivateKeyToScalar:i(a=>Rs(n,a),"normPrivateKeyToScalar"),weierstrassEquation:s,isWithinCurveOrder:o})}i(CO,"_weierstrass_new_output_to_legacy");function OO(e,t){let r=t.Point;return Object.assign({},t,{ProjectivePoint:r,CURVE:Object.assign({},e,(0,zc.nLength)(r.Fn.ORDER,r.Fn.BITS))})}i(OO,"_ecdsa_new_output_to_legacy");function KO(e){let{CURVE:t,curveOpts:r,hash:n,ecdsaOpts:o}=PO(e),s=kb(t,r),a=mM(s,n,o);return OO(e,a)}i(KO,"weierstrass")});var bM=ae(Gh=>{"use strict";m();g();Object.defineProperty(Gh,"__esModule",{value:!0});Gh.getHash=UO;Gh.createCurve=NO;var RO=Pb();function UO(e){return{hash:e}}i(UO,"getHash");function NO(e,t){let r=i(n=>(0,RO.weierstrass)({...e,hash:n}),"create");return{...r(t),create:r}}i(NO,"createCurve")});var TM=ae(yr=>{"use strict";m();g();Object.defineProperty(yr,"__esModule",{value:!0});yr.encodeToCurve=yr.hashToCurve=yr.secp256k1_hasher=yr.schnorr=yr.secp256k1=void 0;var Zh=Rh(),SM=Fo(),LO=bM(),AM=bb(),Ur=Cs(),EM=Pb(),ln=zi(),Fc={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},DO={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},VO=BigInt(0),vM=BigInt(1),Cb=BigInt(2);function qO(e){let t=Fc.p,r=BigInt(3),n=BigInt(6),o=BigInt(11),s=BigInt(22),a=BigInt(23),l=BigInt(44),f=BigInt(88),p=e*e*e%t,w=p*p*e%t,A=(0,Ur.pow2)(w,r,t)*w%t,_=(0,Ur.pow2)(A,r,t)*w%t,T=(0,Ur.pow2)(_,Cb,t)*p%t,B=(0,Ur.pow2)(T,o,t)*T%t,P=(0,Ur.pow2)(B,s,t)*B%t,C=(0,Ur.pow2)(P,l,t)*P%t,O=(0,Ur.pow2)(C,f,t)*C%t,L=(0,Ur.pow2)(O,l,t)*P%t,R=(0,Ur.pow2)(L,r,t)*w%t,j=(0,Ur.pow2)(R,a,t)*B%t,Z=(0,Ur.pow2)(j,n,t)*p%t,X=(0,Ur.pow2)(Z,Cb,t);if(!$i.eql($i.sqr(X),e))throw new Error("Cannot find square root");return X}i(qO,"sqrtMod");var $i=(0,Ur.Field)(Fc.p,{sqrt:qO});yr.secp256k1=(0,LO.createCurve)({...Fc,Fp:$i,lowS:!0,endo:DO},Zh.sha256);var wM={};function Yh(e,...t){let r=wM[e];if(r===void 0){let n=(0,Zh.sha256)((0,ln.utf8ToBytes)(e));r=(0,ln.concatBytes)(n,n),wM[e]=r}return(0,Zh.sha256)((0,ln.concatBytes)(r,...t))}i(Yh,"taggedHash");var Kb=i(e=>e.toBytes(!0).slice(1),"pointToBytes"),Wc=yr.secp256k1.Point,Rb=i(e=>e%Cb===VO,"hasEven");function Ob(e){let{Fn:t,BASE:r}=Wc,n=(0,EM._normFnElement)(t,e),o=r.multiply(n);return{scalar:Rb(o.y)?n:t.neg(n),bytes:Kb(o)}}i(Ob,"schnorrGetExtPubKey");function _M(e){let t=$i;if(!t.isValidNot0(e))throw new Error("invalid x: Fail if x \u2265 p");let r=t.create(e*e),n=t.create(r*e+BigInt(7)),o=t.sqrt(n);Rb(o)||(o=t.neg(o));let s=Wc.fromAffine({x:e,y:o});return s.assertValidity(),s}i(_M,"lift_x");var vl=ln.bytesToNumberBE;function MM(...e){return Wc.Fn.create(vl(Yh("BIP0340/challenge",...e)))}i(MM,"challenge");function xM(e){return Ob(e).bytes}i(xM,"schnorrGetPublicKey");function HO(e,t,r=(0,SM.randomBytes)(32)){let{Fn:n}=Wc,o=(0,ln.ensureBytes)("message",e),{bytes:s,scalar:a}=Ob(t),l=(0,ln.ensureBytes)("auxRand",r,32),f=n.toBytes(a^vl(Yh("BIP0340/aux",l))),p=Yh("BIP0340/nonce",f,s,o),{bytes:w,scalar:A}=Ob(p),_=MM(w,s,o),T=new Uint8Array(64);if(T.set(w,0),T.set(n.toBytes(n.create(A+_*a)),32),!IM(T,o,s))throw new Error("sign: Invalid signature produced");return T}i(HO,"schnorrSign");function IM(e,t,r){let{Fn:n,BASE:o}=Wc,s=(0,ln.ensureBytes)("signature",e,64),a=(0,ln.ensureBytes)("message",t),l=(0,ln.ensureBytes)("publicKey",r,32);try{let f=_M(vl(l)),p=vl(s.subarray(0,32));if(!(0,ln.inRange)(p,vM,Fc.p))return!1;let w=vl(s.subarray(32,64));if(!(0,ln.inRange)(w,vM,Fc.n))return!1;let A=MM(n.toBytes(p),Kb(f),a),_=o.multiplyUnsafe(w).add(f.multiplyUnsafe(n.neg(A))),{x:T,y:B}=_.toAffine();return!(_.is0()||!Rb(B)||T!==p)}catch{return!1}}i(IM,"schnorrVerify");yr.schnorr=(()=>{let r=i((o=(0,SM.randomBytes)(48))=>(0,Ur.mapHashToField)(o,Fc.n),"randomSecretKey");yr.secp256k1.utils.randomSecretKey;function n(o){let s=r(o);return{secretKey:s,publicKey:xM(s)}}return i(n,"keygen"),{keygen:n,getPublicKey:xM,sign:HO,verify:IM,Point:Wc,utils:{randomSecretKey:r,randomPrivateKey:r,taggedHash:Yh,lift_x:_M,pointToBytes:Kb,numberToBytesBE:ln.numberToBytesBE,bytesToNumberBE:ln.bytesToNumberBE,mod:Ur.mod},lengths:{secretKey:32,publicKey:32,publicKeyHasPrefix:!1,signature:32*2,seed:48}}})();var jO=(0,AM.isogenyMap)($i,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(t=>BigInt(t)))),zO=(0,EM.mapToCurveSimpleSWU)($i,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:$i.create(BigInt("-11"))});yr.secp256k1_hasher=(0,AM.createHasher)(yr.secp256k1.Point,e=>{let{x:t,y:r}=zO($i.create(e[0]));return jO(t,r)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:$i.ORDER,m:1,k:128,expand:"xmd",hash:Zh.sha256});yr.hashToCurve=yr.secp256k1_hasher.hashToCurve;yr.encodeToCurve=yr.secp256k1_hasher.encodeToCurve});var Ub=ae(Ba=>{"use strict";m();g();Object.defineProperty(Ba,"__esModule",{value:!0});Ba.decodeHex=Ba.remove0x=void 0;var FO=un(),WO=i(function(e){return e.startsWith("0x")||e.startsWith("0X")?e.slice(2):e},"remove0x");Ba.remove0x=WO;var $O=i(function(e){return(0,FO.hexToBytes)((0,Ba.remove0x)(e))},"decodeHex");Ba.decodeHex=$O});var PM=ae(Nr=>{"use strict";m();g();Object.defineProperty(Nr,"__esModule",{value:!0});Nr.hexToPublicKey=Nr.convertPublicKeyFormat=Nr.getSharedPoint=Nr.getPublicKey=Nr.isValidPrivateKey=Nr.getValidSecret=void 0;var GO=Zy(),BM=cM(),ZO=TM(),wl=ul(),kM=_h(),YO=Ub(),JO=i(function(e){var t;do t=(0,GO.randomBytes)(kM.SECRET_KEY_LENGTH);while(!(0,Nr.isValidPrivateKey)(t,e));return t},"getValidSecret");Nr.getValidSecret=JO;var XO=i(function(e,t){return xl(t||(0,wl.ellipticCurve)(),function(r){return r.utils.isValidPrivateKey(e)},function(){return!0},function(){return!0})},"isValidPrivateKey");Nr.isValidPrivateKey=XO;var QO=i(function(e,t){return xl(t||(0,wl.ellipticCurve)(),function(r){return r.getPublicKey(e)},function(r){return r.getPublicKey(e)},function(r){return r.getPublicKey(e)})},"getPublicKey");Nr.getPublicKey=QO;var eK=i(function(e,t,r,n){return xl(n||(0,wl.ellipticCurve)(),function(o){return o.getSharedSecret(e,t,r)},function(o){return o.getSharedSecret(e,t)},function(o){return oK(o,e,t)})},"getSharedPoint");Nr.getSharedPoint=eK;var tK=i(function(e,t,r){return xl(r||(0,wl.ellipticCurve)(),function(n){return n.getSharedSecret(BigInt(1),e,t)},function(){return e},function(){return e})},"convertPublicKeyFormat");Nr.convertPublicKeyFormat=tK;var rK=i(function(e,t){var r=(0,YO.decodeHex)(e);return xl(t||(0,wl.ellipticCurve)(),function(){return nK(r)},function(){return r},function(){return r})},"hexToPublicKey");Nr.hexToPublicKey=rK;function xl(e,t,r,n){if(e==="secp256k1")return t(ZO.secp256k1);if(e==="x25519")return r(BM.x25519);if(e==="ed25519")return n(BM.ed25519);throw new Error("Not implemented")}i(xl,"_exec");var nK=i(function(e){if(e.length===kM.ETH_PUBLIC_KEY_SIZE){var t=new Uint8Array(1+e.length);return t.set([4]),t.set(e,1),t}return e},"compatEthPublicKey"),oK=i(function(e,t,r){var n=e.utils.getExtendedPublicKey(t).scalar,o=e.ExtendedPoint.fromHex(r).multiply(n);return o.toRawBytes()},"getSharedPointOnEd25519")});var UM=ae(Gc=>{"use strict";m();g();Object.defineProperty(Gc,"__esModule",{value:!0});Gc.hkdf=void 0;Gc.extract=KM;Gc.expand=RM;var OM=Mb(),$c=Fo();function KM(e,t,r){return(0,$c.ahash)(e),r===void 0&&(r=new Uint8Array(e.outputLen)),(0,OM.hmac)(e,(0,$c.toBytes)(r),(0,$c.toBytes)(t))}i(KM,"extract");var Nb=Uint8Array.from([0]),CM=Uint8Array.of();function RM(e,t,r,n=32){(0,$c.ahash)(e),(0,$c.anumber)(n);let o=e.outputLen;if(n>255*o)throw new Error("Length should be <= 255*HashLen");let s=Math.ceil(n/o);r===void 0&&(r=CM);let a=new Uint8Array(s*o),l=OM.hmac.create(e,t),f=l._cloneInto(),p=new Uint8Array(l.outputLen);for(let w=0;w<s;w++)Nb[0]=w+1,f.update(w===0?CM:p).update(r).update(Nb).digestInto(p),a.set(p,o*w),l._cloneInto(f);return l.destroy(),f.destroy(),(0,$c.clean)(p,Nb),a.slice(0,n)}i(RM,"expand");var iK=i((e,t,r,n,o)=>RM(e,KM(e,t,r),n,o),"hkdf");Gc.hkdf=iK});var NM=ae(ka=>{"use strict";m();g();Object.defineProperty(ka,"__esModule",{value:!0});ka.getSharedKey=ka.deriveKey=void 0;var sK=un(),aK=UM(),cK=Rh(),uK=i(function(e,t,r){return(0,aK.hkdf)(cK.sha256,e,t,r,32)},"deriveKey");ka.deriveKey=uK;var lK=i(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,ka.deriveKey)(sK.concatBytes.apply(void 0,e))},"getSharedKey");ka.getSharedKey=lK});var VM=ae(Pa=>{"use strict";m();g();Object.defineProperty(Pa,"__esModule",{value:!0});Pa.polyval=Pa.ghash=void 0;Pa._toGHASHKey=LM;var Rt=un(),Gi=16,Db=new Uint8Array(16),Xo=(0,Rt.u32)(Db),fK=225,dK=i((e,t,r,n)=>{let o=n&1;return{s3:r<<31|n>>>1,s2:t<<31|r>>>1,s1:e<<31|t>>>1,s0:e>>>1^fK<<24&-(o&1)}},"mul2"),Tn=i(e=>(e>>>0&255)<<24|(e>>>8&255)<<16|(e>>>16&255)<<8|e>>>24&255|0,"swapLE");function LM(e){e.reverse();let t=e[15]&1,r=0;for(let n=0;n<e.length;n++){let o=e[n];e[n]=o>>>1|r,r=(o&1)<<7}return e[0]^=-t&225,e}i(LM,"_toGHASHKey");var hK=i(e=>e>64*1024?8:e>1024?4:2,"estimateWindow"),Jh=class{static{i(this,"GHASH")}constructor(t,r){this.blockLen=Gi,this.outputLen=Gi,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,t=(0,Rt.toBytes)(t),(0,Rt.abytes)(t,16);let n=(0,Rt.createView)(t),o=n.getUint32(0,!1),s=n.getUint32(4,!1),a=n.getUint32(8,!1),l=n.getUint32(12,!1),f=[];for(let B=0;B<128;B++)f.push({s0:Tn(o),s1:Tn(s),s2:Tn(a),s3:Tn(l)}),{s0:o,s1:s,s2:a,s3:l}=dK(o,s,a,l);let p=hK(r||1024);if(![1,2,4,8].includes(p))throw new Error("ghash: invalid window size, expected 2, 4 or 8");this.W=p;let A=128/p,_=this.windowSize=2**p,T=[];for(let B=0;B<A;B++)for(let P=0;P<_;P++){let C=0,O=0,L=0,R=0;for(let j=0;j<p;j++){if(!(P>>>p-j-1&1))continue;let{s0:X,s1:Q,s2:z,s3:H}=f[p*B+j];C^=X,O^=Q,L^=z,R^=H}T.push({s0:C,s1:O,s2:L,s3:R})}this.t=T}_updateBlock(t,r,n,o){t^=this.s0,r^=this.s1,n^=this.s2,o^=this.s3;let{W:s,t:a,windowSize:l}=this,f=0,p=0,w=0,A=0,_=(1<<s)-1,T=0;for(let B of[t,r,n,o])for(let P=0;P<4;P++){let C=B>>>8*P&255;for(let O=8/s-1;O>=0;O--){let L=C>>>s*O&_,{s0:R,s1:j,s2:Z,s3:X}=a[T*l+L];f^=R,p^=j,w^=Z,A^=X,T+=1}}this.s0=f,this.s1=p,this.s2=w,this.s3=A}update(t){(0,Rt.aexists)(this),t=(0,Rt.toBytes)(t),(0,Rt.abytes)(t);let r=(0,Rt.u32)(t),n=Math.floor(t.length/Gi),o=t.length%Gi;for(let s=0;s<n;s++)this._updateBlock(r[s*4+0],r[s*4+1],r[s*4+2],r[s*4+3]);return o&&(Db.set(t.subarray(n*Gi)),this._updateBlock(Xo[0],Xo[1],Xo[2],Xo[3]),(0,Rt.clean)(Xo)),this}destroy(){let{t}=this;for(let r of t)r.s0=0,r.s1=0,r.s2=0,r.s3=0}digestInto(t){(0,Rt.aexists)(this),(0,Rt.aoutput)(t,this),this.finished=!0;let{s0:r,s1:n,s2:o,s3:s}=this,a=(0,Rt.u32)(t);return a[0]=r,a[1]=n,a[2]=o,a[3]=s,t}digest(){let t=new Uint8Array(Gi);return this.digestInto(t),this.destroy(),t}},Lb=class extends Jh{static{i(this,"Polyval")}constructor(t,r){t=(0,Rt.toBytes)(t),(0,Rt.abytes)(t);let n=LM((0,Rt.copyBytes)(t));super(n,r),(0,Rt.clean)(n)}update(t){t=(0,Rt.toBytes)(t),(0,Rt.aexists)(this);let r=(0,Rt.u32)(t),n=t.length%Gi,o=Math.floor(t.length/Gi);for(let s=0;s<o;s++)this._updateBlock(Tn(r[s*4+3]),Tn(r[s*4+2]),Tn(r[s*4+1]),Tn(r[s*4+0]));return n&&(Db.set(t.subarray(o*Gi)),this._updateBlock(Tn(Xo[3]),Tn(Xo[2]),Tn(Xo[1]),Tn(Xo[0])),(0,Rt.clean)(Xo)),this}digestInto(t){(0,Rt.aexists)(this),(0,Rt.aoutput)(t,this),this.finished=!0;let{s0:r,s1:n,s2:o,s3:s}=this,a=(0,Rt.u32)(t);return a[0]=r,a[1]=n,a[2]=o,a[3]=s,t.reverse()}};function DM(e){let t=i((n,o)=>e(o,n.length).update((0,Rt.toBytes)(n)).digest(),"hashC"),r=e(new Uint8Array(16),0);return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=(n,o)=>e(n,o),t}i(DM,"wrapConstructorWithKey");Pa.ghash=DM((e,t)=>new Jh(e,t));Pa.polyval=DM((e,t)=>new Lb(e,t))});var e3=ae(Lt=>{"use strict";m();g();Object.defineProperty(Lt,"__esModule",{value:!0});Lt.unsafe=Lt.aeskwp=Lt.aeskw=Lt.siv=Lt.gcmsiv=Lt.gcm=Lt.cfb=Lt.cbc=Lt.ecb=Lt.ctr=void 0;var qb=VM(),re=un(),Qr=16,jb=4,Xh=new Uint8Array(Qr),pK=283;function zb(e){return e<<1^pK&-(e>>7)}i(zb,"mul2");function Zc(e,t){let r=0;for(;t>0;t>>=1)r^=e&-(t&1),e=zb(e);return r}i(Zc,"mul");var Hb=(()=>{let e=new Uint8Array(256);for(let r=0,n=1;r<256;r++,n^=zb(n))e[r]=n;let t=new Uint8Array(256);t[0]=99;for(let r=0;r<255;r++){let n=e[255-r];n|=n<<8,t[e[r]]=(n^n>>4^n>>5^n>>6^n>>7^99)&255}return(0,re.clean)(e),t})(),mK=Hb.map((e,t)=>Hb.indexOf(t)),gK=i(e=>e<<24|e>>>8,"rotr32_8"),Vb=i(e=>e<<8|e>>>24,"rotl32_8"),e0=i(e=>e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255,"byteSwap");function jM(e,t){if(e.length!==256)throw new Error("Wrong sbox length");let r=new Uint32Array(256).map((p,w)=>t(e[w])),n=r.map(Vb),o=n.map(Vb),s=o.map(Vb),a=new Uint32Array(256*256),l=new Uint32Array(256*256),f=new Uint16Array(256*256);for(let p=0;p<256;p++)for(let w=0;w<256;w++){let A=p*256+w;a[A]=r[p]^n[w],l[A]=o[p]^s[w],f[A]=e[p]<<8|e[w]}return{sbox:e,sbox2:f,T0:r,T1:n,T2:o,T3:s,T01:a,T23:l}}i(jM,"genTtable");var Fb=jM(Hb,e=>Zc(e,3)<<24|e<<16|e<<8|Zc(e,2)),zM=jM(mK,e=>Zc(e,11)<<24|Zc(e,13)<<16|Zc(e,9)<<8|Zc(e,14)),yK=(()=>{let e=new Uint8Array(16);for(let t=0,r=1;t<16;t++,r=zb(r))e[t]=r;return e})();function ei(e){(0,re.abytes)(e);let t=e.length;if(![16,24,32].includes(t))throw new Error("aes: invalid key size, should be 16, 24 or 32, got "+t);let{sbox2:r}=Fb,n=[];(0,re.isAligned32)(e)||n.push(e=(0,re.copyBytes)(e));let o=(0,re.u32)(e),s=o.length,a=i(f=>Qo(r,f,f,f,f),"subByte"),l=new Uint32Array(t+28);l.set(o);for(let f=s;f<l.length;f++){let p=l[f-1];f%s===0?p=a(gK(p))^yK[f/s-1]:s>6&&f%s===4&&(p=a(p)),l[f]=l[f-s]^p}return(0,re.clean)(...n),l}i(ei,"expandKeyLE");function r0(e){let t=ei(e),r=t.slice(),n=t.length,{sbox2:o}=Fb,{T0:s,T1:a,T2:l,T3:f}=zM;for(let p=0;p<n;p+=4)for(let w=0;w<4;w++)r[p+w]=t[n-p-4+w];(0,re.clean)(t);for(let p=4;p<n-4;p++){let w=r[p],A=Qo(o,w,w,w,w);r[p]=s[A&255]^a[A>>>8&255]^l[A>>>16&255]^f[A>>>24]}return r}i(r0,"expandKeyDecLE");function Us(e,t,r,n,o,s){return e[r<<8&65280|n>>>8&255]^t[o>>>8&65280|s>>>24&255]}i(Us,"apply0123");function Qo(e,t,r,n,o){return e[t&255|r&65280]|e[n>>>16&255|o>>>16&65280]<<16}i(Qo,"applySbox");function Lr(e,t,r,n,o){let{sbox2:s,T01:a,T23:l}=Fb,f=0;t^=e[f++],r^=e[f++],n^=e[f++],o^=e[f++];let p=e.length/4-2;for(let B=0;B<p;B++){let P=e[f++]^Us(a,l,t,r,n,o),C=e[f++]^Us(a,l,r,n,o,t),O=e[f++]^Us(a,l,n,o,t,r),L=e[f++]^Us(a,l,o,t,r,n);t=P,r=C,n=O,o=L}let w=e[f++]^Qo(s,t,r,n,o),A=e[f++]^Qo(s,r,n,o,t),_=e[f++]^Qo(s,n,o,t,r),T=e[f++]^Qo(s,o,t,r,n);return{s0:w,s1:A,s2:_,s3:T}}i(Lr,"encrypt");function Sl(e,t,r,n,o){let{sbox2:s,T01:a,T23:l}=zM,f=0;t^=e[f++],r^=e[f++],n^=e[f++],o^=e[f++];let p=e.length/4-2;for(let B=0;B<p;B++){let P=e[f++]^Us(a,l,t,o,n,r),C=e[f++]^Us(a,l,r,t,o,n),O=e[f++]^Us(a,l,n,r,t,o),L=e[f++]^Us(a,l,o,n,r,t);t=P,r=C,n=O,o=L}let w=e[f++]^Qo(s,t,o,n,r),A=e[f++]^Qo(s,r,t,o,n),_=e[f++]^Qo(s,n,r,t,o),T=e[f++]^Qo(s,o,n,r,t);return{s0:w,s1:A,s2:_,s3:T}}i(Sl,"decrypt");function FM(e,t,r,n){(0,re.abytes)(t,Qr),(0,re.abytes)(r);let o=r.length;n=(0,re.getOutput)(o,n),(0,re.complexOverlapBytes)(r,n);let s=t,a=(0,re.u32)(s),{s0:l,s1:f,s2:p,s3:w}=Lr(e,a[0],a[1],a[2],a[3]),A=(0,re.u32)(r),_=(0,re.u32)(n);for(let B=0;B+4<=A.length;B+=4){_[B+0]=A[B+0]^l,_[B+1]=A[B+1]^f,_[B+2]=A[B+2]^p,_[B+3]=A[B+3]^w;let P=1;for(let C=s.length-1;C>=0;C--)P=P+(s[C]&255)|0,s[C]=P&255,P>>>=8;({s0:l,s1:f,s2:p,s3:w}=Lr(e,a[0],a[1],a[2],a[3]))}let T=Qr*Math.floor(A.length/jb);if(T<o){let B=new Uint32Array([l,f,p,w]),P=(0,re.u8)(B);for(let C=T,O=0;C<o;C++,O++)n[C]=r[C]^P[O];(0,re.clean)(B)}return n}i(FM,"ctrCounter");function Yc(e,t,r,n,o){(0,re.abytes)(r,Qr),(0,re.abytes)(n),o=(0,re.getOutput)(n.length,o);let s=r,a=(0,re.u32)(s),l=(0,re.createView)(s),f=(0,re.u32)(n),p=(0,re.u32)(o),w=t?0:12,A=n.length,_=l.getUint32(w,t),{s0:T,s1:B,s2:P,s3:C}=Lr(e,a[0],a[1],a[2],a[3]);for(let L=0;L+4<=f.length;L+=4)p[L+0]=f[L+0]^T,p[L+1]=f[L+1]^B,p[L+2]=f[L+2]^P,p[L+3]=f[L+3]^C,_=_+1>>>0,l.setUint32(w,_,t),{s0:T,s1:B,s2:P,s3:C}=Lr(e,a[0],a[1],a[2],a[3]);let O=Qr*Math.floor(f.length/jb);if(O<A){let L=new Uint32Array([T,B,P,C]),R=(0,re.u8)(L);for(let j=O,Z=0;j<A;j++,Z++)o[j]=n[j]^R[Z];(0,re.clean)(L)}return o}i(Yc,"ctr32");Lt.ctr=(0,re.wrapCipher)({blockSize:16,nonceLength:16},i(function(t,r){function n(o,s){if((0,re.abytes)(o),s!==void 0&&((0,re.abytes)(s),!(0,re.isAligned32)(s)))throw new Error("unaligned destination");let a=ei(t),l=(0,re.copyBytes)(r),f=[a,l];(0,re.isAligned32)(o)||f.push(o=(0,re.copyBytes)(o));let p=FM(a,l,o,s);return(0,re.clean)(...f),p}return i(n,"processCtr"),{encrypt:i((o,s)=>n(o,s),"encrypt"),decrypt:i((o,s)=>n(o,s),"decrypt")}},"aesctr"));function WM(e){if((0,re.abytes)(e),e.length%Qr!==0)throw new Error("aes-(cbc/ecb).decrypt ciphertext should consist of blocks with size "+Qr)}i(WM,"validateBlockDecrypt");function $M(e,t,r){(0,re.abytes)(e);let n=e.length,o=n%Qr;if(!t&&o!==0)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");(0,re.isAligned32)(e)||(e=(0,re.copyBytes)(e));let s=(0,re.u32)(e);if(t){let l=Qr-o;l||(l=Qr),n=n+l}r=(0,re.getOutput)(n,r),(0,re.complexOverlapBytes)(e,r);let a=(0,re.u32)(r);return{b:s,o:a,out:r}}i($M,"validateBlockEncrypt");function GM(e,t){if(!t)return e;let r=e.length;if(!r)throw new Error("aes/pcks5: empty ciphertext not allowed");let n=e[r-1];if(n<=0||n>16)throw new Error("aes/pcks5: wrong padding");let o=e.subarray(0,-n);for(let s=0;s<n;s++)if(e[r-s-1]!==n)throw new Error("aes/pcks5: wrong padding");return o}i(GM,"validatePCKS");function ZM(e){let t=new Uint8Array(16),r=(0,re.u32)(t);t.set(e);let n=Qr-e.length;for(let o=Qr-n;o<Qr;o++)t[o]=n;return r}i(ZM,"padPCKS");Lt.ecb=(0,re.wrapCipher)({blockSize:16},i(function(t,r={}){let n=!r.disablePadding;return{encrypt(o,s){let{b:a,o:l,out:f}=$M(o,n,s),p=ei(t),w=0;for(;w+4<=a.length;){let{s0:A,s1:_,s2:T,s3:B}=Lr(p,a[w+0],a[w+1],a[w+2],a[w+3]);l[w++]=A,l[w++]=_,l[w++]=T,l[w++]=B}if(n){let A=ZM(o.subarray(w*4)),{s0:_,s1:T,s2:B,s3:P}=Lr(p,A[0],A[1],A[2],A[3]);l[w++]=_,l[w++]=T,l[w++]=B,l[w++]=P}return(0,re.clean)(p),f},decrypt(o,s){WM(o);let a=r0(t);s=(0,re.getOutput)(o.length,s);let l=[a];(0,re.isAligned32)(o)||l.push(o=(0,re.copyBytes)(o)),(0,re.complexOverlapBytes)(o,s);let f=(0,re.u32)(o),p=(0,re.u32)(s);for(let w=0;w+4<=f.length;){let{s0:A,s1:_,s2:T,s3:B}=Sl(a,f[w+0],f[w+1],f[w+2],f[w+3]);p[w++]=A,p[w++]=_,p[w++]=T,p[w++]=B}return(0,re.clean)(...l),GM(s,n)}}},"aesecb"));Lt.cbc=(0,re.wrapCipher)({blockSize:16,nonceLength:16},i(function(t,r,n={}){let o=!n.disablePadding;return{encrypt(s,a){let l=ei(t),{b:f,o:p,out:w}=$M(s,o,a),A=r,_=[l];(0,re.isAligned32)(A)||_.push(A=(0,re.copyBytes)(A));let T=(0,re.u32)(A),B=T[0],P=T[1],C=T[2],O=T[3],L=0;for(;L+4<=f.length;)B^=f[L+0],P^=f[L+1],C^=f[L+2],O^=f[L+3],{s0:B,s1:P,s2:C,s3:O}=Lr(l,B,P,C,O),p[L++]=B,p[L++]=P,p[L++]=C,p[L++]=O;if(o){let R=ZM(s.subarray(L*4));B^=R[0],P^=R[1],C^=R[2],O^=R[3],{s0:B,s1:P,s2:C,s3:O}=Lr(l,B,P,C,O),p[L++]=B,p[L++]=P,p[L++]=C,p[L++]=O}return(0,re.clean)(..._),w},decrypt(s,a){WM(s);let l=r0(t),f=r,p=[l];(0,re.isAligned32)(f)||p.push(f=(0,re.copyBytes)(f));let w=(0,re.u32)(f);a=(0,re.getOutput)(s.length,a),(0,re.isAligned32)(s)||p.push(s=(0,re.copyBytes)(s)),(0,re.complexOverlapBytes)(s,a);let A=(0,re.u32)(s),_=(0,re.u32)(a),T=w[0],B=w[1],P=w[2],C=w[3];for(let O=0;O+4<=A.length;){let L=T,R=B,j=P,Z=C;T=A[O+0],B=A[O+1],P=A[O+2],C=A[O+3];let{s0:X,s1:Q,s2:z,s3:H}=Sl(l,T,B,P,C);_[O++]=X^L,_[O++]=Q^R,_[O++]=z^j,_[O++]=H^Z}return(0,re.clean)(...p),GM(a,o)}}},"aescbc"));Lt.cfb=(0,re.wrapCipher)({blockSize:16,nonceLength:16},i(function(t,r){function n(o,s,a){(0,re.abytes)(o);let l=o.length;if(a=(0,re.getOutput)(l,a),(0,re.overlapBytes)(o,a))throw new Error("overlapping src and dst not supported.");let f=ei(t),p=r,w=[f];(0,re.isAligned32)(p)||w.push(p=(0,re.copyBytes)(p)),(0,re.isAligned32)(o)||w.push(o=(0,re.copyBytes)(o));let A=(0,re.u32)(o),_=(0,re.u32)(a),T=s?_:A,B=(0,re.u32)(p),P=B[0],C=B[1],O=B[2],L=B[3];for(let j=0;j+4<=A.length;){let{s0:Z,s1:X,s2:Q,s3:z}=Lr(f,P,C,O,L);_[j+0]=A[j+0]^Z,_[j+1]=A[j+1]^X,_[j+2]=A[j+2]^Q,_[j+3]=A[j+3]^z,P=T[j++],C=T[j++],O=T[j++],L=T[j++]}let R=Qr*Math.floor(A.length/jb);if(R<l){({s0:P,s1:C,s2:O,s3:L}=Lr(f,P,C,O,L));let j=(0,re.u8)(new Uint32Array([P,C,O,L]));for(let Z=R,X=0;Z<l;Z++,X++)a[Z]=o[Z]^j[X];(0,re.clean)(j)}return(0,re.clean)(...w),a}return i(n,"processCfb"),{encrypt:i((o,s)=>n(o,!0,s),"encrypt"),decrypt:i((o,s)=>n(o,!1,s),"decrypt")}},"aescfb"));function YM(e,t,r,n,o){let s=o?o.length:0,a=e.create(r,n.length+s);o&&a.update(o);let l=(0,re.u64Lengths)(8*n.length,8*s,t);a.update(n),a.update(l);let f=a.digest();return(0,re.clean)(l),f}i(YM,"computeTag");Lt.gcm=(0,re.wrapCipher)({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},i(function(t,r,n){if(r.length<8)throw new Error("aes/gcm: invalid nonce length");let o=16;function s(l,f,p){let w=YM(qb.ghash,!1,l,p,n);for(let A=0;A<f.length;A++)w[A]^=f[A];return w}i(s,"_computeTag");function a(){let l=ei(t),f=Xh.slice(),p=Xh.slice();if(Yc(l,!1,p,p,f),r.length===12)p.set(r);else{let A=Xh.slice(),_=(0,re.createView)(A);(0,re.setBigUint64)(_,8,BigInt(r.length*8),!1);let T=qb.ghash.create(f).update(r).update(A);T.digestInto(p),T.destroy()}let w=Yc(l,!1,p,Xh);return{xk:l,authKey:f,counter:p,tagMask:w}}return i(a,"deriveKeys"),{encrypt(l){let{xk:f,authKey:p,counter:w,tagMask:A}=a(),_=new Uint8Array(l.length+o),T=[f,p,w,A];(0,re.isAligned32)(l)||T.push(l=(0,re.copyBytes)(l)),Yc(f,!1,w,l,_.subarray(0,l.length));let B=s(p,A,_.subarray(0,_.length-o));return T.push(B),_.set(B,l.length),(0,re.clean)(...T),_},decrypt(l){let{xk:f,authKey:p,counter:w,tagMask:A}=a(),_=[f,p,A,w];(0,re.isAligned32)(l)||_.push(l=(0,re.copyBytes)(l));let T=l.subarray(0,-o),B=l.subarray(-o),P=s(p,A,T);if(_.push(P),!(0,re.equalBytes)(P,B))throw new Error("aes/gcm: invalid ghash tag");let C=Yc(f,!1,w,T);return(0,re.clean)(..._),C}}},"aesgcm"));var Qh=i((e,t,r)=>n=>{if(!Number.isSafeInteger(n)||t>n||n>r){let o="["+t+".."+r+"]";throw new Error(""+e+": expected value in range "+o+", got "+n)}},"limit");Lt.gcmsiv=(0,re.wrapCipher)({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},i(function(t,r,n){let s=Qh("AAD",0,68719476736),a=Qh("plaintext",0,2**36),l=Qh("nonce",12,12),f=Qh("ciphertext",16,2**36+16);(0,re.abytes)(t,16,24,32),l(r.length),n!==void 0&&s(n.length);function p(){let _=ei(t),T=new Uint8Array(t.length),B=new Uint8Array(16),P=[_,T],C=r;(0,re.isAligned32)(C)||P.push(C=(0,re.copyBytes)(C));let O=(0,re.u32)(C),L=0,R=O[0],j=O[1],Z=O[2],X=0;for(let z of[B,T].map(re.u32)){let H=(0,re.u32)(z);for(let E=0;E<H.length;E+=2){let{s0:c,s1:d}=Lr(_,L,R,j,Z);H[E+0]=c,H[E+1]=d,L=++X}}let Q={authKey:B,encKey:ei(T)};return(0,re.clean)(...P),Q}i(p,"deriveKeys");function w(_,T,B){let P=YM(qb.polyval,!0,T,B,n);for(let Z=0;Z<12;Z++)P[Z]^=r[Z];P[15]&=127;let C=(0,re.u32)(P),O=C[0],L=C[1],R=C[2],j=C[3];return{s0:O,s1:L,s2:R,s3:j}=Lr(_,O,L,R,j),C[0]=O,C[1]=L,C[2]=R,C[3]=j,P}i(w,"_computeTag");function A(_,T,B){let P=(0,re.copyBytes)(T);P[15]|=128;let C=Yc(_,!0,P,B);return(0,re.clean)(P),C}return i(A,"processSiv"),{encrypt(_){a(_.length);let{encKey:T,authKey:B}=p(),P=w(T,B,_),C=[T,B,P];(0,re.isAligned32)(_)||C.push(_=(0,re.copyBytes)(_));let O=new Uint8Array(_.length+16);return O.set(P,_.length),O.set(A(T,P,_)),(0,re.clean)(...C),O},decrypt(_){f(_.length);let T=_.subarray(-16),{encKey:B,authKey:P}=p(),C=[B,P];(0,re.isAligned32)(_)||C.push(_=(0,re.copyBytes)(_));let O=A(B,T,_.subarray(0,-16)),L=w(B,P,O);if(C.push(L),!(0,re.equalBytes)(T,L))throw(0,re.clean)(...C),new Error("invalid polyval tag");return(0,re.clean)(...C),O}}},"aessiv"));Lt.siv=Lt.gcmsiv;function JM(e){return e instanceof Uint32Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint32Array"}i(JM,"isBytes32");function XM(e,t){if((0,re.abytes)(t,16),!JM(e))throw new Error("_encryptBlock accepts result of expandKeyLE");let r=(0,re.u32)(t),{s0:n,s1:o,s2:s,s3:a}=Lr(e,r[0],r[1],r[2],r[3]);return r[0]=n,r[1]=o,r[2]=s,r[3]=a,t}i(XM,"encryptBlock");function QM(e,t){if((0,re.abytes)(t,16),!JM(e))throw new Error("_decryptBlock accepts result of expandKeyLE");let r=(0,re.u32)(t),{s0:n,s1:o,s2:s,s3:a}=Sl(e,r[0],r[1],r[2],r[3]);return r[0]=n,r[1]=o,r[2]=s,r[3]=a,t}i(QM,"decryptBlock");var t0={encrypt(e,t){if(t.length>=2**32)throw new Error("plaintext should be less than 4gb");let r=ei(e);if(t.length===16)XM(r,t);else{let n=(0,re.u32)(t),o=n[0],s=n[1];for(let a=0,l=1;a<6;a++)for(let f=2;f<n.length;f+=2,l++){let{s0:p,s1:w,s2:A,s3:_}=Lr(r,o,s,n[f],n[f+1]);o=p,s=w^e0(l),n[f]=A,n[f+1]=_}n[0]=o,n[1]=s}r.fill(0)},decrypt(e,t){if(t.length-8>=2**32)throw new Error("ciphertext should be less than 4gb");let r=r0(e),n=t.length/8-1;if(n===1)QM(r,t);else{let o=(0,re.u32)(t),s=o[0],a=o[1];for(let l=0,f=n*6;l<6;l++)for(let p=n*2;p>=1;p-=2,f--){a^=e0(f);let{s0:w,s1:A,s2:_,s3:T}=Sl(r,s,a,o[p],o[p+1]);s=w,a=A,o[p]=_,o[p+1]=T}o[0]=s,o[1]=a}r.fill(0)}},qM=new Uint8Array(8).fill(166);Lt.aeskw=(0,re.wrapCipher)({blockSize:8},e=>({encrypt(t){if(!t.length||t.length%8!==0)throw new Error("invalid plaintext length");if(t.length===8)throw new Error("8-byte keys not allowed in AESKW, use AESKWP instead");let r=(0,re.concatBytes)(qM,t);return t0.encrypt(e,r),r},decrypt(t){if(t.length%8!==0||t.length<3*8)throw new Error("invalid ciphertext length");let r=(0,re.copyBytes)(t);if(t0.decrypt(e,r),!(0,re.equalBytes)(r.subarray(0,8),qM))throw new Error("integrity check failed");return r.subarray(0,8).fill(0),r.subarray(8)}}));var HM=2790873510;Lt.aeskwp=(0,re.wrapCipher)({blockSize:8},e=>({encrypt(t){if(!t.length)throw new Error("invalid plaintext length");let r=Math.ceil(t.length/8)*8,n=new Uint8Array(8+r);n.set(t,8);let o=(0,re.u32)(n);return o[0]=HM,o[1]=e0(t.length),t0.encrypt(e,n),n},decrypt(t){if(t.length<16)throw new Error("invalid ciphertext length");let r=(0,re.copyBytes)(t),n=(0,re.u32)(r);t0.decrypt(e,r);let o=e0(n[1])>>>0,s=Math.ceil(o/8)*8;if(n[0]!==HM||r.length-8!==s)throw new Error("integrity check failed");for(let a=o;a<s;a++)if(r[8+a]!==0)throw new Error("integrity check failed");return r.subarray(0,8).fill(0),r.subarray(8,8+o)}}));Lt.unsafe={expandKeyLE:ei,expandKeyDecLE:r0,encrypt:Lr,decrypt:Sl,encryptBlock:XM,decryptBlock:QM,ctrCounter:FM,ctr32:Yc}});var r3=ae(Jc=>{"use strict";m();g();Object.defineProperty(Jc,"__esModule",{value:!0});Jc.aes256cbc=Jc.aes256gcm=void 0;var t3=e3(),bK=i(function(e,t,r){return(0,t3.gcm)(e,t,r)},"aes256gcm");Jc.aes256gcm=bK;var vK=i(function(e,t,r){return(0,t3.cbc)(e,t)},"aes256cbc");Jc.aes256cbc=vK});var s3=ae(o0=>{"use strict";m();g();Object.defineProperty(o0,"__esModule",{value:!0});o0.rotl=EK;o0.createCipher=IK;var zt=un(),o3=i(e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),"_utf8ToBytes"),wK=o3("expand 16-byte k"),xK=o3("expand 32-byte k"),SK=(0,zt.u32)(wK),AK=(0,zt.u32)(xK);function EK(e,t){return e<<t|e>>>32-t}i(EK,"rotl");function Wb(e){return e.byteOffset%4===0}i(Wb,"isAligned32");var n0=64,_K=16,i3=2**32-1,n3=new Uint32Array;function MK(e,t,r,n,o,s,a,l){let f=o.length,p=new Uint8Array(n0),w=(0,zt.u32)(p),A=Wb(o)&&Wb(s),_=A?(0,zt.u32)(o):n3,T=A?(0,zt.u32)(s):n3;for(let B=0;B<f;a++){if(e(t,r,n,w,a,l),a>=i3)throw new Error("arx: counter overflow");let P=Math.min(n0,f-B);if(A&&P===n0){let C=B/4;if(B%4!==0)throw new Error("arx: invalid block position");for(let O=0,L;O<_K;O++)L=C+O,T[L]=_[L]^w[O];B+=n0;continue}for(let C=0,O;C<P;C++)O=B+C,s[O]=o[O]^p[C];B+=P}}i(MK,"runCipher");function IK(e,t){let{allowShortKeys:r,extendNonceFn:n,counterLength:o,counterRight:s,rounds:a}=(0,zt.checkOpts)({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return(0,zt.anumber)(o),(0,zt.anumber)(a),(0,zt.abool)(s),(0,zt.abool)(r),(l,f,p,w,A=0)=>{(0,zt.abytes)(l),(0,zt.abytes)(f),(0,zt.abytes)(p);let _=p.length;if(w===void 0&&(w=new Uint8Array(_)),(0,zt.abytes)(w),(0,zt.anumber)(A),A<0||A>=i3)throw new Error("arx: counter overflow");if(w.length<_)throw new Error(`arx: output (${w.length}) is shorter than data (${_})`);let T=[],B=l.length,P,C;if(B===32)T.push(P=(0,zt.copyBytes)(l)),C=AK;else if(B===16&&r)P=new Uint8Array(32),P.set(l),P.set(l,16),C=SK,T.push(P);else throw new Error(`arx: invalid 32-byte key, got length=${B}`);Wb(f)||T.push(f=(0,zt.copyBytes)(f));let O=(0,zt.u32)(P);if(n){if(f.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(C,O,(0,zt.u32)(f.subarray(0,16)),O),f=f.subarray(16)}let L=16-o;if(L!==f.length)throw new Error(`arx: nonce must be ${L} or 16 bytes`);if(L!==12){let j=new Uint8Array(12);j.set(f,s?0:12-f.length),f=j,T.push(f)}let R=(0,zt.u32)(f);return MK(e,C,O,R,p,w,A,a),(0,zt.clean)(...T),w}}i(IK,"createCipher")});var c3=ae(Al=>{"use strict";m();g();Object.defineProperty(Al,"__esModule",{value:!0});Al.poly1305=void 0;Al.wrapConstructorWithKey=a3;var ti=un(),br=i((e,t)=>e[t++]&255|(e[t++]&255)<<8,"u8to16"),$b=class{static{i(this,"Poly1305")}constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=(0,ti.toBytes)(t),(0,ti.abytes)(t,32);let r=br(t,0),n=br(t,2),o=br(t,4),s=br(t,6),a=br(t,8),l=br(t,10),f=br(t,12),p=br(t,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|o<<6)&7939,this.r[3]=(o>>>7|s<<9)&8191,this.r[4]=(s>>>4|a<<12)&255,this.r[5]=a>>>1&8190,this.r[6]=(a>>>14|l<<2)&8191,this.r[7]=(l>>>11|f<<5)&8065,this.r[8]=(f>>>8|p<<8)&8191,this.r[9]=p>>>5&127;for(let w=0;w<8;w++)this.pad[w]=br(t,16+2*w)}process(t,r,n=!1){let o=n?0:2048,{h:s,r:a}=this,l=a[0],f=a[1],p=a[2],w=a[3],A=a[4],_=a[5],T=a[6],B=a[7],P=a[8],C=a[9],O=br(t,r+0),L=br(t,r+2),R=br(t,r+4),j=br(t,r+6),Z=br(t,r+8),X=br(t,r+10),Q=br(t,r+12),z=br(t,r+14),H=s[0]+(O&8191),E=s[1]+((O>>>13|L<<3)&8191),c=s[2]+((L>>>10|R<<6)&8191),d=s[3]+((R>>>7|j<<9)&8191),h=s[4]+((j>>>4|Z<<12)&8191),y=s[5]+(Z>>>1&8191),b=s[6]+((Z>>>14|X<<2)&8191),M=s[7]+((X>>>11|Q<<5)&8191),I=s[8]+((Q>>>8|z<<8)&8191),x=s[9]+(z>>>5|o),u=0,S=u+H*l+E*(5*C)+c*(5*P)+d*(5*B)+h*(5*T);u=S>>>13,S&=8191,S+=y*(5*_)+b*(5*A)+M*(5*w)+I*(5*p)+x*(5*f),u+=S>>>13,S&=8191;let V=u+H*f+E*l+c*(5*C)+d*(5*P)+h*(5*B);u=V>>>13,V&=8191,V+=y*(5*T)+b*(5*_)+M*(5*A)+I*(5*w)+x*(5*p),u+=V>>>13,V&=8191;let q=u+H*p+E*f+c*l+d*(5*C)+h*(5*P);u=q>>>13,q&=8191,q+=y*(5*B)+b*(5*T)+M*(5*_)+I*(5*A)+x*(5*w),u+=q>>>13,q&=8191;let F=u+H*w+E*p+c*f+d*l+h*(5*C);u=F>>>13,F&=8191,F+=y*(5*P)+b*(5*B)+M*(5*T)+I*(5*_)+x*(5*A),u+=F>>>13,F&=8191;let ee=u+H*A+E*w+c*p+d*f+h*l;u=ee>>>13,ee&=8191,ee+=y*(5*C)+b*(5*P)+M*(5*B)+I*(5*T)+x*(5*_),u+=ee>>>13,ee&=8191;let ie=u+H*_+E*A+c*w+d*p+h*f;u=ie>>>13,ie&=8191,ie+=y*l+b*(5*C)+M*(5*P)+I*(5*B)+x*(5*T),u+=ie>>>13,ie&=8191;let ce=u+H*T+E*_+c*A+d*w+h*p;u=ce>>>13,ce&=8191,ce+=y*f+b*l+M*(5*C)+I*(5*P)+x*(5*B),u+=ce>>>13,ce&=8191;let ye=u+H*B+E*T+c*_+d*A+h*w;u=ye>>>13,ye&=8191,ye+=y*p+b*f+M*l+I*(5*C)+x*(5*P),u+=ye>>>13,ye&=8191;let ue=u+H*P+E*B+c*T+d*_+h*A;u=ue>>>13,ue&=8191,ue+=y*w+b*p+M*f+I*l+x*(5*C),u+=ue>>>13,ue&=8191;let N=u+H*C+E*P+c*B+d*T+h*_;u=N>>>13,N&=8191,N+=y*A+b*w+M*p+I*f+x*l,u+=N>>>13,N&=8191,u=(u<<2)+u|0,u=u+S|0,S=u&8191,u=u>>>13,V+=u,s[0]=S,s[1]=V,s[2]=q,s[3]=F,s[4]=ee,s[5]=ie,s[6]=ce,s[7]=ye,s[8]=ue,s[9]=N}finalize(){let{h:t,pad:r}=this,n=new Uint16Array(10),o=t[1]>>>13;t[1]&=8191;for(let l=2;l<10;l++)t[l]+=o,o=t[l]>>>13,t[l]&=8191;t[0]+=o*5,o=t[0]>>>13,t[0]&=8191,t[1]+=o,o=t[1]>>>13,t[1]&=8191,t[2]+=o,n[0]=t[0]+5,o=n[0]>>>13,n[0]&=8191;for(let l=1;l<10;l++)n[l]=t[l]+o,o=n[l]>>>13,n[l]&=8191;n[9]-=8192;let s=(o^1)-1;for(let l=0;l<10;l++)n[l]&=s;s=~s;for(let l=0;l<10;l++)t[l]=t[l]&s|n[l];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let a=t[0]+r[0];t[0]=a&65535;for(let l=1;l<8;l++)a=(t[l]+r[l]|0)+(a>>>16)|0,t[l]=a&65535;(0,ti.clean)(n)}update(t){(0,ti.aexists)(this),t=(0,ti.toBytes)(t),(0,ti.abytes)(t);let{buffer:r,blockLen:n}=this,o=t.length;for(let s=0;s<o;){let a=Math.min(n-this.pos,o-s);if(a===n){for(;n<=o-s;s+=n)this.process(t,s);continue}r.set(t.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){(0,ti.clean)(this.h,this.r,this.buffer,this.pad)}digestInto(t){(0,ti.aexists)(this),(0,ti.aoutput)(t,this),this.finished=!0;let{buffer:r,h:n}=this,{pos:o}=this;if(o){for(r[o++]=1;o<16;o++)r[o]=0;this.process(r,0,!0)}this.finalize();let s=0;for(let a=0;a<8;a++)t[s++]=n[a]>>>0,t[s++]=n[a]>>>8;return t}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}};function a3(e){let t=i((n,o)=>e(o).update((0,ti.toBytes)(n)).digest(),"hashC"),r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}i(a3,"wrapConstructorWithKey");Al.poly1305=a3(e=>new $b(e))});var d3=ae(Dt=>{"use strict";m();g();Object.defineProperty(Dt,"__esModule",{value:!0});Dt.xchacha20poly1305=Dt.chacha20poly1305=Dt._poly1305_aead=Dt.chacha12=Dt.chacha8=Dt.xchacha20=Dt.chacha20=Dt.chacha20orig=void 0;Dt.hchacha=f3;var pe=s3(),TK=c3(),Zi=un();function El(e,t,r,n,o,s=20){let a=e[0],l=e[1],f=e[2],p=e[3],w=t[0],A=t[1],_=t[2],T=t[3],B=t[4],P=t[5],C=t[6],O=t[7],L=o,R=r[0],j=r[1],Z=r[2],X=a,Q=l,z=f,H=p,E=w,c=A,d=_,h=T,y=B,b=P,M=C,I=O,x=L,u=R,S=j,V=Z;for(let F=0;F<s;F+=2)X=X+E|0,x=(0,pe.rotl)(x^X,16),y=y+x|0,E=(0,pe.rotl)(E^y,12),X=X+E|0,x=(0,pe.rotl)(x^X,8),y=y+x|0,E=(0,pe.rotl)(E^y,7),Q=Q+c|0,u=(0,pe.rotl)(u^Q,16),b=b+u|0,c=(0,pe.rotl)(c^b,12),Q=Q+c|0,u=(0,pe.rotl)(u^Q,8),b=b+u|0,c=(0,pe.rotl)(c^b,7),z=z+d|0,S=(0,pe.rotl)(S^z,16),M=M+S|0,d=(0,pe.rotl)(d^M,12),z=z+d|0,S=(0,pe.rotl)(S^z,8),M=M+S|0,d=(0,pe.rotl)(d^M,7),H=H+h|0,V=(0,pe.rotl)(V^H,16),I=I+V|0,h=(0,pe.rotl)(h^I,12),H=H+h|0,V=(0,pe.rotl)(V^H,8),I=I+V|0,h=(0,pe.rotl)(h^I,7),X=X+c|0,V=(0,pe.rotl)(V^X,16),M=M+V|0,c=(0,pe.rotl)(c^M,12),X=X+c|0,V=(0,pe.rotl)(V^X,8),M=M+V|0,c=(0,pe.rotl)(c^M,7),Q=Q+d|0,x=(0,pe.rotl)(x^Q,16),I=I+x|0,d=(0,pe.rotl)(d^I,12),Q=Q+d|0,x=(0,pe.rotl)(x^Q,8),I=I+x|0,d=(0,pe.rotl)(d^I,7),z=z+h|0,u=(0,pe.rotl)(u^z,16),y=y+u|0,h=(0,pe.rotl)(h^y,12),z=z+h|0,u=(0,pe.rotl)(u^z,8),y=y+u|0,h=(0,pe.rotl)(h^y,7),H=H+E|0,S=(0,pe.rotl)(S^H,16),b=b+S|0,E=(0,pe.rotl)(E^b,12),H=H+E|0,S=(0,pe.rotl)(S^H,8),b=b+S|0,E=(0,pe.rotl)(E^b,7);let q=0;n[q++]=a+X|0,n[q++]=l+Q|0,n[q++]=f+z|0,n[q++]=p+H|0,n[q++]=w+E|0,n[q++]=A+c|0,n[q++]=_+d|0,n[q++]=T+h|0,n[q++]=B+y|0,n[q++]=P+b|0,n[q++]=C+M|0,n[q++]=O+I|0,n[q++]=L+x|0,n[q++]=R+u|0,n[q++]=j+S|0,n[q++]=Z+V|0}i(El,"chachaCore");function f3(e,t,r,n){let o=e[0],s=e[1],a=e[2],l=e[3],f=t[0],p=t[1],w=t[2],A=t[3],_=t[4],T=t[5],B=t[6],P=t[7],C=r[0],O=r[1],L=r[2],R=r[3];for(let Z=0;Z<20;Z+=2)o=o+f|0,C=(0,pe.rotl)(C^o,16),_=_+C|0,f=(0,pe.rotl)(f^_,12),o=o+f|0,C=(0,pe.rotl)(C^o,8),_=_+C|0,f=(0,pe.rotl)(f^_,7),s=s+p|0,O=(0,pe.rotl)(O^s,16),T=T+O|0,p=(0,pe.rotl)(p^T,12),s=s+p|0,O=(0,pe.rotl)(O^s,8),T=T+O|0,p=(0,pe.rotl)(p^T,7),a=a+w|0,L=(0,pe.rotl)(L^a,16),B=B+L|0,w=(0,pe.rotl)(w^B,12),a=a+w|0,L=(0,pe.rotl)(L^a,8),B=B+L|0,w=(0,pe.rotl)(w^B,7),l=l+A|0,R=(0,pe.rotl)(R^l,16),P=P+R|0,A=(0,pe.rotl)(A^P,12),l=l+A|0,R=(0,pe.rotl)(R^l,8),P=P+R|0,A=(0,pe.rotl)(A^P,7),o=o+p|0,R=(0,pe.rotl)(R^o,16),B=B+R|0,p=(0,pe.rotl)(p^B,12),o=o+p|0,R=(0,pe.rotl)(R^o,8),B=B+R|0,p=(0,pe.rotl)(p^B,7),s=s+w|0,C=(0,pe.rotl)(C^s,16),P=P+C|0,w=(0,pe.rotl)(w^P,12),s=s+w|0,C=(0,pe.rotl)(C^s,8),P=P+C|0,w=(0,pe.rotl)(w^P,7),a=a+A|0,O=(0,pe.rotl)(O^a,16),_=_+O|0,A=(0,pe.rotl)(A^_,12),a=a+A|0,O=(0,pe.rotl)(O^a,8),_=_+O|0,A=(0,pe.rotl)(A^_,7),l=l+f|0,L=(0,pe.rotl)(L^l,16),T=T+L|0,f=(0,pe.rotl)(f^T,12),l=l+f|0,L=(0,pe.rotl)(L^l,8),T=T+L|0,f=(0,pe.rotl)(f^T,7);let j=0;n[j++]=o,n[j++]=s,n[j++]=a,n[j++]=l,n[j++]=C,n[j++]=O,n[j++]=L,n[j++]=R}i(f3,"hchacha");Dt.chacha20orig=(0,pe.createCipher)(El,{counterRight:!1,counterLength:8,allowShortKeys:!0});Dt.chacha20=(0,pe.createCipher)(El,{counterRight:!1,counterLength:4,allowShortKeys:!1});Dt.xchacha20=(0,pe.createCipher)(El,{counterRight:!1,counterLength:8,extendNonceFn:f3,allowShortKeys:!1});Dt.chacha8=(0,pe.createCipher)(El,{counterRight:!1,counterLength:4,rounds:8});Dt.chacha12=(0,pe.createCipher)(El,{counterRight:!1,counterLength:4,rounds:12});var BK=new Uint8Array(16),u3=i((e,t)=>{e.update(t);let r=t.length%16;r&&e.update(BK.subarray(r))},"updatePadded"),kK=new Uint8Array(32);function l3(e,t,r,n,o){let s=e(t,r,kK),a=TK.poly1305.create(s);o&&u3(a,o),u3(a,n);let l=(0,Zi.u64Lengths)(n.length,o?o.length:0,!0);a.update(l);let f=a.digest();return(0,Zi.clean)(s,l),f}i(l3,"computeTag");var PK=i(e=>(t,r,n)=>({encrypt(s,a){let l=s.length;a=(0,Zi.getOutput)(l+16,a,!1),a.set(s);let f=a.subarray(0,-16);e(t,r,f,f,1);let p=l3(e,t,r,f,n);return a.set(p,l),(0,Zi.clean)(p),a},decrypt(s,a){a=(0,Zi.getOutput)(s.length-16,a,!1);let l=s.subarray(0,-16),f=s.subarray(-16),p=l3(e,t,r,l,n);if(!(0,Zi.equalBytes)(f,p))throw new Error("invalid tag");return a.set(s.subarray(0,-16)),e(t,r,a,a,1),(0,Zi.clean)(p),a}}),"_poly1305_aead");Dt._poly1305_aead=PK;Dt.chacha20poly1305=(0,Zi.wrapCipher)({blockSize:64,nonceLength:12,tagLength:16},(0,Dt._poly1305_aead)(Dt.chacha20));Dt.xchacha20poly1305=(0,Zi.wrapCipher)({blockSize:64,nonceLength:24,tagLength:16},(0,Dt._poly1305_aead)(Dt.xchacha20))});var p3=ae(Xc=>{"use strict";m();g();Object.defineProperty(Xc,"__esModule",{value:!0});Xc.chacha20=Xc.xchacha20=void 0;var h3=d3(),CK=i(function(e,t,r){return(0,h3.xchacha20poly1305)(e,t,r)},"xchacha20");Xc.xchacha20=CK;var OK=i(function(e,t,r){return(0,h3.chacha20poly1305)(e,t,r)},"chacha20");Xc.chacha20=OK});var b3=ae(Bn=>{"use strict";m();g();Object.defineProperty(Bn,"__esModule",{value:!0});Bn.aesDecrypt=Bn.aesEncrypt=Bn.symDecrypt=Bn.symEncrypt=void 0;var Zb=un(),KK=Zy(),m3=r3(),RK=p3(),g3=ul(),Gb=_h(),UK=i(function(e,t,r){return y3(LK,e,t,r)},"symEncrypt");Bn.symEncrypt=UK;var NK=i(function(e,t,r){return y3(DK,e,t,r)},"symDecrypt");Bn.symDecrypt=NK;Bn.aesEncrypt=Bn.symEncrypt;Bn.aesDecrypt=Bn.symDecrypt;function y3(e,t,r,n){var o=(0,g3.symmetricAlgorithm)();if(o==="aes-256-gcm")return e(m3.aes256gcm,t,r,(0,g3.symmetricNonceLength)(),Gb.AEAD_TAG_LENGTH,n);if(o==="xchacha20")return e(RK.xchacha20,t,r,Gb.XCHACHA20_NONCE_LENGTH,Gb.AEAD_TAG_LENGTH,n);if(o==="aes-256-cbc")return e(m3.aes256cbc,t,r,16,0);throw new Error("Not implemented")}i(y3,"_exec");function LK(e,t,r,n,o,s){var a=(0,KK.randomBytes)(n),l=e(t,a,s),f=l.encrypt(r);if(o===0)return(0,Zb.concatBytes)(a,f);var p=f.length-o,w=f.subarray(0,p),A=f.subarray(p);return(0,Zb.concatBytes)(a,A,w)}i(LK,"_encrypt");function DK(e,t,r,n,o,s){var a=r.subarray(0,n),l=e(t,Uint8Array.from(a),s),f=r.subarray(n);if(o===0)return l.decrypt(f);var p=f.subarray(0,o),w=f.subarray(o);return l.decrypt((0,Zb.concatBytes)(w,p))}i(DK,"_decrypt")});var s0=ae(ri=>{"use strict";m();g();var VK=ri&&ri.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:i(function(){return t[r]},"get")}),Object.defineProperty(e,n,o)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),i0=ri&&ri.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&VK(t,e,r)};Object.defineProperty(ri,"__esModule",{value:!0});i0(PM(),ri);i0(NM(),ri);i0(Ub(),ri);i0(b3(),ri)});var Yb=ae(c0=>{"use strict";m();g();Object.defineProperty(c0,"__esModule",{value:!0});c0.PublicKey=void 0;var v3=un(),a0=s0(),qK=function(){function e(t,r){var n=(0,a0.convertPublicKeyFormat)(t,!0,r),o=(0,a0.convertPublicKeyFormat)(t,!1,r);this.data=n,this.dataUncompressed=n.length!==o.length?o:null}return i(e,"PublicKey"),e.fromHex=function(t,r){return new e((0,a0.hexToPublicKey)(t,r),r)},Object.defineProperty(e.prototype,"_uncompressed",{get:i(function(){return this.dataUncompressed!==null?this.dataUncompressed:this.data},"get"),enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uncompressed",{get:i(function(){return Buffer.from(this._uncompressed)},"get"),enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"compressed",{get:i(function(){return Buffer.from(this.data)},"get"),enumerable:!1,configurable:!0}),e.prototype.toBytes=function(t){return t===void 0&&(t=!0),t?this.data:this._uncompressed},e.prototype.toHex=function(t){return t===void 0&&(t=!0),(0,v3.bytesToHex)(this.toBytes(t))},e.prototype.decapsulate=function(t,r){r===void 0&&(r=!1);var n=this.toBytes(r),o=t.multiply(this,r);return(0,a0.getSharedKey)(n,o)},e.prototype.equals=function(t){return(0,v3.equalBytes)(this.data,t.data)},e}();c0.PublicKey=qK});var x3=ae(u0=>{"use strict";m();g();Object.defineProperty(u0,"__esModule",{value:!0});u0.PrivateKey=void 0;var w3=un(),Qc=s0(),HK=Yb(),jK=function(){function e(t,r){if(this.curve=r,t===void 0)this.data=(0,Qc.getValidSecret)(r);else if((0,Qc.isValidPrivateKey)(t,r))this.data=t;else throw new Error("Invalid private key");this.publicKey=new HK.PublicKey((0,Qc.getPublicKey)(this.data,r),r)}return i(e,"PrivateKey"),e.fromHex=function(t,r){return new e((0,Qc.decodeHex)(t),r)},Object.defineProperty(e.prototype,"secret",{get:i(function(){return Buffer.from(this.data)},"get"),enumerable:!1,configurable:!0}),e.prototype.toHex=function(){return(0,w3.bytesToHex)(this.data)},e.prototype.encapsulate=function(t,r){r===void 0&&(r=!1);var n=this.publicKey.toBytes(r),o=this.multiply(t,r);return(0,Qc.getSharedKey)(n,o)},e.prototype.multiply=function(t,r){return r===void 0&&(r=!1),(0,Qc.getSharedPoint)(this.data,t.toBytes(!0),r,this.curve)},e.prototype.equals=function(t){return(0,w3.equalBytes)(this.data,t.data)},e}();u0.PrivateKey=jK});var Jb=ae(eu=>{"use strict";m();g();Object.defineProperty(eu,"__esModule",{value:!0});eu.PublicKey=eu.PrivateKey=void 0;var zK=x3();Object.defineProperty(eu,"PrivateKey",{enumerable:!0,get:i(function(){return zK.PrivateKey},"get")});var FK=Yb();Object.defineProperty(eu,"PublicKey",{enumerable:!0,get:i(function(){return FK.PublicKey},"get")})});var Xb=ae(kn=>{"use strict";m();g();Object.defineProperty(kn,"__esModule",{value:!0});kn.utils=kn.PublicKey=kn.PrivateKey=kn.ECIES_CONFIG=void 0;kn.encrypt=$K;kn.decrypt=ZK;var WK=un(),tu=ul(),ru=Jb(),Yi=s0();function $K(e,t){return Buffer.from(GK(e,t))}i($K,"encrypt");function GK(e,t){var r=(0,tu.ellipticCurve)(),n=new ru.PrivateKey(void 0,r),o=e instanceof Uint8Array?new ru.PublicKey(e,r):ru.PublicKey.fromHex(e,r),s=n.encapsulate(o,(0,tu.isHkdfKeyCompressed)()),a=n.publicKey.toBytes((0,tu.isEphemeralKeyCompressed)()),l=(0,Yi.symEncrypt)(s,t);return(0,WK.concatBytes)(a,l)}i(GK,"_encrypt");function ZK(e,t){return Buffer.from(YK(e,t))}i(ZK,"decrypt");function YK(e,t){var r=(0,tu.ellipticCurve)(),n=e instanceof Uint8Array?new ru.PrivateKey(e,r):ru.PrivateKey.fromHex(e,r),o=(0,tu.ephemeralKeySize)(),s=new ru.PublicKey(t.subarray(0,o),r),a=t.subarray(o),l=s.decapsulate(n,(0,tu.isHkdfKeyCompressed)());return(0,Yi.symDecrypt)(l,a)}i(YK,"_decrypt");var JK=ul();Object.defineProperty(kn,"ECIES_CONFIG",{enumerable:!0,get:i(function(){return JK.ECIES_CONFIG},"get")});var S3=Jb();Object.defineProperty(kn,"PrivateKey",{enumerable:!0,get:i(function(){return S3.PrivateKey},"get")});Object.defineProperty(kn,"PublicKey",{enumerable:!0,get:i(function(){return S3.PublicKey},"get")});kn.utils={aesEncrypt:Yi.aesEncrypt,aesDecrypt:Yi.aesDecrypt,symEncrypt:Yi.symEncrypt,symDecrypt:Yi.symDecrypt,decodeHex:Yi.decodeHex,getValidSecret:Yi.getValidSecret,remove0x:Yi.remove0x}});m();g();m();g();var Fa;(function(e){e.Image="image",e.Emoji="emoji",e.ReadOnlyDefault="read-only-default",e.Default="default"})(Fa||(Fa={}));var Ww=v.object({type:v.nativeEnum(Fa),imageUrl:v.string().optional(),unicode:v.string().optional()}),Wa;(function(e){e.Ledger="ledger"})(Wa||(Wa={}));var $a;(function(e){e.BLE="ble"})($a||($a={}));var oT=v.object({version:v.literal(1),connectionType:v.nativeEnum($a),deviceType:v.nativeEnum(Wa),id:v.string().min(1),name:v.string().optional(),model:v.string().optional()}),iT=v.object({value:v.number(),timestamp:v.number()}),sT=v.object({name:v.string(),icon:Ww.optional(),connectedDevices:oT.array().optional()}),xN=v.object({balance:iT.optional()});var aT=100,cT={unicode:void 0,imageUrl:void 0,type:Fa.Default},uT={version:1,isDeveloperMode:!1};var yu=Yn.Solana.Devnet,bu=Yn.Ethereum.Sepolia,G0=Yn.Sui.Testnet;function vu(){return{version:1,setting:{[K.Solana]:yu,[K.EVM]:bu,[K.Sui]:G0}}}i(vu,"getDefaultNetworkSetting");function Br(e){return e.map(t=>Jn[t].defaultDerivationPathType)}i(Br,"getDefaultDerivationPathTypesForAddressTypes");var os={[ve.Bip44RootSolana]:-1,[ve.Bip44RootEthereum]:-1,[ve.BitcoinTaproot]:0,[ve.BitcoinNativeSegwit]:0,[ve.BitcoinNestedSegwit]:0,[ve.BitcoinLegacy]:0,[ve.Bip44ChangeSolana]:0,[ve.Bip44Ethereum]:0,[ve.Bip44Solana]:1,[ve.Bip44EthereumSecondary]:1,[ve.DeprecatedSolana]:2,[ve.Bip44EthereumTertiary]:2,[ve.Bip44Sui]:0};var lT="https://help.phantom.com/hc/en-us/articles/21872962238355";m();g();var Xw=me(Wl());m();g();m();g();var $w=me(Wl()),Xl=me(qt());var Gw=(0,Xl.createContext)(null);function Zw({children:e,vault:t}){return(0,$w.jsx)(Gw.Provider,{value:t,children:e})}i(Zw,"VaultProxyProvider");function Pt(){let e=(0,Xl.useContext)(Gw);if(!e)throw new Error("useVaultProxy must be used within a VaultProxyProvider");return e}i(Pt,"useVaultProxy");m();g();m();g();m();g();var Ql=i((e,t)=>{try{let r=Va(e,t);switch(r){case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:return Jn.getDisplayName(r);default:return}}catch(r){J.addBreadcrumb(Y.Account,"Failed to get address badge",oe.Error,{...r instanceof Error&&{error:r.message},networkId:e,address:t});return}},"getAddressBadge");var Yw={badge:i((e,t,r)=>t.filter(jl).length<=1?"":Ql(e,r)??"","badge"),showAddressTypeExplainer:i(e=>e.filter(jl).length>1,"showAddressTypeExplainer"),addressTooltipNetworkName:i((e,t,r)=>r.filter(jl).length>=2?Ql(e,t)??be.getChainName(e):be.getChainName(e),"addressTooltipNetworkName")};m();g();var Jw={badge:i(()=>"Lite","badge")};var fT=new zl({[tn.Solana]:{},[tn.Ethereum]:{},[tn.Polygon]:{},[tn.Base]:{},[tn.Arbitrum]:{},[tn.Monad]:{},[tn.Bitcoin]:Yw,[tn.Sui]:{},[tn.Hypercore]:{},[tn.Hyperevm]:Jw}),is=Bw(fT);function dT({children:e}){let t=Pt(),r=is.supportedChains.map(o=>[o,is.get(o)]),n=new zl(Object.fromEntries(r));return(0,Xw.jsx)(Lw,{effects:{deriveAddresses:i(async()=>{await t.deriveAddresses()},"deriveAddresses")},registry:n,children:e})}i(dT,"AccountsChainDependencyProvider");m();g();var U;(function(e){e.Seed="seed",e.PrivateKey="privateKey",e.Ledger="ledger",e.SeedVault="seedVault",e.ReadOnly="readOnly",e.Seedless="seedless",e.KMSVault="kmsVault"})(U||(U={}));var hT=v.object({derivationIndex:v.number(),addresses:v.array(v.object({pathType:v.union([sw,aw]),value:v.string()})),publicKeys:v.array(v.object({pathType:iw,value:v.string()}))}),wi=class extends Error{static{i(this,"VaultFetchAccountInvalidIdentifier")}message="No account exists in storage for identifier"},Ga=class extends Error{static{i(this,"VaultFetchAccountUndefinedBitcoinAddressError")}message="No account exists in storage for identifier"},Ws=class extends Error{static{i(this,"VaultExportSecretsInvalidAddressType")}message="Address type not found or incompatible with account"},ef=class extends Error{static{i(this,"VaultExportSecretsHardwareWallet")}message="Hardware wallet account does not have known secr*ts"},tf=class extends Error{static{i(this,"VaultExportSecretsReadOnlyAccount")}message="Read only account does not have known secr*ts"},rf=class extends Error{static{i(this,"VaultImportReadOnlyAccount")}message="Invalid configuration for read only account"},Za=class extends Error{static{i(this,"VaultImportSeedDuplicate")}message="Seed already exists in storage"},So=class extends Error{static{i(this,"VaultFetchSeedInvalidIdentifier")}message="No seed exists in storage for identifier"},nf=class extends Error{static{i(this,"VaultImportSeedInvalidDerivationIndex")}message="The derivation index is missing or invalid"},of=class extends Error{static{i(this,"VaultImportPrivateKeyDuplicate")}message="Private key already exists in storage"},ss=class extends Error{static{i(this,"VaultFetchPrivateKeyInvalidIdentifier")}message="No private key exists in storage for identifier"};var xi=class extends Error{static{i(this,"VaultImportAccountDuplicate")}message;constructor(t,r){super(),this.message=`Account of type ${t} found in Vault, while trying to add ${r} account`}},sf=class extends Error{static{i(this,"VaultSeedlessAccountAlreadyExists")}message="Vault already stores a seedless account"},pT=v.union([v.literal("unonboarded"),v.literal("unable-to-load-accounts"),v.literal("storage-temporarily-inaccessible")]),mT=v.union([v.literal("invalid-identifier"),v.literal("fetch-integrity-storage-error"),v.literal("fetch-entropy-storage-error"),v.literal("fetch-pk-storage-error"),v.literal("invalid-entropy"),v.literal("invalid-entropy-bip-39"),v.literal("invalid-checksum-bits"),v.literal("invalid-entropy-bits"),v.literal("invalid-checksum"),v.literal("invalid-entropy-length-less-than-twelve"),v.literal("invalid-entropy-length-more-than-twenty-four"),v.literal("invalid-entropy-length-wrong-word"),v.literal("invalid-pk-address-type"),v.literal("invalid-pk-identifier"),v.literal("invalid-pk"),v.literal("internal-error")]),gT=v.literal("safely-onboarded"),yT=v.union([v.object({status:pT,isOnboarded:v.literal(!1),reonboardingNeeded:v.literal(!1)}),v.object({status:mT,isOnboarded:v.literal(!0),reonboardingNeeded:v.literal(!0)}),v.object({status:gT,isOnboarded:v.literal(!0),reonboardingNeeded:v.literal(!1)})]);m();g();var wu=i((e,t=5)=>{let r=e.length,n=e.startsWith("0x")?t+2:t;return`${e.substring(0,n)}...${e.substring(r-t,r)}`},"formatHashMedium");m();g();m();g();var bT=i(e=>e.includes(".")||e.includes("@")?!1:Sw.safeParse(e).success||xw.safeParse(e).success||_w.safeParse(e).success||Aw.safeParse(e).success,"isAddress"),Qw=i((e,t=5)=>bT(e)?wu(e,t):e,"formatIfNotHandle");var vT=i((e,t,r,n=4)=>{let o=t?t.name:r,s=Qw(e,n);return o?`${o} (${s})`:s},"formatAddress");m();g();var wT=i(e=>`${e.substring(0,5)}...`,"formatAddressShort");m();g();var ex=me(Wl()),af=me(qt());var tx=(0,af.createContext)(null);function xT({children:e,authRepository:t}){return(0,ex.jsx)(tx.Provider,{value:t,children:e})}i(xT,"AuthProvider");function yn(){let e=(0,af.useContext)(tx);if(!e)throw new Error("useAuthRepository must be used within an AuthProvider");return e}i(yn,"useAuthRepository");function Si(){return yn().useUser()}i(Si,"useUser");m();g();m();g();var X0=me(vo());m();g();m();g();var ST="https://time.phantom.app/utc",AT=v.number().int().positive();async function $s(){let e=await Ya();return Math.floor(e/1e3)}i($s,"time");async function Ya(){let e;try{let t=await Mt.noBearer().get(ST);if(t.status!==200)throw new Error("Failed to fetch time from server");e=AT.parse(t.data)}catch{e=Date.now()}return e}i(Ya,"timeMs");m();g();var xu="https://phantom.app",Su="https://api.phantom.app/oauth2/auth",cf={prod:"a61bc25e-0c4f-4ab3-aa54-b50ec746eea2",staging:"fe26708b-7db7-4146-9fbb-9a9736acfb2b"},rx="/login/start",nx="/oauth2/token";var Z0;(function(e){e.Apple="apple",e.Google="google"})(Z0||(Z0={}));var Y0=ts({minutes:60}),J0=Y0-ts({minutes:15}),Gs="/v1/authentication-keys";var ET=60,_T=i(()=>Math.floor(Date.now()/1e3),"clientTime");async function Ja(e=!0){let t={alg:"ES256",type:"JWT"},r=e?await $s():_T(),n={iss:xu,aud:Su,nbf:r,exp:r+ET,iat:r};return{header:t,payload:n}}i(Ja,"generateUnsignedClientJWT");function Xa(e){let t=pt(X0.Buffer.from(JSON.stringify(e.header))),r=pt(X0.Buffer.from(JSON.stringify(e.payload)));return[t,r,e.signature].join(".")}i(Xa,"encodeSignedJwt");m();g();var ox=v.object({alg:v.string(),type:v.string(),kid:v.string()}),ix=v.object({sub:v.string(),iss:v.string(),aud:v.string(),nbf:v.number(),exp:v.number(),iat:v.number()}),Q0=v.object({header:ox,payload:ix,signature:v.string()}),sx=v.object({alg:v.string(),type:v.string()}),ax=v.object({iss:v.string(),aud:v.string(),nbf:v.number(),exp:v.number(),iat:v.number()}),ep=v.object({header:sx,payload:ax}),tp=v.object({id_token:v.string(),access_token:v.string(),refresh_token:v.string(),scope:v.string(),token_type:v.string(),expires_in:v.number().gte(0)}),MT=v.object({redirectTo:v.string()}),cx=v.object({at_hash:v.string(),aud:v.array(v.string()),auth_time:v.number(),exp:v.number(),iat:v.number(),iss:v.string(),jti:v.string(),rat:v.number(),sid:v.string(),sub:v.string(),email:v.string().optional()}),uf=v.object({authenticationKeys:v.array(v.object({createdAt:v.string().datetime().nullish().default(null),updatedAt:v.string().datetime().nullish().default(null),id:v.string().uuid(),publicKey:v.string(),userId:v.string().uuid()})).optional()}),Ai;(function(e){e.User="user",e.UserID="userID",e.AccessToken="accessToken",e.Email="email",e.LoggedOut="loggedOut"})(Ai||(Ai={}));m();g();var Zs=me(gp());m();g();var rc=me(gp()),Ix=me(es());var Tx={generateRandom:i(e=>{let t=(0,Ix.randomBytes)(e);return(0,rc.bufferToString)(t)},"generateRandom"),async deriveChallenge(e){let t=Xn((0,rc.textEncodeLite)(e));return(0,rc.urlSafe)(t)}};m();g();var vn=i(()=>{let e=Hr();return e===er.Staging?Ua.staging:e===er.Production?Ua.prod:k.BASE_AUTH_ENDPOINT||Ua.staging},"getAuthBaseEndpoint"),yp=i(()=>`${vn()}${rx}`,"getAuthLoginEndpoint"),Sf=i(()=>`${vn()}${nx}`,"getAuthTokenEndpoint");var Bx=new Zs.BasicQueryStringUtils;async function Af(e,t){let{url:r,codeVerifier:n}=await x6(e.getClientID(),e.redirectURL,t),o=t.type==="email",s=await e.fetchAuthorizationCode(e.redirectURL,r,o);return kx({grantType:"authorization_code",clientID:e.getClientID(),redirectURI:e.redirectURL,tokenEndpoint:Sf(),code:s,codeVerifier:n})}i(Af,"authenticate");async function x6(e,t,r){let n=yp(),o,s=["openid","offline_access","user","incognito","seedless"],a;switch(r.type){case"key":{o={type:"key",jwt:Xa(r.clientJWT)};break}case"email":{o={type:"email",provider:r.provider,existingAccessToken:r.existingAccessToken},a=r.prompt,s.push("email");break}case"session":{o={type:"session",existingAccessToken:r.existingAccessToken};break}}let f=await new Zs.AuthorizationRequest({client_id:e,redirect_uri:t,scope:s.join(" "),response_type:"code"},Tx).toJson(),p;switch(o.type){case"key":p=`jwt:${pt(Buffer.from(o.jwt,"utf8"))}`;break;case"email":p=`sso:${o.provider}`,o.existingAccessToken&&(p=`${p}:${o.existingAccessToken}`);break;case"session":p=`session:${o.existingAccessToken}`;break}let w={redirect_uri:f.redirect_uri,client_id:f.client_id,response_type:f.response_type,state:f.state??"",scope:f.scope,login_hint:p};a&&(w.prompt=a);let A=f.extras?.code_challenge,_=f.extras?.code_challenge_method,T=f.internal?.code_verifier;if(A&&_&&(w.code_challenge=A,w.code_challenge_method=_),!A||!_||!T)throw new Error("Missing code challenge or code verifier for PKCE.");let B=Bx.stringify(w);return{url:`${n}?${B}`,codeVerifier:T}}i(x6,"createAuthorizationCodeRequest");async function kx(e){let{grantType:t,tokenEndpoint:r,clientID:n,redirectURI:o}=e,s;t==="authorization_code"?s=new Zs.TokenRequest({client_id:n,redirect_uri:o,grant_type:t,code:e.code,extras:{code_verifier:e.codeVerifier}}):s=new Zs.TokenRequest({client_id:n,redirect_uri:o,grant_type:t,refresh_token:e.refreshToken});let a=await Mt.headers({"Content-Type":"application/x-www-form-urlencoded"},{mergeHeaders:!1}).auth(Yv()).noBearer().post(r,Bx.stringify(s.toStringMap()));S6(a,t);let l=tp.safeParse(a.data);if(!l.success){let w;if(a.data!==void 0)if(typeof a.data=="string")w=a.data;else try{w=JSON.stringify(a.data)}catch{w=String(a.data)}let A=a.statusText?` ${a.statusText}`:"",_=`Status ${a.status}${A}`,T=w?` | Server response: ${w}`:"";throw new Error(`Invalid OAuth2Token response. ${_}${T}`)}let{data:f}=l,p=await $s();return{idToken:f.id_token,accessToken:f.access_token,refreshToken:f.refresh_token,scope:f.scope,tokenType:f.token_type,expiresAt:(p+f.expires_in)*1e3}}i(kx,"performTokenRequest");async function Ef(e,t){return kx({clientID:e.getClientID(),redirectURI:e.redirectURL,grantType:"refresh_token",tokenEndpoint:Sf(),refreshToken:t})}i(Ef,"refresh");function S6(e,t){if([401,400].includes(e.status)){let r="",n;if(e.data!==void 0)if(typeof e.data=="string")n=e.data;else try{n=JSON.stringify(e.data)}catch{n=String(e.data)}if(e.status===401)switch(r="Token Request Unauthorized (401): ",t){case"authorization_code":r+="Authorization code is expired or invalid.";break;case"refresh_token":r+="Refresh token is expired or invalid.";break;default:r+=`Unknown grant type [${t}]. `}if(e.status===400)switch(r="Bad Token Request (400): ",t){case"authorization_code":r="for [authorization_code]. Possible causes: 1. The authorization code is expired or invalid. 2. Redirect URI mismatch. 3. Code verifier mismatch (if using PKCE).";break;case"refresh_token":r="for [refresh_token]. Possible causes: 1. The refresh token is expired, invalid, or revoked. 2. Client ID mismatch. 3. Missing or malformed refresh token in the request.";break;default:r=`for unknown grant type [${t}]. Check the payload and OAuth provider documentation.`}n&&(r+=` | Server response: ${n}`);let o=new Error(r);throw o.status=e.status,o}}i(S6,"handleBadRequest");m();g();m();g();m();g();var Eu=class{static{i(this,"BaseEventEmitter")}subscribers={};subscribe(t,r){return this.subscribers[t]||(this.subscribers[t]=[]),this.subscribers[t].push(r),()=>{this.subscribers[t].splice(this.subscribers[t].indexOf(r),1)}}emitEvent(t,...r){(this.subscribers[t]??[]).forEach(o=>{o(...r)})}};var _f=class extends Eu{static{i(this,"AuthEventEmitter")}lastEmittedUser=null;isUserEqual(t,r){return t===null||r===null?t===r:t.userID===r.userID&&t.accessToken===r.accessToken&&t.email===r.email}emit(t){t&&(this.isUserEqual(t,this.lastEmittedUser)||(this.lastEmittedUser={...t},this.emitEvent(Ai.User,t),this.emitEvent(Ai.UserID,t.userID),this.emitEvent(Ai.AccessToken,t.accessToken),t.email&&this.emitEvent(Ai.Email,t.email)))}emitLoggedOut(){this.lastEmittedUser=null,this.emitEvent(Ai.LoggedOut)}};m();g();m();g();function _i(e,t="expected value not found"){if(e==null)throw new Error(t);return e}i(_i,"expect");function Px(e,t="expected value not found"){if(!e)throw new Error(t)}i(Px,"assert");var Mf=i(async(e,t)=>{let r=vn(),n=_i(e.signer,"Signer is required for key-based auth."),o=await n.getAuthenticationPublicKey(t),s=await Ja(e.isServerTimeEnabled()),a=await n.sign(s,t),l=await Mt.noBearer().get(`${r}${Gs}`,{params:{token:Xa(a)}});if(!ja(l))throw new Error(`Failed to get authentication keys: response is not okay (status ${l.status})`);let{data:f}=l;return(uf.parse(f).authenticationKeys??[]).some(w=>w.publicKey===o)},"isExistingAuthFactor");m();g();m();g();var Cx=i(async e=>{try{let t=await Mt.headers({"Content-Type":"application/x-www-form-urlencoded"},{mergeHeaders:!1}).bearer(e).get(`${vn()}/userinfo`);return ja(t)}catch{return!1}},"isValidToken");m();g();m();g();var _u=".phantom.auth",If=`${_u}.tokens`,Tf=`${_u}.tokens.staging`,Mu=`${_u}.custom-environments`,Ox=`${_u}.authentication-factors`,A6=`${_u}.email-provider`;async function Bf(e){let t=Hr();return t===er.Production?e.get(If):t===er.Staging?e.get(Tf):(await e.get(Mu))?.[t]??null}i(Bf,"getAuthTokens");async function nc(e,t){let r=Hr();r===er.Production?await e.set(If,t):r===er.Staging?await e.set(Tf,t):await e.update(Mu,n=>({...n,[r]:t}))}i(nc,"setAuthTokens");async function kf(e){let t=Hr();if(t===er.Production)await e.remove(If);else if(t===er.Staging)await e.remove(Tf);else{let r=!1;await e.update(Mu,n=>{if(!n||!(t in n))return n??null;let o={...n};return delete o[t],Object.keys(o).length===0&&(r=!0),o}),r&&await e.remove(Mu)}}i(kf,"clearAuthTokens");m();g();var Ys=i(e=>{let t=e.idToken.split(".");if(t.length!==3)throw new Error("Malformed ID token. Expected 3 period-delimited parts to ID token.");let r;try{let n=xr(t[1]).toString("utf-8"),o=JSON.parse(n);r=cx.parse(o)}catch{throw new Error("Unable to parse ID token payload.")}return{accessToken:e.accessToken,userID:r.sub,email:r.email}},"authTokensToUser");m();g();var Kx="@phantom/auth",nr={user:["auth",`${Kx}:user`],authFactors:["auth",`${Kx}:user-auth-factors`]};m();g();var Pf=i(async(e,t,r)=>{let{storage:n,authConfig:o}=e,s,{type:a}=r;switch(a){case"key":{let f=_i(e.signer,"Signer is required for key-based auth."),p=await Ja(e.isServerTimeEnabled()),w=await f.sign(p,r.secretIdentifier);s=await Af(o,{type:a,clientJWT:w});break}case"email":{s=await Af(o,{type:a,prompt:r.prompt,provider:r.provider});break}case"session":{s=await Af(o,{type:a,existingAccessToken:r.accessToken});break}}J.addBreadcrumb(Y.Auth,"\u2705 Login succeeded!",oe.Debug),await nc(n,s);let l=Ys(s);return await Promise.all([e.queryClient.setQueryData([...nr.user,{skipAutoLogin:!0}],l),e.queryClient.setQueryData([...nr.user,{skipAutoLogin:!1}],l)]),t.emit(l),l},"logIn");var Rx={queryKey:nr.user,gcTime:J0,staleTime:ts({minutes:5})},oc=i(async(e,t,r)=>{let n=r?.skipAutoLogin??!1;return e.queryClient.fetchQuery({...Rx,queryKey:[...nr.user,{skipAutoLogin:n}],queryFn:i(async()=>Nx(e,t,n),"queryFn")})},"getUser"),Ux=i((e,t)=>Tr({...Rx,queryKey:[...nr.user,{skipAutoLogin:!1}],queryFn:i(async()=>{let r=await Nx(e,t,!1);if(!r)throw new Error("Unable to log in.");return r},"queryFn"),retryOnMount:!1}),"useUser"),Nx=i(async(e,t,r)=>e.runExclusive(async()=>{let n=await _6(e);if(n)return t.emit(n),n;if(r||!e.signer)return null;let o=await M6(e,t);return t.emit(o),o}),"queryFn");async function E6(e,t){if(!(e instanceof Error)){J.addBreadcrumb(Y.Auth,`Token refresh failed: ${e}. Tokens preserved.`,oe.Error);return}let r=e;if(J.captureError(r,Y.Auth),r.status!==400&&r.status!==401){J.addBreadcrumb(Y.Auth,`Token refresh failed (${r.status??"unknown"}): ${r.message}. Tokens preserved for retry.`,oe.Error);return}J.addBreadcrumb(Y.Auth,`Token refresh failed (${r.status}): ${r.message}. Clearing invalid tokens.`,oe.Error),await kf(t)}i(E6,"handleRefreshError");async function _6({storage:e,authConfig:t,isLocalTokenValidityCheckEnabled:r,isServerTimeEnabled:n}){let o=await Bf(e);if(!o)return J.addBreadcrumb(Y.Auth,"No auth tokens found; skipping refresh.",oe.Debug),null;let s=n()?await $s():Math.floor(Date.now()/1e3),a=Math.floor(o.expiresAt/1e3),l=(Y0-J0)/1e3,f=a-l,p=s<f;if(p&&!r()&&(p=await Cx(o.accessToken)),p)return J.addBreadcrumb(Y.Auth,`\u267B\uFE0F Access token still valid => Expires at ${o.expiresAt}`,oe.Debug),Ys(o);if(o.refreshToken)try{let w=await Ef(t,o.refreshToken);return J.addBreadcrumb(Y.Auth,`\u2705 Refreshed auth token => Expires at ${w.expiresAt}`,oe.Debug),await nc(e,w),Ys(w)}catch(w){return await E6(w,e),null}return J.addBreadcrumb(Y.Auth,"Auth tokens present but refresh token missing; skipping refresh.",oe.Debug),null}i(_6,"getOrRefreshUser");async function M6(e,t){let n=await _i(e.signer,"Unable to log in with key-based auth. Signer is not available.").getAllSecretIdentifiers();if(n.length===0)return J.addBreadcrumb(Y.Auth,"Unable to log in with key-based auth. Vault is not yet onboarded or has no secrets that can perform key-based auth.",oe.Info),null;let o;try{for(let s of n)if(await Mf(e,s)){o=s;break}}catch(s){throw J.addBreadcrumb(Y.Auth,"Unable to log in with key-based auth. Error checking auth factors.",oe.Error),s}o||(o=n[0],J.addBreadcrumb(Y.Auth,"No auth factor found, creating new user with first secret identifier.",oe.Debug));try{return await Pf(e,t,{type:"key",secretIdentifier:o})}catch(s){throw J.addBreadcrumb(Y.Auth,"Unable to log in with key-based auth. Error performing auth.",oe.Error),s}}i(M6,"autoLoginWithKeyBasedAuth");m();g();var Iu=i(e=>{e.removeQueries({queryKey:nr.user})},"removeUser"),I6=i(e=>{e.removeQueries({queryKey:[...nr.user,{skipAutoLogin:!0}]})},"removeUserSkipAutoLogin"),bp=i(async e=>{await e.resetQueries({queryKey:nr.user})},"resetUser"),Js=i(async e=>{await e.invalidateQueries({queryKey:nr.user})},"invalidateUser"),Mi=i(async e=>{await e.invalidateQueries({queryKey:nr.authFactors})},"invalidateUserAuthFactors");var T6=i(e=>{let t=new _f,r={getUser:i(async n=>oc(e,t,n),"getUser"),useUser:i(()=>Ux(e,t),"useUser"),refreshTokens:i(async()=>B6(e),"refreshTokens"),logIn:i(async n=>Pf(e,t,n),"logIn"),isExistingAuthFactor:i(async n=>Mf(e,n),"isExistingAuthFactor"),getAuthenticationKeys:i(async()=>k6(e,t),"getAuthenticationKeys"),getLocalAuthenticationPublicKeys:i(async()=>C6(e),"getLocalAuthenticationPublicKeys"),addAuthFactor:i(async n=>O6(e,t,n),"addAuthFactor"),deleteAuthFactor:i(async n=>K6(e,t,n),"deleteAuthFactor"),deleteAllAuthFactors:i(async()=>R6(e,t),"deleteAllAuthFactors"),subscribe:i((n,o)=>t.subscribe(n,o),"subscribe"),logOut:i(async()=>U6(e,t),"logOut")};return Pw(async(n={})=>{let{refresh:o=!1,skipAutoLogin:s=!1}=n;return o&&await Js(e.queryClient),(await r.getUser({skipAutoLogin:s}))?.accessToken??null}),r},"createAuthRepository"),B6=i(async e=>e.runExclusive(async()=>{let t=await Bf(e.storage);if(!t)return!1;let r=await Ef(e.authConfig,t.refreshToken);await nc(e.storage,r);let n=Ys(r);return await Promise.all([e.queryClient.setQueryData([...nr.user,{skipAutoLogin:!0}],n),e.queryClient.setQueryData([...nr.user,{skipAutoLogin:!1}],n)]),!0}),"refreshTokens"),k6=i(async(e,t)=>({authenticationPublicKeys:(await P6(e,t)).map(n=>n.publicKey)}),"getAuthenticationKeys"),P6=i(async(e,t)=>{let r=vn(),n=await oc(e,t);if(!n)throw new Error("User not authenticated.");let{data:o}=await Mt.bearer(n.accessToken).get(`${r}${Gs}`),s=uf.safeParse(o);if(!s.success)throw new Error("Unable to parse auth factors response.");return s.data.authenticationKeys??[]},"getAuthenticationKeysInternal"),C6=i(async e=>{try{let t=_i(e.signer,"Signer is required for key-based auth."),r=await t.getAllSecretIdentifiers(),n={};for(let o of r)n[o]=await t.getAuthenticationPublicKey(o);return n}catch{return{}}},"getLocalAuthenticationPublicKeys"),O6=i(async(e,t,{secretIdentifier:r})=>{let n=vn(),o=_i(e.signer,"Signer is required for key-based auth."),s=await oc(e,t);if(!s)throw new Error("User not authenticated.");J.addBreadcrumb(Y.Auth,`Adding auth factor: ${r}`,oe.Info);let a=await Ja(e.isServerTimeEnabled()),l=await o.sign(a,r);await Mt.bearer(s.accessToken).post(`${n}${Gs}`,{jwt:Xa(l)})},"addAuthFactor"),K6=i(async(e,t,{authenticationPublicKey:r})=>{let n=vn(),o=await oc(e,t);if(!o)throw new Error("User not authenticated.");J.addBreadcrumb(Y.Auth,`Deleting auth factor: ${r}`,oe.Info),await Mt.bearer(o.accessToken).delete(`${n}${Gs}/${encodeURIComponent(r)}`)},"deleteAuthFactor"),R6=i(async(e,t)=>{let r=vn(),{storage:n}=e,o=await oc(e,t);if(!o)throw new Error("User not authenticated.");J.addBreadcrumb(Y.Auth,"Deleting all auth factors",oe.Info),await Mt.bearer(o.accessToken).delete(`${r}${Gs}`),await n.remove(Ox)},"deleteAllAuthFactors"),U6=i(async({storage:e,queryClient:t},r)=>{await kf(e),Iu(t),r.emitLoggedOut()},"logOut");m();g();var N6=i((e,t)=>{let r=new URL(t);if(!r.toString().startsWith(e))throw new Error("Unexpected redirectURL. RedirectURL from auth flow must match local redirect URL.");let n=r.searchParams.get("code");if(!n)throw new Error("No authorization code");return n},"parseAuthCode");m();g();var L6=i((e,t)=>{let r=new URL(t);if(!r.toString().startsWith(e))throw new Error("Unexpected redirectURL. RedirectURL from auth flow must match local redirect URL.");let n=r.searchParams.get("error"),o=r.searchParams.get("error_description");if(n)throw new Error(`${n}: ${o}`,{cause:n});return!1},"redirectHasErrorParam");m();g();var D6=i(()=>Hr()===er.Production?cf.prod:cf.staging,"getAuthClientID");m();g();var V6=i(e=>{let t=yn(),{data:r}=Si(),n=nr.authFactors;return Tr({queryKey:n,queryFn:i(async()=>{let s=await t.getLocalAuthenticationPublicKeys();if(Object.keys(s).length===0)return{};let a=[];try{if(r){let{authenticationPublicKeys:p=[]}=await t.getAuthenticationKeys();a=p}}catch(p){r&&p instanceof Error&&J.addBreadcrumb(Y.Auth,`Unable to fetch existing AuthFactors for user (${r?.userID}): ${p.message}`,oe.Error)}let l={},f=0;for(let[p,w]of Object.entries(s)){let A=a.includes(w);if(!A&&await t.isExistingAuthFactor(p)){f+=1;continue}l[p]={authenticationPublicKey:w,isExistingAuthFactor:A}}if(r&&Object.keys(l).length===0){if(a.length===0&&f>0)return J.addBreadcrumb(Y.Auth,`AuthFactors map empty (expected): 
- user: ${r?.userID}
- locally available auth factors: ${Object.keys(s).length}
- filtered (belongs to other user): ${f}
- auth factors registered with user: ${a.length}`,oe.Info),l;J.addBreadcrumb(Y.Auth,`Unable to build AuthFactors map: 
- user: ${r?.userID}
- locally available auth factors: ${Object.keys(s).length}
- auth factors registered with user: ${a.length}`,oe.Error)}return l},"queryFn"),...e})},"useEligibleAuthFactors");m();g();m();g();var Tu=i(()=>{let{data:e}=Si();return!!e},"useIsLoggedIn");function q6(e,t){let r=Tu(),n;return e.enabled===void 0?n=r:typeof e.enabled=="function"?n=i(o=>(Px(typeof e.enabled=="function","expected enabled to be a function"),r&&e.enabled(o)),"enabled"):typeof e.enabled=="boolean"?n=r&&e.enabled:Te(e.enabled),Tr({...e,enabled:n},t)}i(q6,"useAuthQuery");m();g();var H6=i(()=>{let e=rr(),t=yn(),r=i(async({secretIdentifier:n})=>{await t.addAuthFactor({secretIdentifier:n}),await Mi(e)},"mutationFn");return Re({mutationFn:i(async n=>{try{await r(n);return}catch(o){J.addBreadcrumb(Y.Auth,`Could not add auth factor: ${n.secretIdentifier}`,oe.Error);let s;throw o instanceof Error?s=o:s=new Error(`Could not add auth factor: ${n.secretIdentifier}`),J.captureError(s,Y.Auth),s}},"mutationFn")})},"useAddAuthFactor");m();g();var j6=i(()=>{let e=rr(),t=yn(),r=i(async({authenticationPublicKey:n})=>{await t.deleteAuthFactor({authenticationPublicKey:n}),await Mi(e)},"mutationFn");return Re({mutationFn:i(async n=>{try{await r(n);return}catch(o){J.addBreadcrumb(Y.Auth,"Could not remove auth factor!",oe.Error);let s;throw o instanceof Error?s=o:s=new Error("Could not remove auth factor!"),J.captureError(s,Y.Auth),s}},"mutationFn")})},"useRemoveAuthFactor");m();g();var z6=i(()=>{let{data:e}=Si();return e?.accessToken},"useAccessToken");m();g();var F6=i(()=>{let{data:e}=Si();return e?.userID},"useUserID");m();g();var W6=me(qt());m();g();var vp=class{static{i(this,"AccountAnalytics")}#e;#t;#r;constructor(t,r,n){this.#e=t,this.#t=r,this.#r=n}identifyAccount=i(async(t,r,n)=>{let o=r.addresses.find(B=>be.isSolanaNetworkID(B.networkID))?.address,s=r.addresses.find(B=>be.isEthereumNetworkID(B.networkID))?.address,a=r.addresses.find(B=>be.isBitcoinNetworkID(B.networkID))?.address,l=r.addresses.find(B=>be.isSuiNetworkID(B.networkID))?.address,f={hasSolanaAddress:!!o,hasEthereumAddress:!!s,hasBitcoinAddress:!!a,hasSuiAddress:!!l,solanaAddress:o,evmAddress:s,bitcoinAddress:a,suiAddress:l},p=n.enabledChainIDs.map(B=>be[B].name).join(", "),w=new Set;for(let B of t)switch(B.type){case U.Seed:case U.Seedless:w.add(B.seedIdentifier);break;case U.ReadOnly:case U.PrivateKey:case U.Ledger:case U.SeedVault:case U.KMSVault:break;default:Te(B);break}let{id:A,type:_}=await this.getIdentifyID(r),T=await this.getUsername();switch(r.type){case U.Seed:case U.Seedless:this.#e.identify(A,{...f,accountType:r.type,rootID:r.seedIdentifier,rootIds:Array.from(w),accountID:r.identifier,isReadOnly:!1,enabledChains:p,idType:_,username:T});break;case U.ReadOnly:this.#e.identify(A,{...f,accountType:r.type,isReadOnly:!0,enabledChains:p,idType:_,username:T});break;case U.PrivateKey:case U.Ledger:case U.SeedVault:case U.KMSVault:this.#e.identify(A,{...f,accountType:r.type,rootIds:Array.from(w),accountID:r.identifier,isReadOnly:!1,enabledChains:p,idType:_,username:T});break;default:Te(r)}},"identifyAccount");getIdentifyID=i(async t=>{let r=await this.#t.getUser().catch(()=>{});return r?{type:"userID",id:r.userID}:{type:"accountID",id:t.identifier}},"getIdentifyID");getUsername=i(async()=>{let t=await this.#r.getUserProfile().catch(()=>{});if(t)return t.username},"getUsername");onAppSessionStart=i(t=>{let r=new Map;for(let n of t){if(n.type===U.ReadOnly)continue;let{addresses:o,identifier:s}=n;for(let a of o){let l=be.getChainName(a.networkID),f={type:n.type,accountId:s,id:a.address};if(!r.get(l))r.set(l,[f]);else{let p=r.get(l)??[];r.set(l,[...p,f])}}}this.#e.capture("appSessionStart",{data:{ids:Object.fromEntries(r)}})},"onAppSessionStart")};var wp=kw(null);m();g();m();g();var $H=v.string().regex(/^(root-derivation-path-group|(recommended|secondary|tertiary)-group:index-\d{1,10})$/,{message:"Invalid derivation path group."}),xp;(function(e){e.PrivateKey="privateKey",e.Mnemonic="mnemonic",e.Seedless="seedless"})(xp||(xp={}));m();g();var Lx=i(({index:e,offsetIndex:t})=>({name:xo.t("onboardingImportAccountsAccountName",{walletIndex:t+e+1})}),"createAccountMetadata");m();g();var Sp=i(e=>{switch(e){case ve.BitcoinTaproot:case ve.BitcoinNativeSegwit:case ve.BitcoinNestedSegwit:case ve.BitcoinLegacy:case ve.Bip44ChangeSolana:case ve.Bip44Ethereum:return!0;case ve.Bip44Solana:case ve.DeprecatedSolana:case ve.Bip44RootSolana:case ve.Bip44RootEthereum:case ve.Bip44EthereumSecondary:case ve.Bip44EthereumTertiary:case ve.Bip44Sui:return!1}},"isRecommendedDerivationPathType");m();g();var $6=i(({pathType:e,index:t})=>{switch(e){case ve.Bip44RootEthereum:case ve.Bip44RootSolana:return"root-derivation-path-group";case ve.Bip44ChangeSolana:case ve.Bip44Ethereum:case ve.Bip44Sui:case ve.BitcoinTaproot:case ve.BitcoinNativeSegwit:case ve.BitcoinNestedSegwit:case ve.BitcoinLegacy:return`recommended-group:index-${t}`;case ve.Bip44EthereumSecondary:case ve.Bip44Solana:return`secondary-group:index-${t}`;case ve.Bip44EthereumTertiary:case ve.DeprecatedSolana:return`tertiary-group:index-${t}`}},"getDerivationPathGroupKey");m();g();var G6=i(e=>e==null?!1:[U.Ledger,U.SeedVault].includes(e),"isHardwareWalletAccountType");m();g();m();g();var Cf="Trying to find a selected account, but there no accounts in the vault.",Dx=i(e=>e?e instanceof Error?e.message===Cf:String(e)===Cf:!1,"isNoAccountsError"),Z6="Missing ChainAvailability.",Vx=i((e,t)=>`No account found! Num accounts: ${e} | Identifier used: ${t}`,"NoAccountFoundFromIdentifierErrorMsg"),Ap=new Error("The current account group has no valid bitcoin address"),Ep=new Error("The current account group has no valid EIP-155 address"),_p=new Error("The current account group has no valid solana address"),Mp=new Error("The current account group has no valid sui address"),qx=new Error("The current account group has no valid address or the the chain type was unsupported"),yj=new Error("[Legacy Mn*monic Fetch] no legacy mn*monic in storage"),bj=new Error("[Legacy Mn*monic Fetch] internal error fetching legacy mn*monic");function Hx(e,t){let n=(e?.addresses??[]).find(({addressType:o})=>o===t);if(!e?.addresses||!n)switch(t){case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:throw Ap;case K.EVM:throw Ep;case K.Solana:throw _p;case K.Sui:throw Mp;default:throw qx}return n}i(Hx,"getChainAddressByAccount");function Y6(e,t){return Hx(e,t)?.address}i(Y6,"getAddressByAccount");function J6(e){switch(e.type){case U.Seed:case U.Seedless:case U.Ledger:return e.chains?Object.entries(e.chains).map(([t,r])=>({addressType:t,address:"address"in r?r.address:Object.values(r.addresses)[0]})):[];case U.PrivateKey:return e.chainType===K.BitcoinTaproot||e.chainType===K.BitcoinNativeSegwit||e.chainType===K.BitcoinNestedSegwit||e.chainType===K.BitcoinLegacy?Object.entries(e.addresses).map(([t,r])=>({addressType:e.chainType,address:r})):[{addressType:e.chainType,address:"address"in e?e.address:""}];case U.ReadOnly:return Object.entries(e.addresses).map(([t,r])=>({addressType:t,address:r||""}));case U.SeedVault:return[{addressType:"solana",address:e.address}];default:return[]}}i(J6,"getAddressesFromAccount");function Qn(e){return e?J6(e).filter(r=>r.address):[]}i(Qn,"getWalletAddressesFromAccount");function X6(e){return eB(e)||Q6(e)||jx(e)}i(X6,"isExportableAccount");function jx(e){return e?.type===U.KMSVault}i(jx,"isKMSVaultAccount");function Q6(e){return e?.type===U.Seedless}i(Q6,"isSeedlessAccount");function eB(e){return e?.type===U.Seed}i(eB,"isSeedAccount");m();g();var tB=i(e=>{let t=e.toString();return wu(t)},"formatAddressValue");m();g();function rB(e){let t=e.endsWith(".sol"),r=e==="@",n=e.startsWith("@")&&e.length>1;return[t,r,n]}i(rB,"parseBonfidaHandle");m();g();function nB(e){return[e.endsWith(".eth")]}i(nB,"parseENSHandle");m();g();var oB=i(async(e,t,r)=>{let o=(await e.fetchAllAccounts()).find(a=>{switch(a.type){case U.Seed:case U.Seedless:return a.seedIdentifier===r;case U.PrivateKey:return a.privateKeyIdentifier===r;case U.Ledger:case U.SeedVault:case U.ReadOnly:case U.KMSVault:return!1;default:Te(a)}});if(!o)throw new Error("Unable to find account to sign client JWT with.");let s=await e.sign(o.identifier,{isJWT:!0,data:t});if(s.status==="error")throw new Error("Error signing over clientJWT.");if(!("signedJWT"in s)||!s.signedJWT)throw new Error("No JWT from vault signing.");return s.signedJWT},"signClientJWT");m();g();m();g();m();g();m();g();var or="vault";function wn(e,t=or){return`kms:${e}:${t}`}i(wn,"getKMSVaultIdentifier");m();g();m();g();m();g();m();g();m();g();m();g();var zx="2025-11-24";m();g();m();g();var Tp=v.enum(["Ed25519","Secp256k1"]),Bp=v.enum(["Ethereum","Solana","BitcoinSegwit","Sui","BitcoinTaproot"]),Nt=v.object({curve:Tp,derivationPath:v.string(),addressFormat:Bp}),ls=Nt.extend({address:v.string(),publicKey:v.string().regex(Nl)}),Fx=v.object({walletId:v.string(),walletName:v.string(),tags:v.array(v.string())});var iB=v.object({code:v.number(),message:v.string()}),Wx=v.object({error:iB,requestId:v.string().optional()}),sB=v.object({kind:v.literal("RLP_ENCODED"),bytes:v.string()}),aB=v.object({kind:v.literal("PSBT"),bytes:v.string()}),cB=v.object({kind:v.literal("SUI_BCS_ENCODED_TRANSACTION_DATA"),bytes:v.string()}),kp=v.union([v.array(v.number().int().min(0)),v.string(),sB,aB,cB]),Kf=v.object({envelope:v.string(),publicKey:v.string(),proof:v.string().optional()}),_o=v.enum(["Ed25519","Secp256r1","Secp256k1","Secp256k1Keccak256"]),oz=v.object({publicKey:v.array(v.number().int().min(0)),algorithm:_o}),iz=v.discriminatedUnion("authenticatorKind",[v.object({authenticatorKind:v.literal("keypair"),publicKey:v.array(v.number().int().min(0)),algorithm:_o}),v.object({authenticatorKind:v.literal("passkey")}),v.object({authenticatorKind:v.literal("oidc")})]),Pp=v.discriminatedUnion("authenticatorKind",[v.object({authenticatorKind:v.literal("keypair"),publicKey:v.string(),algorithm:_o,authenticatorName:v.string()}),v.object({authenticatorKind:v.literal("passkey"),authenticatorName:v.string()}),v.object({authenticatorKind:v.literal("oidc"),authenticatorName:v.string(),jwksUrl:v.string().url(),idTokenClaims:v.object({sub:v.string(),iss:v.string(),aud:v.string().nullish().default(null)})})]),uB=v.discriminatedUnion("authenticatorKind",[v.object({authenticatorKind:v.literal("keypair"),publicKey:v.string(),algorithm:_o,authenticatorName:v.string(),id:v.string(),createdAtMs:v.number()}),v.object({authenticatorKind:v.literal("passkey"),authenticatorName:v.string(),id:v.string(),createdAtMs:v.number()}),v.object({authenticatorKind:v.literal("oidc"),authenticatorName:v.string(),jwksUrl:v.string().url(),idTokenClaims:v.object({sub:v.string(),iss:v.string(),aud:v.string().nullish().default(null)}),id:v.string(),createdAtMs:v.number()})]),lB=v.object({type:v.literal("CEL"),preset:v.literal("LEGACY_USER_ROLE")}),fB=v.enum(["ALLOW","DENY"]),dB=v.object({expression:v.string().min(1).max(4096),outcome:fB,comment:v.string().min(0).max(200)}),Ip=v.lazy(()=>v.union([v.null(),v.boolean(),v.string(),v.number().finite(),v.array(Ip),v.record(Ip)])),hB=v.object({name:v.string().min(1).max(50),value:Ip,comment:v.string().min(0).max(200)}),pB=v.object({type:v.literal("CEL"),rules:v.array(dB),constants:v.array(hB)}),mB=v.object({usdCentsLimitPerDay:v.number(),memoryAccount:v.string(),memoryId:v.number(),memoryBump:v.number()}),gB=v.object({ethereumMessage:v.boolean(),ethereumTx:v.boolean(),ethereumTypedData:v.boolean(),rawPayload:v.boolean(),solanaTx:v.boolean(),utf8Message:v.boolean()}),$x=v.object({type:v.literal("CEL"),preset:v.literal("DAPP_CONNECTION_USER"),walletId:v.string(),usdLimit:mB.nullish().default(null),allowedMethods:gB.nullish().default(null),solanaProgramAllowlist:v.array(v.string()).nullish().default(null),derivationAllowlist:v.array(Nt.shape.derivationPath).nullish().default(null)}),yB=v.union([pB,lB,$x]),bB=v.object({type:v.literal("ROOT")}),Bu=v.union([bB,yB]),Gx=v.enum(["ADMIN","USER"]),ku=v.object({username:v.string(),role:Gx.or(Bu).optional(),traits:v.object({appId:v.string().optional()}).optional(),authenticators:v.array(Pp),policy:Bu.optional(),expiresInMs:v.number().optional()}),Zx=v.object({username:v.string(),role:Gx.optional(),authenticators:v.array(uB),traits:v.record(v.string()).optional().default({}),expiresAtMs:v.number().nullish().default(null),createdAtMs:v.number().nullish().default(null)}),vB=Zx.extend({policy:Bu.optional()}),wB=v.union([vB,Zx]),Er=v.object({organizationId:v.string(),organizationName:v.string(),parentOrganizationId:v.string().nullish().default(null),tags:v.array(v.string()),users:v.array(wB)}),xB=v.discriminatedUnion("rule",[v.object({rule:v.literal("SystemInstructionLamportsThreshold"),min:v.number().int().min(0).nullish().default(null),max:v.number().int().min(0).nullish().default(null)}),v.object({rule:v.literal("SystemInstructionRecipientAllowlist"),allowlist:v.array(v.string())})]),SB=v.union([v.object({In:v.array(v.number().int().min(0))}),v.object({Exact:v.number().int().min(0)}),v.literal("Any")]),Of=v.object({programId:v.string(),discriminator:SB,validate:v.array(xB).optional()}),sz=v.object({max:v.number().int().min(0)}),az=v.object({maxComputeUnitPrice:v.number().int().min(0).nullish().default(null),maxComputeUnits:v.number().int().min(0).nullish().default(null)}),cz=v.object({allowlist:v.array(Of)}),uz=v.object({allowlist:v.array(Of).optional()}),lz=v.null().default(null),AB=v.discriminatedUnion("rule",[v.object({rule:v.literal("NoSignerAccountUsage"),allowlist:v.array(Of).optional()}),v.object({rule:v.literal("BundleSizeLimit"),max:v.number().int().min(0)}),v.object({rule:v.literal("ComputeBudgetLimit"),maxComputeUnitPrice:v.number().int().min(0).nullish().default(null),maxComputeUnits:v.number().int().min(0).nullish().default(null)}),v.object({rule:v.literal("NoAddressLookupTables")}),v.object({rule:v.literal("InstructionAllowlist"),allowlist:v.array(Of)}),v.object({rule:v.literal("AllowAll")})]),EB=v.object({rules:v.array(AB)}),_B=v.object({version:v.literal("v0"),solana:EB.nullish().default(null)}),Pu=_B,MB=v.enum(["owner","signaturePayload","signatureTransaction"]),IB=v.object({version:v.literal("v0"),scopes:v.array(MB),derivationAllowlist:v.array(Nt).nullish().default(null)}),Cu=IB;var Rf=class e extends Error{static{i(this,"KMSRpcError")}response;method;errorCode;requestId;constructor(t,r){let{message:n,requestId:o,code:s}=TB(r.data),a=`KMS RPC call failed: ${t} returned ${r.status} ${r.statusText} - ${n}${o?` (requestId: ${o})`:""}`;super(a),this.name="KMSRpcError",this.response=r,this.method=t,this.requestId=o,this.errorCode=s,Object.setPrototypeOf(this,e.prototype)}};function TB(e){let t=Wx.safeParse(e);if(!t.success)return{message:"Unknown error"};let{error:r,requestId:n}=t.data;return{message:r.message,requestId:n,code:r.code}}i(TB,"extractErrorInfo");var BB="00000000-0000-0000-0000-000000000000",kB="/v1/wallets/kms/rpc";async function Be(e,t,r,n){let o={method:t,params:r,timestampMs:await Ya()},s=await Cp(e,t,o);return n.parse(s)}i(Be,"rpcCall");async function Cp(e,t,r){let n=JSON.stringify(r),o;try{let w=await e.getPublicKey(),A=await e.signRpcPayload(r);o=pt(Buffer.from(JSON.stringify({publicKey:w,signature:A,kind:"PKI"}),"utf-8"))}catch(w){throw new Error(`[KMS] Failed to authenticate rpc call: ${w instanceof Error?w.message:"Unknown error"}`)}let s=k.WALLET_SERVICE_API_URL,l=await(s?Mt.api("custom",s):Mt.api()).bearer(!0).post(kB,n,{headers:{"Content-Type":"application/json","X-Phantom-Stamp":o,"X-App-Id":BB,"x-api-version":zx},validateStatus:!1}),f=!ja(l),p=l.data&&typeof l.data=="object"&&"error"in l.data;if(f||p)throw new Rf(t,l);return l.data}i(Cp,"baseRpcCall");m();g();m();g();m();g();function fs(e,t){return e.users.find(r=>r.authenticators.some(n=>n.authenticatorKind!=="keypair"?!1:Ll(n.publicKey)===t))}i(fs,"getByPublicKey");var Op=v.object({organizationId:v.string(),user:ku,replaceExpirable:v.boolean().optional()}),Uf=v.object({result:Er}).transform(e=>({result:e.result,getByPublicKey:i(t=>fs(e.result,t),"getByPublicKey")}));function Kp(e,t){return Be(e.authenticator,"addUserToOrganization",t,Uf)}i(Kp,"addUserToOrganization");m();g();var Rp=v.object({organizationId:v.string(),importEnvelope:Kf,encryptedSecret:v.string().regex(Nl),walletName:v.string(),accounts:v.array(Nt),mnemonicLength:v.number().int().min(0).default(24).optional(),tags:v.array(v.string()).optional()}),Nf=v.object({result:v.object({walletId:v.string(),walletName:v.string(),accounts:v.array(ls)})});function Up(e,t){return Be(e.authenticator,"completeImportWallet",t,Nf)}i(Up,"completeImportWallet");m();g();var Np=v.object({organizationId:v.string(),username:v.string(),authenticator:Pp}),Lf=v.object({result:v.discriminatedUnion("authenticatorKind",[v.object({authenticatorKind:v.literal("keypair"),publicKey:v.string(),algorithm:_o,authenticatorName:v.string(),id:v.string(),createdAtMs:v.number()}),v.object({authenticatorKind:v.literal("passkey"),authenticatorName:v.string(),id:v.string(),createdAtMs:v.number()}),v.object({authenticatorKind:v.literal("oidc"),authenticatorName:v.string(),jwksUrl:v.string().url(),idTokenClaims:v.object({sub:v.string(),iss:v.string(),aud:v.string().nullish().default(null)}),id:v.string(),createdAtMs:v.number()})])});function Lp(e,t){return Be(e.authenticator,"createAuthenticator",t,Lf)}i(Lp,"createAuthenticator");m();g();var Dp=v.object({organizationName:v.string(),tags:v.array(v.string()).optional(),users:v.array(ku)}),Df=v.object({result:Er}).transform(e=>({result:e.result,getByPublicKey:i(t=>fs(e.result,t),"getByPublicKey")}));function Vp(e,t){return Be(e.authenticator,"createOrganization",t,Df)}i(Vp,"createOrganization");m();g();var qp=v.object({walletName:v.string(),organizationId:v.string(),mnemonicLength:v.number().int().min(0).default(24).optional(),accounts:v.array(Nt).optional()}),Vf=v.object({result:v.object({walletId:v.string(),walletName:v.string(),accounts:v.array(v.object({curve:Tp,derivationPath:v.string(),addressFormat:Bp,publicKey:v.string()}))})});function Hp(e,t){return Be(e.authenticator,"createWallet",t,Vf)}i(Hp,"createWallet");m();g();var jp=v.object({organizationId:v.string(),username:v.string(),authenticatorId:v.string()}),qf=v.object({result:Er}).transform(e=>({result:e.result,getByPublicKey:i(t=>fs(e.result,t),"getByPublicKey")}));function zp(e,t){return Be(e.authenticator,"deleteAuthenticator",t,qf)}i(zp,"deleteAuthenticator");m();g();var Fp=v.object({organizationId:v.string(),username:v.string()}),Hf=v.object({result:Er});function Wp(e,t){return Be(e.authenticator,"deleteUserFromOrganization",t,Hf)}i(Wp,"deleteUserFromOrganization");m();g();var $p=v.object({message:v.string(),organizationId:v.string(),walletId:v.string(),derivationInfo:Nt.nullish().default(null),policyName:v.string().optional()}),jf=v.object({result:v.object({signature:v.string(),address:v.string(),publicKey:v.string()})});function Gp(e,t){return Be(e.authenticator,"ethereumSignMessage",t,jf)}i(Gp,"ethereumSignMessage");m();g();var Yx=v.union([Vl,ql,Hl]),Zp=v.object({typedData:Yx,organizationId:v.string(),walletId:v.string(),derivationInfo:Nt.nullish().default(null),policyName:v.string().optional()}),zf=v.object({result:v.object({signature:v.string(),address:v.string(),publicKey:v.string()})});function Yp(e,t){return Be(e.authenticator,"ethereumSignTypedData",t,zf)}i(Yp,"ethereumSignTypedData");m();g();var Jp=v.object({organizationId:v.string(),walletId:v.string(),publicKey:v.string()}),Ff=v.object({result:v.object({encryptedBundle:v.string()})});function Xp(e,t){return Be(e.authenticator,"exportWallet",t,Ff)}i(Xp,"exportWallet");m();g();var Qp=v.object({organizationId:v.string(),walletId:v.string(),accounts:v.array(Nt)}),Wf=v.object({result:v.array(ls)});function em(e,t){return Be(e.authenticator,"getAccounts",t,Wf)}i(em,"getAccounts");m();g();var tm=v.object({publicKey:v.string()}),$f=v.object({result:Er});function rm(e,t){return Be(e.authenticator,"getOrCreatePhantomOrganization",t,$f)}i(rm,"getOrCreatePhantomOrganization");m();g();var nm=v.object({walletName:v.string(),organizationId:v.string(),tag:v.string(),mnemonicLength:v.number().int().min(0).default(24).optional(),accounts:v.array(Nt).optional()}),Gf=v.object({result:v.object({walletId:v.string(),walletName:v.string(),accounts:v.array(ls)})});function om(e,t){return Be(e.authenticator,"getOrCreateWalletWithTag",t,Gf)}i(om,"getOrCreateWalletWithTag");m();g();var im=v.object({organizationId:v.string()}),Zf=v.object({result:Er}).transform(e=>({result:e.result,getByPublicKey:i(t=>fs(e.result,t),"getByPublicKey")}));function sm(e,t){return Be(e.authenticator,"getOrganization",t,Zf)}i(sm,"getOrganization");m();g();var am=v.object({organizationId:v.string(),limit:v.number().int().min(0).optional(),offset:v.number().int().min(0).optional()}),Yf=v.object({result:v.object({wallets:v.array(Fx),totalCount:v.number().int().min(0),limit:v.number().int().min(0),offset:v.number().int().min(0)})});function cm(e,t){return Be(e.authenticator,"getOrganizationWallets",t,Yf)}i(cm,"getOrganizationWallets");m();g();var um=v.object({}),Jf=v.object({result:Er.nullish()});function lm(e,t){return Be(e.authenticator,"getPhantomOrganization",t,Jf)}i(lm,"getPhantomOrganization");m();g();var fm=v.object({organizationId:v.string(),tag:v.string(),accounts:v.array(Nt).optional()}),Xf=v.object({result:v.object({walletId:v.string(),walletName:v.string(),accounts:v.array(ls)}).nullish()});function dm(e,t){return Be(e.authenticator,"getWalletWithTag",t,Xf)}i(dm,"getWalletWithTag");m();g();var hm=v.object({ownerOrganizationId:v.string(),targetOrganizationId:v.string(),walletId:v.string(),policy:Cu,transactionPolicy:Pu.nullish().default(null)}),Qf=v.object({result:v.object({organizationId:v.string(),walletId:v.string(),organizationPolicy:Cu,transactionPolicy:Pu.nullish().default(null)})});function pm(e,t){return Be(e.authenticator,"grantOrganizationAccess",t,Qf)}i(pm,"grantOrganizationAccess");m();g();var mm=v.object({organizationId:v.string()}),ed=v.object({result:Kf,signature:v.string().optional()});function gm(e,t){return Be(e.authenticator,"initWalletImport",t,ed)}i(gm,"initWalletImport");m();g();var ym=v.object({ownerOrganizationId:v.string(),targetOrganizationId:v.string(),walletId:v.string()}),td=v.object({result:v.object({organizationId:v.string(),walletId:v.string(),organizationPolicy:Cu,transactionPolicy:Pu.nullish().default(null)})});function bm(e,t){return Be(e.authenticator,"revokeOrganizationAccess",t,td)}i(bm,"revokeOrganizationAccess");m();g();var vm=v.object({payload:v.union([v.array(v.number().int().min(0)),v.string()]),organizationId:v.string(),walletId:v.string(),derivationInfo:Nt,algorithm:_o}),rd=v.object({result:v.object({signature:v.string(),address:v.string(),publicKey:v.string()})});function wm(e,t){let r=Array.isArray(t.payload)?pt(Buffer.from(t.payload)):t.payload;return Be(e.authenticator,"signRawPayload",{...t,payload:r},rd)}i(wm,"signRawPayload");m();g();var xm=v.object({transaction:kp,organizationId:v.string(),walletId:v.string(),derivationInfo:Nt.nullish().default(null),policyName:v.string().nullish().default(null)}),nd=v.object({result:v.object({transaction:kp,address:v.string(),publicKey:v.string(),signature:v.string().optional()})});function Sm(e,t){return Be(e.authenticator,"signTransaction",t,nd)}i(Sm,"signTransaction");m();g();var Am=v.object({message:v.string(),organizationId:v.string(),walletId:v.string(),derivationInfo:Nt,algorithm:_o,policyName:v.string().optional()}),od=v.object({result:v.object({signature:v.string(),address:v.string(),publicKey:v.string()})});function Em(e,t){return Be(e.authenticator,"signUtf8Message",t,od)}i(Em,"signUtf8Message");m();g();var _m=v.object({organizationId:v.string(),username:v.string(),newPolicy:Bu.optional(),addTraits:v.record(v.string()).optional(),removeTraits:v.record(v.string()).optional()}),id=v.object({result:Er});function Mm(e,t){return Be(e.authenticator,"updateUserInOrganization",t,id)}i(Mm,"updateUserInOrganization");var PB=20,CB={createOrganization:{request:Dp,response:Df},getOrganization:{request:im,response:Zf},getOrCreatePhantomOrganization:{request:tm,response:$f},getPhantomOrganization:{request:um,response:Jf},addUserToOrganization:{request:Op,response:Uf},deleteUserFromOrganization:{request:Fp,response:Hf},updateUserInOrganization:{request:_m,response:id},createAuthenticator:{request:Np,response:Lf},deleteAuthenticator:{request:jp,response:qf},createWallet:{request:qp,response:Vf},getOrganizationWallets:{request:am,response:Yf},getOrCreateWalletWithTag:{request:nm,response:Gf},getWalletWithTag:{request:fm,response:Xf},exportWallet:{request:Jp,response:Ff},grantOrganizationAccess:{request:hm,response:Qf},revokeOrganizationAccess:{request:ym,response:td},initWalletImport:{request:mm,response:ed},completeImportWallet:{request:Rp,response:Nf},signRawPayload:{request:vm,response:rd},signTransaction:{request:xm,response:nd},signUtf8Message:{request:Am,response:od},ethereumSignMessage:{request:$p,response:jf},ethereumSignTypedData:{request:Zp,response:zf},getAccounts:{request:Qp,response:Wf}};async function Im(e,t){if(t.length===0)return[];let r=[],n=await Ya();for(let o of OB(t,PB)){let s=o.map(f=>({method:f.method,params:f.params,timestampMs:n})),a=await Cp(e,"batch",s);if(!Array.isArray(a))throw new Error("[KMS] Batch RPC call returned non-array response");if(a.length!==o.length)throw new Error(`[KMS] Batch RPC call response length mismatch: expected ${o.length}, got ${a.length}`);let l=o.map((f,p)=>CB[f.method].response.parse(a[p]));r.push(...l)}return r}i(Im,"batchRpcCall");function Jx(e,t){return{method:e,params:t}}i(Jx,"createBatchRequest");function OB(e,t){if(e.length<=t)return[e];let r=[];for(let n=0;n<e.length;n+=t)r.push(e.slice(n,n+t));return r}i(OB,"chunk");var Ii;(function(e){e.RLP_ENCODED="RLP_ENCODED",e.PSBT="PSBT",e.EIP_1559="EIP_1559",e.SUI_BCS_ENCODED_TRANSACTION_DATA="SUI_BCS_ENCODED_TRANSACTION_DATA"})(Ii||(Ii={}));function ic(e){return{createOrganization:i(t=>Vp(e,t),"createOrganization"),getOrganization:i(t=>sm(e,t),"getOrganization"),createAuthenticator:i(t=>Lp(e,t),"createAuthenticator"),deleteAuthenticator:i(t=>zp(e,t),"deleteAuthenticator"),deleteUserFromOrganization:i(t=>Wp(e,t),"deleteUserFromOrganization"),createWallet:i(t=>Hp(e,t),"createWallet"),getOrganizationWallets:i(t=>cm(e,t),"getOrganizationWallets"),getOrCreateWalletWithTag:i(t=>om(e,t),"getOrCreateWalletWithTag"),getWalletWithTag:i(t=>dm(e,t),"getWalletWithTag"),exportWallet:i(t=>Xp(e,t),"exportWallet"),grantOrganizationAccess:i(t=>pm(e,t),"grantOrganizationAccess"),revokeOrganizationAccess:i(t=>bm(e,t),"revokeOrganizationAccess"),initWalletImport:i(t=>gm(e,t),"initWalletImport"),completeImportWallet:i(t=>Up(e,t),"completeImportWallet"),getOrCreatePhantomOrganization:i(async()=>{let t=await e.authenticator.getPublicKey();return rm(e,{publicKey:t})},"getOrCreatePhantomOrganization"),getPhantomOrganization:i(t=>lm(e,t),"getPhantomOrganization"),getAuthenticatorPublicKey:i(()=>e.authenticator.getPublicKey(),"getAuthenticatorPublicKey"),signRawPayload:i(t=>wm(e,t),"signRawPayload"),signTransaction:i(t=>Sm(e,t),"signTransaction"),signUtf8Message:i(t=>Em(e,t),"signUtf8Message"),ethereumSignMessage:i(t=>Gp(e,t),"ethereumSignMessage"),ethereumSignTypedData:i(t=>Yp(e,t),"ethereumSignTypedData"),getAccounts:i(t=>em(e,t),"getAccounts"),addUserToOrganization:i(t=>Kp(e,t),"addUserToOrganization"),updateUserInOrganization:i(t=>Mm(e,t),"updateUserInOrganization"),batchRpcCall:i(t=>Im(e.authenticator,t),"batchRpcCall")}}i(ic,"createKMS");m();g();var RB=["createOrganization","getOrganization","getOrCreatePhantomOrganization","getPhantomOrganization","addUserToOrganization","deleteUserFromOrganization","updateUserInOrganization","createAuthenticator","deleteAuthenticator","createWallet","getOrganizationWallets","getOrCreateWalletWithTag","getWalletWithTag","exportWallet","grantOrganizationAccess","revokeOrganizationAccess","initWalletImport","completeImportWallet","signRawPayload","signTransaction","signUtf8Message","ethereumSignMessage","ethereumSignTypedData","getAccounts"],Qx=v.enum(RB),Xx=v.object({method:Qx,params:v.record(v.unknown()),timestampMs:v.number().int().positive()}),sd=v.union([Xx,v.array(Xx)]);function Tm(e){return sd.parse(e)}i(Tm,"validateKMSRpcPayload");m();g();function UB(e){switch(e){case"Solana":case"Sui":return"Ed25519";case"Ethereum":case"BitcoinSegwit":case"BitcoinTaproot":return"Secp256k1";default:return Te(e)}}i(UB,"getExpectedCurve");function NB(e,t){for(let{curve:r,addressFormat:n}of e){let o=UB(n);if(r!==o)throw new Error(`KMS ${t} request expected curve ${o} for address format ${n}, received ${r}.`)}}i(NB,"validateRequestedAccounts");async function Bm(e,t,r){NB(r,"getWalletWithTag");let{result:n}=await e.getPhantomOrganization({});if(!n)return null;let{result:o}=await e.getWalletWithTag({organizationId:n.organizationId,tag:t,accounts:r});return o?{organizationId:n.organizationId,walletId:o.walletId,walletName:o.walletName,accounts:o.accounts}:null}i(Bm,"getKMSWalletByTagIfExists");m();g();m();g();function e1(e){switch(e){case K.Solana:return{curve:"Ed25519",addressFormat:"Solana"};case K.EVM:return{curve:"Secp256k1",addressFormat:"Ethereum"};case K.BitcoinTaproot:return{curve:"Secp256k1",addressFormat:"BitcoinTaproot"};case K.BitcoinNativeSegwit:return{curve:"Secp256k1",addressFormat:"BitcoinSegwit"};case K.BitcoinNestedSegwit:case K.BitcoinLegacy:throw new Error(`KMS accounts do not support Bitcoin address format ${e}.`);case K.Sui:return{curve:"Ed25519",addressFormat:"Sui"};default:throw new Error(`Unsupported chain type: ${e}`)}}i(e1,"getKMSCurveAndFormatForChainType");function t1(e){switch(e){case ve.Bip44RootSolana:case ve.Bip44Solana:case ve.Bip44ChangeSolana:case ve.DeprecatedSolana:return{curve:"Ed25519",addressFormat:"Solana"};case ve.Bip44RootEthereum:case ve.Bip44Ethereum:case ve.Bip44EthereumSecondary:case ve.Bip44EthereumTertiary:return{curve:"Secp256k1",addressFormat:"Ethereum"};case ve.BitcoinTaproot:return{curve:"Secp256k1",addressFormat:"BitcoinTaproot"};case ve.BitcoinNativeSegwit:return{curve:"Secp256k1",addressFormat:"BitcoinSegwit"};case ve.BitcoinNestedSegwit:case ve.BitcoinLegacy:throw new Error(`KMS accounts do not support Bitcoin derivation path ${e}.`);case ve.Bip44Sui:return{curve:"Ed25519",addressFormat:"Sui"};default:throw new Error(`Unsupported derivation path type: ${e}`)}}i(t1,"getKMSCurveAndFormatForPathType");function km(e,t=0){let r=[];for(let n of e)try{let o=t1(n),s=vi({pathType:n,index:t});r.push({curve:o.curve,derivationPath:s,addressFormat:o.addressFormat})}catch{continue}return r}i(km,"convertDerivationPathTypesToKMSInfo");async function Pm(e=0){let t=zr().enabledAddressTypes,r=Br(t);return km(r,e)}i(Pm,"getKMSDerivationPathsForIndex");m();g();m();g();var Rm={};FI(Rm,{bitGet:()=>zB,bitLen:()=>jB,bitMask:()=>Ou,bitSet:()=>FB,bytesToHex:()=>Xs,bytesToNumberBE:()=>Bi,bytesToNumberLE:()=>cd,concatBytes:()=>sc,createHmacDrbg:()=>Km,ensureBytes:()=>nn,equalBytes:()=>qB,hexToBytes:()=>Qs,hexToNumber:()=>Om,isBytes:()=>eo,numberToBytesBE:()=>ds,numberToBytesLE:()=>ud,numberToHexUnpadded:()=>i1,numberToVarBytesBE:()=>VB,utf8ToBytes:()=>HB,validateObject:()=>hs});m();g();var o1=BigInt(0),ad=BigInt(1),LB=BigInt(2);function eo(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}i(eo,"isBytes");var DB=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Xs(e){if(!eo(e))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=DB[e[r]];return t}i(Xs,"bytesToHex");function i1(e){let t=e.toString(16);return t.length&1?`0${t}`:t}i(i1,"numberToHexUnpadded");function Om(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}i(Om,"hexToNumber");var Ti={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function r1(e){if(e>=Ti._0&&e<=Ti._9)return e-Ti._0;if(e>=Ti._A&&e<=Ti._F)return e-(Ti._A-10);if(e>=Ti._a&&e<=Ti._f)return e-(Ti._a-10)}i(r1,"asciiToBase16");function Qs(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length,r=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(r);for(let o=0,s=0;o<r;o++,s+=2){let a=r1(e.charCodeAt(s)),l=r1(e.charCodeAt(s+1));if(a===void 0||l===void 0){let f=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+s)}n[o]=a*16+l}return n}i(Qs,"hexToBytes");function Bi(e){return Om(Xs(e))}i(Bi,"bytesToNumberBE");function cd(e){if(!eo(e))throw new Error("Uint8Array expected");return Om(Xs(Uint8Array.from(e).reverse()))}i(cd,"bytesToNumberLE");function ds(e,t){return Qs(e.toString(16).padStart(t*2,"0"))}i(ds,"numberToBytesBE");function ud(e,t){return ds(e,t).reverse()}i(ud,"numberToBytesLE");function VB(e){return Qs(i1(e))}i(VB,"numberToVarBytesBE");function nn(e,t,r){let n;if(typeof t=="string")try{n=Qs(t)}catch(s){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${s}`)}else if(eo(t))n=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);let o=n.length;if(typeof r=="number"&&o!==r)throw new Error(`${e} expected ${r} bytes, got ${o}`);return n}i(nn,"ensureBytes");function sc(...e){let t=0;for(let o=0;o<e.length;o++){let s=e[o];if(!eo(s))throw new Error("Uint8Array expected");t+=s.length}let r=new Uint8Array(t),n=0;for(let o=0;o<e.length;o++){let s=e[o];r.set(s,n),n+=s.length}return r}i(sc,"concatBytes");function qB(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return r===0}i(qB,"equalBytes");function HB(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}i(HB,"utf8ToBytes");function jB(e){let t;for(t=0;e>o1;e>>=ad,t+=1);return t}i(jB,"bitLen");function zB(e,t){return e>>BigInt(t)&ad}i(zB,"bitGet");var FB=i((e,t,r)=>e|(r?ad:o1)<<BigInt(t),"bitSet"),Ou=i(e=>(LB<<BigInt(e-1))-ad,"bitMask"),Cm=i(e=>new Uint8Array(e),"u8n"),n1=i(e=>Uint8Array.from(e),"u8fr");function Km(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=Cm(e),o=Cm(e),s=0,a=i(()=>{n.fill(1),o.fill(0),s=0},"reset"),l=i((...A)=>r(o,n,...A),"h"),f=i((A=Cm())=>{o=l(n1([0]),A),n=l(),A.length!==0&&(o=l(n1([1]),A),n=l())},"reseed"),p=i(()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let A=0,_=[];for(;A<t;){n=l();let T=n.slice();_.push(T),A+=n.length}return sc(..._)},"gen");return i((A,_)=>{a(),f(A);let T;for(;!(T=_(p()));)f();return a(),T},"genUntil")}i(Km,"createHmacDrbg");var WB={bigint:i(e=>typeof e=="bigint","bigint"),function:i(e=>typeof e=="function","function"),boolean:i(e=>typeof e=="boolean","boolean"),string:i(e=>typeof e=="string","string"),stringOrUint8Array:i(e=>typeof e=="string"||eo(e),"stringOrUint8Array"),isSafeInteger:i(e=>Number.isSafeInteger(e),"isSafeInteger"),array:i(e=>Array.isArray(e),"array"),field:i((e,t)=>t.Fp.isValid(e),"field"),hash:i(e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen),"hash")};function hs(e,t,r={}){let n=i((o,s,a)=>{let l=WB[s];if(typeof l!="function")throw new Error(`Invalid validator "${s}", expected function`);let f=e[o];if(!(a&&f===void 0)&&!l(f,e))throw new Error(`Invalid param ${String(o)}=${f} (${typeof f}), expected ${s}`)},"checkField");for(let[o,s]of Object.entries(t))n(o,s,!1);for(let[o,s]of Object.entries(r))n(o,s,!0);return e}i(hs,"validateObject");var ir=BigInt(0),Vt=BigInt(1),ea=BigInt(2),$B=BigInt(3),Um=BigInt(4),s1=BigInt(5),a1=BigInt(8),GB=BigInt(9),ZB=BigInt(16);function on(e,t){let r=e%t;return r>=ir?r:t+r}i(on,"mod");function YB(e,t,r){if(r<=ir||t<ir)throw new Error("Expected power/modulo > 0");if(r===Vt)return ir;let n=Vt;for(;t>ir;)t&Vt&&(n=n*e%r),e=e*e%r,t>>=Vt;return n}i(YB,"pow");function ld(e,t){if(e===ir||t<=ir)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=on(e,t),n=t,o=ir,s=Vt,a=Vt,l=ir;for(;r!==ir;){let p=n/r,w=n%r,A=o-a*p,_=s-l*p;n=r,r=w,o=a,s=l,a=A,l=_}if(n!==Vt)throw new Error("invert: does not exist");return on(o,t)}i(ld,"invert");function JB(e){let t=(e-Vt)/ea,r,n,o;for(r=e-Vt,n=0;r%ea===ir;r/=ea,n++);for(o=ea;o<e&&YB(o,t,e)!==e-Vt;o++);if(n===1){let a=(e+Vt)/Um;return i(function(f,p){let w=f.pow(p,a);if(!f.eql(f.sqr(w),p))throw new Error("Cannot find square root");return w},"tonelliFast")}let s=(r+Vt)/ea;return i(function(l,f){if(l.pow(f,t)===l.neg(l.ONE))throw new Error("Cannot find square root");let p=n,w=l.pow(l.mul(l.ONE,o),r),A=l.pow(f,s),_=l.pow(f,r);for(;!l.eql(_,l.ONE);){if(l.eql(_,l.ZERO))return l.ZERO;let T=1;for(let P=l.sqr(_);T<p&&!l.eql(P,l.ONE);T++)P=l.sqr(P);let B=l.pow(w,Vt<<BigInt(p-T-1));w=l.sqr(B),A=l.mul(A,B),_=l.mul(_,w),p=T}return A},"tonelliSlow")}i(JB,"tonelliShanks");function XB(e){if(e%Um===$B){let t=(e+Vt)/Um;return i(function(n,o){let s=n.pow(o,t);if(!n.eql(n.sqr(s),o))throw new Error("Cannot find square root");return s},"sqrt3mod4")}if(e%a1===s1){let t=(e-s1)/a1;return i(function(n,o){let s=n.mul(o,ea),a=n.pow(s,t),l=n.mul(o,a),f=n.mul(n.mul(l,ea),a),p=n.mul(l,n.sub(f,n.ONE));if(!n.eql(n.sqr(p),o))throw new Error("Cannot find square root");return p},"sqrt5mod8")}return e%ZB,JB(e)}i(XB,"FpSqrt");var QB=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Nm(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=QB.reduce((n,o)=>(n[o]="function",n),t);return hs(e,r)}i(Nm,"validateField");function e4(e,t,r){if(r<ir)throw new Error("Expected power > 0");if(r===ir)return e.ONE;if(r===Vt)return t;let n=e.ONE,o=t;for(;r>ir;)r&Vt&&(n=e.mul(n,o)),o=e.sqr(o),r>>=Vt;return n}i(e4,"FpPow");function t4(e,t){let r=new Array(t.length),n=t.reduce((s,a,l)=>e.is0(a)?s:(r[l]=s,e.mul(s,a)),e.ONE),o=e.inv(n);return t.reduceRight((s,a,l)=>e.is0(a)?s:(r[l]=e.mul(s,r[l]),e.mul(s,a)),o),r}i(t4,"FpInvertBatch");function Lm(e,t){let r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}i(Lm,"nLength");function c1(e,t,r=!1,n={}){if(e<=ir)throw new Error(`Expected Field ORDER > 0, got ${e}`);let{nBitLength:o,nByteLength:s}=Lm(e,t);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");let a=XB(e),l=Object.freeze({ORDER:e,BITS:o,BYTES:s,MASK:Ou(o),ZERO:ir,ONE:Vt,create:i(f=>on(f,e),"create"),isValid:i(f=>{if(typeof f!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof f}`);return ir<=f&&f<e},"isValid"),is0:i(f=>f===ir,"is0"),isOdd:i(f=>(f&Vt)===Vt,"isOdd"),neg:i(f=>on(-f,e),"neg"),eql:i((f,p)=>f===p,"eql"),sqr:i(f=>on(f*f,e),"sqr"),add:i((f,p)=>on(f+p,e),"add"),sub:i((f,p)=>on(f-p,e),"sub"),mul:i((f,p)=>on(f*p,e),"mul"),pow:i((f,p)=>e4(l,f,p),"pow"),div:i((f,p)=>on(f*ld(p,e),e),"div"),sqrN:i(f=>f*f,"sqrN"),addN:i((f,p)=>f+p,"addN"),subN:i((f,p)=>f-p,"subN"),mulN:i((f,p)=>f*p,"mulN"),inv:i(f=>ld(f,e),"inv"),sqrt:n.sqrt||(f=>a(l,f)),invertBatch:i(f=>t4(l,f),"invertBatch"),cmov:i((f,p,w)=>w?p:f,"cmov"),toBytes:i(f=>r?ud(f,s):ds(f,s),"toBytes"),fromBytes:i(f=>{if(f.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${f.length}`);return r?cd(f):Bi(f)},"fromBytes")});return Object.freeze(l)}i(c1,"Field");function u1(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}i(u1,"getFieldBytesLength");function Dm(e){let t=u1(e);return t+Math.ceil(t/2)}i(Dm,"getMinHashLength");function fd(e,t,r=!1){let n=e.length,o=u1(t),s=Dm(t);if(n<16||n<s||n>1024)throw new Error(`expected ${s}-1024 bytes of input, got ${n}`);let a=r?Bi(e):cd(e),l=on(a,t-Vt)+Vt;return r?ud(l,o):ds(l,o)}i(fd,"mapHashToField");m();g();m();g();m();g();m();g();function f1(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}i(f1,"number");function r4(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}i(r4,"isBytes");function Vm(e,...t){if(!r4(e))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}i(Vm,"bytes");function d1(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");f1(e.outputLen),f1(e.blockLen)}i(d1,"hash");function ac(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}i(ac,"exists");function h1(e,t){Vm(e);let r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}i(h1,"output");m();g();m();g();var dd=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function p1(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}i(p1,"isBytes");var hd=i(e=>new DataView(e.buffer,e.byteOffset,e.byteLength),"createView"),to=i((e,t)=>e<<32-t|e>>>t,"rotr"),n4=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!n4)throw new Error("Non little-endian hardware is not supported");function o4(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}i(o4,"utf8ToBytes");function Ku(e){if(typeof e=="string"&&(e=o4(e)),!p1(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}i(Ku,"toBytes");function m1(...e){let t=0;for(let n=0;n<e.length;n++){let o=e[n];if(!p1(o))throw new Error("Uint8Array expected");t+=o.length}let r=new Uint8Array(t);for(let n=0,o=0;n<e.length;n++){let s=e[n];r.set(s,o),o+=s.length}return r}i(m1,"concatBytes");var cc=class{static{i(this,"Hash")}clone(){return this._cloneInto()}},$Z={}.toString;function g1(e){let t=i(n=>e().update(Ku(n)).digest(),"hashC"),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}i(g1,"wrapConstructor");function y1(e=32){if(dd&&typeof dd.getRandomValues=="function")return dd.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}i(y1,"randomBytes");var pd=class extends cc{static{i(this,"HMAC")}constructor(t,r){super(),this.finished=!1,this.destroyed=!1,d1(t);let n=Ku(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,s=new Uint8Array(o);s.set(n.length>o?t.create().update(n).digest():n);for(let a=0;a<s.length;a++)s[a]^=54;this.iHash.update(s),this.oHash=t.create();for(let a=0;a<s.length;a++)s[a]^=106;this.oHash.update(s),s.fill(0)}update(t){return ac(this),this.iHash.update(t),this}digestInto(t){ac(this),Vm(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:o,destroyed:s,blockLen:a,outputLen:l}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=a,t.outputLen=l,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},qm=i((e,t,r)=>new pd(e,t).update(r).digest(),"hmac");qm.create=(e,t)=>new pd(e,t);m();g();m();g();var i4=BigInt(0),Hm=BigInt(1);function b1(e,t){let r=i((o,s)=>{let a=s.negate();return o?a:s},"constTimeNegate"),n=i(o=>{let s=Math.ceil(t/o)+1,a=2**(o-1);return{windows:s,windowSize:a}},"opts");return{constTimeNegate:r,unsafeLadder(o,s){let a=e.ZERO,l=o;for(;s>i4;)s&Hm&&(a=a.add(l)),l=l.double(),s>>=Hm;return a},precomputeWindow(o,s){let{windows:a,windowSize:l}=n(s),f=[],p=o,w=p;for(let A=0;A<a;A++){w=p,f.push(w);for(let _=1;_<l;_++)w=w.add(p),f.push(w);p=w.double()}return f},wNAF(o,s,a){let{windows:l,windowSize:f}=n(o),p=e.ZERO,w=e.BASE,A=BigInt(2**o-1),_=2**o,T=BigInt(o);for(let B=0;B<l;B++){let P=B*f,C=Number(a&A);a>>=T,C>f&&(C-=_,a+=Hm);let O=P,L=P+Math.abs(C)-1,R=B%2!==0,j=C<0;C===0?w=w.add(r(R,s[O])):p=p.add(r(j,s[L]))}return{p,f:w}},wNAFCached(o,s,a,l){let f=o._WINDOW_SIZE||1,p=s.get(o);return p||(p=this.precomputeWindow(o,f),f!==1&&s.set(o,l(p))),this.wNAF(f,p,a)}}}i(b1,"wNAF");function jm(e){return Nm(e.Fp),hs(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Lm(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}i(jm,"validateBasic");function s4(e){let t=jm(e);hs(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:o}=t;if(r){if(!n.eql(o,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}i(s4,"validatePointOpts");var{bytesToNumberBE:a4,hexToBytes:c4}=Rm,ta={Err:class extends Error{static{i(this,"DERErr")}constructor(t=""){super(t)}},_parseInt(e){let{Err:t}=ta;if(e.length<2||e[0]!==2)throw new t("Invalid signature integer tag");let r=e[1],n=e.subarray(2,r+2);if(!r||n.length!==r)throw new t("Invalid signature integer: wrong length");if(n[0]&128)throw new t("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:a4(n),l:e.subarray(r+2)}},toSig(e){let{Err:t}=ta,r=typeof e=="string"?c4(e):e;if(!eo(r))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new t("Invalid signature tag");if(r[1]!==n-2)throw new t("Invalid signature: incorrect length");let{d:o,l:s}=ta._parseInt(r.subarray(2)),{d:a,l}=ta._parseInt(s);if(l.length)throw new t("Invalid signature: left bytes after parsing");return{r:o,s:a}},hexFromSig(e){let t=i(p=>Number.parseInt(p[0],16)&8?"00"+p:p,"slice"),r=i(p=>{let w=p.toString(16);return w.length&1?`0${w}`:w},"h"),n=t(r(e.s)),o=t(r(e.r)),s=n.length/2,a=o.length/2,l=r(s),f=r(a);return`30${r(a+s+4)}02${f}${o}02${l}${n}`}},ki=BigInt(0),xn=BigInt(1),hY=BigInt(2),v1=BigInt(3),pY=BigInt(4);function u4(e){let t=s4(e),{Fp:r}=t,n=t.toBytes||((B,P,C)=>{let O=P.toAffine();return sc(Uint8Array.from([4]),r.toBytes(O.x),r.toBytes(O.y))}),o=t.fromBytes||(B=>{let P=B.subarray(1),C=r.fromBytes(P.subarray(0,r.BYTES)),O=r.fromBytes(P.subarray(r.BYTES,2*r.BYTES));return{x:C,y:O}});function s(B){let{a:P,b:C}=t,O=r.sqr(B),L=r.mul(O,B);return r.add(r.add(L,r.mul(B,P)),C)}if(i(s,"weierstrassEquation"),!r.eql(r.sqr(t.Gy),s(t.Gx)))throw new Error("bad generator point: equation left != right");function a(B){return typeof B=="bigint"&&ki<B&&B<t.n}i(a,"isWithinCurveOrder");function l(B){if(!a(B))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}i(l,"assertGE");function f(B){let{allowedPrivateKeyLengths:P,nByteLength:C,wrapPrivateKey:O,n:L}=t;if(P&&typeof B!="bigint"){if(eo(B)&&(B=Xs(B)),typeof B!="string"||!P.includes(B.length))throw new Error("Invalid key");B=B.padStart(C*2,"0")}let R;try{R=typeof B=="bigint"?B:Bi(nn("private key",B,C))}catch{throw new Error(`private key must be ${C} bytes, hex or bigint, not ${typeof B}`)}return O&&(R=on(R,L)),l(R),R}i(f,"normPrivateKeyToScalar");let p=new Map;function w(B){if(!(B instanceof A))throw new Error("ProjectivePoint expected")}i(w,"assertPrjPoint");class A{static{i(this,"Point")}constructor(P,C,O){if(this.px=P,this.py=C,this.pz=O,P==null||!r.isValid(P))throw new Error("x required");if(C==null||!r.isValid(C))throw new Error("y required");if(O==null||!r.isValid(O))throw new Error("z required")}static fromAffine(P){let{x:C,y:O}=P||{};if(!P||!r.isValid(C)||!r.isValid(O))throw new Error("invalid affine point");if(P instanceof A)throw new Error("projective point not allowed");let L=i(R=>r.eql(R,r.ZERO),"is0");return L(C)&&L(O)?A.ZERO:new A(C,O,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(P){let C=r.invertBatch(P.map(O=>O.pz));return P.map((O,L)=>O.toAffine(C[L])).map(A.fromAffine)}static fromHex(P){let C=A.fromAffine(o(nn("pointHex",P)));return C.assertValidity(),C}static fromPrivateKey(P){return A.BASE.multiply(f(P))}_setWindowSize(P){this._WINDOW_SIZE=P,p.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}let{x:P,y:C}=this.toAffine();if(!r.isValid(P)||!r.isValid(C))throw new Error("bad point: x or y not FE");let O=r.sqr(C),L=s(P);if(!r.eql(O,L))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:P}=this.toAffine();if(r.isOdd)return!r.isOdd(P);throw new Error("Field doesn't support isOdd")}equals(P){w(P);let{px:C,py:O,pz:L}=this,{px:R,py:j,pz:Z}=P,X=r.eql(r.mul(C,Z),r.mul(R,L)),Q=r.eql(r.mul(O,Z),r.mul(j,L));return X&&Q}negate(){return new A(this.px,r.neg(this.py),this.pz)}double(){let{a:P,b:C}=t,O=r.mul(C,v1),{px:L,py:R,pz:j}=this,Z=r.ZERO,X=r.ZERO,Q=r.ZERO,z=r.mul(L,L),H=r.mul(R,R),E=r.mul(j,j),c=r.mul(L,R);return c=r.add(c,c),Q=r.mul(L,j),Q=r.add(Q,Q),Z=r.mul(P,Q),X=r.mul(O,E),X=r.add(Z,X),Z=r.sub(H,X),X=r.add(H,X),X=r.mul(Z,X),Z=r.mul(c,Z),Q=r.mul(O,Q),E=r.mul(P,E),c=r.sub(z,E),c=r.mul(P,c),c=r.add(c,Q),Q=r.add(z,z),z=r.add(Q,z),z=r.add(z,E),z=r.mul(z,c),X=r.add(X,z),E=r.mul(R,j),E=r.add(E,E),z=r.mul(E,c),Z=r.sub(Z,z),Q=r.mul(E,H),Q=r.add(Q,Q),Q=r.add(Q,Q),new A(Z,X,Q)}add(P){w(P);let{px:C,py:O,pz:L}=this,{px:R,py:j,pz:Z}=P,X=r.ZERO,Q=r.ZERO,z=r.ZERO,H=t.a,E=r.mul(t.b,v1),c=r.mul(C,R),d=r.mul(O,j),h=r.mul(L,Z),y=r.add(C,O),b=r.add(R,j);y=r.mul(y,b),b=r.add(c,d),y=r.sub(y,b),b=r.add(C,L);let M=r.add(R,Z);return b=r.mul(b,M),M=r.add(c,h),b=r.sub(b,M),M=r.add(O,L),X=r.add(j,Z),M=r.mul(M,X),X=r.add(d,h),M=r.sub(M,X),z=r.mul(H,b),X=r.mul(E,h),z=r.add(X,z),X=r.sub(d,z),z=r.add(d,z),Q=r.mul(X,z),d=r.add(c,c),d=r.add(d,c),h=r.mul(H,h),b=r.mul(E,b),d=r.add(d,h),h=r.sub(c,h),h=r.mul(H,h),b=r.add(b,h),c=r.mul(d,b),Q=r.add(Q,c),c=r.mul(M,b),X=r.mul(y,X),X=r.sub(X,c),c=r.mul(y,d),z=r.mul(M,z),z=r.add(z,c),new A(X,Q,z)}subtract(P){return this.add(P.negate())}is0(){return this.equals(A.ZERO)}wNAF(P){return T.wNAFCached(this,p,P,C=>{let O=r.invertBatch(C.map(L=>L.pz));return C.map((L,R)=>L.toAffine(O[R])).map(A.fromAffine)})}multiplyUnsafe(P){let C=A.ZERO;if(P===ki)return C;if(l(P),P===xn)return this;let{endo:O}=t;if(!O)return T.unsafeLadder(this,P);let{k1neg:L,k1:R,k2neg:j,k2:Z}=O.splitScalar(P),X=C,Q=C,z=this;for(;R>ki||Z>ki;)R&xn&&(X=X.add(z)),Z&xn&&(Q=Q.add(z)),z=z.double(),R>>=xn,Z>>=xn;return L&&(X=X.negate()),j&&(Q=Q.negate()),Q=new A(r.mul(Q.px,O.beta),Q.py,Q.pz),X.add(Q)}multiply(P){l(P);let C=P,O,L,{endo:R}=t;if(R){let{k1neg:j,k1:Z,k2neg:X,k2:Q}=R.splitScalar(C),{p:z,f:H}=this.wNAF(Z),{p:E,f:c}=this.wNAF(Q);z=T.constTimeNegate(j,z),E=T.constTimeNegate(X,E),E=new A(r.mul(E.px,R.beta),E.py,E.pz),O=z.add(E),L=H.add(c)}else{let{p:j,f:Z}=this.wNAF(C);O=j,L=Z}return A.normalizeZ([O,L])[0]}multiplyAndAddUnsafe(P,C,O){let L=A.BASE,R=i((Z,X)=>X===ki||X===xn||!Z.equals(L)?Z.multiplyUnsafe(X):Z.multiply(X),"mul"),j=R(this,C).add(R(P,O));return j.is0()?void 0:j}toAffine(P){let{px:C,py:O,pz:L}=this,R=this.is0();P==null&&(P=R?r.ONE:r.inv(L));let j=r.mul(C,P),Z=r.mul(O,P),X=r.mul(L,P);if(R)return{x:r.ZERO,y:r.ZERO};if(!r.eql(X,r.ONE))throw new Error("invZ was invalid");return{x:j,y:Z}}isTorsionFree(){let{h:P,isTorsionFree:C}=t;if(P===xn)return!0;if(C)return C(A,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:P,clearCofactor:C}=t;return P===xn?this:C?C(A,this):this.multiplyUnsafe(t.h)}toRawBytes(P=!0){return this.assertValidity(),n(A,this,P)}toHex(P=!0){return Xs(this.toRawBytes(P))}}A.BASE=new A(t.Gx,t.Gy,r.ONE),A.ZERO=new A(r.ZERO,r.ONE,r.ZERO);let _=t.nBitLength,T=b1(A,t.endo?Math.ceil(_/2):_);return{CURVE:t,ProjectivePoint:A,normPrivateKeyToScalar:f,weierstrassEquation:s,isWithinCurveOrder:a}}i(u4,"weierstrassPoints");function l4(e){let t=jm(e);return hs(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}i(l4,"validateOpts");function w1(e){let t=l4(e),{Fp:r,n}=t,o=r.BYTES+1,s=2*r.BYTES+1;function a(b){return ki<b&&b<r.ORDER}i(a,"isValidFieldElement");function l(b){return on(b,n)}i(l,"modN");function f(b){return ld(b,n)}i(f,"invN");let{ProjectivePoint:p,normPrivateKeyToScalar:w,weierstrassEquation:A,isWithinCurveOrder:_}=u4({...t,toBytes(b,M,I){let x=M.toAffine(),u=r.toBytes(x.x),S=sc;return I?S(Uint8Array.from([M.hasEvenY()?2:3]),u):S(Uint8Array.from([4]),u,r.toBytes(x.y))},fromBytes(b){let M=b.length,I=b[0],x=b.subarray(1);if(M===o&&(I===2||I===3)){let u=Bi(x);if(!a(u))throw new Error("Point is not on curve");let S=A(u),V=r.sqrt(S),q=(V&xn)===xn;return(I&1)===1!==q&&(V=r.neg(V)),{x:u,y:V}}else if(M===s&&I===4){let u=r.fromBytes(x.subarray(0,r.BYTES)),S=r.fromBytes(x.subarray(r.BYTES,2*r.BYTES));return{x:u,y:S}}else throw new Error(`Point of length ${M} was invalid. Expected ${o} compressed bytes or ${s} uncompressed bytes`)}}),T=i(b=>Xs(ds(b,t.nByteLength)),"numToNByteStr");function B(b){let M=n>>xn;return b>M}i(B,"isBiggerThanHalfOrder");function P(b){return B(b)?l(-b):b}i(P,"normalizeS");let C=i((b,M,I)=>Bi(b.slice(M,I)),"slcNum");class O{static{i(this,"Signature")}constructor(M,I,x){this.r=M,this.s=I,this.recovery=x,this.assertValidity()}static fromCompact(M){let I=t.nByteLength;return M=nn("compactSignature",M,I*2),new O(C(M,0,I),C(M,I,2*I))}static fromDER(M){let{r:I,s:x}=ta.toSig(nn("DER",M));return new O(I,x)}assertValidity(){if(!_(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!_(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(M){return new O(this.r,this.s,M)}recoverPublicKey(M){let{r:I,s:x,recovery:u}=this,S=Q(nn("msgHash",M));if(u==null||![0,1,2,3].includes(u))throw new Error("recovery id invalid");let V=u===2||u===3?I+t.n:I;if(V>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let q=u&1?"03":"02",F=p.fromHex(q+T(V)),ee=f(V),ie=l(-S*ee),ce=l(x*ee),ye=p.BASE.multiplyAndAddUnsafe(F,ie,ce);if(!ye)throw new Error("point at infinify");return ye.assertValidity(),ye}hasHighS(){return B(this.s)}normalizeS(){return this.hasHighS()?new O(this.r,l(-this.s),this.recovery):this}toDERRawBytes(){return Qs(this.toDERHex())}toDERHex(){return ta.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Qs(this.toCompactHex())}toCompactHex(){return T(this.r)+T(this.s)}}let L={isValidPrivateKey(b){try{return w(b),!0}catch{return!1}},normPrivateKeyToScalar:w,randomPrivateKey:i(()=>{let b=Dm(t.n);return fd(t.randomBytes(b),t.n)},"randomPrivateKey"),precompute(b=8,M=p.BASE){return M._setWindowSize(b),M.multiply(BigInt(3)),M}};function R(b,M=!0){return p.fromPrivateKey(b).toRawBytes(M)}i(R,"getPublicKey");function j(b){let M=eo(b),I=typeof b=="string",x=(M||I)&&b.length;return M?x===o||x===s:I?x===2*o||x===2*s:b instanceof p}i(j,"isProbPub");function Z(b,M,I=!0){if(j(b))throw new Error("first arg must be private key");if(!j(M))throw new Error("second arg must be public key");return p.fromHex(M).multiply(w(b)).toRawBytes(I)}i(Z,"getSharedSecret");let X=t.bits2int||function(b){let M=Bi(b),I=b.length*8-t.nBitLength;return I>0?M>>BigInt(I):M},Q=t.bits2int_modN||function(b){return l(X(b))},z=Ou(t.nBitLength);function H(b){if(typeof b!="bigint")throw new Error("bigint expected");if(!(ki<=b&&b<z))throw new Error(`bigint expected < 2^${t.nBitLength}`);return ds(b,t.nByteLength)}i(H,"int2octets");function E(b,M,I=c){if(["recovered","canonical"].some(N=>N in I))throw new Error("sign() legacy options not supported");let{hash:x,randomBytes:u}=t,{lowS:S,prehash:V,extraEntropy:q}=I;S==null&&(S=!0),b=nn("msgHash",b),V&&(b=nn("prehashed msgHash",x(b)));let F=Q(b),ee=w(M),ie=[H(ee),H(F)];if(q!=null){let N=q===!0?u(r.BYTES):q;ie.push(nn("extraEntropy",N))}let ce=sc(...ie),ye=F;function ue(N){let G=X(N);if(!_(G))return;let W=f(G),ne=p.BASE.multiply(G).toAffine(),le=l(ne.x);if(le===ki)return;let te=l(W*l(ye+le*ee));if(te===ki)return;let se=(ne.x===le?0:2)|Number(ne.y&xn),dt=te;return S&&B(te)&&(dt=P(te),se^=1),new O(le,dt,se)}return i(ue,"k2sig"),{seed:ce,k2sig:ue}}i(E,"prepSig");let c={lowS:t.lowS,prehash:!1},d={lowS:t.lowS,prehash:!1};function h(b,M,I=c){let{seed:x,k2sig:u}=E(b,M,I),S=t;return Km(S.hash.outputLen,S.nByteLength,S.hmac)(x,u)}i(h,"sign"),p.BASE._setWindowSize(8);function y(b,M,I,x=d){let u=b;if(M=nn("msgHash",M),I=nn("publicKey",I),"strict"in x)throw new Error("options.strict was renamed to lowS");let{lowS:S,prehash:V}=x,q,F;try{if(typeof u=="string"||eo(u))try{q=O.fromDER(u)}catch(ne){if(!(ne instanceof ta.Err))throw ne;q=O.fromCompact(u)}else if(typeof u=="object"&&typeof u.r=="bigint"&&typeof u.s=="bigint"){let{r:ne,s:le}=u;q=new O(ne,le)}else throw new Error("PARSE");F=p.fromHex(I)}catch(ne){if(ne.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(S&&q.hasHighS())return!1;V&&(M=t.hash(M));let{r:ee,s:ie}=q,ce=Q(M),ye=f(ie),ue=l(ce*ye),N=l(ee*ye),G=p.BASE.multiplyAndAddUnsafe(F,ue,N)?.toAffine();return G?l(G.x)===ee:!1}return i(y,"verify"),{CURVE:t,getPublicKey:R,getSharedSecret:Z,sign:h,verify:y,ProjectivePoint:p,Signature:O,utils:L}}i(w1,"weierstrass");function f4(e){return{hash:e,hmac:i((t,...r)=>qm(e,t,m1(...r)),"hmac"),randomBytes:y1}}i(f4,"getHash");function x1(e,t){let r=i(n=>w1({...e,...f4(n)}),"create");return Object.freeze({...r(t),create:r})}i(x1,"createCurve");m();g();m();g();function d4(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let o=BigInt(32),s=BigInt(4294967295),a=Number(r>>o&s),l=Number(r&s),f=n?4:0,p=n?0:4;e.setUint32(t+f,a,n),e.setUint32(t+p,l,n)}i(d4,"setBigUint64");var md=class extends cc{static{i(this,"SHA2")}constructor(t,r,n,o){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=hd(this.buffer)}update(t){ac(this);let{view:r,buffer:n,blockLen:o}=this;t=Ku(t);let s=t.length;for(let a=0;a<s;){let l=Math.min(o-this.pos,s-a);if(l===o){let f=hd(t);for(;o<=s-a;a+=o)this.process(f,a);continue}n.set(t.subarray(a,a+l),this.pos),this.pos+=l,a+=l,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){ac(this),h1(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:o,isLE:s}=this,{pos:a}=this;r[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>o-a&&(this.process(n,0),a=0);for(let A=a;A<o;A++)r[A]=0;d4(n,o-8,BigInt(this.length*8),s),this.process(n,0);let l=hd(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let p=f/4,w=this.get();if(p>w.length)throw new Error("_sha2: outputLen bigger than state");for(let A=0;A<p;A++)l.setUint32(4*A,w[A],s)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:o,finished:s,destroyed:a,pos:l}=this;return t.length=o,t.pos=l,t.finished=s,t.destroyed=a,o%r&&t.buffer.set(n),t}};var h4=i((e,t,r)=>e&t^~e&r,"Chi"),p4=i((e,t,r)=>e&t^e&r^t&r,"Maj"),m4=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ps=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ms=new Uint32Array(64),zm=class extends md{static{i(this,"SHA256")}constructor(){super(64,32,8,!1),this.A=ps[0]|0,this.B=ps[1]|0,this.C=ps[2]|0,this.D=ps[3]|0,this.E=ps[4]|0,this.F=ps[5]|0,this.G=ps[6]|0,this.H=ps[7]|0}get(){let{A:t,B:r,C:n,D:o,E:s,F:a,G:l,H:f}=this;return[t,r,n,o,s,a,l,f]}set(t,r,n,o,s,a,l,f){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=s|0,this.F=a|0,this.G=l|0,this.H=f|0}process(t,r){for(let A=0;A<16;A++,r+=4)ms[A]=t.getUint32(r,!1);for(let A=16;A<64;A++){let _=ms[A-15],T=ms[A-2],B=to(_,7)^to(_,18)^_>>>3,P=to(T,17)^to(T,19)^T>>>10;ms[A]=P+ms[A-7]+B+ms[A-16]|0}let{A:n,B:o,C:s,D:a,E:l,F:f,G:p,H:w}=this;for(let A=0;A<64;A++){let _=to(l,6)^to(l,11)^to(l,25),T=w+_+h4(l,f,p)+m4[A]+ms[A]|0,P=(to(n,2)^to(n,13)^to(n,22))+p4(n,o,s)|0;w=p,p=f,f=l,l=a+T|0,a=s,s=o,o=n,n=T+P|0}n=n+this.A|0,o=o+this.B|0,s=s+this.C|0,a=a+this.D|0,l=l+this.E|0,f=f+this.F|0,p=p+this.G|0,w=w+this.H|0,this.set(n,o,s,a,l,f,p,w)}roundClean(){ms.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var S1=g1(()=>new zm);var A1=c1(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),g4=A1.create(BigInt("-3")),y4=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),ra=x1({a:g4,b:y4,Fp:A1,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},S1);m();g();m();g();m();g();async function E1(e){let t=new Uint8Array(Array.from("mnemonic"+(e.passphrase??"")).map(r=>r.charCodeAt(0)));return e.pbkdf2(e.mnemonic,t,2048,64,"sha512")}i(E1,"mnemonicToSeed");m();g();var _1=me(vo());var b4=me(es());m();g();var Fm=["abandon","ability","able","about","above","absent","absorb","abstract","absurd","abuse","access","accident","account","accuse","achieve","acid","acoustic","acquire","across","act","action","actor","actress","actual","adapt","add","addict","address","adjust","admit","adult","advance","advice","aerobic","affair","afford","afraid","again","age","agent","agree","ahead","aim","air","airport","aisle","alarm","album","alcohol","alert","alien","all","alley","allow","almost","alone","alpha","already","also","alter","always","amateur","amazing","among","amount","amused","analyst","anchor","ancient","anger","angle","angry","animal","ankle","announce","annual","another","answer","antenna","antique","anxiety","any","apart","apology","appear","apple","approve","april","arch","arctic","area","arena","argue","arm","armed","armor","army","around","arrange","arrest","arrive","arrow","art","artefact","artist","artwork","ask","aspect","assault","asset","assist","assume","asthma","athlete","atom","attack","attend","attitude","attract","auction","audit","august","aunt","author","auto","autumn","average","avocado","avoid","awake","aware","away","awesome","awful","awkward","axis","baby","bachelor","bacon","badge","bag","balance","balcony","ball","bamboo","banana","banner","bar","barely","bargain","barrel","base","basic","basket","battle","beach","bean","beauty","because","become","beef","before","begin","behave","behind","believe","below","belt","bench","benefit","best","betray","better","between","beyond","bicycle","bid","bike","bind","biology","bird","birth","bitter","black","blade","blame","blanket","blast","bleak","bless","blind","blood","blossom","blouse","blue","blur","blush","board","boat","body","boil","bomb","bone","bonus","book","boost","border","boring","borrow","boss","bottom","bounce","box","boy","bracket","brain","brand","brass","brave","bread","breeze","brick","bridge","brief","bright","bring","brisk","broccoli","broken","bronze","broom","brother","brown","brush","bubble","buddy","budget","buffalo","build","bulb","bulk","bullet","bundle","bunker","burden","burger","burst","bus","business","busy","butter","buyer","buzz","cabbage","cabin","cable","cactus","cage","cake","call","calm","camera","camp","can","canal","cancel","candy","cannon","canoe","canvas","canyon","capable","capital","captain","car","carbon","card","cargo","carpet","carry","cart","case","cash","casino","castle","casual","cat","catalog","catch","category","cattle","caught","cause","caution","cave","ceiling","celery","cement","census","century","cereal","certain","chair","chalk","champion","change","chaos","chapter","charge","chase","chat","cheap","check","cheese","chef","cherry","chest","chicken","chief","child","chimney","choice","choose","chronic","chuckle","chunk","churn","cigar","cinnamon","circle","citizen","city","civil","claim","clap","clarify","claw","clay","clean","clerk","clever","click","client","cliff","climb","clinic","clip","clock","clog","close","cloth","cloud","clown","club","clump","cluster","clutch","coach","coast","coconut","code","coffee","coil","coin","collect","color","column","combine","come","comfort","comic","common","company","concert","conduct","confirm","congress","connect","consider","control","convince","cook","cool","copper","copy","coral","core","corn","correct","cost","cotton","couch","country","couple","course","cousin","cover","coyote","crack","cradle","craft","cram","crane","crash","crater","crawl","crazy","cream","credit","creek","crew","cricket","crime","crisp","critic","crop","cross","crouch","crowd","crucial","cruel","cruise","crumble","crunch","crush","cry","crystal","cube","culture","cup","cupboard","curious","current","curtain","curve","cushion","custom","cute","cycle","dad","damage","damp","dance","danger","daring","dash","daughter","dawn","day","deal","debate","debris","decade","december","decide","decline","decorate","decrease","deer","defense","define","defy","degree","delay","deliver","demand","demise","denial","dentist","deny","depart","depend","deposit","depth","deputy","derive","describe","desert","design","desk","despair","destroy","detail","detect","develop","device","devote","diagram","dial","diamond","diary","dice","diesel","diet","differ","digital","dignity","dilemma","dinner","dinosaur","direct","dirt","disagree","discover","disease","dish","dismiss","disorder","display","distance","divert","divide","divorce","dizzy","doctor","document","dog","doll","dolphin","domain","donate","donkey","donor","door","dose","double","dove","draft","dragon","drama","drastic","draw","dream","dress","drift","drill","drink","drip","drive","drop","drum","dry","duck","dumb","dune","during","dust","dutch","duty","dwarf","dynamic","eager","eagle","early","earn","earth","easily","east","easy","echo","ecology","economy","edge","edit","educate","effort","egg","eight","either","elbow","elder","electric","elegant","element","elephant","elevator","elite","else","embark","embody","embrace","emerge","emotion","employ","empower","empty","enable","enact","end","endless","endorse","enemy","energy","enforce","engage","engine","enhance","enjoy","enlist","enough","enrich","enroll","ensure","enter","entire","entry","envelope","episode","equal","equip","era","erase","erode","erosion","error","erupt","escape","essay","essence","estate","eternal","ethics","evidence","evil","evoke","evolve","exact","example","excess","exchange","excite","exclude","excuse","execute","exercise","exhaust","exhibit","exile","exist","exit","exotic","expand","expect","expire","explain","expose","express","extend","extra","eye","eyebrow","fabric","face","faculty","fade","faint","faith","fall","false","fame","family","famous","fan","fancy","fantasy","farm","fashion","fat","fatal","father","fatigue","fault","favorite","feature","february","federal","fee","feed","feel","female","fence","festival","fetch","fever","few","fiber","fiction","field","figure","file","film","filter","final","find","fine","finger","finish","fire","firm","first","fiscal","fish","fit","fitness","fix","flag","flame","flash","flat","flavor","flee","flight","flip","float","flock","floor","flower","fluid","flush","fly","foam","focus","fog","foil","fold","follow","food","foot","force","forest","forget","fork","fortune","forum","forward","fossil","foster","found","fox","fragile","frame","frequent","fresh","friend","fringe","frog","front","frost","frown","frozen","fruit","fuel","fun","funny","furnace","fury","future","gadget","gain","galaxy","gallery","game","gap","garage","garbage","garden","garlic","garment","gas","gasp","gate","gather","gauge","gaze","general","genius","genre","gentle","genuine","gesture","ghost","giant","gift","giggle","ginger","giraffe","girl","give","glad","glance","glare","glass","glide","glimpse","globe","gloom","glory","glove","glow","glue","goat","goddess","gold","good","goose","gorilla","gospel","gossip","govern","gown","grab","grace","grain","grant","grape","grass","gravity","great","green","grid","grief","grit","grocery","group","grow","grunt","guard","guess","guide","guilt","guitar","gun","gym","habit","hair","half","hammer","hamster","hand","happy","harbor","hard","harsh","harvest","hat","have","hawk","hazard","head","health","heart","heavy","hedgehog","height","hello","helmet","help","hen","hero","hidden","high","hill","hint","hip","hire","history","hobby","hockey","hold","hole","holiday","hollow","home","honey","hood","hope","horn","horror","horse","hospital","host","hotel","hour","hover","hub","huge","human","humble","humor","hundred","hungry","hunt","hurdle","hurry","hurt","husband","hybrid","ice","icon","idea","identify","idle","ignore","ill","illegal","illness","image","imitate","immense","immune","impact","impose","improve","impulse","inch","include","income","increase","index","indicate","indoor","industry","infant","inflict","inform","inhale","inherit","initial","inject","injury","inmate","inner","innocent","input","inquiry","insane","insect","inside","inspire","install","intact","interest","into","invest","invite","involve","iron","island","isolate","issue","item","ivory","jacket","jaguar","jar","jazz","jealous","jeans","jelly","jewel","job","join","joke","journey","joy","judge","juice","jump","jungle","junior","junk","just","kangaroo","keen","keep","ketchup","key","kick","kid","kidney","kind","kingdom","kiss","kit","kitchen","kite","kitten","kiwi","knee","knife","knock","know","lab","label","labor","ladder","lady","lake","lamp","language","laptop","large","later","latin","laugh","laundry","lava","law","lawn","lawsuit","layer","lazy","leader","leaf","learn","leave","lecture","left","leg","legal","legend","leisure","lemon","lend","length","lens","leopard","lesson","letter","level","liar","liberty","library","license","life","lift","light","like","limb","limit","link","lion","liquid","list","little","live","lizard","load","loan","lobster","local","lock","logic","lonely","long","loop","lottery","loud","lounge","love","loyal","lucky","luggage","lumber","lunar","lunch","luxury","lyrics","machine","mad","magic","magnet","maid","mail","main","major","make","mammal","man","manage","mandate","mango","mansion","manual","maple","marble","march","margin","marine","market","marriage","mask","mass","master","match","material","math","matrix","matter","maximum","maze","meadow","mean","measure","meat","mechanic","medal","media","melody","melt","member","memory","mention","menu","mercy","merge","merit","merry","mesh","message","metal","method","middle","midnight","milk","million","mimic","mind","minimum","minor","minute","miracle","mirror","misery","miss","mistake","mix","mixed","mixture","mobile","model","modify","mom","moment","monitor","monkey","monster","month","moon","moral","more","morning","mosquito","mother","motion","motor","mountain","mouse","move","movie","much","muffin","mule","multiply","muscle","museum","mushroom","music","must","mutual","myself","mystery","myth","naive","name","napkin","narrow","nasty","nation","nature","near","neck","need","negative","neglect","neither","nephew","nerve","nest","net","network","neutral","never","news","next","nice","night","noble","noise","nominee","noodle","normal","north","nose","notable","note","nothing","notice","novel","now","nuclear","number","nurse","nut","oak","obey","object","oblige","obscure","observe","obtain","obvious","occur","ocean","october","odor","off","offer","office","often","oil","okay","old","olive","olympic","omit","once","one","onion","online","only","open","opera","opinion","oppose","option","orange","orbit","orchard","order","ordinary","organ","orient","original","orphan","ostrich","other","outdoor","outer","output","outside","oval","oven","over","own","owner","oxygen","oyster","ozone","pact","paddle","page","pair","palace","palm","panda","panel","panic","panther","paper","parade","parent","park","parrot","party","pass","patch","path","patient","patrol","pattern","pause","pave","payment","peace","peanut","pear","peasant","pelican","pen","penalty","pencil","people","pepper","perfect","permit","person","pet","phone","photo","phrase","physical","piano","picnic","picture","piece","pig","pigeon","pill","pilot","pink","pioneer","pipe","pistol","pitch","pizza","place","planet","plastic","plate","play","please","pledge","pluck","plug","plunge","poem","poet","point","polar","pole","police","pond","pony","pool","popular","portion","position","possible","post","potato","pottery","poverty","powder","power","practice","praise","predict","prefer","prepare","present","pretty","prevent","price","pride","primary","print","priority","prison","private","prize","problem","process","produce","profit","program","project","promote","proof","property","prosper","protect","proud","provide","public","pudding","pull","pulp","pulse","pumpkin","punch","pupil","puppy","purchase","purity","purpose","purse","push","put","puzzle","pyramid","quality","quantum","quarter","question","quick","quit","quiz","quote","rabbit","raccoon","race","rack","radar","radio","rail","rain","raise","rally","ramp","ranch","random","range","rapid","rare","rate","rather","raven","raw","razor","ready","real","reason","rebel","rebuild","recall","receive","recipe","record","recycle","reduce","reflect","reform","refuse","region","regret","regular","reject","relax","release","relief","rely","remain","remember","remind","remove","render","renew","rent","reopen","repair","repeat","replace","report","require","rescue","resemble","resist","resource","response","result","retire","retreat","return","reunion","reveal","review","reward","rhythm","rib","ribbon","rice","rich","ride","ridge","rifle","right","rigid","ring","riot","ripple","risk","ritual","rival","river","road","roast","robot","robust","rocket","romance","roof","rookie","room","rose","rotate","rough","round","route","royal","rubber","rude","rug","rule","run","runway","rural","sad","saddle","sadness","safe","sail","salad","salmon","salon","salt","salute","same","sample","sand","satisfy","satoshi","sauce","sausage","save","say","scale","scan","scare","scatter","scene","scheme","school","science","scissors","scorpion","scout","scrap","screen","script","scrub","sea","search","season","seat","second","secret","section","security","seed","seek","segment","select","sell","seminar","senior","sense","sentence","series","service","session","settle","setup","seven","shadow","shaft","shallow","share","shed","shell","sheriff","shield","shift","shine","ship","shiver","shock","shoe","shoot","shop","short","shoulder","shove","shrimp","shrug","shuffle","shy","sibling","sick","side","siege","sight","sign","silent","silk","silly","silver","similar","simple","since","sing","siren","sister","situate","six","size","skate","sketch","ski","skill","skin","skirt","skull","slab","slam","sleep","slender","slice","slide","slight","slim","slogan","slot","slow","slush","small","smart","smile","smoke","smooth","snack","snake","snap","sniff","snow","soap","soccer","social","sock","soda","soft","solar","soldier","solid","solution","solve","someone","song","soon","sorry","sort","soul","sound","soup","source","south","space","spare","spatial","spawn","speak","special","speed","spell","spend","sphere","spice","spider","spike","spin","spirit","split","spoil","sponsor","spoon","sport","spot","spray","spread","spring","spy","square","squeeze","squirrel","stable","stadium","staff","stage","stairs","stamp","stand","start","state","stay","steak","steel","stem","step","stereo","stick","still","sting","stock","stomach","stone","stool","story","stove","strategy","street","strike","strong","struggle","student","stuff","stumble","style","subject","submit","subway","success","such","sudden","suffer","sugar","suggest","suit","summer","sun","sunny","sunset","super","supply","supreme","sure","surface","surge","surprise","surround","survey","suspect","sustain","swallow","swamp","swap","swarm","swear","sweet","swift","swim","swing","switch","sword","symbol","symptom","syrup","system","table","tackle","tag","tail","talent","talk","tank","tape","target","task","taste","tattoo","taxi","teach","team","tell","ten","tenant","tennis","tent","term","test","text","thank","that","theme","then","theory","there","they","thing","this","thought","three","thrive","throw","thumb","thunder","ticket","tide","tiger","tilt","timber","time","tiny","tip","tired","tissue","title","toast","tobacco","today","toddler","toe","together","toilet","token","tomato","tomorrow","tone","tongue","tonight","tool","tooth","top","topic","topple","torch","tornado","tortoise","toss","total","tourist","toward","tower","town","toy","track","trade","traffic","tragic","train","transfer","trap","trash","travel","tray","treat","tree","trend","trial","tribe","trick","trigger","trim","trip","trophy","trouble","truck","true","truly","trumpet","trust","truth","try","tube","tuition","tumble","tuna","tunnel","turkey","turn","turtle","twelve","twenty","twice","twin","twist","two","type","typical","ugly","umbrella","unable","unaware","uncle","uncover","under","undo","unfair","unfold","unhappy","uniform","unique","unit","universe","unknown","unlock","until","unusual","unveil","update","upgrade","uphold","upon","upper","upset","urban","urge","usage","use","used","useful","useless","usual","utility","vacant","vacuum","vague","valid","valley","valve","van","vanish","vapor","various","vast","vault","vehicle","velvet","vendor","venture","venue","verb","verify","version","very","vessel","veteran","viable","vibrant","vicious","victory","video","view","village","vintage","violin","virtual","virus","visa","visit","visual","vital","vivid","vocal","voice","void","volcano","volume","vote","voyage","wage","wagon","wait","walk","wall","walnut","want","warfare","warm","warrior","wash","wasp","waste","water","wave","way","wealth","weapon","wear","weasel","weather","web","wedding","weekend","weird","welcome","west","wet","whale","what","wheat","wheel","when","where","whip","whisper","wide","width","wife","wild","will","win","window","wine","wing","wink","winner","winter","wire","wisdom","wise","wish","witness","wolf","woman","wonder","wood","wool","word","work","world","worry","worth","wrap","wreck","wrestle","wrist","write","wrong","yard","year","yellow","you","young","youth","zebra","zero","zone","zoo"],GY=new Set(Fm);var v4=i((e,t,r,n,o)=>{let s;switch(o){case"rmd160":case"md5":case"sha":throw new Error(`${o} is unsupported by noble`);case"ripemd160":case"sha1":case"sha224":case"sha384":throw new Error(`${o} is supported by noble, but we don't need it for bip39`);case"sha256":s=Xn;break;case"sha512":s=nw;break}return za(s,e,t,{c:r,dkLen:n})},"pbkdf2Noble"),w4=i((e,t,r)=>{for(;e.length<r;)e=t+e;return e},"lpad"),M1=i(e=>e.map(t=>w4(t.toString(2),"0",8)).join(""),"bytesToBinary"),x4=i(e=>parseInt(e,2),"binaryToByte"),S4=i(e=>{let r=e.length*8/32,n=Xn(e);return M1(Array.from(n)).slice(0,r)},"deriveChecksumBits"),Pi;(function(e){e.InvalidChecksum="InvalidChecksum",e.InvalidChecksumBits="InvalidChecksumBits",e.InvalidEntropy="InvalidEntropy",e.InvalidEntropyBits="InvalidEntropyBits",e.LessThanTwelve="LessThanTwelve",e.ExactlyTwelveOrTwentyFour="ExactlyTwelveOrTwentyFour",e.MoreThanTwentyFour="MoreThanTwentyFour",e.WrongWord="WrongWord"})(Pi||(Pi={}));var na=i(async e=>{let t=Fm;if(e.length<16)throw new Error(Pi.LessThanTwelve);if(e.length>32)throw new Error(Pi.MoreThanTwentyFour);if(e.length%4!==0)throw new Error(Pi.WrongWord);let r,n;try{r=M1(Array.from(e))}catch{throw new Error(Pi.InvalidEntropyBits)}try{n=S4(e)}catch{throw new Error(Pi.InvalidChecksumBits)}let s=(r+n).match(/(.{1,11})/g);if(!s)throw new Error(Pi.InvalidChecksum);let a=s.map(p=>{let w=x4(p);return t[w]}),l=_1.Buffer.from(a.join(" "));return{seed:await E1({mnemonic:l,pbkdf2:v4}),mnemonic:l}},"entropyToSeedAndMnemonic");m();g();m();g();m();g();var I1=me(vo());var Wm=i(()=>({addresses:new Set,publicKeys:new Set}),"createEmptyIdentifiers"),uc=i((e,t)=>{t&&(t instanceof Uint8Array?e.publicKeys.add(I1.Buffer.from(t).toString("base64")):typeof t=="string"&&e.publicKeys.add(t))},"addPublicKey"),A4=i((e,t)=>{if(!e||typeof e!="object")return;let r=e,{chainType:n}=r;if(n)switch(n){case K.Solana:case K.EVM:{let o=r,s;typeof o.address=="string"?s=o.address:typeof o.publicKey=="string"&&(s=o.publicKey),s&&t.addresses.add(s);break}case K.Sui:{let o=r.address;typeof o=="string"&&t.addresses.add(o),uc(t,r.publicKey);break}case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:{let o=r.addresses??{};Object.values(o).forEach(s=>{s&&t.addresses.add(s)}),uc(t,r.publicKey);break}default:break}},"addChainAddressToSnapshot"),T1=i((e,t)=>{t.addresses.forEach(r=>e.addresses.add(r)),t.publicKeys.forEach(r=>e.publicKeys.add(r))},"mergeSnapshots"),gd=i(e=>{let t=Wm();return e&&Object.values(e).forEach(r=>{A4(r,t)}),t},"collectIdentifiersFromChains"),B1=i(e=>{let t=Wm();switch(e.type){case U.Seed:case U.Seedless:case U.Ledger:case U.KMSVault:{T1(t,gd(e.chains));break}case U.PrivateKey:{"addresses"in e?(Object.values(e.addresses??{}).forEach(r=>{r&&t.addresses.add(r)}),uc(t,e.publicKey)):"address"in e&&"publicKey"in e&&e.chainType===K.Sui?(t.addresses.add(e.address),uc(t,e.publicKey)):"address"in e&&t.addresses.add(e.address);break}case U.SeedVault:{t.addresses.add(e.address);break}case U.ReadOnly:{Object.values(e.addresses).forEach(r=>{r&&t.addresses.add(r)});break}}return t},"collectIdentifiersFromVaultAccount"),$m=i(e=>{let t=Wm();switch(e.type){case U.Seed:case U.Seedless:case U.Ledger:case U.KMSVault:{T1(t,gd(e.chains));break}case U.PrivateKey:{switch(e.chainType){case K.Solana:case K.EVM:{t.addresses.add(e.publicKey);break}case K.Sui:{t.addresses.add(e.address),uc(t,e.publicKey);break}case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:{Object.values(e.addresses??{}).forEach(r=>{r&&t.addresses.add(r)}),uc(t,e.publicKey);break}}break}case U.SeedVault:{t.addresses.add(e.publicKey);break}case U.ReadOnly:{Object.values(e.addresses).forEach(r=>{r&&t.addresses.add(r)});break}}return t},"collectIdentifiersFromVaultStorageAccount");m();g();var Ru=me(rT());function E4(e){return e=(0,Ru.default)(e),e.accounts.forEach(t=>{switch(t.type){case U.PrivateKey:{switch(t.chainType){case K.EVM:case K.Solana:break;case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:case K.Sui:{oa(t.publicKey)&&(t.publicKey=new Uint8Array(Buffer.from(t.publicKey)));break}default:Te(t)}break}case U.ReadOnly:break;case U.Ledger:case U.Seedless:case U.Seed:case U.KMSVault:for(let r of Object.keys(t.chains)){let n=t.chains[r];if(n)switch(n.chainType){case K.EVM:case K.Solana:break;case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:case K.Sui:{oa(n.publicKey)&&(n.publicKey=new Uint8Array(Buffer.from(n.publicKey)));break}default:Te(n)}}break;case U.SeedVault:break;default:Te(t)}}),e}i(E4,"deserializeVaultAccount");function _4(e){return e=(0,Ru.default)(e),e.accounts.forEach(t=>{switch(t.type){case U.PrivateKey:{switch(t.chainType){case K.EVM:case K.Solana:break;case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:case K.Sui:{t.publicKey instanceof Uint8Array&&(t.publicKey=Buffer.from(t.publicKey).toJSON());break}default:Te(t)}break}case U.ReadOnly:break;case U.Ledger:case U.Seedless:case U.Seed:case U.KMSVault:for(let r of Object.keys(t.chains)){let n=t.chains[r];if(n)switch(n.chainType){case K.EVM:case K.Solana:break;case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:case K.Sui:{n.publicKey instanceof Uint8Array&&(t.chains[r].publicKey=Buffer.from(n.publicKey).toJSON());break}default:Te(n)}}break;case U.SeedVault:break;default:Te(t)}}),e}i(_4,"serializeVaultAccount");function k1(e){return e=(0,Ru.default)(e),e.accounts.forEach(t=>{switch(t.type){case U.PrivateKey:{t.version===1&&oa(t.publicKey)&&(t.publicKey=new Uint8Array(Buffer.from(t.publicKey)));break}case U.ReadOnly:break;case U.KMSVault:case U.Ledger:case U.Seed:case U.Seedless:for(let r of Object.keys(t.chains))if(t.version===1&&oa(t.chains[r]?.publicKey)){let n=t.chains[r];n&&(n.publicKey=new Uint8Array(Buffer.from(n.publicKey)))}break;case U.SeedVault:break;default:Te(t)}}),e}i(k1,"deserializeVaultStorageAccount");function P1(e){return e=(0,Ru.default)(e),e.accounts.forEach(t=>{switch(t.type){case U.PrivateKey:{t.version===1&&t.publicKey instanceof Uint8Array&&(t.publicKey=Buffer.from(t.publicKey).toJSON());break}case U.ReadOnly:break;case U.KMSVault:case U.Ledger:case U.Seed:case U.Seedless:for(let r of Object.keys(t.chains))t.version===1&&t.chains[r]?.publicKey instanceof Uint8Array&&(t.chains[r].publicKey=Buffer.from(t.chains[r]?.publicKey).toJSON());break;case U.SeedVault:break;default:Te(t)}}),e}i(P1,"serializeVaultStorageAccount");function oa(e){return!!e&&typeof e=="object"&&F0("type",e)&&typeof e.type=="string"&&F0("data",e)&&Array.isArray(e.data)&&e.data.every(t=>!Number.isNaN(parseInt(t)))}i(oa,"isSerializedBuffer");m();g();var kr=".phantom-labs.vault";var lc=`${kr}.accounts`,Ci=`${kr}.secrets`,bd=i(e=>`${kr}.privateKey.${e}`,"privateKeyStorageKey"),vd=i(e=>`${kr}.seed.${e}`,"seedStorageKey"),wd=i(e=>`${kr}.seedless.${e}`,"seedlessStorageKey"),M4=`${kr}.cache.secrets`,I4=i(e=>`${kr}.cache.seed.${e}`,"seedCacheKey"),T4=i(e=>`${kr}.cache.client-jwt.${e}`,"clientJWTKeypairKey"),yd=`${kr}.integrityCheck`,ro=`${kr}.kmsAuthenticatorMapping`,yt=ut(function*(){return(yield V1())?.accounts??[]}),fc=ut(function*(){let e=yield no(),t=new Set(e.seedIdentifiers),r=yield yt();for(let o of r)o.type===U.Seed&&t.add(o.seedIdentifier);let n=[];for(let o of t)n.push({identifier:o});return n}),xd=ut(function*(){let e=yield no(),t=new Set(e.seedlessIdentifiers),r=yield yt();for(let o of r)o.type===U.Seedless&&t.add(o.seedIdentifier);let n=[];for(let o of t)n.push({identifier:o});return n}),no=ut(function*(){let e=Io(Ci);return{privateKeyIdentifiers:e?.privateKeyIdentifiers??[],seedIdentifiers:e?.seedIdentifiers??[],seedlessIdentifiers:e?.seedlessIdentifiers??[]}});async function K1(e,t){let r=vd(t),n=await e.secretsStorage.getSecureValue(r);if(n===null){let o=wd(t);n=await e.secretsStorage.getSecureValue(o)}if(n==null)throw new So;return oa(n.entropy)?n.entropy=new Uint8Array(Buffer.from(n.entropy)):n.entropy=new Uint8Array(Object.values(n.entropy)),n}i(K1,"fetchEntropy");async function Mo(e,t){let r=bd(t),n=await e.secretsStorage.getSecureValue(r);if(n==null)throw new ss;return oa(n.privateKey)?n.privateKey=new Uint8Array(Buffer.from(n.privateKey)):n.privateKey=new Uint8Array(Object.values(n.privateKey)),n}i(Mo,"fetchPrivateKey");async function sr(e,t,r=!0){let n=await V1();if(!n)n={version:1,accounts:[t]};else{let o=n.accounts,s=P4(o,t);if(s.length>0){if(!r)throw new xi(s[0].type,t.type);let a=O1(t.type);for(let f of s)if(O1(f.type)>=a)throw new xi(f.type,t.type);let l=s.map(f=>f.identifier);return o=o.filter(f=>!l.includes(f.identifier)),o.push(t),await Sn(o),await Gm(e)}else o.push(t);n.accounts=o}return Sn(n.accounts)}i(sr,"storeAccount");async function Sn(e){let t={version:1,accounts:e};return Oi(lc)(P1(t))}i(Sn,"storeAccounts");async function R1(e,t){let r=bd(t.identifier);await e.secretsStorage.setSecureValue(r,t),await K4(t.identifier)}i(R1,"storePrivateKey");async function U1(e,t){let r=vd(t.identifier);await e.secretsStorage.setSecureValue(r,t),await C4(t.identifier)}i(U1,"storeSeed");async function N1(e,t){let r=wd(t.identifier);await e.secretsStorage.setSecureValue(r,t),await O4(t.identifier)}i(N1,"storeSeedlessSeed");async function Gm(e){let t=await yt(),r=new Set,n=new Set;for(let p of t)switch(p.type){case U.Seed:case U.Seedless:r.add(p.seedIdentifier);break;case U.PrivateKey:n.add(p.privateKeyIdentifier);break;case U.Ledger:case U.ReadOnly:case U.SeedVault:case U.KMSVault:break;default:Te(p)}let o=await no(),s={seedIdentifiers:o.seedIdentifiers.filter(p=>r.has(p)),seedlessIdentifiers:o.seedlessIdentifiers.filter(p=>r.has(p)),privateKeyIdentifiers:o.privateKeyIdentifiers.filter(p=>n.has(p))},a={seedIdentifiers:o.seedIdentifiers.filter(p=>!r.has(p)),seedlessIdentifiers:o.seedlessIdentifiers.filter(p=>!r.has(p)),privateKeyIdentifiers:o.privateKeyIdentifiers.filter(p=>!n.has(p))};(a.seedIdentifiers.length+a.seedlessIdentifiers.length>0||a.privateKeyIdentifiers.length>0)&&J.addBreadcrumb(Y.Account,"Removing dangling secrets from vault storage",oe.Info,{seedIdentifiersCount:a.seedIdentifiers.length,seedlessIdentifiersCount:a.seedlessIdentifiers.length,privateKeyIdentifiersCount:a.privateKeyIdentifiers.length,seedIdentifiersSample:a.seedIdentifiers.slice(0,3).join(","),seedlessIdentifiersSample:a.seedlessIdentifiers.slice(0,3).join(",")}),await e.generalStorage.set(Ci,{version:1,...s}),Oi(Ci)({version:1,...s}),await e.secretsStorage.removeSecureValue([...a.seedIdentifiers.map(p=>vd(p)),...a.seedlessIdentifiers.map(p=>wd(p)),...a.privateKeyIdentifiers.map(p=>bd(p))])}i(Gm,"removeDanglingSecrets");async function Zm(e,t){t?await e.secretsStorage.setSecureValue(yd,t):await e.secretsStorage.removeSecureValue(yd)}i(Zm,"storeIntegrityCheck");async function L1(e){return e.secretsStorage.getSecureValue(yd)}i(L1,"fetchIntegrityCheck");async function D1(e){await e.secureCache.clear();let t=await B4();J.addBreadcrumb(Y.Account,"clearVault: removing all vault secrets",oe.Info,{seedIdentifiersCount:t.seedIdentifiers.length,seedlessIdentifiersCount:t.seedlessIdentifiers.length,privateKeyIdentifiersCount:t.privateKeyIdentifiers.length});let r=t.privateKeyIdentifiers.map(w=>bd(w)),n=t.seedIdentifiers.map(w=>vd(w)),o=t.seedlessIdentifiers.map(w=>wd(w)),s=Array.from(new Set([...t.seedIdentifiers,...t.seedlessIdentifiers])),a=s.map(w=>I4(w)),l=Array.from(new Set([...s,...t.privateKeyIdentifiers])).map(w=>T4(w));await e.generalStorage.remove(lc),await e.generalStorage.remove(ro),await e.secretsStorage.removeSecureValue([...r,...o,...n,...a,...l]),await e.generalStorage.remove(M4),await e.generalStorage.remove(Ci),await e.secretsStorage.removeSecureValue(yd);let f=Oi(lc),p=Oi(Ci);f(null),p(null)}i(D1,"clearVault");var V1=ut(function*(){let e=Io(lc);return e?(e=k1(e),e=yield k4(e),e):null});async function B4(){let e=await no(),t=new Set(e.seedIdentifiers),r=new Set(e.seedlessIdentifiers),n=new Set(e.privateKeyIdentifiers),o=await yt();for(let s of o)switch(s.type){case U.Seed:t.add(s.seedIdentifier);break;case U.Seedless:r.add(s.seedIdentifier);break;case U.PrivateKey:n.add(s.privateKeyIdentifier);break;case U.Ledger:case U.ReadOnly:case U.SeedVault:case U.KMSVault:break;default:Te(s)}return{seedIdentifiers:Array.from(t),seedlessIdentifiers:Array.from(r),privateKeyIdentifiers:Array.from(n)}}i(B4,"fetchAllSecretIdentifiersForClearVault");async function k4(e){let t=!1;return e.accounts.forEach(r=>{switch(r.type){case U.PrivateKey:{t=C1(r)||t;break}case U.ReadOnly:break;case U.Ledger:case U.Seed:case U.Seedless:Object.values(r.chains).forEach(n=>{t=C1(n)||t});break;case U.SeedVault:case U.KMSVault:break;default:Te(r)}}),e}i(k4,"computeBitcoinAddressesIfNeeded");function C1(e){let t=!1;switch(e.chainType){case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:{Object.values(wr).forEach(r=>{if(e.addresses&&e.addresses[r])return;let n=Sr({publicKey:e.publicKey,addressType:e.chainType,networkID:r});e.addresses={...e.addresses,[r]:n},t=!0});break}default:}return t}i(C1,"computeBitcoinAddressesForChain");function P4(e,t){let r=$m(t),n=[];for(let o of e){let s=$m(o),a=Array.from(r.addresses).some(f=>s.addresses.has(f)),l=Array.from(r.publicKeys).some(f=>s.publicKeys.has(f));(a||l)&&n.push(o)}return n}i(P4,"existingAccountsMatchingAccount");async function C4(e){let t=await no();return t.seedIdentifiers=[...new Set([...t.seedIdentifiers,e])],Oi(Ci)({version:1,...t})}i(C4,"storeSecretIdentifierForSeed");async function O4(e){let t=await no();return t.seedlessIdentifiers=[...new Set([...t.seedlessIdentifiers,e])],Oi(Ci)({version:1,...t})}i(O4,"storeSecretIdentifierForSeedless");async function K4(e){let t=await no();return t.privateKeyIdentifiers=[...new Set([...t.privateKeyIdentifiers,e])],Oi(Ci)({version:1,...t})}i(K4,"storeSecretIdentifierForPrivateKey");function O1(e){switch(e){case U.ReadOnly:return 1;case U.PrivateKey:return 2;case U.Seedless:case U.Seed:return 3;case U.Ledger:return 4;case U.SeedVault:return 5;case U.KMSVault:return 6;default:return 0}}i(O1,"accountTypeOverridePriority");var R4=v.object({version:v.literal(1),accounts:v.array(v.any())}),U4=v.object({version:v.literal(1),seedIdentifiers:v.array(v.string()),seedlessIdentifiers:v.array(v.string()),privateKeyIdentifiers:v.array(v.string())}),N4=v.object({version:v.literal(1),mapping:v.record(v.string(),v.string())}),[Io,Oi,GJ]=$l("vault",[{key:lc,type:"object",validator:R4,nullable:!0},{key:Ci,type:"object",validator:U4,nullable:!0},{key:ro,type:"object",validator:N4,nullable:!0}]);async function An(e,t){let r=await K1(e,t);if(!r)throw new So;let n=wo.from(r.entropy);return r.entropy.fill(0),n}i(An,"exportEntropy");async function Wt(e,t){let r,n=await e.secureCache.getSeed(t);if(n)r=n;else{let s=await An(e,t),{seed:a}=await s.foldAsync(na);r=a,await e.secureCache.setSeed(t,r)}let o=wo.from(r);return r.fill(0),o}i(Wt,"exportSeed");var Ym="m/23001'/0'";async function gs(e,t){let r;switch(t.type){case U.Seedless:case U.Seed:r=t.seedIdentifier;break;case U.PrivateKey:r=t.privateKeyIdentifier;break}let n=await e.secureCache.getClientJWTSigner(r,Ym);if(n)return{publicKey:n.p256pubkey,privateKey:n.p256privkey};let o;switch(t.type){case U.Seedless:case U.Seed:{o=(await Wt(e,t.seedIdentifier)).fold(a=>new Na(a));break}case U.PrivateKey:{let s=await Mo(e,t.privateKeyIdentifier);o=new Na(s.privateKey);break}}try{let s=o.derivePath({ellipticCurve:"ed25519",derivationPath:Ym,bytesInPrivateKey:64}),a=fd(s.secretKey,ra.CURVE.n),l=ra.getPublicKey(a);return await e.secureCache.setClientJWTSigner(r,Ym,{p256pubkey:l,p256privkey:a}),{publicKey:l,privateKey:a}}finally{o.cleanup()}}i(gs,"deriveClientJWTKeypair");m();g();function L4(e){return e.type===U.Seed||e.type===U.Seedless||e.type===U.PrivateKey}i(L4,"isKMSAuthenticatorSourceAccount");async function Sd(){let e=await yt(),t=[];for(let r of e)L4(r)&&t.push(r);return t.sort((r,n)=>{let o=i(s=>s==="seedless"?0:s==="seed"?1:s==="privateKey"?2:3,"priority");return o(r.type)-o(n.type)}),t}i(Sd,"getAllSignerAccounts");function q1(e,t){let r;async function n(){if(r)return r;let s=await Sd();if(s.length===0)throw new Error("Vault requires a seed, seedless, or private key account to derive the KMS authenticator. Add a local secret before calling getKMSInstance().");if(!Zl("enable-kms-authenticator-mapping")||!t)return r=s[0],r;let f=Io(ro)?.mapping;if(!f)throw new Error("KMS authenticator mapping not found. Mapping must be built before creating KMS instances. Rebuild mapping required.");let p=f[t];if(!p)throw new Error(`KMS authenticator mapping missing for ${t}.`);let w=s.find(A=>(A.type===U.PrivateKey?A.privateKeyIdentifier:A.seedIdentifier)===p);if(!w)throw J.addBreadcrumb(Y.Account,`KMS authenticator mapping references missing signer account ${p}.`,oe.Error),new Error(`KMS authenticator mapping references missing signer account ${p}.`);return r=w,J.addBreadcrumb(Y.Account,`Using cached KMS authenticator account ${w.identifier} for ${t}`,oe.Debug),r}i(n,"getSigningAccount");async function o(){let s=await n();return gs(e,s)}return i(o,"getKeyPair"),{getPublicKey:i(async()=>pt((await o()).publicKey),"getPublicKey"),signRpcPayload:i(async s=>{let a=await o(),l=await e.vaultSigner.signWithKeypair(a,{isKMSPKIAuthenticator:!0,payload:s});if("status"in l&&l.status==="error")throw new Error(l.message);return l.signature},"signRpcPayload")}}i(q1,"createVaultKMSPKIAuthenticator");function H1(e){return ic({authenticator:q1(e)})}i(H1,"createVaultKMS");function Uu(e,t){let r=q1(e,t);return ic({authenticator:r})}i(Uu,"createVaultKMSForAccount");function D4(e,t){async function r(){return gs(e,t)}return i(r,"getKeyPair"),{getPublicKey:i(async()=>pt((await r()).publicKey),"getPublicKey"),signRpcPayload:i(async n=>{let o=await r(),s=await e.vaultSigner.signWithKeypair(o,{isKMSPKIAuthenticator:!0,payload:n});if("status"in s&&s.status==="error")throw new Error(s.message);return s.signature},"signRpcPayload")}}i(D4,"createAuthenticatorForAccount");async function j1(e,t,r){try{let n=D4(e,t),o=ic({authenticator:n}),{result:s}=await o.getPhantomOrganization({})??{result:null};if(!s)return J.addBreadcrumb(Y.Account,"No Phantom organization found for account.",oe.Info),null;if(r===void 0)return s;let a=await o.getWalletWithTag({organizationId:s.organizationId,tag:r.tag,accounts:r.accounts});if(a?.result&&r.accountSelector(a.result))return s;if(a?.result){let l={accountAddresses:a?.result.accounts.map(f=>Qm(f.address)),walletId:a?.result.walletId,walletName:a?.result.walletName,orgId:s.organizationId};J.addBreadcrumb(Y.Account,`Wallet with tag ${r.tag} does not match account selector. Wallet metadata: ${JSON.stringify(l)}`,oe.Info)}else J.addBreadcrumb(Y.Account,`Phantom org ${s.organizationId} does not have wallet with tag ${r.tag}`,oe.Info);return null}catch(n){let o=n instanceof Error?n.message:String(n);return J.captureError(n instanceof Error?n:new Error(o),Y.Account),J.addBreadcrumb(Y.Account,`Error getting Phantom organization for account: ${o}`,oe.Error),null}}i(j1,"tryGetPhantomOrgForAccount");async function Xm(e){let t=Oi(ro),r=Io(ro)?.mapping||{},n=e(r);t({version:1,mapping:n})}i(Xm,"updateKMSMappingAtomically");async function z1(e){J.addBreadcrumb(Y.Account,"Rebuilding KMS authenticator mapping",oe.Info);let r=(await yt()).filter(n=>n.type===U.KMSVault);for(let n of r)await Nu(e,n.kms.walletId,n.kms.tag,!1)}i(z1,"rebuildKMSAuthenticatorMappingInternal");async function Nu(e,t,r,n=!0){let o=wn(t,r);if((Io(ro)?.mapping||{})[o]&&n)return;let a=await Sd();for(let l of a){let f=l.type===U.PrivateKey?l.privateKeyIdentifier:l.seedIdentifier;if(await j1(e,l,{tag:r,accountSelector:i(w=>w?.walletId===t,"accountSelector")})){await Xm(w=>({...w,[o]:f})),J.addBreadcrumb(Y.Account,`Updated KMS account mapping ${o} to signer ${f}`,oe.Info);return}}J.addBreadcrumb(Y.Account,`No signer account found for KMS account ${o}`,oe.Error)}i(Nu,"updateKMSVaultAccountMapping");async function F1(e,t){if(!t){J.addBreadcrumb(Y.Account,"updateCashAccountMapping called without cashAddress, skipping",oe.Debug);return}let r=`cash:${t}`;if((Io(ro)?.mapping||{})[r])return;let o=await Sd(),s=await Pm(0);for(let a of o){let l=a.type===U.PrivateKey?a.privateKeyIdentifier:a.seedIdentifier,f=V4(a);J.addBreadcrumb(Y.Account,`Looking for cash account in source account w/ metadata ${JSON.stringify(f)}`,oe.Info);try{if(await j1(e,a,{tag:"cash",accounts:s,accountSelector:i(w=>w?w.accounts.some(A=>A.address.toLowerCase()===t.toLowerCase()):!1,"accountSelector")})){await Xm(w=>({...w,[r]:l})),J.addBreadcrumb(Y.Account,`Updated cash account mapping ${r} to signer ${l}`,oe.Info);return}}catch(p){J.addBreadcrumb(Y.Account,`Failed to check cash account for signer ${l}: ${p}`,oe.Debug)}}J.addBreadcrumb(Y.Account,`No signer account found for cash account ${Qm(t)}`,oe.Error)}i(F1,"updateCashAccountMapping");async function W1(e,t,r){let n=wn(t,r);await Xm(o=>{if(!o[n])return J.addBreadcrumb(Y.Account,`KMS account mapping ${n} not found, nothing to remove`,oe.Debug),o;let s={...o};return delete s[n],J.addBreadcrumb(Y.Account,`Removed KMS account mapping ${n}`,oe.Debug),s})}i(W1,"removeKMSVaultAccountMapping");function Jm(e){let t=e.type===U.PrivateKey?e.publicKey:e.chains[K.Solana]?.publicKey;if(!(!t||typeof t!="string"))return Qm(t)}i(Jm,"toSolanaAddress");function V4(e){let t,r;switch(e.type){case U.PrivateKey:{t="leaf",r=Jm(e);break}case U.Seed:{t="root",r=Jm(e);break}case U.Seedless:{t="rootless",r=Jm(e);break}default:return}return{type:t,solanaAddress:r}}i(V4,"toSourceAccountMetadata");function Qm(e){return`${e.slice(0,6)}...${e.slice(-6)}`}i(Qm,"toTruncated");m();g();function q4(e){switch(e.chainType){case K.Solana:case K.EVM:case K.Sui:case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:return;default:Te(e)}}i(q4,"assertSupportedKMSChain");function eg(e){switch(q4(e),e.chainType){case K.Solana:case K.EVM:return{chainType:e.chainType,publicKey:e.address,pathType:e.pathType};case K.Sui:return{chainType:e.chainType,publicKey:e.publicKey,address:e.address,pathType:e.pathType};case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:{let{addresses:t,...r}=e;return{...r,addresses:{...t}}}default:return Te(e)}}i(eg,"buildVaultStorageKMSChainAddress");function $1(e){let t={};for(let[,r]of Object.entries(e)){let n=eg(r);t[r.chainType]=n}return t}i($1,"buildVaultStorageKMSChainAddresses");async function G1(e,{organizationId:t,walletId:r,tag:n,derivationIndex:o,chains:s,apiEnvironment:a}){if(J.addBreadcrumb(Y.Account,`[addKMSVaultAccount] ENTRY: walletId=${r}`,oe.Info),n!==or)throw new Error(`KMS vault accounts must use tag "${or}", received "${n}".`);let l=$1(s),f=wn(r,n),p={version:1,type:U.KMSVault,identifier:f,derivationIndex:o,kms:{organizationId:t,walletId:r,tag:n},chains:l,...a&&{apiEnvironment:a}};return await sr(e,p),Nu(e,r,n).catch(w=>{J.captureError(w,Y.Account)}),p}i(G1,"addKMSVaultAccount");m();g();m();g();var Ad=Object.values(wr);function Z1(e){switch(e.chainType){case K.Solana:case K.EVM:{let t=H4(e.chainType,e.address,e.publicKey);return{chainType:e.chainType,pathType:e.pathType,address:t}}case K.Sui:{let t=e.address??Sr({publicKey:e.publicKey,addressType:e.chainType});return{chainType:e.chainType,pathType:e.pathType,publicKey:e.publicKey,address:t}}case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:return{chainType:e.chainType,pathType:e.pathType,publicKey:e.publicKey,addresses:j4(e.chainType,e.publicKey,e.addresses)};default:return Te(e)}}i(Z1,"normalizeChainAddress");function H4(e,t,r){if(t)return t;if(r)return Sr({publicKey:r,addressType:e});throw new Error(`Expected address or publicKey for chain type ${e}`)}i(H4,"getAddressForEvmOrSolana");function j4(e,t,r){return r?z4(e,t,r):F4(e,t)}i(j4,"getBitcoinAddresses");function z4(e,t,r){let n={...r};for(let o of Ad)n[o]||(n[o]=Sr({publicKey:t,addressType:e,networkID:o}));return n}i(z4,"fillMissingBitcoinAddresses");function F4(e,t){return Ad.reduce((r,n)=>(r[n]=Sr({publicKey:t,addressType:e,networkID:n}),r),{})}i(F4,"deriveAllBitcoinAddresses");function Y1(e){let t=Z1(e);switch(t.chainType){case K.Solana:case K.EVM:return t;case K.Sui:return t;case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:return t;default:return Te(t)}}i(Y1,"buildVaultChainAddress");function J1(e){let t=Z1(e);switch(t.chainType){case K.Solana:case K.EVM:return{chainType:t.chainType,publicKey:t.address,pathType:t.pathType};case K.Sui:return{chainType:t.chainType,publicKey:t.publicKey,address:t.address,pathType:t.pathType};case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:return{chainType:t.chainType,publicKey:t.publicKey,addresses:t.addresses,pathType:t.pathType};default:return Te(t)}}i(J1,"buildVaultStorageChainAddress");function W4(e,t){let r=!1,n={...e};for(let[o,s]of Object.entries(t)){let a=o,l=eg(s),f=e[a];if(!f){n[a]=l,r=!0;continue}switch(l.chainType){case K.Solana:case K.EVM:case K.Sui:continue;case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:{let p=f,w=l,A=p.addresses?{...p.addresses}:{};for(let _ of Ad){let T=w.addresses?.[_];T&&A[_]!==T&&(A[_]=T,r=!0)}n[a]={...p,addresses:A};break}default:Te(l)}}return{merged:n,changed:r}}i(W4,"deepMergeChains");async function X1(e,{organizationId:t,walletId:r,tag:n,derivationIndex:o,chains:s}){if(n!==or)throw new Error(`KMS vault accounts must use tag "${or}", received "${n}".`);let a=wn(r,n),l=await yt(),f=l.findIndex(B=>B.type===U.KMSVault&&B.identifier===a);if(f===-1)throw new Error(`KMSVault account not found for identifier ${a}`);let p=l[f];if(p.kms.organizationId!==t||p.kms.walletId!==r||p.kms.tag!==n||p.derivationIndex!==o)throw new Error(`KMS vault metadata mismatch for identifier ${a} (existing data retained, incoming rejected).`);let{merged:w,changed:A}=W4(p.chains,s);if(!A)return p;let _={...p,chains:w},T=[...l];return T[f]=_,await Sn(T),_}i(X1,"upsertKMSVaultChains");m();g();m();g();var tg=me(La());function dc(e){return e.fold(tg.keccak256)}i(dc,"identifierForSeed");function ys(e,t,r){let n=os[r];return tg.keccak256(`${e}:${t}:${n}`)}i(ys,"identifierForSeedAccount");function To(e,t,r,n){let o={};for(let s of n){let{publicKey:a}=e.keypairGenerator.generateKeypairFromSeed(t,r,s),l=Jn.getAddressType(s),f=$4({addressType:l,derivationPathType:s,publicKey:a});o[l]=J1(f)}return o}i(To,"storageChainAddresses");function $4({addressType:e,derivationPathType:t,publicKey:r}){switch(e){case K.Solana:case K.EVM:case K.Sui:case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:return{chainType:e,pathType:t,publicKey:r};default:return Te(e)}}i($4,"toChainAddressInput");async function Q1(e,t){let r=new Set,n=await yt();for(let s of n)s.type===U.Seed&&s.seedIdentifier===t&&os[Object.values(s.chains)[0].pathType]===0&&r.add(s.derivationIndex);let o=0;for(let s=0;s<=r.size;s++)if(!r.has(s)){o=s;break}return e2(e,t,o)}i(Q1,"addAccountForExistingSeed");async function e2(e,t,r){try{return await G4(e,t,r)}catch(n){if(n instanceof xi)return await e2(e,t,r+1);throw n}}i(e2,"addAccountForSeedWithDerivationIndex");async function G4(e,t,r){let n=await Wt(e,t),o=(await e.fetchChainAvailability()).enabledAddressTypes,s=Br(o),a=await ys(t,r,s[0]),l={version:1,type:U.Seed,identifier:a,seedIdentifier:t,derivationIndex:r,chains:To(e,n,r,s)};return await sr(e,l,!1),l}i(G4,"_addAccountForExistingSeed");m();g();var a2=me(QI());var c2=me(Ew()),u2=me(s2()),l2=me(La());function e8(e,t,r){let n=os[r];return l2.keccak256(`${e}:${t}:${n}`)}i(e8,"_identifierForLedgerAccount");async function f2(e,t,r){let n=[];for(let o of r){let s=o.addresses.filter(_=>_.value.length>0),a=o.publicKeys.filter(_=>_.value.length>0);if(s.length===0&&a.length===0)throw new Error("Must have at least 1 address or public key in account to add Ledger account.");let l=s[0]?.pathType||a[0]?.pathType,f=e8(t,o.derivationIndex,l);c2.initEccLib(a2);let p=(0,u2.ECPairFactory)(a2),w={...s.reduce((_,T)=>{let B=Jn.getAddressType(T.pathType);switch(B){case K.EVM:case K.Solana:{_[B]={chainType:B,pathType:T.pathType,publicKey:T.value};break}case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:throw new Error("Bitcoin accounts should be using public key not computed addresses");case K.Sui:throw new j0("add ledger account");default:Te(B)}return _},{}),...a.reduce((_,T)=>{let B=Jn.getAddressType(T.pathType);switch(B){case K.EVM:case K.Solana:throw new Error("EVM or Solana accounts should be using addreses directly, not public keys");case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:{let P=p.fromPublicKey(Buffer.from(T.value,"hex")),C=new Uint8Array(P.publicKey);_[B]={chainType:B,pathType:T.pathType,publicKey:C,addresses:Object.values(wr).reduce((O,L)=>({...O,[L]:Sr({publicKey:C,addressType:B,networkID:L})}),{})};break}case K.Sui:throw new j0("add ledger account");default:Te(B)}return _},{})},A={version:1,type:U.Ledger,identifier:f,ledgerGroupIdentifier:t,derivationIndex:o.derivationIndex,chains:w};n.push(A),await sr(e,A)}return n}i(f2,"addLedgerAccounts");m();g();var d2=me(La());function t8(e){return d2.keccak256(e)}i(t8,"_identifierForPrivateKey");async function h2(e,t,r,n){let o=await e.keypairGenerator.generateKeypairFromPrivateKey(r,t),s=await no(),a=t8(o.publicKey);if((s?.privateKeyIdentifiers??[]).includes(a))throw new of;let p={version:1,identifier:a,name:n,chainType:t,privateKey:Buffer.from(o.privateKey)},w=a,A;switch(t){case K.EVM:case K.Solana:{A={version:1,type:U.PrivateKey,identifier:w,privateKeyIdentifier:a,publicKey:Sr({publicKey:o.publicKey,addressType:t}),chainType:t};break}case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:{A={version:1,type:U.PrivateKey,identifier:w,privateKeyIdentifier:a,publicKey:o.publicKey,addresses:Object.values(wr).reduce((_,T)=>({..._,[T]:Sr({publicKey:o.publicKey,addressType:t,networkID:T})}),{}),chainType:t};break}case K.Sui:{A={version:1,type:U.PrivateKey,identifier:w,privateKeyIdentifier:a,publicKey:o.publicKey,address:Sr({publicKey:o.publicKey,addressType:t}),chainType:t};break}default:Te(t)}if(!A)throw new Error("unable to create a private key account based on the address type");return await sr(e,A),await R1(e,p),A}i(h2,"addPrivateKeyAccount");m();g();var p2=me(La());function r8(e){return p2.keccak256(e)}i(r8,"_identifierForReadOnlyAccount");async function m2(e,t){let r=Object.values(t).find(Boolean);if(!r)throw new rf;let n=r8(r),o={version:1,type:U.ReadOnly,identifier:n,addresses:t};return await sr(e,o),o}i(m2,"addReadonlyAccount");m();g();async function g2(e,t){let r=new Set,n=await yt();for(let s of n)s.type===U.Seedless&&s.seedIdentifier===t&&os[Object.values(s.chains)[0].pathType]===0&&r.add(s.derivationIndex);let o=0;for(let s=0;s<=r.size;s++)if(!r.has(s)){o=s;break}return y2(e,t,o)}i(g2,"addAccountForExistingSeedless");async function y2(e,t,r){try{return await n8(e,t,r)}catch(n){if(n instanceof xi)return await y2(e,t,r+1);throw n}}i(y2,"addAccountForSeedWithDerivationIndex");async function n8(e,t,r){let n=await Wt(e,t),o=(await e.fetchChainAvailability()).enabledAddressTypes,s=Br(o),a=await ys(t,r,s[0]),l={version:1,type:U.Seedless,identifier:a,seedIdentifier:t,derivationIndex:r,chains:To(e,n,r,s)};return await sr(e,l,!1),l}i(n8,"_addAccountForExistingSeed");m();g();m();g();m();g();async function mc(e,t){let r=await no(),n=dc(t),o=r?.seedIdentifiers??[],s=r?.seedlessIdentifiers??[];return o.concat(s).includes(n)}i(mc,"isExistingSeed");async function _d(e,t,r,n){if((await xd()).length>0)throw new sf;if(n.length===0)throw new nf;if(await mc(e,t))throw new Za;let a=dc(t),l=t.fold(w=>({version:1,identifier:a,name:r,entropy:new Uint8Array(w)}));await N1(e,l);let f=[],p=await Wt(e,a);for(let w of n){let A=ys(a,w.derivationIndex,w.derivationPathTypes[0]),_=To(e,p,w.derivationIndex,w.derivationPathTypes),T={version:1,type:U.Seedless,identifier:A,seedIdentifier:a,derivationIndex:w.derivationIndex,chains:_};await sr(e,T),f.push(T)}return f}i(_d,"addSeedlessWithMultipleAccounts");async function b2(e,t,r){let n=(await e.fetchChainAvailability()).enabledAddressTypes,o=0,s=Br(n);return(await _d(e,t,r,[{name:r,derivationIndex:o,derivationPathTypes:s}]))[0]}i(b2,"addSeedlessWithDefaultAccount");m();g();m();g();async function Md(e,t,r,n,o=!1){let s=await mc(e,t);if(!o&&s)throw new Za;let a=dc(t),l=t.fold(w=>({version:1,identifier:a,name:r,entropy:new Uint8Array(w)}));await U1(e,l);let f=[],p=await Wt(e,a);for(let w of n){let A=await ys(a,w.derivationIndex,w.derivationPathTypes[0]),_=To(e,p,w.derivationIndex,w.derivationPathTypes),T={version:1,type:U.Seed,identifier:A,seedIdentifier:a,derivationIndex:w.derivationIndex,chains:_};await sr(e,T),f.push(T)}return f}i(Md,"addSeedWithMultipleAccounts");async function v2(e,t,r){let n=(await e.fetchChainAvailability()).enabledAddressTypes,o=0,s=Br(n);return(await Md(e,t,r,[{name:r,derivationIndex:o,derivationPathTypes:s}]))[0]}i(v2,"addSeedWithDefaultAccount");m();g();var w2=me(La());function o8(e){return w2.keccak256(e)}i(o8,"_identifierForSolanaSeedVaultAccount");async function x2(e,t){let r=[];for(let{publicKey:n,derivationPath:o,authToken:s}of t){let a=o8(n),l={version:1,type:U.SeedVault,identifier:a,derivationPath:o,authToken:s,publicKey:n,chainType:K.Solana};r.push(l),await sr(e,l)}return r}i(x2,"addSolanaSeedVaultAccounts");m();g();m();g();async function Id(e,t,r){let o=(await yt()).find(s=>s.identifier===t);if(!o)throw new wi;switch(o.type){case U.Seed:case U.Seedless:{let s=o.chains[r]?.pathType;if(!s)throw new Ws;let a=await Wt(e,o.seedIdentifier),l=e.keypairGenerator.generateKeypairFromSeed(a,o.derivationIndex,s);return wo.from(l.privateKey)}case U.PrivateKey:{let s=await Mo(e,o.privateKeyIdentifier);if(s.chainType!==r)throw new Ws;let a=e.keypairGenerator.generateKeypairFromPrivateKey(wo.from(s.privateKey),r);return wo.from(a.privateKey)}case U.Ledger:case U.SeedVault:case U.KMSVault:throw new ef;case U.ReadOnly:throw new tf;default:(s=>{throw new Error("invalid account type")})(o)}}i(Id,"exportPrivateKey");var i8=new So,s8=new Ws,a8=new ss,wt={unableToLoadAccounts:{status:"unable-to-load-accounts",isOnboarded:!1,reonboardingNeeded:!1},unonboarded:{status:"unonboarded",isOnboarded:!1,reonboardingNeeded:!1},storageTemporarilyInaccessible:{status:"storage-temporarily-inaccessible",isOnboarded:!1,reonboardingNeeded:!1},invalidIdentifier:{status:"invalid-identifier",isOnboarded:!0,reonboardingNeeded:!0},fetchIntegrityStorageError:{status:"fetch-integrity-storage-error",isOnboarded:!0,reonboardingNeeded:!0},fetchEntropyStorageError:{status:"fetch-entropy-storage-error",isOnboarded:!0,reonboardingNeeded:!0},fetchPkStorageError:{status:"fetch-pk-storage-error",isOnboarded:!0,reonboardingNeeded:!0},invalidEntropy:{status:"invalid-entropy",isOnboarded:!0,reonboardingNeeded:!0},invalidEntropyBip39:{status:"invalid-entropy-bip-39",isOnboarded:!0,reonboardingNeeded:!0},invalidChecksumBits:{status:"invalid-checksum-bits",isOnboarded:!0,reonboardingNeeded:!0},invalidEntropyBits:{status:"invalid-entropy-bits",isOnboarded:!0,reonboardingNeeded:!0},invalidChecksum:{status:"invalid-checksum",isOnboarded:!0,reonboardingNeeded:!0},invalidEntropyLengthLessThanTwelve:{status:"invalid-entropy-length-less-than-twelve",isOnboarded:!0,reonboardingNeeded:!0},invalidEntropyLengthMoreThanTwentyFour:{status:"invalid-entropy-length-more-than-twenty-four",isOnboarded:!0,reonboardingNeeded:!0},invalidEntropyLengthWrongWord:{status:"invalid-entropy-length-wrong-word",isOnboarded:!0,reonboardingNeeded:!0},invalidPkAddressType:{status:"invalid-pk-address-type",isOnboarded:!0,reonboardingNeeded:!0},invalidPkIdentifier:{status:"invalid-pk-identifier",isOnboarded:!0,reonboardingNeeded:!0},invalidPk:{status:"invalid-pk",isOnboarded:!0,reonboardingNeeded:!0},internalError:{status:"internal-error",isOnboarded:!0,reonboardingNeeded:!0},safelyOnboarded:{status:"safely-onboarded",isOnboarded:!0,reonboardingNeeded:!1}},gc=i(e=>e instanceof Error?e.message.includes("User interaction is not allowed"):!1,"isStorageTemporarilyInaccessibleError"),E2=i(async e=>Dw(()=>L1(e),gc,3,200),"fetchIntegrityCheckWithRetry");async function _2(e){let t;try{if(t=await yt(),t.length===0)return wt.unonboarded}catch{return wt.unableToLoadAccounts}return c8(e,t)}i(_2,"checkVaultIntegrity");var c8=i(async(e,t)=>{let r=await u8(e,t);if(r.status!=="safely-onboarded")return r;try{let a=await E2(e);if(a?.version===3&&a?.isSafelyOnboarded)return wt.safelyOnboarded}catch(a){return gc(a)?wt.storageTemporarilyInaccessible:wt.fetchIntegrityStorageError}let n=await A2(e,t,U.Seed),o=await A2(e,t,U.Seedless),s=await f8(e,t);if(n.status!=="safely-onboarded")return n;if(o.status!=="safely-onboarded")return o;if(s.status!=="safely-onboarded")return s;try{await Zm(e,{version:3,isSafelyOnboarded:!0,lastCheckedTimestamp:Date.now()})}catch(a){J.addBreadcrumb(Y.Account,`storeIntegrityCheck (v3) failed: ${a instanceof Error?a.message:"unknown"}`,oe.Info)}return wt.safelyOnboarded},"checkAndValidateAllSecrets"),u8=i(async(e,t)=>{try{if((await E2(e))?.isSafelyOnboarded)return wt.safelyOnboarded}catch(o){return gc(o)?wt.storageTemporarilyInaccessible:wt.fetchIntegrityStorageError}let r=await S2(e,t,U.Seed),n=await S2(e,t,U.Seedless);if(r.status!=="safely-onboarded")return r;if(n.status!=="safely-onboarded")return n;try{await Zm(e,{version:1,isSafelyOnboarded:!0,lastCheckedTimestamp:Date.now()})}catch(o){J.addBreadcrumb(Y.Account,`storeIntegrityCheck (v1) failed: ${o instanceof Error?o.message:"unknown"}`,oe.Info)}return wt.safelyOnboarded},"checkForExistingEntropy"),S2=i(async(e,t,r)=>{let n=new Set;for(let o of t)o.type===r&&n.add(o.seedIdentifier);for(let o of n)try{await An(e,o)}catch(s){if(gc(s))return wt.storageTemporarilyInaccessible;if(s instanceof Error){if(s.message===i8.message)return wt.invalidIdentifier;if(s.message.match(/ExpoSecureStorage/))return wt.fetchEntropyStorageError}return wt.internalError}return wt.safelyOnboarded},"checkExistingEntropy"),l8=i(e=>{if(gc(e))return wt.storageTemporarilyInaccessible;if(!(e instanceof Error))return wt.invalidEntropy;let t=[[/ExpoSecureStorage/,wt.fetchEntropyStorageError],[/InvalidEntropyBip39/,wt.invalidEntropyBip39],[/LessThanTwelve/,wt.invalidEntropyLengthLessThanTwelve],[/MoreThanTwentyFour/,wt.invalidEntropyLengthMoreThanTwentyFour],[/WrongWord/,wt.invalidEntropyLengthWrongWord],[/InvalidChecksumBits/,wt.invalidChecksumBits],[/InvalidEntropyBits/,wt.invalidEntropyBits],[/InvalidChecksum/,wt.invalidChecksum]];for(let[r,n]of t)if(e.message.match(r))return n;return wt.invalidEntropy},"getCheckValidEntropyErrorResult"),A2=i(async(e,t,r)=>{let n=new Set;for(let o of t)o.type===r&&n.add(o.seedIdentifier);for(let o of n)try{await Wt(e,o)}catch(s){return l8(s)}return wt.safelyOnboarded},"checkValidEntropy"),f8=i(async(e,t)=>{for(let r of t)if(r.type===U.PrivateKey)try{await Id(e,r.identifier,r.chainType)}catch(n){if(gc(n))return wt.storageTemporarilyInaccessible;if(n instanceof Error){if(n.message===s8.message)return wt.invalidPkAddressType;if(n.message===a8.message)return wt.invalidPkIdentifier;if(n.message.match(/ExpoSecureStorage/))return wt.fetchPkStorageError}return wt.invalidPk}return wt.safelyOnboarded},"checkValidPrivateKeys");m();g();m();g();m();g();var Du=new Error("Unknown error"),Td=new Error("Invalid entropy length"),Lu=new Error("Invalid mn*monic sentence length"),ag=new Error("Invalid checksum"),M2=new RangeError("Invalid mn*monic word"),sg=new RangeError("Invalid wordlist"),cg=new RangeError("Invalid wordlist index"),En=i((e,t)=>{if(!e)throw t},"assert");function vs(e){En(e>=128,Td),En(e<=256,Td),En(e%32===0,Td)}i(vs,"assertEntropyLengthIsValid");function Vu(e){En(e>=12,Lu),En(e<=24,Lu),En(e%3===0,Lu)}i(Vu,"assertMnemonicSentenceLengthIsValid");function yc(e){En(e.length===2048,sg),En(e.every(t=>typeof t=="string"),sg)}i(yc,"assertWordlistIsValid");function ug(e,t){return Vu(e),t(e*4/3)}i(ug,"generateEntropy");async function Bd(e,t){let r=e.length*8;vs(r);let n=r/32,o=await t(e),[s]=o,a=8-n,l=s>>>a<<a>>>0,f=new Uint8Array(e.length+1);return f.set(e,0),f[f.length-1]=l,f}i(Bd,"deriveBits");function kd(e){let t=(e.length-1)*8;vs(t);let r=t/32,n=(t+r)/11,o=new ArrayBuffer(n*4),s=new DataView(o),a=0,l=0,f=0;for(let p of e)if(f+=8,l|=p<<32-f,l>>>=0,f>=11){let w=l>>>21;En(w>=0&&w<=2047,cg),s.setUint32(a*4,w,!0),a++,l<<=11,l>>>=0,f-=11}return En(a===n,Lu),new Uint32Array(o)}i(kd,"mapBitsToIndexes");function I2(e){let t=e.length;Vu(t);let r=11,n=e.length*r,o=new ArrayBuffer(Math.ceil(n/8)),s=new DataView(o),a=new DataView(e.buffer),l=e.length,f=0,p=0,w=0,A=8;for(let _=0;_<l;_++){let T=a.getUint32(_*4,!0);En(T<2048,cg);let B=r;for(;B>0;){let P=32-B,C=B>=A?A:B;f|=T>>32-P-C&(1<<C)-1,p+=C,f<<=A-C,f>>>=0,B-=C,A-=C,A<=0&&(A=8),p%8===0&&(s.setUint8(w++,f),f=0)}}return l%8!==0&&s.setUint8(w,f),new Uint8Array(o)}i(I2,"mapIndexesToBits");function lg(e){Vu(e.length);let t=I2(e),r=t.slice(0,t.length-1);return t.fill(0),r}i(lg,"indexesToEntropy");async function bc(e,t){let r=e.length*8;vs(r);let n=await Bd(e,t),o=kd(n);return n.fill(0),o}i(bc,"entropyToIndexes");function fg(e,t){yc(t);let r=new Set(t),n=new Uint32Array(24),o=0,s="";for(let l=0;l<e.length;l++){let f=e[l],p=f===32,w=l===e.length-1;if(w&&(s+=String.fromCharCode(f)),p||w){En(r.has(s),M2);let A=0;for(let _ of t){if(s===_)break;A++}n[o++]=A,s=""}else s+=String.fromCharCode(f)}Vu(o);let a=n.slice(0,o);return n.fill(0),a}i(fg,"mnemonicToIndexes");async function vc(e,t,r){let n=await bc(e,r),o=new Uint8Array(n.reduce((a,l)=>a+t[l].length+1,-1)),s=0;for(let a of n){s>0&&(o[s++]=32);let l=t[a];for(let f of l)o[s++]=f.charCodeAt(0)}return n.fill(0),o}i(vc,"entropyToMnemonic");var ig=Uint8Array.of(109,110,101,109,111,110,105,99);async function Ki(e,t,r,n,o){let s=await vc(e,r,n),a=new Uint8Array(ig.length+t.length);a.set(ig,0),a.set(t,ig.length);let l=await o(s,a,2048,64,"sha512");return a.fill(0),s.fill(0),l}i(Ki,"entropyToSeed");m();g();var wc=me(ZI(),1);m();g();var ia=["abandon","ability","able","about","above","absent","absorb","abstract","absurd","abuse","access","accident","account","accuse","achieve","acid","acoustic","acquire","across","act","action","actor","actress","actual","adapt","add","addict","address","adjust","admit","adult","advance","advice","aerobic","affair","afford","afraid","again","age","agent","agree","ahead","aim","air","airport","aisle","alarm","album","alcohol","alert","alien","all","alley","allow","almost","alone","alpha","already","also","alter","always","amateur","amazing","among","amount","amused","analyst","anchor","ancient","anger","angle","angry","animal","ankle","announce","annual","another","answer","antenna","antique","anxiety","any","apart","apology","appear","apple","approve","april","arch","arctic","area","arena","argue","arm","armed","armor","army","around","arrange","arrest","arrive","arrow","art","artefact","artist","artwork","ask","aspect","assault","asset","assist","assume","asthma","athlete","atom","attack","attend","attitude","attract","auction","audit","august","aunt","author","auto","autumn","average","avocado","avoid","awake","aware","away","awesome","awful","awkward","axis","baby","bachelor","bacon","badge","bag","balance","balcony","ball","bamboo","banana","banner","bar","barely","bargain","barrel","base","basic","basket","battle","beach","bean","beauty","because","become","beef","before","begin","behave","behind","believe","below","belt","bench","benefit","best","betray","better","between","beyond","bicycle","bid","bike","bind","biology","bird","birth","bitter","black","blade","blame","blanket","blast","bleak","bless","blind","blood","blossom","blouse","blue","blur","blush","board","boat","body","boil","bomb","bone","bonus","book","boost","border","boring","borrow","boss","bottom","bounce","box","boy","bracket","brain","brand","brass","brave","bread","breeze","brick","bridge","brief","bright","bring","brisk","broccoli","broken","bronze","broom","brother","brown","brush","bubble","buddy","budget","buffalo","build","bulb","bulk","bullet","bundle","bunker","burden","burger","burst","bus","business","busy","butter","buyer","buzz","cabbage","cabin","cable","cactus","cage","cake","call","calm","camera","camp","can","canal","cancel","candy","cannon","canoe","canvas","canyon","capable","capital","captain","car","carbon","card","cargo","carpet","carry","cart","case","cash","casino","castle","casual","cat","catalog","catch","category","cattle","caught","cause","caution","cave","ceiling","celery","cement","census","century","cereal","certain","chair","chalk","champion","change","chaos","chapter","charge","chase","chat","cheap","check","cheese","chef","cherry","chest","chicken","chief","child","chimney","choice","choose","chronic","chuckle","chunk","churn","cigar","cinnamon","circle","citizen","city","civil","claim","clap","clarify","claw","clay","clean","clerk","clever","click","client","cliff","climb","clinic","clip","clock","clog","close","cloth","cloud","clown","club","clump","cluster","clutch","coach","coast","coconut","code","coffee","coil","coin","collect","color","column","combine","come","comfort","comic","common","company","concert","conduct","confirm","congress","connect","consider","control","convince","cook","cool","copper","copy","coral","core","corn","correct","cost","cotton","couch","country","couple","course","cousin","cover","coyote","crack","cradle","craft","cram","crane","crash","crater","crawl","crazy","cream","credit","creek","crew","cricket","crime","crisp","critic","crop","cross","crouch","crowd","crucial","cruel","cruise","crumble","crunch","crush","cry","crystal","cube","culture","cup","cupboard","curious","current","curtain","curve","cushion","custom","cute","cycle","dad","damage","damp","dance","danger","daring","dash","daughter","dawn","day","deal","debate","debris","decade","december","decide","decline","decorate","decrease","deer","defense","define","defy","degree","delay","deliver","demand","demise","denial","dentist","deny","depart","depend","deposit","depth","deputy","derive","describe","desert","design","desk","despair","destroy","detail","detect","develop","device","devote","diagram","dial","diamond","diary","dice","diesel","diet","differ","digital","dignity","dilemma","dinner","dinosaur","direct","dirt","disagree","discover","disease","dish","dismiss","disorder","display","distance","divert","divide","divorce","dizzy","doctor","document","dog","doll","dolphin","domain","donate","donkey","donor","door","dose","double","dove","draft","dragon","drama","drastic","draw","dream","dress","drift","drill","drink","drip","drive","drop","drum","dry","duck","dumb","dune","during","dust","dutch","duty","dwarf","dynamic","eager","eagle","early","earn","earth","easily","east","easy","echo","ecology","economy","edge","edit","educate","effort","egg","eight","either","elbow","elder","electric","elegant","element","elephant","elevator","elite","else","embark","embody","embrace","emerge","emotion","employ","empower","empty","enable","enact","end","endless","endorse","enemy","energy","enforce","engage","engine","enhance","enjoy","enlist","enough","enrich","enroll","ensure","enter","entire","entry","envelope","episode","equal","equip","era","erase","erode","erosion","error","erupt","escape","essay","essence","estate","eternal","ethics","evidence","evil","evoke","evolve","exact","example","excess","exchange","excite","exclude","excuse","execute","exercise","exhaust","exhibit","exile","exist","exit","exotic","expand","expect","expire","explain","expose","express","extend","extra","eye","eyebrow","fabric","face","faculty","fade","faint","faith","fall","false","fame","family","famous","fan","fancy","fantasy","farm","fashion","fat","fatal","father","fatigue","fault","favorite","feature","february","federal","fee","feed","feel","female","fence","festival","fetch","fever","few","fiber","fiction","field","figure","file","film","filter","final","find","fine","finger","finish","fire","firm","first","fiscal","fish","fit","fitness","fix","flag","flame","flash","flat","flavor","flee","flight","flip","float","flock","floor","flower","fluid","flush","fly","foam","focus","fog","foil","fold","follow","food","foot","force","forest","forget","fork","fortune","forum","forward","fossil","foster","found","fox","fragile","frame","frequent","fresh","friend","fringe","frog","front","frost","frown","frozen","fruit","fuel","fun","funny","furnace","fury","future","gadget","gain","galaxy","gallery","game","gap","garage","garbage","garden","garlic","garment","gas","gasp","gate","gather","gauge","gaze","general","genius","genre","gentle","genuine","gesture","ghost","giant","gift","giggle","ginger","giraffe","girl","give","glad","glance","glare","glass","glide","glimpse","globe","gloom","glory","glove","glow","glue","goat","goddess","gold","good","goose","gorilla","gospel","gossip","govern","gown","grab","grace","grain","grant","grape","grass","gravity","great","green","grid","grief","grit","grocery","group","grow","grunt","guard","guess","guide","guilt","guitar","gun","gym","habit","hair","half","hammer","hamster","hand","happy","harbor","hard","harsh","harvest","hat","have","hawk","hazard","head","health","heart","heavy","hedgehog","height","hello","helmet","help","hen","hero","hidden","high","hill","hint","hip","hire","history","hobby","hockey","hold","hole","holiday","hollow","home","honey","hood","hope","horn","horror","horse","hospital","host","hotel","hour","hover","hub","huge","human","humble","humor","hundred","hungry","hunt","hurdle","hurry","hurt","husband","hybrid","ice","icon","idea","identify","idle","ignore","ill","illegal","illness","image","imitate","immense","immune","impact","impose","improve","impulse","inch","include","income","increase","index","indicate","indoor","industry","infant","inflict","inform","inhale","inherit","initial","inject","injury","inmate","inner","innocent","input","inquiry","insane","insect","inside","inspire","install","intact","interest","into","invest","invite","involve","iron","island","isolate","issue","item","ivory","jacket","jaguar","jar","jazz","jealous","jeans","jelly","jewel","job","join","joke","journey","joy","judge","juice","jump","jungle","junior","junk","just","kangaroo","keen","keep","ketchup","key","kick","kid","kidney","kind","kingdom","kiss","kit","kitchen","kite","kitten","kiwi","knee","knife","knock","know","lab","label","labor","ladder","lady","lake","lamp","language","laptop","large","later","latin","laugh","laundry","lava","law","lawn","lawsuit","layer","lazy","leader","leaf","learn","leave","lecture","left","leg","legal","legend","leisure","lemon","lend","length","lens","leopard","lesson","letter","level","liar","liberty","library","license","life","lift","light","like","limb","limit","link","lion","liquid","list","little","live","lizard","load","loan","lobster","local","lock","logic","lonely","long","loop","lottery","loud","lounge","love","loyal","lucky","luggage","lumber","lunar","lunch","luxury","lyrics","machine","mad","magic","magnet","maid","mail","main","major","make","mammal","man","manage","mandate","mango","mansion","manual","maple","marble","march","margin","marine","market","marriage","mask","mass","master","match","material","math","matrix","matter","maximum","maze","meadow","mean","measure","meat","mechanic","medal","media","melody","melt","member","memory","mention","menu","mercy","merge","merit","merry","mesh","message","metal","method","middle","midnight","milk","million","mimic","mind","minimum","minor","minute","miracle","mirror","misery","miss","mistake","mix","mixed","mixture","mobile","model","modify","mom","moment","monitor","monkey","monster","month","moon","moral","more","morning","mosquito","mother","motion","motor","mountain","mouse","move","movie","much","muffin","mule","multiply","muscle","museum","mushroom","music","must","mutual","myself","mystery","myth","naive","name","napkin","narrow","nasty","nation","nature","near","neck","need","negative","neglect","neither","nephew","nerve","nest","net","network","neutral","never","news","next","nice","night","noble","noise","nominee","noodle","normal","north","nose","notable","note","nothing","notice","novel","now","nuclear","number","nurse","nut","oak","obey","object","oblige","obscure","observe","obtain","obvious","occur","ocean","october","odor","off","offer","office","often","oil","okay","old","olive","olympic","omit","once","one","onion","online","only","open","opera","opinion","oppose","option","orange","orbit","orchard","order","ordinary","organ","orient","original","orphan","ostrich","other","outdoor","outer","output","outside","oval","oven","over","own","owner","oxygen","oyster","ozone","pact","paddle","page","pair","palace","palm","panda","panel","panic","panther","paper","parade","parent","park","parrot","party","pass","patch","path","patient","patrol","pattern","pause","pave","payment","peace","peanut","pear","peasant","pelican","pen","penalty","pencil","people","pepper","perfect","permit","person","pet","phone","photo","phrase","physical","piano","picnic","picture","piece","pig","pigeon","pill","pilot","pink","pioneer","pipe","pistol","pitch","pizza","place","planet","plastic","plate","play","please","pledge","pluck","plug","plunge","poem","poet","point","polar","pole","police","pond","pony","pool","popular","portion","position","possible","post","potato","pottery","poverty","powder","power","practice","praise","predict","prefer","prepare","present","pretty","prevent","price","pride","primary","print","priority","prison","private","prize","problem","process","produce","profit","program","project","promote","proof","property","prosper","protect","proud","provide","public","pudding","pull","pulp","pulse","pumpkin","punch","pupil","puppy","purchase","purity","purpose","purse","push","put","puzzle","pyramid","quality","quantum","quarter","question","quick","quit","quiz","quote","rabbit","raccoon","race","rack","radar","radio","rail","rain","raise","rally","ramp","ranch","random","range","rapid","rare","rate","rather","raven","raw","razor","ready","real","reason","rebel","rebuild","recall","receive","recipe","record","recycle","reduce","reflect","reform","refuse","region","regret","regular","reject","relax","release","relief","rely","remain","remember","remind","remove","render","renew","rent","reopen","repair","repeat","replace","report","require","rescue","resemble","resist","resource","response","result","retire","retreat","return","reunion","reveal","review","reward","rhythm","rib","ribbon","rice","rich","ride","ridge","rifle","right","rigid","ring","riot","ripple","risk","ritual","rival","river","road","roast","robot","robust","rocket","romance","roof","rookie","room","rose","rotate","rough","round","route","royal","rubber","rude","rug","rule","run","runway","rural","sad","saddle","sadness","safe","sail","salad","salmon","salon","salt","salute","same","sample","sand","satisfy","satoshi","sauce","sausage","save","say","scale","scan","scare","scatter","scene","scheme","school","science","scissors","scorpion","scout","scrap","screen","script","scrub","sea","search","season","seat","second","secret","section","security","seed","seek","segment","select","sell","seminar","senior","sense","sentence","series","service","session","settle","setup","seven","shadow","shaft","shallow","share","shed","shell","sheriff","shield","shift","shine","ship","shiver","shock","shoe","shoot","shop","short","shoulder","shove","shrimp","shrug","shuffle","shy","sibling","sick","side","siege","sight","sign","silent","silk","silly","silver","similar","simple","since","sing","siren","sister","situate","six","size","skate","sketch","ski","skill","skin","skirt","skull","slab","slam","sleep","slender","slice","slide","slight","slim","slogan","slot","slow","slush","small","smart","smile","smoke","smooth","snack","snake","snap","sniff","snow","soap","soccer","social","sock","soda","soft","solar","soldier","solid","solution","solve","someone","song","soon","sorry","sort","soul","sound","soup","source","south","space","spare","spatial","spawn","speak","special","speed","spell","spend","sphere","spice","spider","spike","spin","spirit","split","spoil","sponsor","spoon","sport","spot","spray","spread","spring","spy","square","squeeze","squirrel","stable","stadium","staff","stage","stairs","stamp","stand","start","state","stay","steak","steel","stem","step","stereo","stick","still","sting","stock","stomach","stone","stool","story","stove","strategy","street","strike","strong","struggle","student","stuff","stumble","style","subject","submit","subway","success","such","sudden","suffer","sugar","suggest","suit","summer","sun","sunny","sunset","super","supply","supreme","sure","surface","surge","surprise","surround","survey","suspect","sustain","swallow","swamp","swap","swarm","swear","sweet","swift","swim","swing","switch","sword","symbol","symptom","syrup","system","table","tackle","tag","tail","talent","talk","tank","tape","target","task","taste","tattoo","taxi","teach","team","tell","ten","tenant","tennis","tent","term","test","text","thank","that","theme","then","theory","there","they","thing","this","thought","three","thrive","throw","thumb","thunder","ticket","tide","tiger","tilt","timber","time","tiny","tip","tired","tissue","title","toast","tobacco","today","toddler","toe","together","toilet","token","tomato","tomorrow","tone","tongue","tonight","tool","tooth","top","topic","topple","torch","tornado","tortoise","toss","total","tourist","toward","tower","town","toy","track","trade","traffic","tragic","train","transfer","trap","trash","travel","tray","treat","tree","trend","trial","tribe","trick","trigger","trim","trip","trophy","trouble","truck","true","truly","trumpet","trust","truth","try","tube","tuition","tumble","tuna","tunnel","turkey","turn","turtle","twelve","twenty","twice","twin","twist","two","type","typical","ugly","umbrella","unable","unaware","uncle","uncover","under","undo","unfair","unfold","unhappy","uniform","unique","unit","universe","unknown","unlock","until","unusual","unveil","update","upgrade","uphold","upon","upper","upset","urban","urge","usage","use","used","useful","useless","usual","utility","vacant","vacuum","vague","valid","valley","valve","van","vanish","vapor","various","vast","vault","vehicle","velvet","vendor","venture","venue","verb","verify","version","very","vessel","veteran","viable","vibrant","vicious","victory","video","view","village","vintage","violin","virtual","virus","visa","visit","visual","vital","vivid","vocal","voice","void","volcano","volume","vote","voyage","wage","wagon","wait","walk","wall","walnut","want","warfare","warm","warrior","wash","wasp","waste","water","wave","way","wealth","weapon","wear","weasel","weather","web","wedding","weekend","weird","welcome","west","wet","whale","what","wheat","wheel","when","where","whip","whisper","wide","width","wife","wild","will","win","window","wine","wing","wink","winner","winter","wire","wisdom","wise","wish","witness","wolf","woman","wonder","wood","wool","word","work","world","worry","worth","wrap","wreck","wrestle","wrist","write","wrong","yard","year","yellow","you","young","youth","zebra","zero","zone","zoo"];async function dg(e){switch(e){case"english":return ia}}i(dg,"getWordlist");function hg(e){return t=>new e(t)}i(hg,"createFromEntropy");function pg(e,t){return async r=>{let n=null,o=null,s=null,a=null,l=null;try{o=lg(r),s=await Bd(o,t),a=kd(s);let f=r[r.length-1],p=a[a.length-1];if(f!==p)throw ag;l=e.fromEntropy(o)}catch(f){f instanceof Error?n=f:(console.error(f),n=Du)}finally{if(o?.fill(0),s?.fill(0),a?.fill(0),n)throw n;return l}}}i(pg,"createFromIndexes");function mg(e,t){return async r=>{let n=null,o=null,s=null;try{o=fg(r,t),s=await e.fromIndexes(o)}catch(a){a instanceof Error?n=a:(console.error(a),n=Du)}finally{if(o?.fill(0),n)throw n;return s}}}i(mg,"createFromMnemonic");function gg(e,t){return r=>{let n=null,o=null,s=null;try{o=ug(r,t),s=e.fromEntropy(o)}catch(a){a instanceof Error?n=a:(console.error(a),n=Du)}finally{if(o?.fill(0),n)throw n;return s}}}i(gg,"createFromSentenceLength");var yg=class{static{i(this,"Bip39Factory")}static async webCrypto(t){let r=typeof t=="string"?await dg(t):t;yc(r);let n=i(a=>self.crypto.getRandomValues(new Uint8Array(a)),"random"),o=i(async a=>new Uint8Array(await self.crypto.subtle.digest("SHA-256",a)),"sha256"),s=i(async(a,l,f,p,w)=>{let A="SHA-"+w.substring(3),_=await self.crypto.subtle.importKey("raw",a,"PBKDF2",!1,["deriveBits"]),T=await self.crypto.subtle.deriveBits({name:"PBKDF2",salt:l,iterations:f,hash:A},_,p*8);return new Uint8Array(T)},"pbkdf2");return class qu{static{i(this,"WebCryptoBip39")}static fromEntropy=hg(qu);static fromIndexes=pg(qu,o);static fromMnemonic=mg(qu,r);static fromSentenceLength=gg(qu,n);static wordlist=r;#e;constructor(l){vs(l.length*8),this.#e=l.slice()}deriveSeed=i(async(l=new Uint8Array)=>Ki(this.#e,l,r,o,s),"deriveSeed");getEntropy=i(()=>this.#e.slice(),"getEntropy");getIndexes=i(async()=>bc(this.#e,o),"getIndexes");getMnemonic=i(async()=>vc(this.#e,r,o),"getMnemonic");getSentenceLength=i(()=>{let l=this.#e.length*8,f=l/32;return(l+f)/11},"getSentenceLength")}}static async nodeCrypto(t){let r=typeof t=="string"?await dg(t):t;yc(r);let n=i(a=>new Uint8Array((0,wc.randomBytes)(a).buffer),"random"),o=i(a=>new Uint8Array((0,wc.createHash)("sha256").update(a).digest().buffer),"sha256"),s=i(async(...a)=>new Promise((l,f)=>{(0,wc.pbkdf2)(...a,(p,w)=>{if(p){f(p);return}l(new Uint8Array(w.buffer))})}),"pbkdf2");return class Hu{static{i(this,"NodeCryptoBip39")}static fromEntropy=hg(Hu);static fromIndexes=pg(Hu,o);static fromMnemonic=mg(Hu,r);static fromSentenceLength=gg(Hu,n);static wordlist=r;#e;constructor(l){vs(l.length*8),this.#e=l.slice()}deriveSeed=i(async(l=new Uint8Array)=>Ki(this.#e,l,r,o,s),"deriveSeed");getEntropy=i(()=>this.#e.slice(),"getEntropy");getIndexes=i(async()=>bc(this.#e,o),"getIndexes");getMnemonic=i(async()=>vc(this.#e,r,o),"getMnemonic");getSentenceLength=i(()=>{let l=this.#e.length*8,f=l/32;return(l+f)/11},"getSentenceLength")}}static async customCrypto(t,r){let n=typeof t=="string"?await dg(t):t;yc(n);let{random:o,sha256:s,pbkdf2:a}=r;return class ju{static{i(this,"CustomCryptoBip39")}static fromEntropy=hg(ju);static fromIndexes=pg(ju,s);static fromMnemonic=mg(ju,n);static fromSentenceLength=gg(ju,o);static wordlist=n;#e;constructor(f){vs(f.length*8),this.#e=f.slice()}deriveSeed=i(async(f=new Uint8Array)=>Ki(this.#e,f,n,s,a),"deriveSeed");getEntropy=i(()=>this.#e.slice(),"getEntropy");getIndexes=i(async()=>bc(this.#e,s),"getIndexes");getMnemonic=i(async()=>vc(this.#e,n,s),"getMnemonic");getSentenceLength=i(()=>{let f=this.#e.length*8,p=f/32;return(f+p)/11},"getSentenceLength")}}};async function T2(e){let t=await fc(),r=[],n=0;for(let{identifier:o}of t)try{await e.secureCache.removeSeeds([o]);let a=await(await An(e,o)).foldAsync(async l=>Ki(l,new Uint8Array,ia,Xn,(f,p,w,A)=>za(Xn,f,p,{c:w,dkLen:A})));await e.secureCache.setSeed(o,a),a.fill(0),n++}catch(s){r.push(`Failed to corrupt seed ${o}: ${s instanceof Error?s.message:String(s)}`)}return{corruptedCount:n,errors:r}}i(T2,"DEBUG_corruptSeedCacheWithSha256");m();g();async function B2(e){let t=(await e.fetchChainAvailability()).enabledAddressTypes,r=!1,n=await yt();if(n.length===0)return r;let o=new Map;for(let s of n){if(s.type!==U.Seed&&s.type!==U.Seedless)continue;let a=o.get(s.seedIdentifier);a?a.push(s):o.set(s.seedIdentifier,[s])}for(let[s,a]of o){let l;for(let f of a){let p=Object.values(f.chains);if(!(p.length>0&&p.every(A=>!Sp(A.pathType))))for(let A of t){if(f.chains[A])continue;l||(l=await Wt(e,s));let T=Br([A]),B=To(e,l,f.derivationIndex,T);f.chains={...f.chains,...B},r=!0}}}return r&&await Sn(n),r}i(B2,"deriveAddresses");m();g();var bg=class extends Error{static{i(this,"SeedCacheCorruptionError")}sha256Count;mismatchCount;totalSeeds;constructor(t,r,n){super(`IDPLAT-295: Seed cache corruption detected - SHA256: ${t}, Mismatch: ${r}`),this.sha256Count=t,this.mismatchCount=r,this.totalSeeds=n}};async function P2(e){let t=await fc(),r=[];for(let{identifier:s}of t){let a=null,l=null,f=null;try{f=await e.secureCache.getSeed(s);let p=await An(e,s);if(a=await p.foldAsync(async w=>{let{seed:A}=await na(w);return A}),!f){r.push({seedIdentifier:s,digest:"uncached"});continue}if(k2(f,a)){r.push({seedIdentifier:s,digest:"sha512"});continue}if(l=await p.foldAsync(async w=>Ki(w,new Uint8Array,ia,Xn,(A,_,T,B)=>za(Xn,A,_,{c:T,dkLen:B}))),k2(f,l)){r.push({seedIdentifier:s,digest:"sha256"});continue}r.push({seedIdentifier:s,digest:"mismatch"})}catch(p){r.push({seedIdentifier:s,digest:"error",error:p instanceof Error?p.message:String(p)})}finally{a&&a.fill(0),l&&l.fill(0),f&&f.fill(0)}}let n=r.filter(s=>s.digest==="sha256").length,o=r.filter(s=>s.digest==="mismatch").length;if(n>0||o>0){let s=new bg(n,o,r.length);J.captureError(s,Y.Account)}return r}i(P2,"DO_NOT_USE_diagnoseSeedCacheDigests");var k2=i((e,t)=>{if(!e||!t||e.length!==t.length)return!1;for(let r=0;r<e.length;r+=1)if(e[r]!==t[r])return!1;return!0},"buffersEqual");m();g();var d8=i(e=>e.type===U.Seed||e.type===U.Seedless||e.type===U.PrivateKey,"isAccountWithKey"),C2=i(async(e,t)=>{let r=await yt();if(r.length===0)throw new Error("No accounts, unable to get authentication public key.");let o=r.filter(d8).find(a=>a.type===U.PrivateKey?a.privateKeyIdentifier===t:a.seedIdentifier===t);if(!o)throw new Error("Unable to derive authentication public key for given secret identifier.");let s=await gs(e,o);return pt(s.publicKey)},"getAuthenticationPublicKey");m();g();m();g();function h8(e){let t={};for(let r of Object.keys(e)){let n=e[r];if(!n)continue;let o;switch(n.chainType){case K.Solana:case K.EVM:{let{publicKey:s,...a}=n;o={...a,address:s};break}case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:{let{addresses:s,...a}=n,l=Object.values(wr).reduce((f,p)=>{let w=s?s[p]:void 0;if(!w)throw new Ga;return{...f,[p]:w}},{});o={...a,addresses:l};break}case K.Sui:{o=n;break}}t[r]=o}return t}i(h8,"convertStorageChainsToExternal");function Pd(e){switch(e.type){case U.Seed:return zu(e);case U.Seedless:return Fu(e);case U.PrivateKey:return xg(e);case U.Ledger:return wg(e);case U.SeedVault:return Sg(e);case U.ReadOnly:return e;case U.KMSVault:return Cd(e)}}i(Pd,"toExternalVaultAccount");function vg(e){let{chains:t,version:r,...n}=e,o=h8(t);return{...n,chains:o}}i(vg,"convertVaultAccountWithChains");function Cd(e){return vg(e)}i(Cd,"toExternalKMSVaultAccount");function wg(e){return vg(e)}i(wg,"toExternalVaultLedgerAccount");function xg(e){switch(e.chainType){case K.Solana:case K.EVM:{let{publicKey:t,version:r,...n}=e;return{...n,address:t}}case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:{let{addresses:t,version:r,...n}=e,o=Object.values(wr).reduce((s,a)=>{let l=t?t[a]:void 0;if(!l)throw new Ga;return{...s,[a]:l}},{});return{...n,addresses:o}}case K.Sui:return e}}i(xg,"toExternalVaultPrivateKeyAccount");function Sg(e){let{publicKey:t,version:r,...n}=e;return{...n,address:t}}i(Sg,"toExternalSolanaSeedVaultAccount");function zu(e){return vg(e)}i(zu,"toExternalVaultSeedAccount");function Fu(e){let{chains:t,version:r,...n}=e,o={};for(let s of Object.keys(t)){let a=t[s];if(!a)continue;let l;switch(a.chainType){case K.Solana:case K.EVM:{let{publicKey:f,...p}=a;l={...p,address:f};break}case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:{let{addresses:f,...p}=a,w=Object.values(wr).reduce((A,_)=>{let T=f?f[_]:void 0;if(!T)throw new Ga;return{...A,[_]:T}},{});l={...p,addresses:w};break}case K.Sui:l=a}o[s]=l}return{...n,chains:o}}i(Fu,"toExternalVaultSeedlessAccount");function p8(e){return e===U.Seed||e===U.Seedless||e===U.PrivateKey}i(p8,"needsLocalSecret");async function O2(e,t){try{return await e(),!0}catch(r){if(r instanceof t)return!1;throw r}}i(O2,"checkSecretExists");function m8(e){let t=Pd(e),r=Qn(t),n={};for(let{addressType:o,address:s}of r){if(!s)continue;let a=o;n[a]||(n[a]=s)}return n}i(m8,"extractAddressesFromAccount");async function g8(e,t){let r=[],n=0,o=new Map;for(let s of t)if(p8(s.type))if(n++,s.type===U.Seed||s.type===U.Seedless){let a=s.seedIdentifier;if(!o.has(a)){let f=await O2(()=>An(e,a),So);o.set(a,f)}(o.get(a)??!1)||r.push(s)}else s.type===U.PrivateKey&&(await O2(()=>Mo(e,s.privateKeyIdentifier),ss)||r.push(s));return{accountsToHeal:r,totalAccountsChecked:n}}i(g8,"identifyAccountsWithMissingSecrets");async function K2(e){let t={healedAccounts:[],failedAccounts:[],totalAccountsChecked:0},r=await yt(),{accountsToHeal:n,totalAccountsChecked:o}=await g8(e,r);if(t.totalAccountsChecked=o,n.length===0)return t;J.addBreadcrumb(Y.Account,`healAccountsWithMissingSecrets: Found ${n.length} accounts with missing secrets`,oe.Error);let s=[];for(let a of n)try{let l=m8(a);if(Object.keys(l).length===0){t.failedAccounts.push({identifier:a.identifier,type:a.type,error:"No valid addresses could be extracted"});continue}let f={version:1,type:U.ReadOnly,identifier:a.identifier,addresses:l};s.push(f),t.healedAccounts.push({identifier:a.identifier,originalType:a.type,addresses:l})}catch(l){t.failedAccounts.push({identifier:a.identifier,type:a.type,error:l instanceof Error?l.message:"Unknown error"})}if(s.length>0){let a=new Map(s.map(f=>[f.identifier,f])),l=r.map(f=>a.get(f.identifier)??f);await Sn(l)}if(t.healedAccounts.length>0){let a=t.failedAccounts.length>0?"partial":"success";J.captureMessage(`heal_accounts_with_missing_secrets:${a} healed=${t.healedAccounts.length}, failed=${t.failedAccounts.length}`,Y.Account,oe.Error)}return t.failedAccounts.length>0&&t.healedAccounts.length===0&&J.captureMessage(`heal_accounts_with_missing_secrets: all_failed=${t.failedAccounts.length}`,Y.Account,oe.Error),t}i(K2,"healAccountsWithMissingSecrets");m();g();async function R2(e,t){let r=await yt();if(r.length===0)throw new wi;let n=r.find(a=>a.identifier===t),o=n?.type===U.KMSVault,s=r.filter(a=>a.identifier!==t);if(await Sn(s),await Gm(e),o){let a=n;await W1(e,a.kms.walletId,a.kms.tag)}}i(R2,"removeAccount");m();g();async function U2(e,t,r){let n=await yt();if(r<0||r>=n.length)throw new wi;let o=n.map(a=>a.identifier).indexOf(t);if(o<0)throw new wi;if(o===r)return;let s=n[o];n.splice(o,1),n.splice(r,0,s),await Sn(n)}i(U2,"reorderAccount");m();g();m();g();var y8="cash",N2="cash",b8={pathType:ve.Bip44ChangeSolana,index:0};async function L2(e){J.addBreadcrumb(Y.Cash,"Getting user's Cash account from KMS",oe.Info);let t;try{let{result:r}=await e.getOrCreatePhantomOrganization();J.addBreadcrumb(Y.Cash,`Successfully got user's Phantom Org (orgId: ${Ag(r.organizationId)})`,oe.Info),t=r.organizationId}catch(r){J.addBreadcrumb(Y.Cash,"[KMS] Error getting user's Phantom Org",oe.Error);let n=r instanceof Error?r:new Error("[KMS] Failed to get user's Phantom Org");throw J.captureError(n,Y.Cash),n}try{let{result:{walletId:r,walletName:n,accounts:o}}=await e.getOrCreateWalletWithTag({organizationId:t,walletName:y8,tag:N2,mnemonicLength:24,accounts:[{derivationPath:vi(b8),curve:"Ed25519",addressFormat:"Solana"}]});if(o.length===0)throw new Error("No Cash account found");return J.addBreadcrumb(Y.Cash,`Successfully got user's Cash wallet (walletId: ${Ag(r)}, walletName: ${n}, orgId: ${Ag(t)})`,oe.Info),{organizationId:t,walletId:r,walletName:n,tag:N2,account:o[0]}}catch(r){J.addBreadcrumb(Y.Cash,"[KMS] Error getting user's Cash wallet",oe.Error);let n=r instanceof Error?r:new Error("[KMS] Failed to get user's Cash wallet");throw J.captureError(n,Y.Cash),n}}i(L2,"getCashKMSAccount");var Ag=i(e=>e?.slice(0,5)??"","sanitizeString");m();g();var v8="m/24001'/0'",D2=i(async e=>{let t=await yt();if(t.length===0)throw new Error("No accounts, unable to derive cash key.");let r=t[0],n;switch(r.type){case U.Seed:case U.Seedless:{n=(await Wt(e,r.seedIdentifier)).fold(s=>new Na(s));break}case U.PrivateKey:{let o=await Mo(e,r.privateKeyIdentifier);n=new Na(o.privateKey);break}default:throw new Error(`Account type ${r.type} is not supported, unable to derive cash key.`)}try{let o=n.derivePath({ellipticCurve:"ed25519",derivationPath:v8,bytesInPrivateKey:64});return{publicKey:o.publicKey,privateKey:o.secretKey}}finally{n.cleanup()}},"deriveCashKeypair");m();g();m();g();var Fr=me(vo());var X2=me(Ew()),_g=me(tT());m();g();m();g();var w8=v.array(v.object({address:v.string(),signingIndexes:v.array(v.number()),sigHash:v.number().optional(),isScriptSpend:v.boolean().optional()})),V2=v.object({chainType:pu,signingType:v.literal("transaction"),message:v.string().min(1),inputsToSign:w8.optional(),finalize:v.boolean()}),x8=v.object({chainType:pu,signingType:v.literal("message"),message:v.instanceof(Uint8Array)}),S8=V2.or(x8),q2=v.object({chainType:v.literal(K.Sui),signingType:v.literal("transaction"),transaction:v.instanceof(Uint8Array)}),H2=v.object({chainType:v.literal(K.Sui),signingType:v.literal("personalMessage"),message:v.instanceof(Uint8Array)}),A8=q2.or(H2),j2=v.object({chainType:v.literal(K.Solana),signingType:v.literal("transaction"),message:v.union([v.string().min(1),v.instanceof(Uint8Array)])}),z2=v.object({chainType:v.literal(K.Solana),signingType:v.literal("message"),message:v.string().min(1)}),F2=j2.or(z2),W2=v.object({chainType:v.literal(K.EVM),signingType:v.literal("transaction"),message:v.string().min(1)}),$2=v.object({chainType:v.literal(K.EVM),signingType:v.literal("message"),message:v.string().min(1)}),G2=v.object({chainType:v.literal(K.EVM),signingType:v.literal("typedData"),version:v.literal(1),data:Vl}),Z2=v.object({chainType:v.literal(K.EVM),signingType:v.literal("typedData"),version:v.literal(3),data:ql}),Y2=v.object({chainType:v.literal(K.EVM),signingType:v.literal("typedData"),version:v.literal(4),data:Hl}),E8=W2.or($2).or(G2).or(Z2).or(Y2),_8=v.object({isJWT:v.literal(!0),data:ep}),Bo=v.object({policyName:v.string().optional()}),M8=j2.merge(Bo),I8=z2.merge(Bo),Gne=M8.or(I8),T8=W2.merge(Bo),B8=$2.merge(Bo),k8=G2.merge(Bo),P8=Z2.merge(Bo),C8=Y2.merge(Bo),Zne=T8.or(B8).or(k8).or(P8).or(C8),Yne=V2.merge(Bo),Jne=v.union([q2.merge(Bo),H2.merge(Bo)]),O8=v.object({isKMSPKIAuthenticator:v.literal(!0),payload:sd}),Xne=v.object({organizationId:v.string(),walletId:v.string(),derivationPath:v.string()}),J2=v.object({isCash:v.literal(!0),data:F2}),K8=J2.extend({isCashKMS:v.literal(!0),cashAccountAddress:v.string()}),R8=v.object({status:v.literal("success"),signature:v.string()}),U8=v.object({status:v.literal("success"),signature:v.string()}),N8=v.object({status:v.literal("success"),signature:v.string(),message:v.instanceof(Uint8Array).optional()}),L8=v.object({status:v.literal("success"),signature:v.string()}),D8=v.object({status:v.literal("success"),signature:v.string(),signedJWT:Q0.optional()}),V8=v.object({status:v.literal("success"),signature:v.string()});var Eg=F2.or(E8).or(S8).or(A8).or(_8).or(O8).or(J2).or(K8),he;(function(e){e.InvalidInput="invalidInput",e.InvalidAccountId="invalidAccountId",e.InvalidAddressType="invalidAddressType",e.InvalidMessageEncoding="invalidMessageEncoding",e.InvalidDerivationPath="invalidDerivationPath",e.InvalidRpcPayload="invalidRpcPayload",e.LedgerAppNotOpen="ledgerAppNotOpen",e.LedgerNotConnected="ledgerNotConnected",e.LedgerNeedPermission="ledgerNeedPermission",e.LedgerRejectAction="ledgerRejectAction",e.LedgerUnknownSignError="ledgerUnknownSignError",e.UnsupportedOperation="unsupportedOperation",e.InternalError="internalError",e.ExpiredTokenError="expiredToken",e.BeforeIATError="beforeTimeOfIssuance",e.InvalidClaimError="invalidClaim"})(he||(he={}));var q8=v.object({status:v.literal("error"),type:v.nativeEnum(he),message:v.string()}),H8=v.union([D8,V8,N8,R8,U8,L8,q8]),$t;(function(e){e.KeyPair="keyPair",e.Ledger="ledger",e.SeedVault="seedVault",e.KMS="kms"})($t||($t={}));var j8={[he.InvalidInput]:{message:"Invalid input"},[he.InvalidAccountId]:{message:"Invalid account identifier."},[he.InvalidAddressType]:{message:"Invalid chain type."},[he.InvalidMessageEncoding]:{message:"Invalid message encoding."},[he.InvalidDerivationPath]:{message:"Invalid derivation path."},[he.InvalidRpcPayload]:{message:"Invalid KMS RPC payload."},[he.LedgerAppNotOpen]:{message:"Ledger App not open."},[he.LedgerNotConnected]:{message:"Ledger not connected."},[he.LedgerNeedPermission]:{message:"Need permission to connect to Ledger."},[he.LedgerRejectAction]:{message:"Ledger user rejected action."},[he.LedgerUnknownSignError]:{message:"Ledger unknown sign error."},[he.UnsupportedOperation]:{message:"Unsupported operation."},[he.InternalError]:{message:"Internal error."},[he.ExpiredTokenError]:{message:"Token is expired"},[he.BeforeIATError]:{message:"Received token before issuance time"},[he.InvalidClaimError]:{message:"Claim is invalid"}},Me=i((e,t)=>({status:"error",type:e,message:t??j8[e].message}),"createVaultSignerError");var Mg=i(e=>e.length===32?e:e.slice(1,33),"toXOnly");function z8(e){return Fr.Buffer.concat([(0,_g.encode)(e.byteLength),e])}i(z8,"encodeVarString");function F8(e){let{sha256:t}=X2.crypto,n=t(Fr.Buffer.from("BIP0322-signed-message"));return t(Fr.Buffer.concat([n,n,Fr.Buffer.from(e)])).toString("hex")}i(F8,"bip0322Hash");var W8=i((e,t)=>{switch(e){case K.BitcoinTaproot:return ow.getPublicKey(t);case K.BitcoinNestedSegwit:return q0(t,!0);case K.BitcoinNativeSegwit:return q0(t,!0);default:throw new Error("Unsupported Address Type")}},"getSigningPk"),$8=i((e,t)=>{let r=Vw;switch(e){case K.BitcoinTaproot:return Hw(t,void 0,r);case K.BitcoinNativeSegwit:return $0(t,r);case K.BitcoinNestedSegwit:{let n=$0(t,r);return qw(n,r)}default:throw new Error("Unsupported Address Type")}},"getSignerScript");function G8(e,t,r,n){let o=Jl.fromPSBT(r,{allowUnknownInputs:!0});try{t.forEach(s=>{let a=Va(wr.Mainnet,s.address),l=e[a];if(!l)throw new Error("missing private key for ("+a+")");let{publicKey:f,privateKey:p}=l;s.signingIndexes.forEach(w=>{let A=o.getInput(w),_=A.witnessUtxo?.script&&jw.decode(A.witnessUtxo.script);if(!s.isScriptSpend&&!A.tapInternalKey&&_?.type==="tr"&&o.updateInput(w,{tapInternalKey:Mg(Fr.Buffer.from(f))}),s.sigHash)try{o.signIdx(p,w,[s.sigHash],hu(32))}catch{o.signIdx(p,w,void 0,hu(32))}else o.signIdx(p,w,void 0,hu(32));if(n)try{o.finalizeIdx(w)}catch{}})})}catch(s){throw console.error(s),new Error(`Error signing PSBT ${s.toString()}`)}return Promise.resolve(o.toPSBT(0))}i(G8,"signPsbt");var Q2=i(()=>({type:$t.KeyPair,sign:i(async(e,t)=>{try{switch(t.signingType){case"message":{let r=t.chainType,n=Fr.Buffer.from(t.message).toString("utf8"),o=e[t.chainType]?.privateKey;if(!o)throw new Error("missing private key for ("+t.chainType+")");let s=Fr.Buffer.from(o).toString("hex"),a=W8(r,s),l=$8(r,a),f=Fr.Buffer.from("0000000000000000000000000000000000000000000000000000000000000000","hex"),p=0,w=4294967295,A=0,_=W0.encode(["OP_0",Fr.Buffer.from(F8(n),"hex")]),T=new Jl({allowUnknownOutputs:!0,version:p});T.addOutput({amount:BigInt(0),script:l.script}),T.addInput({txid:f,index:w,sequence:A,finalScriptSig:_});let B=new Jl({allowUnknownOutputs:!0,version:p});B.addInput({txid:T.id,index:0,sequence:A,tapInternalKey:r===K.BitcoinTaproot?a:void 0,witnessUtxo:{script:l.script,amount:BigInt(0)},redeemScript:l.redeemScript}),B.addOutput({script:W0.encode(["RETURN"]),amount:BigInt(0)}),B.sign(Fr.Buffer.from(s,"hex"),void 0,hu(32)),B.finalize();let P,C=B.getInput(0);if(C.finalScriptWitness?.length){let O=(0,_g.encode)(C.finalScriptWitness?.length);P=Fr.Buffer.concat([O,...C.finalScriptWitness.map(L=>z8(L))])}else throw new Error("couldnt produce a signature");return{status:"success",signature:P.toString("hex"),message:B.toBytes()}}case"transaction":{let r=await G8(e,t.inputsToSign??[],Fr.Buffer.from(t.message??"","hex"),t.finalize??!1);return{status:"success",signature:Fr.Buffer.from(r).toString("hex")}}}}catch{return Me(he.InternalError)}},"sign")}),"createBitcoinKeyPairSigner");m();g();var tS=me(mu()),rS=me(es());m();g();var eS=me(mu());function Od(e,t,r){if(r!==K.Solana)return Me(he.InvalidAddressType);if(e instanceof Uint8Array)return e;try{return t==="transaction"?eS.default.decode(e):Buffer.from(e,"utf8")}catch(n){return Me(he.InvalidMessageEncoding,`Failed to decode message: ${n instanceof Error?n.message:"Unknown error"}`)}}i(Od,"decodeSolanaMessage");var nS=i(()=>({type:$t.KeyPair,sign:i((e,t)=>{let r=t.data,n=Od(r.message,r.signingType,r.chainType);if("status"in n)return Promise.resolve(n);let o=tS.default.encode(rS.default.sign.detached(n,e.privateKey));return Promise.resolve({status:"success",signature:o})},"sign")}),"createCashVaultSigner");m();g();var Oc=me(vo()),AA=me(YI());var No=me(SA()),EA=me(La());var _A=i(()=>({type:$t.KeyPair,sign:i((e,t)=>{try{switch(t.signingType){case"typedData":{switch(t.version){case 1:{let r=Oc.Buffer.from(e.privateKey.slice()),n=No.SignTypedDataVersion.V1,{data:o}=t,s=(0,No.signTypedData)({privateKey:r,version:n,data:o});return r.fill(0),Promise.resolve({status:"success",signature:s})}case 3:{let r=Oc.Buffer.from(e.privateKey.slice()),n=No.SignTypedDataVersion.V3,o=t.data,s=(0,No.signTypedData)({privateKey:r,version:n,data:o});return r.fill(0),Promise.resolve({status:"success",signature:s})}case 4:{let r=Oc.Buffer.from(e.privateKey.slice()),n=No.SignTypedDataVersion.V4,o=t.data,s=(0,No.signTypedData)({privateKey:r,version:n,data:o});return r.fill(0),Promise.resolve({status:"success",signature:s})}}break}case"message":{let r=t.message,n=(0,No.personalSign)({privateKey:Oc.Buffer.from(e.privateKey),data:r});return Promise.resolve({status:"success",signature:n})}case"transaction":{let r=Oc.Buffer.from(t.message.replace("0x",""),"hex"),n=new fw(e.privateKey),o=`0x${(0,EA.keccak256)(r)}`,s=(0,AA.joinSignature)(n.signDigest(o));return Promise.resolve({status:"success",signature:s})}}}catch(r){return console.error(r),Promise.resolve(Me(he.InvalidMessageEncoding))}},"sign")}),"createEthereumKeyPairSigner");m();g();var ma=me(vo());var MA=i(()=>({type:$t.KeyPair,sign:i((e,t)=>{if(!t.isJWT)return Promise.resolve(Me(he.InvalidAddressType));if(t.data.payload.iss!==xu)return Promise.resolve(Me(he.InvalidClaimError));if(t.data.payload.aud!==Su)return Promise.resolve(Me(he.InvalidClaimError));let r={...t.data.header,kid:pt(ma.Buffer.from(e.publicKey))},n={...t.data.payload,sub:pt(ma.Buffer.from(e.publicKey))},o=pt(ma.Buffer.from(JSON.stringify(r)))+"."+pt(ma.Buffer.from(JSON.stringify(n))),a=ra.sign(ma.Buffer.from(o).toString("hex"),e.privateKey,{prehash:!0}).toCompactRawBytes(),l=pt(ma.Buffer.from(a)),f={header:r,payload:n,signature:l};return Promise.resolve({status:"success",signature:l,signedJWT:f})},"sign")}),"createJWTKeypairSigner");m();g();m();g();m();g();var IA=me(mu());async function Qg(e,t,r){let n=Od(r.message,r.signingType,r.chainType);if("status"in n)return n;try{let o={curve:"Ed25519",derivationPath:t.derivationPath,addressFormat:"Solana"};if(r.signingType==="transaction"){let s=Da.VersionedMessage.deserialize(n),l=new Da.VersionedTransaction(s).serialize(),f=pt(l),{result:{transaction:p}}=await e.signTransaction({transaction:f,organizationId:t.organizationId,walletId:t.walletId,derivationInfo:o,policyName:r.policyName??null}),w;if(typeof p=="string")w=new Uint8Array(xr(p));else if(Array.isArray(p))w=new Uint8Array(p);else throw new Error("Unexpected transaction format from KMS");let A=Da.VersionedTransaction.deserialize(w);if(!A.signatures||A.signatures.length===0)throw new Error("Signed transaction has no signatures");return{status:"success",signature:IA.default.encode(A.signatures[0])}}else{let s=new TextDecoder().decode(n),{result:{signature:a}}=await e.signUtf8Message({message:s,organizationId:t.organizationId,walletId:t.walletId,derivationInfo:o,algorithm:"Ed25519",policyName:r.policyName});return{status:"success",signature:Ll(a)}}}catch(o){return Me(he.InternalError,`KMS Solana signing failed: ${o instanceof Error?o.message:"Unknown error"}`)}}i(Qg,"signSolana");m();g();var Yd=me(vo());async function ey(e,t,r){try{let n={curve:"Secp256k1",derivationPath:t.derivationPath,addressFormat:"Ethereum"};switch(r.signingType){case"transaction":{let{result:{signature:o}}=await e.signTransaction({transaction:{kind:Ii.RLP_ENCODED,bytes:r.message},organizationId:t.organizationId,walletId:t.walletId,derivationInfo:n,policyName:r.policyName});return typeof o!="string"||!BA(o)?Me(he.InternalError,"KMS returned invalid Ethereum signature"):{status:"success",signature:o}}case"message":{let o=dk(r.message),s=pt(o),{result:{signature:a}}=await e.ethereumSignMessage({message:s,organizationId:t.organizationId,walletId:t.walletId,derivationInfo:n,policyName:r.policyName});return{status:"success",signature:TA(a)}}case"typedData":{let{result:{signature:o}}=await e.ethereumSignTypedData({typedData:r.data,organizationId:t.organizationId,walletId:t.walletId,derivationInfo:n,policyName:r.policyName});return{status:"success",signature:TA(o)}}}}catch(n){return Me(he.InternalError,`KMS EVM signing failed: ${n instanceof Error?n.message:"Unknown error"}`)}}i(ey,"signEVM");function TA(e){let t=xr(e);return`0x${Yd.Buffer.from(t).toString("hex")}`}i(TA,"base64UrlSignatureToHex");function dk(e){if(BA(e)){let t=e.slice(2),r=t.length%2===0?t:`0${t}`;return Yd.Buffer.from(r,"hex")}return Yd.Buffer.from(e,"utf8")}i(dk,"normalizePersonalSignPayload");function BA(e){return e.length<3||!(e.startsWith("0x")||e.startsWith("0X"))||e.length%2!==0?!1:/^[0-9a-fA-F]+$/.test(e.slice(2))}i(BA,"looksLikeHex");m();g();function kA(e,t){let r=xr(e),n=xr(t);return Buffer.concat([Buffer.from([0]),r,n]).toString("base64")}i(kA,"serializeSuiSignature");async function ty(e,t,r){try{let n={curve:"Ed25519",derivationPath:t.derivationPath,addressFormat:"Sui"};switch(r.signingType){case"transaction":{let o=pt(r.transaction),{result:{signature:s,publicKey:a}}=await e.signTransaction({transaction:{kind:Ii.SUI_BCS_ENCODED_TRANSACTION_DATA,bytes:o},organizationId:t.organizationId,walletId:t.walletId,derivationInfo:n,policyName:r.policyName??null});return!s||!a?Me(he.InternalError,"KMS Sui signing failed: signature or public key not returned in response"):{status:"success",signature:kA(s,a)}}case"personalMessage":{let o=new TextDecoder().decode(r.message),{result:{signature:s,publicKey:a}}=await e.signUtf8Message({message:o,organizationId:t.organizationId,walletId:t.walletId,derivationInfo:n,algorithm:"Ed25519",policyName:r.policyName});return!s||!a?Me(he.InternalError,"KMS Sui signing failed: signature or public key not returned in response"):{status:"success",signature:kA(s,a)}}}return Me(he.UnsupportedOperation,`Unsupported Sui signingType: ${r.signingType}`)}catch(n){return Me(he.InternalError,`KMS Sui signing failed: ${n instanceof Error?n.message:"Unknown error"}`)}}i(ty,"signSui");m();g();async function ry(e,t,r){try{if(r.signingType!=="transaction")return Me(he.UnsupportedOperation,"KMS does not support Bitcoin message signing");let n=null;switch(r.chainType){case K.BitcoinTaproot:n="BitcoinTaproot";break;case K.BitcoinNativeSegwit:n="BitcoinSegwit";break}if(!n)return Me(he.UnsupportedOperation,`KMS does not yet support Bitcoin address type: ${r.chainType}`);let o={curve:"Secp256k1",derivationPath:t.derivationPath,addressFormat:n},s=r.message,a=ww(s),l=a.length%2===0?a:`0${a}`,f=rw(l),p=pt(f),{result:{transaction:w}}=await e.signTransaction({transaction:{kind:Ii.PSBT,bytes:p},organizationId:t.organizationId,walletId:t.walletId,derivationInfo:o,policyName:void 0}),A;if(typeof w=="string")A=xr(w);else if(Array.isArray(w))A=new Uint8Array(w);else return Me(he.InternalError,"Unexpected Bitcoin transaction response format from KMS");return{status:"success",signature:tw(A)}}catch(n){return Me(he.InternalError,`KMS Bitcoin signing failed: ${n instanceof Error?n.message:"Unknown error"}`)}}i(ry,"signBitcoin");var PA=i(()=>({type:$t.KMS,sign:i(async(e,t,r)=>{switch(r.chainType){case K.Solana:return Qg(e,t,r);case K.EVM:return ey(e,t,r);case K.Sui:return ty(e,t,r);case K.BitcoinTaproot:case K.BitcoinNativeSegwit:return ry(e,t,r);default:return Me(he.UnsupportedOperation,`KMS signer does not support chain type: ${r.chainType}`)}},"sign")}),"createKMSSigner");m();g();var CA=i(()=>({type:$t.KeyPair,sign:i(async(e,t)=>{if(!t.isKMSPKIAuthenticator)return Me(he.InvalidAddressType);try{let r=Tm(t.payload),n=JSON.stringify(r),o=Buffer.from(n).toString("hex"),a=ra.sign(o,e.privateKey,{prehash:!0}).toCompactRawBytes();return{status:"success",signature:pt(a)}}catch(r){if(r instanceof v.ZodError)return Me(he.InvalidRpcPayload,`Invalid KMS RPC payload: ${r.message}`);let n=r instanceof Error?r.message:"Failed to authenticate KMS RPC request";return Me(he.InternalError,n)}},"sign")}),"createKMSPKIAuthenticatorSigner");m();g();var OA=me(vo());var ny=me(mu()),KA=me(es());var RA=i(()=>({type:$t.KeyPair,sign:i((e,t)=>{if(t.chainType!==K.Solana)return Promise.resolve(Me(he.InvalidAddressType));let r;try{typeof t.message=="string"?t.signingType==="transaction"?r=ny.default.decode(t.message):r=OA.Buffer.from(t.message,"utf8"):r=t.message}catch{return Promise.resolve(Me(he.InvalidMessageEncoding))}let n=ny.default.encode(KA.default.sign.detached(r,e.privateKey));return Promise.resolve({status:"success",signature:n})},"sign")}),"createSolanaKeyPairSigner");m();g();m();g();m();g();var wa=me(es(),1);m();g();m();g();m();g();m();g();m();g();function hk(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}i(hk,"isBytes");function Kc(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}i(Kc,"anumber");function Ui(e,...t){if(!hk(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}i(Ui,"abytes");function NA(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Kc(e.outputLen),Kc(e.blockLen)}i(NA,"ahash");function Ni(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}i(Ni,"aexists");function Jd(e,t){Ui(e);let r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}i(Jd,"aoutput");function Qu(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}i(Qu,"u32");function co(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}i(co,"clean");function Xd(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}i(Xd,"createView");var LA=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function DA(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}i(DA,"byteSwap");var Lo=LA?e=>e:e=>DA(e);function pk(e){for(let t=0;t<e.length;t++)e[t]=DA(e[t]);return e}i(pk,"byteSwap32");var ga=LA?e=>e:pk,VA=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",mk=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Qd(e){if(Ui(e),VA)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=mk[e[r]];return t}i(Qd,"bytesToHex");var Ri={_0:48,_9:57,A:65,F:70,a:97,f:102};function UA(e){if(e>=Ri._0&&e<=Ri._9)return e-Ri._0;if(e>=Ri.A&&e<=Ri.F)return e-(Ri.A-10);if(e>=Ri.a&&e<=Ri.f)return e-(Ri.a-10)}i(UA,"asciiToBase16");function qA(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(VA)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(r);for(let o=0,s=0;o<r;o++,s+=2){let a=UA(e.charCodeAt(s)),l=UA(e.charCodeAt(s+1));if(a===void 0||l===void 0){let f=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+s)}n[o]=a*16+l}return n}i(qA,"hexToBytes");function gk(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}i(gk,"utf8ToBytes");function uo(e){return typeof e=="string"&&(e=gk(e)),Ui(e),e}i(uo,"toBytes");var As=class{static{i(this,"Hash")}};function HA(e){let t=i(n=>e().update(uo(n)).digest(),"hashC"),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}i(HA,"createHasher");function jA(e){let t=i((n,o)=>e(o).update(uo(n)).digest(),"hashC"),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}i(jA,"createOptHasher");var zA=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]);m();g();function yk(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let o=BigInt(32),s=BigInt(4294967295),a=Number(r>>o&s),l=Number(r&s),f=n?4:0,p=n?0:4;e.setUint32(t+f,a,n),e.setUint32(t+p,l,n)}i(yk,"setBigUint64");var eh=class extends As{static{i(this,"HashMD")}constructor(t,r,n,o){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.buffer=new Uint8Array(t),this.view=Xd(this.buffer)}update(t){Ni(this),t=uo(t),Ui(t);let{view:r,buffer:n,blockLen:o}=this,s=t.length;for(let a=0;a<s;){let l=Math.min(o-this.pos,s-a);if(l===o){let f=Xd(t);for(;o<=s-a;a+=o)this.process(f,a);continue}n.set(t.subarray(a,a+l),this.pos),this.pos+=l,a+=l,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Ni(this),Jd(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:o,isLE:s}=this,{pos:a}=this;r[a++]=128,co(this.buffer.subarray(a)),this.padOffset>o-a&&(this.process(n,0),a=0);for(let A=a;A<o;A++)r[A]=0;yk(n,o-8,BigInt(this.length*8),s),this.process(n,0);let l=Xd(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let p=f/4,w=this.get();if(p>w.length)throw new Error("_sha2: outputLen bigger than state");for(let A=0;A<p;A++)l.setUint32(4*A,w[A],s)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:o,finished:s,destroyed:a,pos:l}=this;return t.destroyed=a,t.finished=s,t.length=o,t.pos=l,o%r&&t.buffer.set(n),t}clone(){return this._cloneInto()}};var pr=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]);m();g();var th=BigInt(4294967295),FA=BigInt(32);function oy(e,t=!1){return t?{h:Number(e&th),l:Number(e>>FA&th)}:{h:Number(e>>FA&th)|0,l:Number(e&th)|0}}i(oy,"fromBig");function WA(e,t=!1){let r=e.length,n=new Uint32Array(r),o=new Uint32Array(r);for(let s=0;s<r;s++){let{h:a,l}=oy(e[s],t);[n[s],o[s]]=[a,l]}return[n,o]}i(WA,"split");var iy=i((e,t,r)=>e>>>r,"shrSH"),sy=i((e,t,r)=>e<<32-r|t>>>r,"shrSL"),Do=i((e,t,r)=>e>>>r|t<<32-r,"rotrSH"),Vo=i((e,t,r)=>e<<32-r|t>>>r,"rotrSL"),ya=i((e,t,r)=>e<<64-r|t>>>r-32,"rotrBH"),ba=i((e,t,r)=>e>>>r-32|t<<64-r,"rotrBL"),$A=i((e,t)=>t,"rotr32H"),GA=i((e,t)=>e,"rotr32L");function an(e,t,r,n){let o=(t>>>0)+(n>>>0);return{h:e+r+(o/2**32|0)|0,l:o|0}}i(an,"add");var el=i((e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),"add3L"),tl=i((e,t,r,n)=>t+r+n+(e/2**32|0)|0,"add3H"),ZA=i((e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),"add4L"),YA=i((e,t,r,n,o)=>t+r+n+o+(e/2**32|0)|0,"add4H"),JA=i((e,t,r,n,o)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(o>>>0),"add5L"),XA=i((e,t,r,n,o,s)=>t+r+n+o+s+(e/2**32|0)|0,"add5H");var Qt=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),de=new Uint32Array(32);function Es(e,t,r,n,o,s){let a=o[s],l=o[s+1],f=de[2*e],p=de[2*e+1],w=de[2*t],A=de[2*t+1],_=de[2*r],T=de[2*r+1],B=de[2*n],P=de[2*n+1],C=el(f,w,a);p=tl(C,p,A,l),f=C|0,{Dh:P,Dl:B}={Dh:P^p,Dl:B^f},{Dh:P,Dl:B}={Dh:$A(P,B),Dl:GA(P,B)},{h:T,l:_}=an(T,_,P,B),{Bh:A,Bl:w}={Bh:A^T,Bl:w^_},{Bh:A,Bl:w}={Bh:Do(A,w,24),Bl:Vo(A,w,24)},de[2*e]=f,de[2*e+1]=p,de[2*t]=w,de[2*t+1]=A,de[2*r]=_,de[2*r+1]=T,de[2*n]=B,de[2*n+1]=P}i(Es,"G1b");function _s(e,t,r,n,o,s){let a=o[s],l=o[s+1],f=de[2*e],p=de[2*e+1],w=de[2*t],A=de[2*t+1],_=de[2*r],T=de[2*r+1],B=de[2*n],P=de[2*n+1],C=el(f,w,a);p=tl(C,p,A,l),f=C|0,{Dh:P,Dl:B}={Dh:P^p,Dl:B^f},{Dh:P,Dl:B}={Dh:Do(P,B,16),Dl:Vo(P,B,16)},{h:T,l:_}=an(T,_,P,B),{Bh:A,Bl:w}={Bh:A^T,Bl:w^_},{Bh:A,Bl:w}={Bh:ya(A,w,63),Bl:ba(A,w,63)},de[2*e]=f,de[2*e+1]=p,de[2*t]=w,de[2*t+1]=A,de[2*r]=_,de[2*r+1]=T,de[2*n]=B,de[2*n+1]=P}i(_s,"G2b");function bk(e,t={},r,n,o){if(Kc(r),e<0||e>r)throw new Error("outputLen bigger than keyLen");let{key:s,salt:a,personalization:l}=t;if(s!==void 0&&(s.length<1||s.length>r))throw new Error("key length must be undefined or 1.."+r);if(a!==void 0&&a.length!==n)throw new Error("salt must be undefined or "+n);if(l!==void 0&&l.length!==o)throw new Error("personalization must be undefined or "+o)}i(bk,"checkBlake2Opts");var ay=class extends As{static{i(this,"BLAKE2")}constructor(t,r){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,Kc(t),Kc(r),this.blockLen=t,this.outputLen=r,this.buffer=new Uint8Array(t),this.buffer32=Qu(this.buffer)}update(t){Ni(this),t=uo(t),Ui(t);let{blockLen:r,buffer:n,buffer32:o}=this,s=t.length,a=t.byteOffset,l=t.buffer;for(let f=0;f<s;){this.pos===r&&(ga(o),this.compress(o,0,!1),ga(o),this.pos=0);let p=Math.min(r-this.pos,s-f),w=a+f;if(p===r&&!(w%4)&&f+p<s){let A=new Uint32Array(l,w,Math.floor((s-f)/4));ga(A);for(let _=0;f+r<s;_+=o.length,f+=r)this.length+=r,this.compress(A,_,!1);ga(A);continue}n.set(t.subarray(f,f+p),this.pos),this.pos+=p,this.length+=p,f+=p}return this}digestInto(t){Ni(this),Jd(t,this);let{pos:r,buffer32:n}=this;this.finished=!0,co(this.buffer.subarray(r)),ga(n),this.compress(n,0,!0),ga(n);let o=Qu(t);this.get().forEach((s,a)=>o[a]=Lo(s))}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){let{buffer:r,length:n,finished:o,destroyed:s,outputLen:a,pos:l}=this;return t||(t=new this.constructor({dkLen:a})),t.set(...this.get()),t.buffer.set(r),t.destroyed=s,t.finished=o,t.length=n,t.pos=l,t.outputLen=a,t}clone(){return this._cloneInto()}},rh=class extends ay{static{i(this,"BLAKE2b")}constructor(t={}){let r=t.dkLen===void 0?64:t.dkLen;super(128,r),this.v0l=Qt[0]|0,this.v0h=Qt[1]|0,this.v1l=Qt[2]|0,this.v1h=Qt[3]|0,this.v2l=Qt[4]|0,this.v2h=Qt[5]|0,this.v3l=Qt[6]|0,this.v3h=Qt[7]|0,this.v4l=Qt[8]|0,this.v4h=Qt[9]|0,this.v5l=Qt[10]|0,this.v5h=Qt[11]|0,this.v6l=Qt[12]|0,this.v6h=Qt[13]|0,this.v7l=Qt[14]|0,this.v7h=Qt[15]|0,bk(r,t,64,16,16);let{key:n,personalization:o,salt:s}=t,a=0;if(n!==void 0&&(n=uo(n),a=n.length),this.v0l^=this.outputLen|a<<8|65536|1<<24,s!==void 0){s=uo(s);let l=Qu(s);this.v4l^=Lo(l[0]),this.v4h^=Lo(l[1]),this.v5l^=Lo(l[2]),this.v5h^=Lo(l[3])}if(o!==void 0){o=uo(o);let l=Qu(o);this.v6l^=Lo(l[0]),this.v6h^=Lo(l[1]),this.v7l^=Lo(l[2]),this.v7h^=Lo(l[3])}if(n!==void 0){let l=new Uint8Array(this.blockLen);l.set(n),this.update(l)}}get(){let{v0l:t,v0h:r,v1l:n,v1h:o,v2l:s,v2h:a,v3l:l,v3h:f,v4l:p,v4h:w,v5l:A,v5h:_,v6l:T,v6h:B,v7l:P,v7h:C}=this;return[t,r,n,o,s,a,l,f,p,w,A,_,T,B,P,C]}set(t,r,n,o,s,a,l,f,p,w,A,_,T,B,P,C){this.v0l=t|0,this.v0h=r|0,this.v1l=n|0,this.v1h=o|0,this.v2l=s|0,this.v2h=a|0,this.v3l=l|0,this.v3h=f|0,this.v4l=p|0,this.v4h=w|0,this.v5l=A|0,this.v5h=_|0,this.v6l=T|0,this.v6h=B|0,this.v7l=P|0,this.v7h=C|0}compress(t,r,n){this.get().forEach((f,p)=>de[p]=f),de.set(Qt,16);let{h:o,l:s}=oy(BigInt(this.length));de[24]=Qt[8]^s,de[25]=Qt[9]^o,n&&(de[28]=~de[28],de[29]=~de[29]);let a=0,l=zA;for(let f=0;f<12;f++)Es(0,4,8,12,t,r+2*l[a++]),_s(0,4,8,12,t,r+2*l[a++]),Es(1,5,9,13,t,r+2*l[a++]),_s(1,5,9,13,t,r+2*l[a++]),Es(2,6,10,14,t,r+2*l[a++]),_s(2,6,10,14,t,r+2*l[a++]),Es(3,7,11,15,t,r+2*l[a++]),_s(3,7,11,15,t,r+2*l[a++]),Es(0,5,10,15,t,r+2*l[a++]),_s(0,5,10,15,t,r+2*l[a++]),Es(1,6,11,12,t,r+2*l[a++]),_s(1,6,11,12,t,r+2*l[a++]),Es(2,7,8,13,t,r+2*l[a++]),_s(2,7,8,13,t,r+2*l[a++]),Es(3,4,9,14,t,r+2*l[a++]),_s(3,4,9,14,t,r+2*l[a++]);this.v0l^=de[0]^de[16],this.v0h^=de[1]^de[17],this.v1l^=de[2]^de[18],this.v1h^=de[3]^de[19],this.v2l^=de[4]^de[20],this.v2h^=de[5]^de[21],this.v3l^=de[6]^de[22],this.v3h^=de[7]^de[23],this.v4l^=de[8]^de[24],this.v4h^=de[9]^de[25],this.v5l^=de[10]^de[26],this.v5h^=de[11]^de[27],this.v6l^=de[12]^de[28],this.v6h^=de[13]^de[29],this.v7l^=de[14]^de[30],this.v7h^=de[15]^de[31],co(de)}destroy(){this.destroyed=!0,co(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},eE=jA(e=>new rh(e));var va=eE;var il=me(JI(),1);m();g();m();g();m();g();m();g();var Ms=32;function tE(e){return vk(e)&&wk(e)===Ms}i(tE,"isValidSuiAddress");function qo(e,t=!1){let r=e.toLowerCase();return!t&&r.startsWith("0x")&&(r=r.slice(2)),`0x${r.padStart(Ms*2,"0")}`}i(qo,"normalizeSuiAddress");function vk(e){return/^(0x|0X)?[a-fA-F0-9]+$/.test(e)&&e.length%2===0}i(vk,"isHex");function wk(e){return/^(0x|0X)/.test(e)?(e.length-2)/2:e.length/2}i(wk,"getHexByteLength");m();g();var xk=/^vector<(.+)>$/,Sk=/^([^:]+)::([^:]+)::([^<]+)(<(.+)>)?/,rl=class e{static{i(this,"TypeTagSerializer")}static parseFromStr(t,r=!1){if(t==="address")return{address:null};if(t==="bool")return{bool:null};if(t==="u8")return{u8:null};if(t==="u16")return{u16:null};if(t==="u32")return{u32:null};if(t==="u64")return{u64:null};if(t==="u128")return{u128:null};if(t==="u256")return{u256:null};if(t==="signer")return{signer:null};let n=t.match(xk);if(n)return{vector:e.parseFromStr(n[1],r)};let o=t.match(Sk);if(o)return{struct:{address:r?qo(o[1]):o[1],module:o[2],name:o[3],typeParams:o[5]===void 0?[]:e.parseStructTypeArgs(o[5],r)}};throw new Error(`Encountered unexpected token when parsing type args for ${t}`)}static parseStructTypeArgs(t,r=!1){return hw(t).map(n=>e.parseFromStr(n,r))}static tagToString(t){if("bool"in t)return"bool";if("u8"in t)return"u8";if("u16"in t)return"u16";if("u32"in t)return"u32";if("u64"in t)return"u64";if("u128"in t)return"u128";if("u256"in t)return"u256";if("address"in t)return"address";if("signer"in t)return"signer";if("vector"in t)return`vector<${e.tagToString(t.vector)}>`;if("struct"in t){let r=t.struct,n=r.typeParams.map(e.tagToString).join(", ");return`${r.address}::${r.module}::${r.name}${n?`<${n}>`:""}`}throw new Error("Invalid TypeTag")}};function Ak(e){return D.u64({name:"unsafe_u64",...e}).transform({input:i(t=>t,"input"),output:i(t=>Number(t),"output")})}i(Ak,"unsafe_u64");function Ek(e){return D.enum("Option",{None:null,Some:e})}i(Ek,"optionEnum");var Tt=D.bytes(Ms).transform({validate:i(e=>{let t=typeof e=="string"?e:zs(e);if(!t||!tE(qo(t)))throw new Error(`Invalid Sui address ${t}`)},"validate"),input:i(e=>typeof e=="string"?Ul(qo(e)):e,"input"),output:i(e=>qo(zs(e)),"output")}),cn=D.vector(D.u8()).transform({name:"ObjectDigest",input:i(e=>H0(e),"input"),output:i(e=>dw(new Uint8Array(e)),"output"),validate:i(e=>{if(H0(e).length!==32)throw new Error("ObjectDigest must be 32 bytes")},"validate")}),Yr=D.struct("SuiObjectRef",{objectId:Tt,version:D.u64(),digest:cn}),cy=D.struct("SharedObjectRef",{objectId:Tt,initialSharedVersion:D.u64(),mutable:D.bool()}),uy=D.enum("ObjectArg",{ImmOrOwnedObject:Yr,SharedObject:cy,Receiving:Yr}),ly=D.enum("CallArg",{Pure:D.struct("Pure",{bytes:D.vector(D.u8()).transform({input:i(e=>typeof e=="string"?jr(e):e,"input"),output:i(e=>tr(new Uint8Array(e)),"output")})}),Object:uy}),fy=D.enum("TypeTag",{bool:null,u8:null,u64:null,u128:null,address:null,signer:null,vector:D.lazy(()=>fy),struct:D.lazy(()=>yy),u16:null,u32:null,u256:null}),nh=fy.transform({input:i(e=>typeof e=="string"?rl.parseFromStr(e,!0):e,"input"),output:i(e=>rl.tagToString(e),"output")}),lo=D.enum("Argument",{GasCoin:null,Input:D.u16(),Result:D.u16(),NestedResult:D.tuple([D.u16(),D.u16()])}),dy=D.struct("ProgrammableMoveCall",{package:Tt,module:D.string(),function:D.string(),typeArguments:D.vector(nh),arguments:D.vector(lo)}),hy=D.enum("Command",{MoveCall:dy,TransferObjects:D.struct("TransferObjects",{objects:D.vector(lo),address:lo}),SplitCoins:D.struct("SplitCoins",{coin:lo,amounts:D.vector(lo)}),MergeCoins:D.struct("MergeCoins",{destination:lo,sources:D.vector(lo)}),Publish:D.struct("Publish",{modules:D.vector(D.vector(D.u8()).transform({input:i(e=>typeof e=="string"?jr(e):e,"input"),output:i(e=>tr(new Uint8Array(e)),"output")})),dependencies:D.vector(Tt)}),MakeMoveVec:D.struct("MakeMoveVec",{type:Ek(nh).transform({input:i(e=>e===null?{None:!0}:{Some:e},"input"),output:i(e=>e.Some??null,"output")}),elements:D.vector(lo)}),Upgrade:D.struct("Upgrade",{modules:D.vector(D.vector(D.u8()).transform({input:i(e=>typeof e=="string"?jr(e):e,"input"),output:i(e=>tr(new Uint8Array(e)),"output")})),dependencies:D.vector(Tt),package:Tt,ticket:lo})}),py=D.struct("ProgrammableTransaction",{inputs:D.vector(ly),commands:D.vector(hy)}),my=D.enum("TransactionKind",{ProgrammableTransaction:py,ChangeEpoch:null,Genesis:null,ConsensusCommitPrologue:null}),gy=D.enum("TransactionExpiration",{None:null,Epoch:Ak()}),yy=D.struct("StructTag",{address:Tt,module:D.string(),name:D.string(),typeParams:D.vector(fy)}),by=D.struct("GasData",{payment:D.vector(Yr),owner:Tt,price:D.u64(),budget:D.u64()}),vy=D.struct("TransactionDataV1",{kind:my,sender:Tt,gasData:by,expiration:gy}),wy=D.enum("TransactionData",{V1:vy}),xy=D.enum("IntentScope",{TransactionData:null,TransactionEffects:null,CheckpointSummary:null,PersonalMessage:null}),Sy=D.enum("IntentVersion",{V0:null}),Ay=D.enum("AppId",{Sui:null}),Ey=D.struct("Intent",{scope:xy,version:Sy,appId:Ay});function _y(e){return D.struct(`IntentMessage<${e.name}>`,{intent:Ey,value:e})}i(_y,"IntentMessage");var My=D.enum("CompressedSignature",{ED25519:D.fixedArray(64,D.u8()),Secp256k1:D.fixedArray(64,D.u8()),Secp256r1:D.fixedArray(64,D.u8()),ZkLogin:D.vector(D.u8())}),Iy=D.enum("PublicKey",{ED25519:D.fixedArray(32,D.u8()),Secp256k1:D.fixedArray(33,D.u8()),Secp256r1:D.fixedArray(33,D.u8()),ZkLogin:D.vector(D.u8())}),Ty=D.struct("MultiSigPkMap",{pubKey:Iy,weight:D.u8()}),By=D.struct("MultiSigPublicKey",{pk_map:D.vector(Ty),threshold:D.u16()}),rE=D.struct("MultiSig",{sigs:D.vector(My),bitmap:D.u16(),multisig_pk:By}),_k=D.vector(D.u8()).transform({input:i(e=>typeof e=="string"?jr(e):e,"input"),output:i(e=>tr(new Uint8Array(e)),"output")}),ky=D.struct("SenderSignedTransaction",{intentMessage:_y(wy),txSignatures:D.vector(_k)}),nE=D.vector(ky,{name:"SenderSignedData"});m();g();var Mk=D.enum("PackageUpgradeError",{UnableToFetchPackage:D.struct("UnableToFetchPackage",{packageId:Tt}),NotAPackage:D.struct("NotAPackage",{objectId:Tt}),IncompatibleUpgrade:null,DigestDoesNotMatch:D.struct("DigestDoesNotMatch",{digest:D.vector(D.u8())}),UnknownUpgradePolicy:D.struct("UnknownUpgradePolicy",{policy:D.u8()}),PackageIDDoesNotMatch:D.struct("PackageIDDoesNotMatch",{packageId:Tt,ticketId:Tt})}),Ik=D.struct("ModuleId",{address:Tt,name:D.string()}),oE=D.struct("MoveLocation",{module:Ik,function:D.u16(),instruction:D.u16(),functionName:D.option(D.string())}),Tk=D.enum("CommandArgumentError",{TypeMismatch:null,InvalidBCSBytes:null,InvalidUsageOfPureArg:null,InvalidArgumentToPrivateEntryFunction:null,IndexOutOfBounds:D.struct("IndexOutOfBounds",{idx:D.u16()}),SecondaryIndexOutOfBounds:D.struct("SecondaryIndexOutOfBounds",{resultIdx:D.u16(),secondaryIdx:D.u16()}),InvalidResultArity:D.struct("InvalidResultArity",{resultIdx:D.u16()}),InvalidGasCoinUsage:null,InvalidValueUsage:null,InvalidObjectByValue:null,InvalidObjectByMutRef:null,SharedObjectOperationNotAllowed:null}),Bk=D.enum("TypeArgumentError",{TypeNotFound:null,ConstraintNotSatisfied:null}),kk=D.enum("ExecutionFailureStatus",{InsufficientGas:null,InvalidGasObject:null,InvariantViolation:null,FeatureNotYetSupported:null,MoveObjectTooBig:D.struct("MoveObjectTooBig",{objectSize:D.u64(),maxObjectSize:D.u64()}),MovePackageTooBig:D.struct("MovePackageTooBig",{objectSize:D.u64(),maxObjectSize:D.u64()}),CircularObjectOwnership:D.struct("CircularObjectOwnership",{object:Tt}),InsufficientCoinBalance:null,CoinBalanceOverflow:null,PublishErrorNonZeroAddress:null,SuiMoveVerificationError:null,MovePrimitiveRuntimeError:D.option(oE),MoveAbort:D.tuple([oE,D.u64()]),VMVerificationOrDeserializationError:null,VMInvariantViolation:null,FunctionNotFound:null,ArityMismatch:null,TypeArityMismatch:null,NonEntryFunctionInvoked:null,CommandArgumentError:D.struct("CommandArgumentError",{argIdx:D.u16(),kind:Tk}),TypeArgumentError:D.struct("TypeArgumentError",{argumentIdx:D.u16(),kind:Bk}),UnusedValueWithoutDrop:D.struct("UnusedValueWithoutDrop",{resultIdx:D.u16(),secondaryIdx:D.u16()}),InvalidPublicFunctionReturnType:D.struct("InvalidPublicFunctionReturnType",{idx:D.u16()}),InvalidTransferObject:null,EffectsTooLarge:D.struct("EffectsTooLarge",{currentSize:D.u64(),maxSize:D.u64()}),PublishUpgradeMissingDependency:null,PublishUpgradeDependencyDowngrade:null,PackageUpgradeError:D.struct("PackageUpgradeError",{upgradeError:Mk}),WrittenObjectsTooLarge:D.struct("WrittenObjectsTooLarge",{currentSize:D.u64(),maxSize:D.u64()}),CertificateDenied:null,SuiMoveVerificationTimedout:null,SharedObjectOperationNotAllowed:null,InputObjectDeleted:null,ExecutionCancelledDueToSharedObjectCongestion:D.struct("ExecutionCancelledDueToSharedObjectCongestion",{congestedObjects:D.vector(Tt)}),AddressDeniedForCoin:D.struct("AddressDeniedForCoin",{address:Tt,coinType:D.string()}),CoinTypeGlobalPause:D.struct("CoinTypeGlobalPause",{coinType:D.string()}),ExecutionCancelledDueToRandomnessUnavailable:null}),iE=D.enum("ExecutionStatus",{Success:null,Failed:D.struct("ExecutionFailed",{error:kk,command:D.option(D.u64())})}),sE=D.struct("GasCostSummary",{computationCost:D.u64(),storageCost:D.u64(),storageRebate:D.u64(),nonRefundableStorageFee:D.u64()}),Rc=D.enum("Owner",{AddressOwner:Tt,ObjectOwner:Tt,Shared:D.struct("Shared",{initialSharedVersion:D.u64()}),Immutable:null}),Pk=D.struct("TransactionEffectsV1",{status:iE,executedEpoch:D.u64(),gasUsed:sE,modifiedAtVersions:D.vector(D.tuple([Tt,D.u64()])),sharedObjects:D.vector(Yr),transactionDigest:cn,created:D.vector(D.tuple([Yr,Rc])),mutated:D.vector(D.tuple([Yr,Rc])),unwrapped:D.vector(D.tuple([Yr,Rc])),deleted:D.vector(Yr),unwrappedThenDeleted:D.vector(Yr),wrapped:D.vector(Yr),gasObject:D.tuple([Yr,Rc]),eventsDigest:D.option(cn),dependencies:D.vector(cn)}),Py=D.tuple([D.u64(),cn]),Ck=D.enum("ObjectIn",{NotExist:null,Exist:D.tuple([Py,Rc])}),Ok=D.enum("ObjectOut",{NotExist:null,ObjectWrite:D.tuple([cn,Rc]),PackageWrite:Py}),Kk=D.enum("IDOperation",{None:null,Created:null,Deleted:null}),Rk=D.struct("EffectsObjectChange",{inputState:Ck,outputState:Ok,idOperation:Kk}),Uk=D.enum("UnchangedSharedKind",{ReadOnlyRoot:Py,MutateDeleted:D.u64(),ReadDeleted:D.u64(),Cancelled:D.u64(),PerEpochConfig:null}),Nk=D.struct("TransactionEffectsV2",{status:iE,executedEpoch:D.u64(),gasUsed:sE,transactionDigest:cn,gasObjectIndex:D.option(D.u32()),eventsDigest:D.option(cn),dependencies:D.vector(cn),lamportVersion:D.u64(),changedObjects:D.vector(D.tuple([Tt,Rk])),unchangedSharedObjects:D.vector(D.tuple([Tt,Uk])),auxDataDigest:D.option(cn)}),aE=D.enum("TransactionEffects",{V1:Pk,V2:Nk});var Li={...D,U8:D.u8(),U16:D.u16(),U32:D.u32(),U64:D.u64(),U128:D.u128(),U256:D.u256(),ULEB128:D.uleb128(),Bool:D.bool(),String:D.string(),Address:Tt,AppId:Ay,Argument:lo,CallArg:ly,CompressedSignature:My,GasData:by,Intent:Ey,IntentMessage:_y,IntentScope:xy,IntentVersion:Sy,MultiSig:rE,MultiSigPkMap:Ty,MultiSigPublicKey:By,ObjectArg:uy,ObjectDigest:cn,ProgrammableMoveCall:dy,ProgrammableTransaction:py,PublicKey:Iy,SenderSignedData:nE,SenderSignedTransaction:ky,SharedObjectRef:cy,StructTag:yy,SuiObjectRef:Yr,Command:hy,TransactionData:wy,TransactionDataV1:vy,TransactionExpiration:gy,TransactionKind:my,TypeTag:nh,TransactionEffects:aE};function oh(e,t){return Li.IntentMessage(Li.fixedArray(t.length,Li.u8())).serialize({intent:{scope:{[e]:!0},version:{V0:!0},appId:{Sui:!0}},value:t}).toBytes()}i(oh,"messageWithIntent");m();g();var Di={ED25519:0,Secp256k1:1,Secp256r1:2,MultiSig:3,ZkLogin:5},cE={ED25519:32,Secp256k1:33,Secp256r1:33},ih={0:"ED25519",1:"Secp256k1",2:"Secp256r1",3:"MultiSig",5:"ZkLogin"};m();g();m();g();m();g();function Cy(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}i(Cy,"bytesEqual");var Uc=class{static{i(this,"PublicKey")}equals(t){return Cy(this.toRawBytes(),t.toRawBytes())}toBase64(){return tr(this.toRawBytes())}toString(){throw new Error("`toString` is not implemented on public keys. Use `toBase64()` or `toRawBytes()` instead.")}toSuiPublicKey(){let t=this.toSuiBytes();return tr(t)}verifyWithIntent(t,r,n){let o=oh(n,t),s=va(o,{dkLen:32});return this.verify(s,r)}verifyPersonalMessage(t,r){return this.verifyWithIntent(Li.vector(Li.u8()).serialize(t).toBytes(),r,"PersonalMessage")}verifyTransaction(t,r){return this.verifyWithIntent(t,r,"TransactionData")}toSuiBytes(){let t=this.toRawBytes(),r=new Uint8Array(t.length+1);return r.set([this.flag()]),r.set(t,1),r}toSuiAddress(){return qo(Qd(va(this.toSuiBytes(),{dkLen:32})).slice(0,Ms*2))}};m();g();var uE=i(e=>{throw TypeError(e)},"__typeError"),lE=i((e,t,r)=>t.has(e)||uE("Cannot "+r),"__accessCheck"),sh=i((e,t,r)=>(lE(e,t,"read from private field"),r?r.call(e):t.get(e)),"__privateGet"),ah=i((e,t,r)=>t.has(e)?uE("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),"__privateAdd"),ch=i((e,t,r,n)=>(lE(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),"__privateSet"),uh,lh,fh,dh,Oy=class extends Error{static{i(this,"SuiGraphQLRequestError")}},hh=class{static{i(this,"SuiGraphQLClient")}constructor({url:t,fetch:r=fetch,headers:n={},queries:o={}}){ah(this,uh),ah(this,lh),ah(this,fh),ah(this,dh),ch(this,uh,t),ch(this,lh,o),ch(this,fh,n),ch(this,dh,(...s)=>r(...s))}async query(t){let r=await sh(this,dh).call(this,sh(this,uh),{method:"POST",headers:{"Content-Type":"application/json",...sh(this,fh)},body:JSON.stringify({query:typeof t.query=="string"?String(t.query):pw(t.query),variables:t.variables,extensions:t.extensions,operationName:t.operationName})});if(!r.ok)throw new Oy(`GraphQL request failed: ${r.statusText} (${r.status})`);return await r.json()}async execute(t,r){return this.query({...r,query:sh(this,lh)[t]})}};uh=new WeakMap;lh=new WeakMap;fh=new WeakMap;dh=new WeakMap;m();g();var fE=mw();m();g();function Lk(e){if(e.length!==1)throw new Error("Invalid base64Url character: "+e);let r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".indexOf(e);if(r===-1)throw new Error("Invalid base64Url character: "+e);let n=r.toString(2).padStart(6,"0");return Array.from(n).map(Number)}i(Lk,"base64UrlCharTo6Bits");function Dk(e){let t=[];for(let r=0;r<e.length;r++){let n=e.charAt(r),o=Lk(n);t=t.concat(o)}return t}i(Dk,"base64UrlStringToBitVector");function Vk(e,t){if(e.length<2)throw new Error(`Input (s = ${e}) is not tightly packed because s.length < 2`);let r=Dk(e),n=t%4;if(n!==0)if(n===1)r=r.slice(2);else if(n===2)r=r.slice(4);else throw new Error(`Input (s = ${e}) is not tightly packed because i%4 = 3 (i = ${t}))`);let o=(t+e.length-1)%4;if(o!==3)if(o===2)r=r.slice(0,r.length-2);else if(o===1)r=r.slice(0,r.length-4);else throw new Error(`Input (s = ${e}) is not tightly packed because (i + s.length - 1)%4 = 0 (i = ${t}))`);if(r.length%8!==0)throw new Error("We should never reach here...");let s=new Uint8Array(Math.floor(r.length/8)),a=0;for(let l=0;l<r.length;l+=8){let f=r.slice(l,l+8),p=parseInt(f.join(""),2);s[a++]=p}return new TextDecoder().decode(s)}i(Vk,"decodeBase64URL");function qk(e){if(!(e.slice(-1)==="}"||e.slice(-1)===","))throw new Error("Invalid claim");let t=JSON.parse("{"+e.slice(0,-1)+"}");if(Object.keys(t).length!==1)throw new Error("Invalid claim");let r=Object.keys(t)[0];return[r,t[r]]}i(qk,"verifyExtendedClaim");function dE(e,t){let r=Vk(e.value,e.indexMod4),[n,o]=qk(r);if(n!==t)throw new Error(`Invalid field name: found ${n} expected ${t}`);return o}i(dE,"extractClaimValue");m();g();m();g();var hE=D.struct("ZkLoginSignature",{inputs:D.struct("ZkLoginSignatureInputs",{proofPoints:D.struct("ZkLoginSignatureInputsProofPoints",{a:D.vector(D.string()),b:D.vector(D.vector(D.string())),c:D.vector(D.string())}),issBase64Details:D.struct("ZkLoginSignatureInputsClaim",{value:D.string(),indexMod4:D.u8()}),headerBase64:D.string(),addressSeed:D.string()}),maxEpoch:D.u64(),userSignature:D.vector(D.u8())});function pE(e){return hE.parse(typeof e=="string"?jr(e):e)}i(pE,"parseZkLoginSignature");m();g();function Hk(e){for(let t=0;t<e.length;t++)if(e[t]!==0)return t;return-1}i(Hk,"findFirstNonZeroIndex");function ph(e,t){let r=e.toString(16);return qA(r.padStart(t*2,"0").slice(-t*2))}i(ph,"toPaddedBigEndianBytes");function Ky(e,t){let r=ph(e,t),n=Hk(r);return n===-1?new Uint8Array([0]):r.slice(n)}i(Ky,"toBigEndianBytes");var yE=i(e=>{throw TypeError(e)},"__typeError"),bE=i((e,t,r)=>t.has(e)||yE("Cannot "+r),"__accessCheck"),Vi=i((e,t,r)=>(bE(e,t,"read from private field"),r?r.call(e):t.get(e)),"__privateGet"),Ry=i((e,t,r)=>t.has(e)?yE("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),"__privateAdd"),Nc=i((e,t,r,n)=>(bE(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),"__privateSet"),fo,nl,ol,jk=class Uy extends Uc{static{i(this,"_ZkLoginPublicIdentifier")}constructor(t,{client:r}={}){super(),Ry(this,fo),Ry(this,nl),Ry(this,ol),Nc(this,nl,r),typeof t=="string"?Nc(this,fo,jr(t)):t instanceof Uint8Array?Nc(this,fo,t):Nc(this,fo,Uint8Array.from(t)),Nc(this,ol,Vi(this,fo).length!==Vi(this,fo)[0]+1+32),Vi(this,ol)&&Nc(this,fo,mE(Vi(this,fo)))}equals(t){return super.equals(t)}toSuiAddress(){if(Vi(this,ol)){let t=mE(Vi(this,fo),!0),r=new Uint8Array(t.length+1);return r[0]=this.flag(),r.set(t,1),qo(Qd(va(r,{dkLen:32})).slice(0,Ms*2))}return super.toSuiAddress()}toRawBytes(){return Vi(this,fo)}flag(){return Di.ZkLogin}async verify(t,r){throw Error("does not support")}verifyPersonalMessage(t,r){let n=mh(r),o=new Uy(n.publicKey).toSuiAddress();return gE({address:o,bytes:tr(t),signature:n.serializedSignature,intentScope:"PERSONAL_MESSAGE",client:Vi(this,nl)})}verifyTransaction(t,r){let n=mh(r),o=new Uy(n.publicKey).toSuiAddress();return gE({address:o,bytes:tr(t),signature:n.serializedSignature,intentScope:"TRANSACTION_DATA",client:Vi(this,nl)})}};fo=new WeakMap;nl=new WeakMap;ol=new WeakMap;var zk=jk;function Fk(e,t,r){let n=r?.legacyAddress?Ky(e,32):ph(e,32),o=new TextEncoder().encode(t),s=new Uint8Array(1+o.length+n.length);return s.set([o.length],0),s.set(o,1),s.set(n,1+o.length),new zk(s,r)}i(Fk,"toZkLoginPublicIdentifier");var Wk=fE(`
	query Zklogin(
		$bytes: Base64!
		$signature: Base64!
		$intentScope: ZkLoginIntentScope!
		$author: SuiAddress!
	) {
		verifyZkloginSignature(
			bytes: $bytes
			signature: $signature
			intentScope: $intentScope
			author: $author
		) {
			success
			errors
		}
	}
`);function mE(e,t=!1){let r=e[0]+1,n=BigInt(`0x${zs(e.slice(r))}`),o=t?Ky(n,32):ph(n,32),s=new Uint8Array(r+o.length);return s.set(e.slice(0,r),0),s.set(o,r),s}i(mE,"normalizeZkLoginPublicKeyBytes");async function gE({address:e,bytes:t,signature:r,intentScope:n,client:o=new hh({url:"https://sui-mainnet.mystenlabs.com/graphql"})}){let s=await o.query({query:Wk,variables:{bytes:t,signature:r,intentScope:n,author:e}});return s.data?.verifyZkloginSignature.success===!0&&s.data?.verifyZkloginSignature.errors.length===0}i(gE,"graphqlVerifyZkLoginSignature");function mh(e){let t=typeof e=="string"?jr(e):e;if(t[0]!==Di.ZkLogin)throw new Error("Invalid signature scheme");let r=t.slice(1),{inputs:n,maxEpoch:o,userSignature:s}=pE(r),{issBase64Details:a,addressSeed:l}=n,f=dE(a,"iss"),p=Fk(BigInt(l),f);return{serializedSignature:tr(t),signatureScheme:"ZkLogin",zkLogin:{inputs:n,maxEpoch:o,userSignature:s,iss:f,addressSeed:BigInt(l)},signature:t,publicKey:p.toRawBytes()}}i(mh,"parseSerializedZkLoginSignature");function vE({signature:e,signatureScheme:t,publicKey:r}){if(!r)throw new Error("`publicKey` is required");let n=r.toRawBytes(),o=new Uint8Array(1+e.length+n.length);return o.set([Di[t]]),o.set(e,1),o.set(n,1+e.length),tr(o)}i(vE,"toSerializedSignature");function wE(e){let t=jr(e),r=ih[t[0]];switch(r){case"MultiSig":let n=Li.MultiSig.parse(t.slice(1));return{serializedSignature:e,signatureScheme:r,multisig:n,bytes:t};case"ZkLogin":return mh(e);case"ED25519":case"Secp256k1":case"Secp256r1":let o=cE[r],s=t.slice(1,t.length-o),a=t.slice(1+s.length);return{serializedSignature:e,signatureScheme:r,signature:s,publicKey:a,bytes:t};default:throw new Error("Unsupported signature scheme")}}i(wE,"parseSerializedSignature");var sl=32;var xE="suiprivkey",Ny=class{static{i(this,"Signer")}async signWithIntent(t,r){let n=oh(r,t),o=va(n,{dkLen:32});return{signature:vE({signature:await this.sign(o),signatureScheme:this.getKeyScheme(),publicKey:this.getPublicKey()}),bytes:tr(t)}}async signTransaction(t){return this.signWithIntent(t,"TransactionData")}async signPersonalMessage(t){let{signature:r}=await this.signWithIntent(D.vector(D.u8()).serialize(t).toBytes(),"PersonalMessage");return{bytes:tr(t),signature:r}}toSuiAddress(){return this.getPublicKey().toSuiAddress()}},gh=class extends Ny{static{i(this,"Keypair")}};function SE(e){let{prefix:t,words:r}=il.bech32.decode(e);if(t!==xE)throw new Error("invalid private key prefix");let n=new Uint8Array(il.bech32.fromWords(r)),o=n.slice(1);return{schema:ih[n[0]],secretKey:o}}i(SE,"decodeSuiPrivateKey");function AE(e,t){if(e.length!==sl)throw new Error("Invalid bytes length");let r=Di[t],n=new Uint8Array(e.length+1);return n.set([r]),n.set(e,1),il.bech32.encode(xE,il.bech32.toWords(n))}i(AE,"encodeSuiPrivateKey");m();g();function Ly(e){return!!new RegExp("^m\\/44'\\/784'\\/[0-9]+'\\/[0-9]+'\\/[0-9]+'+$").test(e)}i(Ly,"isValidHardenedPath");function $k(e){return gw(e,"")}i($k,"mnemonicToSeed");function EE(e){return zs($k(e))}i(EE,"mnemonicToSeedHex");m();g();m();g();var yh=class extends As{static{i(this,"HMAC")}constructor(t,r){super(),this.finished=!1,this.destroyed=!1,NA(t);let n=uo(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,s=new Uint8Array(o);s.set(n.length>o?t.create().update(n).digest():n);for(let a=0;a<s.length;a++)s[a]^=54;this.iHash.update(s),this.oHash=t.create();for(let a=0;a<s.length;a++)s[a]^=106;this.oHash.update(s),co(s)}update(t){return Ni(this),this.iHash.update(t),this}digestInto(t){Ni(this),Ui(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:o,destroyed:s,blockLen:a,outputLen:l}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=a,t.outputLen=l,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},bh=i((e,t,r)=>new yh(e,t).update(r).digest(),"hmac");bh.create=(e,t)=>new yh(e,t);m();g();m();g();var _E=WA(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),Gk=_E[0],Zk=_E[1],Is=new Uint32Array(80),Ts=new Uint32Array(80),vh=class extends eh{static{i(this,"SHA512")}constructor(t=64){super(128,t,16,!1),this.Ah=pr[0]|0,this.Al=pr[1]|0,this.Bh=pr[2]|0,this.Bl=pr[3]|0,this.Ch=pr[4]|0,this.Cl=pr[5]|0,this.Dh=pr[6]|0,this.Dl=pr[7]|0,this.Eh=pr[8]|0,this.El=pr[9]|0,this.Fh=pr[10]|0,this.Fl=pr[11]|0,this.Gh=pr[12]|0,this.Gl=pr[13]|0,this.Hh=pr[14]|0,this.Hl=pr[15]|0}get(){let{Ah:t,Al:r,Bh:n,Bl:o,Ch:s,Cl:a,Dh:l,Dl:f,Eh:p,El:w,Fh:A,Fl:_,Gh:T,Gl:B,Hh:P,Hl:C}=this;return[t,r,n,o,s,a,l,f,p,w,A,_,T,B,P,C]}set(t,r,n,o,s,a,l,f,p,w,A,_,T,B,P,C){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=o|0,this.Ch=s|0,this.Cl=a|0,this.Dh=l|0,this.Dl=f|0,this.Eh=p|0,this.El=w|0,this.Fh=A|0,this.Fl=_|0,this.Gh=T|0,this.Gl=B|0,this.Hh=P|0,this.Hl=C|0}process(t,r){for(let R=0;R<16;R++,r+=4)Is[R]=t.getUint32(r),Ts[R]=t.getUint32(r+=4);for(let R=16;R<80;R++){let j=Is[R-15]|0,Z=Ts[R-15]|0,X=Do(j,Z,1)^Do(j,Z,8)^iy(j,Z,7),Q=Vo(j,Z,1)^Vo(j,Z,8)^sy(j,Z,7),z=Is[R-2]|0,H=Ts[R-2]|0,E=Do(z,H,19)^ya(z,H,61)^iy(z,H,6),c=Vo(z,H,19)^ba(z,H,61)^sy(z,H,6),d=ZA(Q,c,Ts[R-7],Ts[R-16]),h=YA(d,X,E,Is[R-7],Is[R-16]);Is[R]=h|0,Ts[R]=d|0}let{Ah:n,Al:o,Bh:s,Bl:a,Ch:l,Cl:f,Dh:p,Dl:w,Eh:A,El:_,Fh:T,Fl:B,Gh:P,Gl:C,Hh:O,Hl:L}=this;for(let R=0;R<80;R++){let j=Do(A,_,14)^Do(A,_,18)^ya(A,_,41),Z=Vo(A,_,14)^Vo(A,_,18)^ba(A,_,41),X=A&T^~A&P,Q=_&B^~_&C,z=JA(L,Z,Q,Zk[R],Ts[R]),H=XA(z,O,j,X,Gk[R],Is[R]),E=z|0,c=Do(n,o,28)^ya(n,o,34)^ya(n,o,39),d=Vo(n,o,28)^ba(n,o,34)^ba(n,o,39),h=n&s^n&l^s&l,y=o&a^o&f^a&f;O=P|0,L=C|0,P=T|0,C=B|0,T=A|0,B=_|0,{h:A,l:_}=an(p|0,w|0,H|0,E|0),p=l|0,w=f|0,l=s|0,f=a|0,s=n|0,a=o|0;let b=el(E,d,y);n=tl(b,H,c,h),o=b|0}({h:n,l:o}=an(this.Ah|0,this.Al|0,n|0,o|0)),{h:s,l:a}=an(this.Bh|0,this.Bl|0,s|0,a|0),{h:l,l:f}=an(this.Ch|0,this.Cl|0,l|0,f|0),{h:p,l:w}=an(this.Dh|0,this.Dl|0,p|0,w|0),{h:A,l:_}=an(this.Eh|0,this.El|0,A|0,_|0),{h:T,l:B}=an(this.Fh|0,this.Fl|0,T|0,B|0),{h:P,l:C}=an(this.Gh|0,this.Gl|0,P|0,C|0),{h:O,l:L}=an(this.Hh|0,this.Hl|0,O|0,L|0),this.set(n,o,s,a,l,f,p,w,A,_,T,B,P,C,O,L)}roundClean(){co(Is,Ts)}destroy(){co(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var ME=HA(()=>new vh);var Dy=ME;var Yk=me(es(),1);var Jk="ed25519 seed",Xk=2147483648,Qk=new RegExp("^m(\\/[0-9]+')+$"),IE=i(e=>e.replace("'",""),"replaceDerive"),eP=i(e=>{let r=bh.create(Dy,Jk).update(Ul(e)).digest(),n=r.slice(0,32),o=r.slice(32);return{key:n,chainCode:o}},"getMasterKeyFromSeed"),tP=i(({key:e,chainCode:t},r)=>{let n=new ArrayBuffer(4);new DataView(n).setUint32(0,r);let s=new Uint8Array(1+e.length+n.byteLength);s.set(new Uint8Array(1).fill(0)),s.set(e,1),s.set(new Uint8Array(n,0,n.byteLength),e.length+1);let a=bh.create(Dy,t).update(s).digest(),l=a.slice(0,32),f=a.slice(32);return{key:l,chainCode:f}},"CKDPriv");var rP=i(e=>Qk.test(e)?!e.split("/").slice(1).map(IE).some(isNaN):!1,"isValidPath"),Vy=i((e,t,r=Xk)=>{if(!rP(e))throw new Error("Invalid derivation path");let{key:n,chainCode:o}=eP(t);return e.split("/").slice(1).map(IE).map(a=>parseInt(a,10)).reduce((a,l)=>tP(a,l+r),{key:n,chainCode:o})},"derivePath");m();g();var TE=me(es(),1);var qy=32,al=class extends Uc{static{i(this,"Ed25519PublicKey")}constructor(t){if(super(),typeof t=="string"?this.data=jr(t):t instanceof Uint8Array?this.data=t:this.data=Uint8Array.from(t),this.data.length!==qy)throw new Error(`Invalid public key input. Expected ${qy} bytes, got ${this.data.length}`)}equals(t){return super.equals(t)}toRawBytes(){return this.data}flag(){return Di.ED25519}async verify(t,r){let n;if(typeof r=="string"){let o=wE(r);if(o.signatureScheme!=="ED25519")throw new Error("Invalid signature scheme");if(!Cy(this.toRawBytes(),o.publicKey))throw new Error("Signature does not match public key");n=o.signature}else n=r;return TE.default.sign.detached.verify(t,n,this.toRawBytes())}};al.SIZE=qy;var Hy="m/44'/784'/0'/0'/0'",cl=class e extends gh{static{i(this,"Ed25519Keypair")}constructor(t){super(),t?this.keypair=t:this.keypair=wa.default.sign.keyPair()}getKeyScheme(){return"ED25519"}static generate(){return new e(wa.default.sign.keyPair())}static fromSecretKey(t,r){if(typeof t=="string"){let s=SE(t);if(s.schema!=="ED25519")throw new Error(`Expected a ED25519 keypair, got ${s.schema}`);return this.fromSecretKey(s.secretKey,r)}let n=t.length;if(n!==sl)throw new Error(`Wrong secretKey size. Expected ${sl} bytes, got ${n}.`);let o=wa.default.sign.keyPair.fromSeed(t);if(!r||!r.skipValidation){let a=new TextEncoder().encode("sui validation"),l=wa.default.sign.detached(a,o.secretKey);if(!wa.default.sign.detached.verify(a,l,o.publicKey))throw new Error("provided secretKey is invalid")}return new e(o)}getPublicKey(){return new al(this.keypair.publicKey)}getSecretKey(){return AE(this.keypair.secretKey.slice(0,sl),this.getKeyScheme())}async sign(t){return wa.default.sign.detached(t,this.keypair.secretKey)}static deriveKeypair(t,r){if(r==null&&(r=Hy),!Ly(r))throw new Error("Invalid derivation path");let{key:n}=Vy(r,EE(t));return e.fromSecretKey(n)}static deriveKeypairFromSeed(t,r){if(r==null&&(r=Hy),!Ly(r))throw new Error("Invalid derivation path");let{key:n}=Vy(r,t);return e.fromSecretKey(n)}};var BE=i(()=>({type:$t.KeyPair,sign:i(async(e,t)=>{let r=cl.fromSecretKey(e.privateKey);try{let n;switch(t.signingType){case"personalMessage":{n=await r.signPersonalMessage(t.message);break}case"transaction":{n=await r.signTransaction(t.transaction);break}}return Promise.resolve({status:"success",signature:n.signature})}catch(n){return console.error(n),Promise.resolve(Me(he.InvalidMessageEncoding))}},"sign")}),"createSuiKeyPairSigner");m();g();var wh=class{static{i(this,"MultiChainVaultSigner")}#e;constructor(t){this.#e=t}async signWithKeypair(t,r){if("isJWT"in r)return this.#e.keyPair.JWT.sign(t,r);if("isKMSPKIAuthenticator"in r)return this.#e.keyPair.KMSPKIAuthenticator.sign(t,r);if("isCash"in r)return this.#e.keyPair.Cash.sign(t,r);let n=r.chainType;switch(n){case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:return this.#e.keyPair[n].sign(t,r);case K.EVM:return this.#e.keyPair[n].sign(t,r);case K.Solana:return this.#e.keyPair[n].sign(t,r);case K.Sui:return this.#e.keyPair[n].sign(t,r)}}async signWithHardware(t,r,n){return this.#e.ledger.sign(t,r,n)}async signWithSolanaSeedVault(t,r,n){return this.#e.seedVault.sign(t,r,n)}async signWithKMS(t,r,n){return this.#e.kms.sign(t,r,n)}};m();g();var kE=i(e=>Eg.safeParse(e).success,"isVaultSignerParams");async function xh(e,t,r){let n=t.chains[r]?.pathType;if(!n)return Me(he.InvalidAddressType,`Seed Account does not contain a chain address for the chain type ${r}.`);let o=await Wt(e,t.seedIdentifier);return e.keypairGenerator.generateKeypairFromSeed(o,t.derivationIndex,n)}i(xh,"deriveKeyPairFromAddressType");async function PE(e,t,r){let n=await yt(),o=n.find(s=>s.identifier===t);if(!o)return Me(he.InvalidAccountId,`Vault (${n.length} account(s) found) does not contain an account for the given identifier: ${t}`);if("isJWT"in r)switch(o.type){case U.Seedless:case U.Seed:case U.PrivateKey:{let s=await gs(e,o);return e.vaultSigner.signWithKeypair(s,r)}default:return Me(he.UnsupportedOperation,"Invalid signingAccount type provided for paramType")}if("isKMSPKIAuthenticator"in r)return Me(he.UnsupportedOperation,"Signing with the KMS PKI authenticator key is not supported through the external vault interface, as this key is reserved for internal authentication purposes.");if("isCash"in r){if("isCashKMS"in r){let a=Uu(e,`cash:${r.cashAccountAddress}`),l=await L2(a);return e.vaultSigner.signWithKMS(a,{organizationId:l.organizationId,walletId:l.walletId,derivationPath:l.account.derivationPath},r.data)}let s=await D2(e);return e.vaultSigner.signWithKeypair(s,r)}switch(o.type){case U.KMSVault:{await Nu(e,o.kms.walletId,o.kms.tag);let s=o.chains[r.chainType],a=Uu(e,wn(o.kms.walletId,o.kms.tag)),{organizationId:l,walletId:f}=o.kms;if(!s)return Me(he.InvalidAddressType,`KMSVault account does not have a derivation path for chain type ${r.chainType}`);let p=vi({pathType:s.pathType,index:o.derivationIndex});return e.vaultSigner.signWithKMS(a,{organizationId:l,walletId:f,derivationPath:p},r)}case U.Seedless:case U.Seed:{switch(r.chainType){case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:{let{enabledAddressTypes:s}=await e.fetchChainAvailability(),a={},l=Object.keys(o.chains).filter(f=>pu.safeParse(f).success).filter(f=>s.includes(f));for(let f of l){let p=await xh(e,o,f);if("status"in p&&p.status==="error")return p;a[f]=p}return e.vaultSigner.signWithKeypair(a,r)}case K.EVM:{let s=await xh(e,o,r.chainType);return"status"in s&&s.status==="error"?s:e.vaultSigner.signWithKeypair(s,r)}case K.Solana:{let s=await xh(e,o,r.chainType);return"status"in s&&s.status==="error"?s:e.vaultSigner.signWithKeypair(s,r)}case K.Sui:{let s=await xh(e,o,r.chainType);return"status"in s&&s.status==="error"?s:e.vaultSigner.signWithKeypair(s,r)}}break}case U.PrivateKey:{let s=await Mo(e,o.privateKeyIdentifier);if(s.chainType!==r.chainType)return Me(he.InvalidAddressType,`Private Key account from accountID is a different chain type from params. Expected ${s.chainType}, got ${r.chainType}`);let a=e.keypairGenerator.generateKeypairFromPrivateKey(wo.from(s.privateKey),r.chainType);switch(r.chainType){case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:return e.vaultSigner.signWithKeypair({[r.chainType]:a},r);case K.EVM:return e.vaultSigner.signWithKeypair(a,r);case K.Solana:return e.vaultSigner.signWithKeypair(a,r);case K.Sui:return e.vaultSigner.signWithKeypair(a,r)}break}case U.Ledger:{let s=o.chains[r.chainType];if(!s)return Me(he.InvalidAddressType,`Ledger Account does not contain a chain address for the chain type ${r.chainType}.`);let a=cw.safeParse({pathType:s.pathType,index:o.derivationIndex});if(!a.success)return Me(he.InvalidDerivationPath,"Unsupported Derivation Path. Ledger account derivation path type is incompatible with ChainType in signing params.");let l=vi(a.data);return e.vaultSigner.signWithHardware(t,l,r)}case U.SeedVault:{let{authToken:s,derivationPath:a,chainType:l}=o;return l!==r.chainType?Me(he.InvalidAddressType,`Solana Seed Vault account from accountID is a different chain type from params. Expected ${l}, got ${r.chainType}`):e.vaultSigner.signWithSolanaSeedVault(s,a,r)}case U.ReadOnly:return Me(he.UnsupportedOperation,"Read Only Accounts cannot sign transactions.");default:(s=>{throw new Error("invalid account type")})(o)}}i(PE,"sign");m();g();function CE(e){return e.find(t=>t.type===U.Seedless)??e.find(t=>t.type===U.Seed)??e.find(t=>t.type===U.PrivateKey)}i(CE,"selectKMSAuthenticatorSourceAccount");var Ho=ut(function*(){return(yield yt()).map(Pd)}),Sh=xd,Ah=fc;function nP(e){return{addSeedWithDefaultAccount:i((t,r)=>v2(e,t,r).then(zu),"addSeedWithDefaultAccount"),addAccountForExistingSeed:i(t=>Q1(e,t).then(zu),"addAccountForExistingSeed"),addSeedWithMultipleAccounts:i((t,r,n,o)=>Md(e,t,r,n,o).then(s=>s.map(zu)),"addSeedWithMultipleAccounts"),addPrivateKeyAccount:i((t,r,n)=>h2(e,t,r,n).then(xg),"addPrivateKeyAccount"),addLedgerAccounts:i((t,r)=>f2(e,t,r).then(n=>n.map(wg)),"addLedgerAccounts"),addSolanaSeedVaultAccounts:i(t=>x2(e,t).then(r=>r.map(Sg)),"addSolanaSeedVaultAccounts"),addReadonlyAccount:i(t=>m2(e,t),"addReadonlyAccount"),addKMSVaultAccount:i(async({organizationId:t,walletId:r,tag:n,derivationIndex:o,chains:s,apiEnvironment:a})=>G1(e,{organizationId:t,walletId:r,tag:n,derivationIndex:o,chains:s,apiEnvironment:a}).then(Cd),"addKMSVaultAccount"),upsertKMSVaultChains:i(async({organizationId:t,walletId:r,tag:n,derivationIndex:o,chains:s})=>X1(e,{organizationId:t,walletId:r,tag:n,derivationIndex:o,chains:s}).then(Cd),"upsertKMSVaultChains"),deriveAddresses:i(()=>B2(e),"deriveAddresses"),removeAccount:i(t=>R2(e,t),"removeAccount"),reorderAccount:i((t,r)=>U2(e,t,r),"reorderAccount"),exportEntropy:i(t=>An(e,t),"exportEntropy"),exportPrivateKey:i((t,r)=>Id(e,t,r),"exportPrivateKey"),fetchAllAccounts:Ho,fetchAllSeedMetas:Ah,fetchAllSeedlessMetas:Sh,sign:i((t,r)=>PE(e,t,r),"sign"),isExistingSeed:i(t=>mc(e,t),"isExistingSeed"),checkVaultIntegrity:i(()=>_2(e),"checkVaultIntegrity"),healAccountsWithMissingSecrets:i(()=>K2(e),"healAccountsWithMissingSecrets"),clearVault:i(()=>D1(e),"clearVault"),addSeedlessWithMultipleAccounts:i((t,r,n)=>_d(e,t,r,n).then(o=>o.map(Fu)),"addSeedlessWithMultipleAccounts"),addSeedlessWithDefaultAccount:i((t,r)=>b2(e,t,r).then(Fu),"addSeedlessWithDefaultAccount"),addAccountForExistingSeedless:i(t=>g2(e,t).then(Fu),"addAccountForExistingSeedless"),getAuthenticationPublicKey:i(t=>C2(e,t),"getAuthenticationPublicKey"),getKMSInstance:i(t=>t===void 0?H1(e):Uu(e,t),"getKMSInstance"),canDeriveKMSAuthenticator:i(async()=>{let t=await Ho();return!!CE(t)},"canDeriveKMSAuthenticator"),DO_NOT_USE_diagnoseSeedCacheDigests:i(()=>P2(e),"DO_NOT_USE_diagnoseSeedCacheDigests"),rebuildKMSAuthenticatorMapping:i(async()=>{await z1(e)},"rebuildKMSAuthenticatorMapping"),updateCashAccountMapping:i(async t=>{await F1(e,t)},"updateCashAccountMapping"),DEBUG_corruptSeedCacheWithSha256:i(()=>T2(e),"DEBUG_corruptSeedCacheWithSha256")}}i(nP,"createVault");var oP=ut(function*(){return[...(yield Ho()).reduce(Jt((r,n)=>{switch(n.type){case U.Seed:case U.Seedless:{r.add(n.seedIdentifier);break}case U.PrivateKey:{r.add(n.privateKeyIdentifier);break}case U.Ledger:case U.SeedVault:case U.ReadOnly:case U.KMSVault:break;default:Te(n);break}return r},0),new Set)]});m();g();var iP=i((e,t)=>e.filter(r=>{switch(r.type){case U.Seed:case U.Seedless:return r.seedIdentifier===t;case U.PrivateKey:return r.privateKeyIdentifier===t;case U.Ledger:case U.SeedVault:case U.ReadOnly:return!1;case U.KMSVault:return r.identifier===t;default:Te(r);return}}),"getAccountsForSecretId");m();g();function sP(e){return is.get(e).networkNameOverride?.(e)??be.getNetworkName(e,!0)}i(sP,"getBadgedNetworkName");m();g();function aP(){return{version:1,setting:{[K.Solana]:yu,[K.EVM]:bu,[K.Sui]:G0}}}i(aP,"getDefaultNetworkSetting");m();g();var cP=new Set([K.Solana,K.EVM,K.Sui,K.BitcoinNativeSegwit,K.BitcoinTaproot]);async function uP(e=0){let r=(await zr()).enabledAddressTypes.filter(o=>cP.has(o));return Br(r).map(o=>({chainType:Jn.getAddressType(o),derivationIndex:e,pathType:o}))}i(uP,"getDefaultKMSVaultChainConfigs");async function Eh(e=0){let t=await uP(e),r=t.map(s=>s.pathType),n=km(r,e),o=t.map(({chainType:s,pathType:a})=>{let{addressFormat:l}=e1(s);return{chainType:s,pathType:a,derivationPath:vi({pathType:a,index:e}),addressFormat:l}});return{derivations:n,conversionMetadata:o}}i(Eh,"getDefaultKMSVaultDerivationsAndMetadata");m();g();var l0=me(Xb());function Qb(){l0.ECIES_CONFIG.ellipticCurve="x25519",l0.ECIES_CONFIG.symmetricAlgorithm="aes-256-gcm",l0.ECIES_CONFIG.symmetricNonceLength=16}i(Qb,"configureKMSECIES");m();g();var f0=me(Xb());function XK(e){let[t,r,n]=e.split(":");if(t!=="kms"||!r||!n)throw new Error("Invalid KMS account identifier");return{walletId:r,tag:n}}i(XK,"parseKMSVaultIdentifier");async function QK(e,t){if(t.type!==U.KMSVault)throw new Error("Account is not a KMS vault");let{walletId:r,tag:n}=XK(t.identifier),{result:o}=await e.getPhantomOrganization({});if(!o)throw new Error("No Phantom organization found");Qb();let s=new f0.PrivateKey,a=pt(Buffer.from(s.publicKey.toBytes())),{result:l}=await e.exportWallet({publicKey:a,organizationId:o.organizationId,walletId:r}),f=xr(l.encryptedBundle),p=(0,f0.decrypt)(s.secret,Buffer.from(f)),{mnemonic:w}=await na(p);return{mnemonic:w,walletId:r,tag:n}}i(QK,"exportKMSVaultMnemonic");m();g();function A3(e,t){return`${e}:${t}`}i(A3,"descriptorKey");function d0(e,t){let r={},n=new Map;for(let o of t){let s=A3(o.addressFormat,o.derivationPath);if(n.has(s))throw new Error(`Duplicate KMS account request for ${s}`);n.set(s,{descriptor:o,used:!1})}for(let o of e){let{addressFormat:s,derivationPath:a,address:l,publicKey:f}=o,p=A3(s,a),w=n.get(p);if(!w)continue;if(w.used)throw new Error(`KMS returned duplicate account data for format=${s}, derivationPath=${a}.`);w.used=!0;let{chainType:A,pathType:_}=w.descriptor;r[A]=Y1(eR({chainType:A,pathType:_,address:l,publicKey:f}))}for(let{descriptor:o,used:s}of n.values())if(!s)throw new Error(`KMS did not return data for requested chain ${o.chainType} with path ${o.derivationPath}`);return{chains:r}}i(d0,"convertKMSWalletToVaultAccountParams");function eR({chainType:e,pathType:t,address:r,publicKey:n}){switch(e){case K.Solana:return{chainType:e,pathType:t,address:r};case K.EVM:return{chainType:e,pathType:t,address:r};case K.Sui:{if(!n)throw new Error("KMS response missing required public key for Sui account conversion.");let o=xr(n);return{chainType:e,pathType:t,address:r,publicKey:o}}case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:{if(!n)throw new Error("KMS response missing required public key for Bitcoin account conversion.");let o=xr(n),s=r?{[wr.Mainnet]:r}:void 0;return{chainType:e,pathType:t,publicKey:o,addresses:s}}default:throw new Error(`Unsupported chain type ${e} returned from KMS conversion.`)}}i(eR,"createChainAddressInput");m();g();async function tR(e){try{return Zl("enable-kms-authenticator-mapping")?(J.addBreadcrumb(Y.Account,"Starting KMS authenticator mapping sync",oe.Info),await e.rebuildKMSAuthenticatorMapping(),J.addBreadcrumb(Y.Account,"Successfully rebuilt KMS authenticator mapping",oe.Info),{success:!0,action:"built",message:"Mapping rebuilt successfully"}):(J.addBreadcrumb(Y.Account,"KMS authenticator mapping sync skipped: feature flag disabled",oe.Info),{success:!0,action:"skipped",message:"Mapping sync skipped (feature flag disabled)"})}catch(t){return J.captureError(t,Y.Account),{success:!1,action:"error",message:t.message}}}i(tR,"syncKMSAuthenticatorMapping");m();g();m();g();m();g();m();g();function vr(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(k.NODE_ENV!=="production"){var o=uR[e],s=o?typeof o=="function"?o.apply(null,r):o:"unknown error nr: "+e;throw Error("[Immer] "+s)}throw Error("[Immer] minified error nr: "+e+(r.length?" "+r.map(function(a){return"'"+a+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}i(vr,"n");function nu(e){return!!e&&!!e[fn]}i(nu,"r");function Oa(e){return!!e&&(function(t){if(!t||typeof t!="object")return!1;var r=Object.getPrototypeOf(t);if(r===null)return!0;var n=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;return n===Object||typeof n=="function"&&Function.toString.call(n)===lR}(e)||Array.isArray(e)||!!e[P3]||!!e.constructor[P3]||uv(e)||lv(e))}i(Oa,"t");function Ml(e,t,r){r===void 0&&(r=!1),iu(e)===0?(r?Object.keys:mv)(e).forEach(function(n){r&&typeof n=="symbol"||t(n,e[n],e)}):e.forEach(function(n,o){return t(o,n,e)})}i(Ml,"i");function iu(e){var t=e[fn];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:uv(e)?2:lv(e)?3:0}i(iu,"o");function ov(e,t){return iu(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}i(ov,"u");function rR(e,t){return iu(e)===2?e.get(t):e[t]}i(rR,"a");function C3(e,t,r){var n=iu(e);n===2?e.set(t,r):n===3?(e.delete(t),e.add(r)):e[t]=r}i(C3,"f");function nR(e,t){return e===t?e!==0||1/e==1/t:e!=e&&t!=t}i(nR,"c");function uv(e){return aR&&e instanceof Map}i(uv,"s");function lv(e){return cR&&e instanceof Set}i(lv,"v");function Ca(e){return e.o||e.t}i(Ca,"p");function fv(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=fR(e);delete t[fn];for(var r=mv(t),n=0;n<r.length;n++){var o=r[n],s=t[o];s.writable===!1&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(t[o]={configurable:!0,writable:!0,enumerable:s.enumerable,value:e[o]})}return Object.create(Object.getPrototypeOf(e),t)}i(fv,"l");function dv(e,t){return t===void 0&&(t=!1),hv(e)||nu(e)||!Oa(e)||(iu(e)>1&&(e.set=e.add=e.clear=e.delete=oR),Object.freeze(e),t&&Ml(e,function(r,n){return dv(n,!0)},!0)),e}i(dv,"d");function oR(){vr(2)}i(oR,"h");function hv(e){return e==null||typeof e!="object"||Object.isFrozen(e)}i(hv,"y");function ni(e){var t=dR[e];return t||vr(18,e),t}i(ni,"b");function E3(){return k.NODE_ENV==="production"||ou||vr(0),ou}i(E3,"_");function ev(e,t){t&&(ni("Patches"),e.u=[],e.s=[],e.v=t)}i(ev,"j");function h0(e){iv(e),e.p.forEach(iR),e.p=null}i(h0,"O");function iv(e){e===ou&&(ou=e.l)}i(iv,"g");function _3(e){return ou={p:[],l:ou,h:e,m:!0,_:0}}i(_3,"w");function iR(e){var t=e[fn];t.i===0||t.i===1?t.j():t.O=!0}i(iR,"S");function tv(e,t){t._=t.p.length;var r=t.p[0],n=e!==void 0&&e!==r;return t.h.g||ni("ES5").S(t,e,n),n?(r[fn].P&&(h0(t),vr(4)),Oa(e)&&(e=p0(t,e),t.l||m0(t,e)),t.u&&ni("Patches").M(r[fn].t,e,t.u,t.s)):e=p0(t,r,[]),h0(t),t.u&&t.v(t.u,t.s),e!==O3?e:void 0}i(tv,"P");function p0(e,t,r){if(hv(t))return t;var n=t[fn];if(!n)return Ml(t,function(s,a){return M3(e,n,t,s,a,r)},!0),t;if(n.A!==e)return t;if(!n.P)return m0(e,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var o=n.i===4||n.i===5?n.o=fv(n.k):n.o;Ml(n.i===3?new Set(o):o,function(s,a){return M3(e,n,o,s,a,r)}),m0(e,o,!1),r&&e.u&&ni("Patches").R(n,r,e.u,e.s)}return n.o}i(p0,"M");function M3(e,t,r,n,o,s){if(k.NODE_ENV!=="production"&&o===r&&vr(5),nu(o)){var a=p0(e,o,s&&t&&t.i!==3&&!ov(t.D,n)?s.concat(n):void 0);if(C3(r,n,a),!nu(a))return;e.m=!1}if(Oa(o)&&!hv(o)){if(!e.h.F&&e._<1)return;p0(e,o),t&&t.A.l||m0(e,o)}}i(M3,"A");function m0(e,t,r){r===void 0&&(r=!1),e.h.F&&e.m&&dv(t,r)}i(m0,"x");function rv(e,t){var r=e[fn];return(r?Ca(r):e)[t]}i(rv,"z");function I3(e,t){if(t in e)for(var r=Object.getPrototypeOf(e);r;){var n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Object.getPrototypeOf(r)}}i(I3,"I");function sv(e){e.P||(e.P=!0,e.l&&sv(e.l))}i(sv,"k");function nv(e){e.o||(e.o=fv(e.t))}i(nv,"E");function av(e,t,r){var n=uv(t)?ni("MapSet").N(t,r):lv(t)?ni("MapSet").T(t,r):e.g?function(o,s){var a=Array.isArray(o),l={i:a?1:0,A:s?s.A:E3(),P:!1,I:!1,D:{},l:s,t:o,k:null,o:null,j:null,C:!1},f=l,p=cv;a&&(f=[l],p=_l);var w=Proxy.revocable(f,p),A=w.revoke,_=w.proxy;return l.k=_,l.j=A,_}(t,r):ni("ES5").J(t,r);return(r?r.A:E3()).p.push(n),n}i(av,"R");function sR(e){return nu(e)||vr(22,e),i(function t(r){if(!Oa(r))return r;var n,o=r[fn],s=iu(r);if(o){if(!o.P&&(o.i<4||!ni("ES5").K(o)))return o.t;o.I=!0,n=T3(r,s),o.I=!1}else n=T3(r,s);return Ml(n,function(a,l){o&&rR(o.t,a)===l||C3(n,a,t(l))}),s===3?new Set(n):n},"n")(e)}i(sR,"D");function T3(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return fv(e)}i(T3,"F");var B3,ou,pv=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",aR=typeof Map<"u",cR=typeof Set<"u",k3=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",O3=pv?Symbol.for("immer-nothing"):((B3={})["immer-nothing"]=!0,B3),P3=pv?Symbol.for("immer-draftable"):"__$immer_draftable",fn=pv?Symbol.for("immer-state"):"__$immer_state";var uR={0:"Illegal state",1:"Immer drafts cannot have computed properties",2:"This object has been frozen and should not be mutated",3:function(e){return"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+e},4:"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.",5:"Immer forbids circular references",6:"The first or second argument to `produce` must be a function",7:"The third argument to `produce` must be a function or undefined",8:"First argument to `createDraft` must be a plain object, an array, or an immerable object",9:"First argument to `finishDraft` must be a draft returned by `createDraft`",10:"The given draft is already finalized",11:"Object.defineProperty() cannot be used on an Immer draft",12:"Object.setPrototypeOf() cannot be used on an Immer draft",13:"Immer only supports deleting array indices",14:"Immer only supports setting array indices and the 'length' property",15:function(e){return"Cannot apply patch, path doesn't resolve: "+e},16:'Sets cannot have "replace" patches.',17:function(e){return"Unsupported patch operation: "+e},18:function(e){return"The plugin for '"+e+"' has not been loaded into Immer. To enable the plugin, import and call `enable"+e+"()` when initializing your application."},20:"Cannot use proxies if Proxy, Proxy.revocable or Reflect are not available",21:function(e){return"produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '"+e+"'"},22:function(e){return"'current' expects a draft, got: "+e},23:function(e){return"'original' expects a draft, got: "+e},24:"Patching reserved attributes like __proto__, prototype and constructor is not allowed"},lR=""+Object.prototype.constructor,mv=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,fR=Object.getOwnPropertyDescriptors||function(e){var t={};return mv(e).forEach(function(r){t[r]=Object.getOwnPropertyDescriptor(e,r)}),t},dR={},cv={get:i(function(e,t){if(t===fn)return e;var r=Ca(e);if(!ov(r,t))return function(o,s,a){var l,f=I3(s,a);return f?"value"in f?f.value:(l=f.get)===null||l===void 0?void 0:l.call(o.k):void 0}(e,r,t);var n=r[t];return e.I||!Oa(n)?n:n===rv(e.t,t)?(nv(e),e.o[t]=av(e.A.h,n,e)):n},"get"),has:i(function(e,t){return t in Ca(e)},"has"),ownKeys:i(function(e){return Reflect.ownKeys(Ca(e))},"ownKeys"),set:i(function(e,t,r){var n=I3(Ca(e),t);if(n?.set)return n.set.call(e.k,r),!0;if(!e.P){var o=rv(Ca(e),t),s=o?.[fn];if(s&&s.t===r)return e.o[t]=r,e.D[t]=!1,!0;if(nR(r,o)&&(r!==void 0||ov(e.t,t)))return!0;nv(e),sv(e)}return e.o[t]===r&&typeof r!="number"&&(r!==void 0||t in e.o)||(e.o[t]=r,e.D[t]=!0,!0)},"set"),deleteProperty:i(function(e,t){return rv(e.t,t)!==void 0||t in e.t?(e.D[t]=!1,nv(e),sv(e)):delete e.D[t],e.o&&delete e.o[t],!0},"deleteProperty"),getOwnPropertyDescriptor:i(function(e,t){var r=Ca(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.i!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},"getOwnPropertyDescriptor"),defineProperty:i(function(){vr(11)},"defineProperty"),getPrototypeOf:i(function(e){return Object.getPrototypeOf(e.t)},"getPrototypeOf"),setPrototypeOf:i(function(){vr(12)},"setPrototypeOf")},_l={};Ml(cv,function(e,t){_l[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),_l.deleteProperty=function(e,t){return k.NODE_ENV!=="production"&&isNaN(parseInt(t))&&vr(13),_l.set.call(this,e,t,void 0)},_l.set=function(e,t,r){return k.NODE_ENV!=="production"&&t!=="length"&&isNaN(parseInt(t))&&vr(14),cv.set.call(this,e[0],t,r,e[0])};var hR=function(){function e(r){var n=this;this.g=k3,this.F=!0,this.produce=function(o,s,a){if(typeof o=="function"&&typeof s!="function"){var l=s;s=o;var f=n;return function(P){var C=this;P===void 0&&(P=l);for(var O=arguments.length,L=Array(O>1?O-1:0),R=1;R<O;R++)L[R-1]=arguments[R];return f.produce(P,function(j){var Z;return(Z=s).call.apply(Z,[C,j].concat(L))})}}var p;if(typeof s!="function"&&vr(6),a!==void 0&&typeof a!="function"&&vr(7),Oa(o)){var w=_3(n),A=av(n,o,void 0),_=!0;try{p=s(A),_=!1}finally{_?h0(w):iv(w)}return typeof Promise<"u"&&p instanceof Promise?p.then(function(P){return ev(w,a),tv(P,w)},function(P){throw h0(w),P}):(ev(w,a),tv(p,w))}if(!o||typeof o!="object"){if((p=s(o))===void 0&&(p=o),p===O3&&(p=void 0),n.F&&dv(p,!0),a){var T=[],B=[];ni("Patches").M(o,p,T,B),a(T,B)}return p}vr(21,o)},this.produceWithPatches=function(o,s){if(typeof o=="function")return function(p){for(var w=arguments.length,A=Array(w>1?w-1:0),_=1;_<w;_++)A[_-1]=arguments[_];return n.produceWithPatches(p,function(T){return o.apply(void 0,[T].concat(A))})};var a,l,f=n.produce(o,s,function(p,w){a=p,l=w});return typeof Promise<"u"&&f instanceof Promise?f.then(function(p){return[p,a,l]}):[f,a,l]},typeof r?.useProxies=="boolean"&&this.setUseProxies(r.useProxies),typeof r?.autoFreeze=="boolean"&&this.setAutoFreeze(r.autoFreeze)}i(e,"e");var t=e.prototype;return t.createDraft=function(r){Oa(r)||vr(8),nu(r)&&(r=sR(r));var n=_3(this),o=av(this,r,void 0);return o[fn].C=!0,iv(n),o},t.finishDraft=function(r,n){var o=r&&r[fn];k.NODE_ENV!=="production"&&(o&&o.C||vr(9),o.I&&vr(10));var s=o.A;return ev(s,n),tv(void 0,s)},t.setAutoFreeze=function(r){this.F=r},t.setUseProxies=function(r){r&&!k3&&vr(20),this.g=r},t.applyPatches=function(r,n){var o;for(o=n.length-1;o>=0;o--){var s=n[o];if(s.path.length===0&&s.op==="replace"){r=s.value;break}}o>-1&&(n=n.slice(o+1));var a=ni("Patches").$;return nu(r)?a(r,n):this.produce(r,function(l){return a(l,n)})},e}(),dn=new hR,Ka=dn.produce,qge=dn.produceWithPatches.bind(dn),Hge=dn.setAutoFreeze.bind(dn),jge=dn.setUseProxies.bind(dn),zge=dn.applyPatches.bind(dn),Fge=dn.createDraft.bind(dn),Wge=dn.finishDraft.bind(dn),$ge=Ka;m();g();var xe;(function(e){e.TermsHaveBeenAcknowledgedLastSeenVersion="termsHaveBeenAcknowledgedLastSeenVersion",e.NotificationsHaveBeenAcknowledgedLastSeenVersion="notificationsHaveBeenAcknowledgedLastSeenVersion",e.NetworkSetting="networkSetting",e.DeveloperMode="developerMode",e.SelectedAccount=".phantom-labs.account.selectedAccount",e.AccountsMetadata=".phantom-labs.account.accountMetadata",e.AccountsBalanceMetadata=".phantom-labs.account.accountMetadata.balance",e.MigratedWithInvalidChecksum=".phantom-labs.account.migratedWithInvalidChecksum",e.AccountMetas="accountMetas"})(xe||(xe={}));var pR=[xe.AccountsMetadata,xe.DeveloperMode,xe.NetworkSetting,xe.SelectedAccount,xe.TermsHaveBeenAcknowledgedLastSeenVersion,xe.NotificationsHaveBeenAcknowledgedLastSeenVersion];var nye=new Error("Failed to clear selected account index"),gv=ut(function*(){try{let e=Cn(xe.SelectedAccount);return e?.version===2?e.identifier:null}catch{throw mR}}),mR=new Error("Failed to get selected account identifier");async function Pn(e){try{let t={version:2,identifier:e};return ii(xe.SelectedAccount)(t)}catch{throw new Error("Failed to set selected account identifier")}}i(Pn,"setSelectedAccountIdentifier");var gR=v.object({version:v.literal(1),isDeveloperMode:v.boolean()}),yR=v.object({version:v.literal(1),setting:v.record(v.string())}),bR=v.union([v.object({version:v.literal(1),index:v.number()}),v.object({version:v.literal(2),identifier:v.string()})]),vR=v.object({version:v.literal(1),accounts:v.record(v.any())}),wR=v.object({version:v.literal(1),accounts:v.record(v.any())}),oye=v.object({version:v.literal(1),accounts:v.array(v.any())}),iye=v.object({version:v.literal(1),seedIdentifiers:v.array(v.string()),seedlessIdentifiers:v.array(v.string()),privateKeyIdentifiers:v.array(v.string())}),xR=i((e,t)=>{let r=e,n=t;return!r&&!n?null:{version:1,accounts:{...r?.accounts??{},...n?.accounts??{}}}},"accountsMetadataResolver"),[oi,su,sye]=Cw("accounts",[{key:xe.AccountsMetadata,type:"object",validator:vR,nullable:!0,resolver:xR,updateOn:"change"}]);var[Cn,ii,K3]=$l("accounts",[{key:xe.DeveloperMode,type:"object",validator:gR,nullable:!0},{key:xe.NetworkSetting,type:"object",validator:yR,nullable:!0},{key:xe.SelectedAccount,type:"object",validator:bR,nullable:!0},{key:xe.AccountsBalanceMetadata,type:"object",validator:wR,nullable:!0},{key:xe.MigratedWithInvalidChecksum,type:"boolean",nullable:!0}]);var R3=new Error("Failed to add user account metadata to storage"),yv=new Error("Could not find account metadata in storage");async function U3(e,t){let r=oi(xe.AccountsMetadata);if(!r)throw yv;let n=r.accounts[e];n?n=Ka(n,s=>{s.name=t}):n={name:t},r.accounts[e]=n,await su(xe.AccountsMetadata)(r)}i(U3,"setMultiChainAccountName");async function N3(e,t){let r=oi(xe.AccountsMetadata);if(!r)throw yv;let n=r.accounts[e];n?n=Ka(n,s=>{s.icon=t}):n={icon:t,name:xo.t("onboardingImportAccountsAccountName",{walletIndex:""})},r.accounts[e]=n,await su(xe.AccountsMetadata)(r)}i(N3,"setMultiChainAccountIcon");async function L3(e,t){let r=Cn(xe.AccountsBalanceMetadata);r||(r={version:1,accounts:{}});let n=r.accounts[e];n?n.balance=t:(n={balance:t},r.accounts[e]=n),await ii(xe.AccountsBalanceMetadata)(r)}i(L3,"setAccountBalance");async function Ns(e,t){try{let r=oi(xe.AccountsMetadata);r?r.accounts[e]=t:r={version:1,accounts:{[e]:t}},await su(xe.AccountsMetadata)(r)}catch{throw R3}}i(Ns,"addMultiChainAccountMetadata");async function g0(e){try{let t=oi(xe.AccountsMetadata);t?t.accounts=Ka(t.accounts,n=>{for(let[o,s]of Object.entries(e))n[o]||(n[o]={name:""}),n[o].name=s.name,n[o].icon=s.icon??n[o].icon,n[o].connectedDevices=s.connectedDevices??n[o].connectedDevices}):t={version:1,accounts:{...e}},await su(xe.AccountsMetadata)(t)}catch{throw R3}}i(g0,"addAccountMetadataBatch");var D3=ut(function*(e){let t=Cn(xe.AccountsBalanceMetadata);t||(t={version:1,accounts:{}});let r=t.accounts[e];return r||(r={}),r}),V3=ut(function*(e){let t=oi(xe.AccountsMetadata);t||(t={version:1,accounts:{}});let r=t.accounts[e],n=xo.t("onboardingImportAccountsAccountName",{walletIndex:""}),a=(yield Fs(gu)?.get(xe.AccountsMetadata))?.accounts?.[e]?.name;return r&&r.name===n&&a&&(r=Ka(r,Jt(l=>{l.name=a},0,[a]))),r||(r={name:a||n}),{...r}}),q3=ut(function*(){let e=Cn(xe.AccountsBalanceMetadata);return e?e.accounts:{}}),H3=ut(function*(){let e=oi(xe.AccountsMetadata),t={},r=new Set([...Object.keys(e?.accounts||{})]),o=yield Fs(gu)?.get(xe.AccountsMetadata),s=xo.t("onboardingImportAccountsAccountName",{walletIndex:""});for(let a of r){let l=e?.accounts[a],f=o?.accounts?.[a]?.name;l&&l.name===s&&f&&(l=Ka(l,Jt(p=>{p.name=f},0,[f]))),l||(l={name:f||s}),t[a]={...l}}return t});async function SR(e){let t=Cn(xe.AccountsBalanceMetadata);t&&(delete t.accounts[e],await ii(xe.AccountsBalanceMetadata)(t))}i(SR,"removeMultiChainAccountBalanceMetadata");async function y0(e){let t=oi(xe.AccountsMetadata);if(!t)throw yv;delete t.accounts[e],await su(xe.AccountsMetadata)(t),await SR(e)}i(y0,"removeMultiChainAccountMetadata");function b0(e,t,r,n){let o=wn(t,r);return e.find(s=>s.type===U.KMSVault&&s.identifier===o&&(!s.apiEnvironment||s.apiEnvironment===n))}i(b0,"findExistingKMSVaultAccount");function v0(e,t,r){let o=gd(t).addresses;return e.some(s=>{if(s.type===U.KMSVault||"apiEnvironment"in s&&s.apiEnvironment&&s.apiEnvironment!==r)return!1;let a=B1(s);for(let l of a.addresses)if(o.has(l))return!0;return!1})}i(v0,"hasMatchingNonKMSAccount");function j3(e){let t=e+1;return xo.t("onboardingImportAccountsAccountName",{walletIndex:t})}i(j3,"generateKMSAccountName");async function w0(e,t,r,n,o,s,a){J.addBreadcrumb(Y.Account,"Adding KMS vault account to local storage",oe.Info);let l=await e.addKMSVaultAccount({organizationId:t,walletId:r,tag:n,derivationIndex:0,chains:o,apiEnvironment:a});J.addBreadcrumb(Y.Account,"Added KMS vault account to vault storage",oe.Info);let f=j3(s.length);return await Ns(l.identifier,{name:f,icon:void 0}),J.addBreadcrumb(Y.Account,`Set account metadata with name: ${f}`,oe.Info),l}i(w0,"addKMSVaultAccountWithMetadata");async function AR(e){try{J.addBreadcrumb(Y.Account,"Starting KMS vault account sync (read-only)",oe.Info);let t=await e.fetchAllAccounts();if(t.some(w=>w.type===U.Seedless))return J.addBreadcrumb(Y.Account,"KMS vault sync skipped: user has seedless accounts (will migrate separately)",oe.Info),{success:!1,action:"skipped_seedless",message:"Sync skipped for seedless accounts"};let n=e.getKMSInstance(),{derivations:o,conversionMetadata:s}=await Eh(0);J.addBreadcrumb(Y.Account,`Checking for KMS vault with tag "${or}"`,oe.Info);let a=await Bm(n,or,o);if(!a)return J.addBreadcrumb(Y.Account,"KMS vault account not found remotely",oe.Info),{success:!1,action:"not_found",message:"Vault account not found in KMS"};J.addBreadcrumb(Y.Account,`Found KMS vault: ${a.walletId}`,oe.Info);let{chains:l}=d0(a.accounts,s),f=Hr()===er.Production?"production":"staging";return b0(t,a.walletId,or,f)?(J.addBreadcrumb(Y.Account,"Upserting missing chains for existing KMS vault account",oe.Info),await e.upsertKMSVaultChains({organizationId:a.organizationId,walletId:a.walletId,tag:or,derivationIndex:0,chains:l}),{success:!0,action:"already_synced",message:"Account already synced (updated chains)",walletId:a.walletId}):v0(t,l,f)?(J.addBreadcrumb(Y.Account,"KMS vault sync skipped: matching non-KMS local account found by address",oe.Info),{success:!0,action:"already_synced",message:"Matching non-KMS local account detected by address; skipping duplicate",walletId:a.walletId}):(await w0(e,a.organizationId,a.walletId,or,l,t,f),J.addBreadcrumb(Y.Account,"Successfully synced KMS vault account to local storage",oe.Info),{success:!0,action:"synced",message:"Account synced successfully",walletId:a.walletId})}catch(t){return J.captureError(t,Y.Account),{success:!1,action:"error",message:t.message}}}i(AR,"syncKMSVaultAccount");m();g();async function ER(e,t,r){try{J.addBreadcrumb(Y.Account,"Storing KMS vault account from existing data",oe.Info);let n=await t.fetchAllAccounts(),{conversionMetadata:o}=await Eh(0),{chains:s}=d0(e.accounts,o),a=Hr()===er.Production?"production":"staging",l=b0(n,e.walletId,or,a);if(l)return J.addBreadcrumb(Y.Account,"KMS vault account already exists locally",oe.Info),await t.upsertKMSVaultChains({organizationId:e.organizationId,walletId:e.walletId,tag:or,derivationIndex:0,chains:s}),{isNewAccount:!1,account:l,message:"Account already exists (chains updated if needed)"};if(v0(n,s,a))return J.addBreadcrumb(Y.Account,"KMS vault account matches existing non-KMS account by address - skipping",oe.Info),{isNewAccount:!1,account:null,message:"Matching non-KMS account detected by address"};J.addBreadcrumb(Y.Account,"Adding new KMS vault account to local storage",oe.Info);let f=await w0(t,e.organizationId,e.walletId,or,s,n,a);return J.addBreadcrumb(Y.Account,"Successfully stored new KMS vault account",oe.Info),{isNewAccount:!0,account:f,message:"Account created successfully"}}catch(n){return J.captureError(n,Y.Account),{isNewAccount:!1,account:null,message:n.message}}}i(ER,"storeKMSVaultAccountFromData");m();g();var _R=i(e=>({getSeed:i(t=>MR(e,t),"getSeed"),setSeed:i((t,r)=>IR(e,t,r),"setSeed"),getClientJWTSigner:i((t,r)=>TR(e,t,r),"getClientJWTSigner"),setClientJWTSigner:i((t,r,n)=>BR(e,t,r,n),"setClientJWTSigner"),removeSeeds:i(t=>z3(e,t),"removeSeeds"),removeClientJWTKeypairs:i(t=>F3(e,t),"removeClientJWTKeypairs"),clear:i(async()=>{await z3(e,"all"),await F3(e,"all")},"clear")}),"createVaultCache"),Ls=`${kr}.cache.secrets`,bv=i(e=>`${kr}.cache.seed.${e}`,"seedCacheKey"),vv=i(e=>`${kr}.cache.client-jwt.${e}`,"clientJWTKeypairKey"),MR=i(async({isEnabled:e,secretsStorage:t},r)=>{if(!e())return null;let n=bv(r),o=null;try{o=await t.getSecureValue(n)}catch{}if(!o)return null;let{bytes:s,encoding:a}=o.seed;return new Uint8Array(Buffer.from(s,a))},"getSeed"),IR=i(async({isEnabled:e,generalStorage:t,secretsStorage:r},n,o)=>{if(!e())return;let s=bv(n);await r.setSecureValue(s,{version:1,identifier:n,seed:{bytes:Buffer.from(o).toString("base64"),encoding:"base64"}});let a=await t.get(Ls);if(!a)a={version:1,seedIdentifiers:[n],clientJWTKeypairIdentifiers:[]};else{let l=new Set(a.seedIdentifiers);l.add(n),a.seedIdentifiers=Array.from(l)}await t.set(Ls,a)},"setSeed"),z3=i(async({generalStorage:e,secretsStorage:t},r)=>{let n=await e.get(Ls);if(!n)return;let o=r==="all"?n.seedIdentifiers:r,s=new Set(o),a=n.seedIdentifiers.filter(l=>s.has(l));await t.removeSecureValue(a.map(bv)),await e.set(Ls,{version:1,seedIdentifiers:n.seedIdentifiers.filter(l=>!s.has(l)),clientJWTKeypairIdentifiers:n.clientJWTKeypairIdentifiers??[]})},"removeSeeds"),TR=i(async({isEnabled:e,secretsStorage:t},r,n)=>{if(!e())return null;let o=vv(r),s=null;try{s=await t.getSecureValue(o)}catch{}if(!s||!s.keyPairs[n])return null;let a=s.keyPairs[n],l=new Uint8Array(Buffer.from(a.p256pubkey.bytes,a.p256pubkey.encoding)),f=new Uint8Array(Buffer.from(a.p256privkey.bytes,a.p256privkey.encoding));return{p256pubkey:l,p256privkey:f}},"getClientJWTSigner"),BR=i(async({isEnabled:e,generalStorage:t,secretsStorage:r},n,o,s)=>{if(!e())return;let a=vv(n),l=await r.getSecureValue(a)??{version:1,identifier:n,keyPairs:{}};l.keyPairs[o]={p256pubkey:{bytes:pt(Buffer.from(s.p256pubkey)),encoding:"base64"},p256privkey:{bytes:pt(Buffer.from(s.p256privkey)),encoding:"base64"}},await r.setSecureValue(a,l);let f=await t.get(Ls);if(!f)f={version:1,seedIdentifiers:[],clientJWTKeypairIdentifiers:[n]};else{let p=new Set(f.clientJWTKeypairIdentifiers??[]);p.add(n),f.clientJWTKeypairIdentifiers=Array.from(p)}await t.set(Ls,f)},"setClientJWTSigner"),F3=i(async({generalStorage:e,secretsStorage:t},r)=>{let n=await e.get(Ls);if(!n||!n.clientJWTKeypairIdentifiers||n.clientJWTKeypairIdentifiers.length===0)return;let o=r==="all"?n.clientJWTKeypairIdentifiers:r,s=new Set(o);await t.removeSecureValue(o.map(vv)),await e.set(Ls,{version:1,seedIdentifiers:n.seedIdentifiers,clientJWTKeypairIdentifiers:n.clientJWTKeypairIdentifiers.filter(a=>!s.has(a))})},"removeClientJWTKeypairs");m();g();var x0=me(qt());m();g();var Il=i(()=>({isReady:!0,value:Ht(zr)}),"useChainAvailability");m();g();var wv=i(()=>{let e=rr();return Re({mutationFn:i(async({addressTypes:r})=>{for(let n of r)await Nw(n);rs(e)},"mutationFn")})},"useDisableAddressTypes");m();g();var kR=i(()=>{let e=rr();return Re({mutationFn:i(async({chainIDs:r})=>{await Kw(r),rs(e)},"mutationFn")})},"useDisableChains");m();g();var xv=i(()=>{let e=rr(),{deriveAddresses:t}=Gl();return Re({mutationFn:i(async({addressTypes:n})=>{for(let o of n)await Uw(o);await t(),await rs(e)},"mutationFn")})},"useEnableAddressTypes");m();g();var PR=i(()=>{let e=rr(),{deriveAddresses:t}=Gl();return Re({mutationFn:i(async({chainIDs:n})=>{await Ow(n),await t(),await rs(e)},"mutationFn")})},"useEnableChains");m();g();var CR=i(()=>{let{mutateAsync:e}=wv(),{mutateAsync:t}=xv();return Re({mutationFn:i(async({addressTypes:n})=>{if(await Rw())await t({addressTypes:n});else{let s=new Set(be.bitcoin.addressTypes);for(let a of n)s.delete(a);if(s.size===be.bitcoin.addressTypes.length&&s.delete(K.BitcoinNativeSegwit),s.size>0){let a=Array.from(s);await e({addressTypes:a})}}},"mutationFn")})},"useUpdateVisibleBitcoinAddressTypes");var Sv=be.getAllChainIDs().filter(e=>be.isChainDefaultEnabled(e)),W3=Sv.map(e=>be.getMainnetNetworkID(e)),OR=W3.flatMap(e=>be.getAddressTypes(e)),$3=i(()=>Il().value?.enabledAddressTypes??OR,"useEnabledAddressTypes"),au=i(()=>Il().value?.enabledChainIDs??Sv,"useEnabledChains"),twe=i(()=>Il().value?.supportedChainIDs??Sv,"useAllChains"),rwe=i(e=>{let t=Il().value;return t?e?t.enabledNetworkIDs:t.enabledMainnetOnlyNetworkIDs:W3},"useEnabledNetworkIDs"),nwe=i(()=>au().length===1,"useIsSingleChainEnabled"),owe=i(()=>{let e=au();return(0,x0.useMemo)(()=>be.getChainIDs(K.EVM).some(t=>e.includes(t)),[e])},"useIsEvmChainEnabled"),iwe=i(()=>{let e=au();return(0,x0.useMemo)(()=>e.length===1&&e.includes(tn.Solana),[e])},"useIsSolanaOnlyEnabled"),swe=i(e=>{let t=au();return(0,x0.useMemo)(()=>e.map(r=>t.includes(r)),[t,e])},"useIsEnabledChains");m();g();var jR=me(qt());m();g();m();g();var G3=i((e,t,r,n)=>{let o=[];for(let s of t){let a=be.getChainID(s);if(n.includes(a))for(let l of be[a].addressTypes){if(!r.includes(l))continue;let f=e[l];if(f)switch(f.chainType){case K.EVM:case K.Solana:{o.push({networkID:s,addressType:l,address:f.address});break}case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:{o.push({networkID:s,addressType:l,publicKey:f.publicKey,address:f.addresses[s]});break}case K.Sui:{o.push({networkID:s,addressType:l,publicKey:f.publicKey,address:f.address});break}default:Te(f)}}}return o},"getAccountAddressesFromChains"),KR=i((e,t,r,n)=>G3(e.chains,t,r,n),"getSeedAccountAddresses"),RR=i((e,t,r,n)=>G3(e.chains,t,r,n),"getLedgerAccountAddresses"),UR=i((e,t,r,n)=>{let o=[];for(let s of t){let a=be.getChainID(s);if(n.includes(a))for(let l of be[a].addressTypes)r.includes(l)&&e.chainType===l&&o.push({networkID:s,addressType:l,address:e.address})}return o},"getSolanaSeedVaultAccountAddresses"),NR=i((e,t,r,n)=>{let o=[];for(let s of t){let a=be.getChainID(s);if(n.includes(a))for(let l of be[a].addressTypes){if(!r.includes(l))continue;let f=e.chains[l];if(f)switch(f.chainType){case K.EVM:case K.Solana:{o.push({networkID:s,addressType:l,address:f.address});break}case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:{o.push({networkID:s,addressType:l,publicKey:f.publicKey,address:f.addresses[s]});break}case K.Sui:{o.push({networkID:s,addressType:l,publicKey:f.publicKey,address:f.address});break}default:Te(f)}}}return o},"getKMSVaultAccountAddresses"),LR=i((e,t,r,n)=>{let o=[];for(let s of t){let a=be.getChainID(s);if(n.includes(a)){for(let l of be[a].addressTypes)if(r.includes(l)&&e.chainType===l)switch(e.chainType){case K.EVM:case K.Solana:{o.push({networkID:s,addressType:l,address:e.address});break}case K.BitcoinTaproot:case K.BitcoinNativeSegwit:case K.BitcoinNestedSegwit:case K.BitcoinLegacy:{o.push({networkID:s,addressType:l,publicKey:e.publicKey,address:e.addresses[s]});break}case K.Sui:{o.push({networkID:s,addressType:l,publicKey:e.publicKey,address:e.address});break}default:Te(e)}}}return o},"getPrivateKeyAccountAddresses"),DR=i((e,t,r,n)=>{let o=[];for(let s of t){let a=be.getChainID(s);if(n.includes(a)){for(let l of be[a].addressTypes)if(r.includes(l))for(let[f,p]of Object.entries(e.addresses))f===l&&o.push({networkID:s,addressType:l,address:p})}}return o},"getReadOnlyAccountAddresses"),cu=i(e=>e.filter(t=>typeof t.address=="string"&&t.address.length>0),"filterOutEmptyAddresses"),S0=i((e,t,r,n,o,s)=>{let a;switch(s?a=Object.values(o.setting):a=t,a=a.sort((l,f)=>be.compareNetworkID(l,f)),e.type){case U.Seedless:case U.Seed:return cu(KR(e,a,r,n));case U.Ledger:return cu(RR(e,a,r,n));case U.SeedVault:return cu(UR(e,a,r,n));case U.KMSVault:return cu(NR(e,a,r,n));case U.PrivateKey:return cu(LR(e,a,r,n));case U.ReadOnly:return cu(DR(e,a,r,n))}},"convertVaultAccountToChainAddresses");m();g();var uu=ut(function*(){let e=Cn(xe.NetworkSetting);if(!e)return vu();let t=VR(e);return qR(t)});function VR(e){let t={...e,setting:{...e.setting}};return t.setting[K.Sui]||(t.setting[K.Sui]=vu().setting[K.Sui]),t}i(VR,"ensureChainSetting");var qR=i(async e=>{let t=!1;HR(e)&&(t=!0);let r=e.setting[K.Solana];r&&be.isMainnetNetworkID(r)&&(e.setting[K.Solana]=yu,t=!0);let n=e.setting[K.EVM];return n&&be.isMainnetNetworkID(n)&&(e.setting[K.EVM]=bu,t=!0),t&&await ii(xe.NetworkSetting)(e),e},"overrideMainnetNetworksIfNeeded"),HR=i(e=>{let t=!1,r=e.setting[K.EVM];return r&&(r.toString()==="eip155:5"&&(e.setting[K.EVM]=Yn.Ethereum.Sepolia,t=!0),r.toString()==="eip155:80001"&&(e.setting[K.EVM]=Yn.Polygon.Amoy,t=!0)),t},"migrateDeprecatedTestnets");var Ds=ut(function*(){let e=zr(),t=yield Ho();if(t.length===0)return[];let r=Hr()===er.Production?"production":"staging",n=t.filter(Jt(T=>T.type===U.KMSVault?!T.apiEnvironment||T.apiEnvironment===r:!0,0,[r])),o=Cn(xe.DeveloperMode),s=uu(),a=H3(),[l,f,p]=yield Fl.all([o,s,a]),A=yield Fs(gu)?.get(xe.AccountsMetadata),_=xo.t("onboardingImportAccountsAccountName",{walletIndex:""});return n.map(Jt(T=>{let B=p[T.identifier],P=A?.accounts?.[T.identifier]?.name;B&&B.name===_&&P&&(B.name=P),B||(B={name:P||_});let C={name:B.name,icon:B.icon,identifier:T.identifier,addresses:S0(T,e.enabledMainnetOnlyNetworkIDs,e.enabledAddressTypes,e.enabledChainIDs,f,l?.isDeveloperMode??!1)};return T.type===U.Seed?{...C,type:U.Seed,seedIdentifier:T.seedIdentifier,isReadOnly:!1}:T.type===U.Seedless?{...C,type:U.Seedless,seedIdentifier:T.seedIdentifier,isReadOnly:!1}:T.type===U.ReadOnly?{...C,type:U.ReadOnly,isReadOnly:!0}:T.type===U.PrivateKey?{...C,privateKeyIdentifier:T.privateKeyIdentifier,type:U.PrivateKey,isReadOnly:!1}:{...C,type:T.type,isReadOnly:!1}},1,[p,A,_,e,f,l]))});var Av=ut(function*(){let e=yield Ds();return J.addBreadcrumb(Y.Account,`Finished fetching all accounts. Num accounts: ${e.length}`,oe.Info),e});function Ev(e){let t=Ht(Ds);return fr(t,e)}i(Ev,"useAllMultiChainAccountsQuery");m();g();m();g();function _v(){return Re({mutationFn:i(async({metadataBatch:r})=>{J.addBreadcrumb(Y.Account,`Adding Account Metadata Batch: ${Object.entries(r).length} entries`,oe.Info),await g0(r)},"mutationFn"),onError:i(r=>{J.captureError(r,Y.Account)},"onError")})}i(_v,"useAddAccountMetadataBatch");function zR(){let{mutateAsync:e}=_v(),t=Pt(),{t:r}=ns();return Re({mutationFn:i(async({accounts:s,pairedBLEDevice:a})=>{let l=Fw(),f=await t.connectLedgerAccounts(l,s),p=f.reduce((A,_,T)=>{let{name:B,accountIndex:P}=s[T],C;!B||B.length===0?C=r("onboardingImportAccountsLedgerAccountName",{walletIndex:1+P}):C=B;let O;a&&(O=[{...a,version:1,connectionType:$a.BLE,deviceType:Wa.Ledger}]);let L={name:C,icon:void 0,connectedDevices:O};return A[_.identifier]=L,A},{});await e({metadataBatch:p});let w=f[0]?.identifier;return w||(w=(await t.fetchAllAccounts())[0].identifier),await Pn(w),f},"mutationFn"),onError:i(s=>J.captureError(s,Y.Account),"onError")})}i(zR,"useConnectLedgerAccounts");m();g();m();g();var Vs=ut(function*(e){if(e.length===0)throw new Error(Cf);let t=yield gv(),r=e.find(Jt(n=>n.identifier===t,0,[t]));return r||e[0]});var Z3=ut(function*(){let e=yield Ds(),t=yield Vs(e),r=Fs(wp);if(r){let n=zr();r.identifyAccount(e,t,n)}return J.addBreadcrumb(Y.Account,`Finished fetching selected account: ${t.identifier}`,oe.Info),t}),FR=ut(e=>{let t=Z3();return{isPending:t.isPending,isLoading:t.isPending,isSuccess:t.isResolved,isFetching:t.isPending,isError:t.isRejected,isFetched:t.isSettled,status:t.isPending?"pending":t.isResolved?"success":"error",data:t.value?e?e(t.value):t.value:void 0,error:t.error}});function hn({select:e}={}){return Ht(FR,e)}i(hn,"useSelectedMultiChainAccount");m();g();var Y3=me(Wl()),A0=me(qt());var J3=(0,A0.createContext)(null);function WR({children:e,userRepository:t}){return(0,Y3.jsx)(J3.Provider,{value:{userRepository:t},children:e})}i(WR,"UserProvider");function $R(){let e=(0,A0.useContext)(J3);if(!e)throw new Error("useUserContext must be used within a UserProvider");return e}i($R,"useUserContext");function pn(){return $R().userRepository}i(pn,"useUserRepository");m();g();m();g();m();g();var Tl=i(e=>`/user/v1/users/${e}/profile`,"userProfileByUserIdEndpoint"),E0=i(e=>`/user/v1/profiles/${e}`,"userProfileByUsernameOrUserProfileIdEndpoint"),X3=i(()=>"/user/v1/profiles/creation-check","userEligibleToClaimEndpoint");m();g();m();g();var qs;(function(e){e.PUBLIC="public",e.PRIVATE="private",e.INVISIBLE="invisible",e.HIDDEN="hidden"})(qs||(qs={}));var GR=Object.values(qs),tI=v.string().brand("ProfileId"),Bl=v.object({id:tI,username:v.string(),icon:v.string().nullish(),addresses:v.record(v.string(),v.string()),privacyState:v.nativeEnum(qs).optional().default(qs.PUBLIC),biography:v.string().nullish(),phantomJoinDate:v.string().nullish()}),Mv=v.string().url().brand("ActorId"),ZR=v.object({id:v.string().optional(),orderedItems:Mv.array(),next:v.string().optional()}),Q3=v.object({id:v.string().url(),current:ZR.optional(),totalItems:v.number().optional()}),eI=v.object({type:v.string(),value:v.string().optional(),name:v.string().optional()}),YR=v.object({id:v.string().url().optional(),name:v.string().optional(),type:v.string()}),JR=v.object({id:Mv,name:v.string(),preferredUsername:v.string(),manuallyApprovesFollowers:v.boolean(),followers:v.union([Q3,v.string().url()]),following:v.union([Q3,v.string().url()]),icon:YR.nullish(),attachment:v.union([eI,v.array(eI)]).optional(),summary:v.string().nullish(),published:v.string().nullish()}).transform(e=>{let{attachment:t,...r}=e,n={},o=!1,s=!1,a=!1,l=!1,f=!1,p=!0,w=null;if(t){let A=Array.isArray(t)?t:[t];for(let _ of A)if(!(!_.name||!_.value)){if(_.name.endsWith(":address")){let T=lw.safeParse(_.name.replace(":address",""));if(T.success){let B=T.data;n[B]=_.value}}_.name==="requesting"&&(o=_.value==="true"),_.name==="requestedBy"&&(s=_.value==="true"),_.name==="blocking"&&(a=_.value==="true"),_.name==="following"&&(l=_.value==="true"),_.name==="followedBy"&&(f=_.value==="true"),_.name==="notificationsEnabled"&&(p=_.value==="true"),_.name==="tradeCount"&&(w=_.value??null)}}return{...r,addresses:n,isSentFollowRequestPending:o,hasPendingFollowRequest:s,isBlocking:a,isFollowing:l,isFollowedBy:f,areNotificationsEnabled:p,tradeCount:w}}),XR={Image:"image",Emoji:"emoji",ReadOnlyDefault:"read-only-default",Default:"default"},QR=v.object({type:v.nativeEnum(XR),imageUrl:v.string().optional(),unicode:v.string().optional()}),Iv=v.object({error:v.object({message:v.string()})});var Tv=i(async e=>{let r=await Mt.api().get(E0(e)),n=Bl.safeParse(r.data);return n.success?n.data:null},"getUserProfileByUsernameOrUserProfileId");var eU=i(e=>({getUsernameAvailability:i(async t=>tU(t),"getUsernameAvailability"),getUserProfile:i(async()=>rU(e),"getUserProfile"),getUserProfileByUsername:i(async t=>Tv(t),"getUserProfileByUsername"),getUserProfileByUsernameOrUserProfileId:i(async t=>Tv(t),"getUserProfileByUsernameOrUserProfileId"),setUserProfile:i(async({username:t,addresses:r,icon:n,privacyState:o})=>nU(e,{username:t,addresses:r,icon:n,privacyState:o}),"setUserProfile"),patchUserProfile:i(async t=>oU(e,t),"patchUserProfile"),deleteUserProfile:i(async()=>iU(e),"deleteUserProfile"),isEligibleToClaim:i(async t=>sU(t),"isEligibleToClaim")}),"createUserRepository"),tU=i(async e=>{switch((await Mt.api().get(E0(e))).status){case 200:return!1;case 403:return!1;case 404:return!0;default:throw new Error("Failed to check for username availability.")}},"getUsernameAvailability"),rU=i(async({authRepository:e})=>{let t=await e.getUser({skipAutoLogin:!0});if(!t)throw new Error("User is not logged in, unable to get user profile.");let{userID:r,accessToken:n}=t,o=await Mt.api().bearer(n).get(Tl(r)),s=Bl.safeParse(o.data);return s.success?s.data:null},"getUserProfile"),nU=i(async({authRepository:e},{username:t,addresses:r,icon:n,privacyState:o})=>{let s=await e.getUser();if(!s)throw new Error("User is not logged in, unable to claim username.");let{userID:a,accessToken:l}=s,f=await Mt.api().bearer(l).post(Tl(a),{username:t,icon:n,addresses:r,privacyState:o});if(f.status===201){let A=Bl.safeParse(f.data);if(A.success)return A.data;throw new Error("Failed to parse created profile")}let p=Iv.safeParse(f.data);throw p.success?new Error(p.data.error.message):new Error("Unknown error")},"setUserProfile"),oU=i(async({authRepository:e},{username:t,addresses:r,icon:n,privacyState:o,biography:s})=>{let a=await e.getUser();if(!a)throw new Error("User is not logged in, unable to claim username.");let{userID:l,accessToken:f}=a,p=await Mt.api().bearer(f).patch(Tl(l),{username:t,addresses:r,icon:n,privacyState:o,biography:s});if(p.status===200)return;J.captureMessage(`Failed to patch user profile: ${p.status} ${JSON.stringify(p.data)}`,Y.Auth);let w=Iv.safeParse(p.data);throw w.success?new Error(w.data.error.message):new Error("Unknown error")},"patchUserProfile"),iU=i(async({authRepository:e})=>{let t=await e.getUser();if(!t)throw new Error("User is not logged in, unable to sync down accounts.");let{userID:r,accessToken:n}=t,o=await Mt.api().bearer(n).delete(Tl(r));return 200<=o.status&&o.status<300},"deleteUserProfile"),sU=i(async e=>{try{return(await Mt.api().post(X3(),{addresses:e})).status===200}catch{return!1}},"isEligibleToClaim");m();g();var Bv="@phantom/users",Dr={checkUsernameAvailability(e){return["user",`${Bv}:check-username-availability`,{username:e}]},userProfile(){return["user",`${Bv}:user-profile`]},userProfileAttributeEffect(e){return["user",`${Bv}:user-profile-attribute-effect`,{username:e}]}};m();g();var aU=new Set([Dr.userProfile()[1]]),cU=i(e=>{let t=e.queryKey[1];return typeof t!="string"||!t?!1:aU.has(t)},"userShouldDehydrateQueryPredicate");m();g();m();g();var _0=Yl(Ar,e=>new kv(e)),kv=class{static{i(this,"ClaimUsernameAnalytics")}#e;constructor(t){this.#e=t}onClaimFlowStart(){this.#e.capture("userUsernameClaimFlowStart")}onCheckAvailability(t,r){this.#e.capture("userUsernameCheckAvailability",{data:{username:t,isAvailable:r}})}onAvatarSaved(t){this.#e.capture("userUsernameClaimFlowAvatarSaved",{data:{avatarType:t}})}onAnonymousAuthSaved(t,r){this.#e.capture("userUsernameClaimFlowAnonymousAuthSaved",{data:{numAuthFactorsSaved:t,numAuthFactorsShown:r}})}onLinkWalletsSaved(t,r){this.#e.capture("userUsernameClaimFlowLinkWalletsSaved",{data:{numWalletsSaved:t,numWalletsShown:r}})}onPublicAddressesSaved(){this.#e.capture("userUsernameClaimFlowPublicAddressesSaved")}onClaimFlowComplete(t,r){this.#e.capture("userUsernameClaimComplete",{data:{username:t,authUserID:r}})}};m();g();var Pv=i(e=>{e.removeQueries({queryKey:Dr.userProfile()})},"removeUserProfile"),Cv=i(async e=>{await e.resetQueries({queryKey:Dr.userProfile()})},"resetUserProfile"),Ra=i(async e=>{await e.invalidateQueries({queryKey:Dr.userProfile()})},"invalidateUserProfile");function uU(){let e=_0(),t=yn(),r=pn(),n=rr(),o=i(async({username:s,addresses:a,icon:l})=>{J.addBreadcrumb(Y.Auth,`Claiming Username: ${s}.`,oe.Debug);let f=await t.getUser();if(!f)throw new Error("Unable to claim username. User not authenticated.");J.addBreadcrumb(Y.Auth,"Creating user profile to claim username",oe.Debug);let p=await r.setUserProfile({username:s,addresses:a,icon:l,privacyState:qs.PUBLIC});return J.addBreadcrumb(Y.Auth,"\u2705 Username Claimed!",oe.Debug),await bp(n),await Cv(n),await Js(n),await Ra(n),await Mi(n),e.onClaimFlowComplete(s,f.userID),p},"mutationFn");return Re({mutationFn:i(async s=>{try{return await o(s)}catch(a){J.addBreadcrumb(Y.Auth,"Could not claim username",oe.Error);let l;throw a instanceof Error?l=a:l=new Error("Unable to claim username"),J.captureError(l,Y.Auth),l}},"mutationFn")})}i(uU,"useClaimUsername");m();g();function lU(e,t){let r=_0(),n=pn(),o=Dr.checkUsernameAvailability(e),s=i(async()=>{if(!e)return!1;let l=await n.getUsernameAvailability(e);return r.onCheckAvailability(e,l),l},"queryFn"),a=t?.enabled??!!e.trim();return Tr({enabled:a,queryKey:o,queryFn:s})}i(lU,"useCheckUsernameAvailability");m();g();m();g();var kl=class extends Error{static{i(this,"NoUserProfileError")}constructor(t="No user profile."){super(t),this.name="NoUserProfileError"}},Ov=class extends Error{static{i(this,"MissingRequiredUsernameClaimParamsError")}constructor(t="Missing required username claim params."){super(t),this.name="MissingRequiredUsernameClaimParamsError"}};var fU=ts({days:1}),dU=ts({minutes:1});function Kv(e){let t=pn(),r=Tu(),{enabled:n,...o}=e??{},s=n!==void 0?n:r,a=Dr.userProfile();return Tr({enabled:s,queryKey:a,queryFn:i(async()=>{let f=await t.getUserProfile();if(!f)throw new kl;return f},"queryFn"),gcTime:fU,staleTime:dU,...o})}i(Kv,"useUserProfile");m();g();var hU=i(()=>{let e=rr(),t=yn(),r=pn();return Re({mutationFn:i(async()=>{await r.deleteUserProfile(),await t.deleteAllAuthFactors(),await t.logOut(),Pv(e),Iu(e),await Ra(e),await Js(e),await Mi(e)},"mutationFn")})},"useDeleteUserProfile");m();g();var Rv=i(()=>{let e=rr(),t=pn(),r=i(async n=>{await t.patchUserProfile(n),await Ra(e)},"mutationFn");return Re({mutationFn:i(async n=>{try{await r(n);return}catch(o){J.addBreadcrumb(Y.Auth,`Could not update user profile: ${JSON.stringify(n)}`,oe.Error);let s;throw o instanceof Error?s=o:s=new Error("Could not update user profile!"),J.captureError(s,Y.Auth),s}},"mutationFn"),onMutate:i(async n=>{let o=Dr.userProfile();await e.cancelQueries({queryKey:o});let s=e.getQueryData(o);return e.setQueryData(o,{...s,...n}),{previousData:s}},"onMutate"),onSuccess:i((n,o)=>{let s=Dr.userProfile(),a=e.getQueryData(s);if(a){let l={...a,...o};e.setQueryData(s,l)}},"onSuccess"),onError:i((n,o,s)=>{s&&e.setQueryData(Dr.userProfile(),s.previousData)},"onError")})},"usePatchUserProfile");m();g();var pU=Yl(Ar,e=>new M0(e)),M0=class{static{i(this,"ManageUserProfileAnalytics")}#e;constructor(t){this.#e=t}onAvatarUpdated(t){this.#e.capture("userManageProfileAvatarUpdated",{data:{avatarType:t}})}onAuthFactorsUpdated(t,r){this.#e.capture("userManageProfileAuthFactorsUpdated",{data:{numAuthFactorsSaved:t,numAuthFactorsShown:r}})}onLinkedWalletsUpdated(t,r){this.#e.capture("userManageProfileLinkedWalletsUpdated",{data:{numWalletsSaved:t,numWalletsShown:r}})}onPrivacyStateUpdated(t){this.#e.capture("userManageProfilePrivacyStateUpdated",{data:{privacyState:t}})}onBiographyUpdated(){this.#e.capture("userManageProfileBiographyUpdated")}onPublicAddressesUpdated(t){this.#e.capture("userManageProfilePublicAddressesUpdated",{data:{networkIdsSaved:t}})}};m();g();var I0=me(qt());var mU=i(e=>{let t=(0,I0.useMemo)(()=>{if(e){if(gU(e))return n=>n.address===e.address&&n.networkID===e.networkID;if(be.isNetworkID(e))return n=>n.networkID===e;if(bw(e))return n=>n.addressType===e;throw new Error(`Unrecognized filter type: ${e}`)}else return()=>!1},[e]),r=(0,I0.useCallback)(n=>{let o=n.addresses.filter(t);if(o.length>1)throw new Error(`Multiple addresses match filter: ${e}`);return o[0]},[e,t]);return hn({select:r})},"useSelectedChainAddress");function gU(e){return typeof e=="object"&&"address"in e&&(typeof e.address=="string"||e.address===void 0)&&"networkID"in e}i(gU,"isAddressNetworkIDFilter");m();g();m();g();m();g();var rI=ut(function*(e){return(yield D3(e))?.balance}),nI=ut(function*(){return yield q3()});var yU=i((e="",t=!0)=>{let r=Ht(rI,e);return fr(r)},"useAccountBalance"),bU=i((e=!0)=>{let t=Ht(nI);return fr(t)},"useAllAccountBalances");m();g();var vU=ut(function*(e){let t=yield Av(),r=t.find(Jt(n=>n.identifier===e,0,[e]));if(!r)throw new Error(Vx(t.length,e));return r});function wU(e){let t=Ht(vU,e);return fr(t)}i(wU,"useAccountWithIdentifier");m();g();function xU(){return Re({mutationFn:i(async({accounts:r,offsetIndex:n=0,refreshSyncedStorage:o})=>{o&&await o();let a=oi(xe.AccountsMetadata)?.accounts??{},l={};r.forEach((p,w)=>{a[p.identifier]||(l[p.identifier]=Lx({account:p,index:w,offsetIndex:n}))});let f=Object.keys(l).length;f>0?(J.addBreadcrumb(Y.Account,`Adding metadata for ${f} missing accounts (skipped ${r.length-f} existing)`,oe.Info),await g0(l)):J.addBreadcrumb(Y.Account,`All ${r.length} accounts already have metadata, skipping batch add`,oe.Info)},"mutationFn"),onError:i(r=>{J.captureError(r,Y.Account)},"onError")})}i(xU,"useAddMetadataForMissingAccounts");m();g();function SU(){let e=Pt();return Re({mutationFn:i(async({name:o,addresses:s,icon:a})=>{let l=await e.addReadonlyAccount(s),f={name:o,icon:a};return await Ns(l.identifier,f),await Pn(l.identifier),l},"mutationFn"),onSettled:i(async()=>{},"onSettled"),onError:i(o=>J.captureError(o,Y.Account),"onError")})}i(SU,"useAddReadOnlyAccount");m();g();function AU(){let{t:e}=ns(),t=Ar(),{fetchAllAccounts:r,addAccountForSeed:n,addAccountForSeedless:o,fetchAllSeedlessMetas:s}=Pt();return Re({mutationFn:i(async({name:p,icon:w,seedIdentifier:A})=>{J.addBreadcrumb(Y.Account,`Adding new account for s**d: ${A}`,oe.Info);let T=(await s()).find(C=>C.identifier===A),B=T?await o(A):await n(A);await Ns(B.identifier,{name:p||e("onboardingImportAccountsAccountName",{walletIndex:(await r()).length}),icon:w}),await Pn(B.identifier);let P=Qn(B);return t.capture("addSeedAccount",{data:{seedIdentifier:A,accountType:T?"seedless":"seed",walletAddresses:P}}),B},"mutationFn"),onSettled:i(async()=>{},"onSettled"),onError:i(p=>J.captureError(p,Y.Account),"onError")})}i(AU,"useAddSeedAccount");m();g();var EU=ut(function*(e){try{let t;switch(e){case"all":{let r=yield Ah();t=[...yield Sh(),...r];break}case"local-only":{t=[...yield Ah()];break}case"recoverable-only":{t=[...yield Sh()];break}}return t}catch(t){throw t instanceof Error&&J.captureError(t,Y.Account),t}});function T0(e){let t=Ht(EU,e);return fr(t)}i(T0,"useAllSeeds");m();g();function Uv(){let e=Ht(K3,xe.DeveloperMode);return fr(e)}i(Uv,"useDeveloperMode");m();g();function _U(){let e=Pt();return Re({mutationFn:i(async({chainType:r,privateKey:n,name:o,icon:s})=>{J.addBreadcrumb(Y.Account,"Importing Private Key Account... \u23F3",oe.Info);let a=await e.importPrivateKeyAccount(r,n),l={name:o,icon:s};return await Ns(a.identifier,l),await Pn(a.identifier),J.addBreadcrumb(Y.Account,`Imported Private Key Account \u2705: ${a.identifier}`,oe.Info),a},"mutationFn")})}i(_U,"useImportPrivateKeyAccount");m();g();function MU(){let e=Ht(uu);return fr(e)}i(MU,"useMultiChainNetworkSetting");m();g();function IU(){let e=Ar(),t=Pt(),r=qa();return Re({mutationFn:i(async({identifier:o})=>{J.addBreadcrumb(Y.Account,`Removing Account... \u23F3: ${o}`,oe.Info);let a=(await t.fetchAllAccounts()).find(p=>p.identifier===o),l=Qn(a);await Promise.all([t.removeAccount(o),y0(o)]);let f=await Vs(await t.fetchAllAccounts());await Pn(f.identifier),await r.getNamespace(Ha).invalidate(),e.capture("removeAccount",{data:{walletAddresses:l}}),J.addBreadcrumb(Y.Account,`Removed Account \u2705: ${o}`,oe.Info)},"mutationFn")})}i(IU,"useRemoveAccount");m();g();function TU(){let e=Ar(),t=Pt(),r=qa();return Re({mutationFn:i(async({seedIdentifier:s})=>{let a=await t.fetchAllAccounts(),l=[];for(let p of a)switch(p.type){case U.PrivateKey:case U.Ledger:case U.SeedVault:case U.ReadOnly:case U.KMSVault:continue;case U.Seed:case U.Seedless:p.seedIdentifier===s&&l.push(p);break;default:Te(p)}let f=l.flatMap(p=>Qn(p));for(let p of l)await Promise.all([t.removeAccount(p.identifier),y0(p.identifier)]);await r.getNamespace(Ha).invalidate(),e.capture("removeSeed",{data:{numOfAccounts:l.length,walletAddresses:f}}),J.addBreadcrumb(Y.Account,"Removed Root Account \u2705",oe.Info,{identifier:s})},"mutationFn"),onError:i(s=>{J.captureError(s,Y.Account)},"onError")})}i(TU,"useRemoveMultiChainSeed");m();g();function BU(){return Re({mutationFn:i(async({identifier:r,name:n})=>{J.addBreadcrumb(Y.Account,"Renaming Multichain Account",oe.Info),await U3(r,n)},"mutationFn"),onError:i(r=>J.captureError(r,Y.Account),"onError")})}i(BU,"useRenameMultiChainAccount");m();g();function kU(){let e=Pt(),t=qa();return Re({mutationFn:i(async({identifier:n,toIndex:o})=>{await e.reorderAccount(n,o),await t.getNamespace(Ha).invalidate()},"mutationFn")})}i(kU,"useReorderMultiChainAccount");m();g();var PU=ut(function*(){try{let e=yield Ho(),r=(yield Vs(e)).identifier;if(!r)throw new Error("Unable to resolve selected account identifier => no available accounts or identifier!");return r}catch(e){if(!Dx(e)){let t=e instanceof Error?e.message:String(e);J.captureError(e instanceof Error?e:new Error(t),Y.Account)}throw e}});function CU(){let e=Ht(PU);return fr(e)}i(CU,"useSelectedAccountIdentifier");m();g();function OU(){return Re({mutationFn:i(async({identifier:t,balance:r})=>(await L3(t,r),{identifier:t,balance:r}),"mutationFn")})}i(OU,"useSetAccountBalance");m();g();var oI=me(qt());function KU(){return{mutate:(0,oI.useCallback)(async({developerMode:t})=>{await ii(xe.DeveloperMode)(t)},[])}}i(KU,"useSetDeveloperMode");m();g();function RU(){return Re({mutationFn:i(async({identifier:t,icon:r})=>{J.addBreadcrumb(Y.Account,"Setting Multichain Account Icon",oe.Info),await N3(t,r)},"mutationFn")})}i(RU,"useSetMultiChainAccountIcon");m();g();var iI=me(qt());function UU(){return{mutate:(0,iI.useCallback)(async({networkSetting:t})=>{await ii(xe.NetworkSetting)(t)},[])}}i(UU,"useSetMultiChainNetworkSetting");m();g();function NU(){let e=Ar(),t=Pt();return Re({mutationFn:i(async({identifier:o})=>{await Pn(o);let a=(await t.fetchAllAccounts()).find(f=>f.identifier===o),l=a?Qn(a):[];return e.capture("changeAccount",{data:{identifier:o,walletAddresses:l}}),o},"mutationFn"),onError:i(o=>J.captureError(o,Y.Account),"onError")})}i(NU,"useSetSelectedMultiChainAccountIdentifier");m();g();var B0=me(qt());m();g();var sI=me(qt());var Pl=i(()=>{let{data:e}=hn();return(0,sI.useMemo)(()=>{let t=e?.addresses??[];return[...new Set(t.map(r=>r.networkID))]},[e])},"useSelectedNetworks");var LU=i(()=>{let{data:e,isFetching:t}=Ev(),{data:r,isFetching:n}=hn(),o=Pt(),s=Pl(),{data:a=[],isFetching:l,error:f}=DU(o),{data:p,isFetching:w}=VU();return(0,B0.useEffect)(()=>{f&&(aI(f)||J.captureError(f,Y.Account))},[f]),(0,B0.useMemo)(()=>({data:{"All Accounts":z0(e),"Selected Account":z0(r),"Selected Networks":s.map(A=>be.getNetworkName(A)),"Seed Cache Digests (IDPLAT-295)":a,"KMS Authenticator Mapping":p},isFetching:t||n||l||w}),[e,t,n,l,a,r,s,w,p])},"useAccountsExport"),aI=i(e=>!(e instanceof Error)||!e.message?!1:/not supported|not implemented|vault locked/i.test(e.message),"isExpectedSeedCacheDigestError"),DU=i(e=>Tr({queryKey:["seed-cache-digests","IDPLAT-295"],queryFn:i(async()=>{try{let t=await e.DO_NOT_USE_diagnoseSeedCacheDigests();return!t||t.length===0?[]:t}catch(t){if(aI(t))return[];throw t}},"queryFn"),retry:!1,staleTime:5*60*1e3}),"useSeedCacheDigestReports"),VU=i(()=>Tr({queryKey:["kms-authenticator-mapping"],queryFn:i(async()=>Io(ro)?.mapping||{},"queryFn"),retry:!1,staleTime:5*60*1e3}),"useKMSAuthenticatorMapping");m();g();var cI=me(qt());var qU=i((e=[])=>{let t=au();return(0,cI.useMemo)(()=>e.filter(r=>{let n=be.getParentChain(r.networkID);return n?t.includes(n):!1}),[e,t])},"useAdditionalNetworks");m();g();var OI=me(nT()),L0=me(qt());m();g();var kt=me(qt(),1);var Rl=i(e=>e.type==="checkbox","isCheckBoxInput"),fu=i(e=>e instanceof Date,"isDateObject"),en=i(e=>e==null,"isNullOrUndefined"),vI=i(e=>typeof e=="object","isObjectType"),lr=i(e=>!en(e)&&!Array.isArray(e)&&vI(e)&&!fu(e),"isObject"),wI=i(e=>lr(e)&&e.target?Rl(e.target)?e.target.checked:e.target.value:e,"getEventValue"),HU=i(e=>e.substring(0,e.search(/.\d/))||e,"getNodeParentName"),xI=i((e,t)=>[...e].some(r=>HU(t)===r),"isNameInFieldArray"),R0=i(e=>e.filter(Boolean),"compact"),Ft=i(e=>e===void 0,"isUndefined"),ge=i((e,t,r)=>{if(!t||!lr(e))return r;let n=R0(t.split(/[,[\].]+?/)).reduce((o,s)=>en(o)?o:o[s],e);return Ft(n)||n===e?Ft(e[t])?r:e[t]:n},"get"),Vv={BLUR:"blur",CHANGE:"change"},yo={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Ji={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},jv=i((e,t)=>{let r=Object.assign({},e);return delete r[t],r},"omit"),jU=kt.default.createContext(null),zv=i(()=>kt.default.useContext(jU),"useFormContext");var SI=i((e,t,r,n=!0)=>{function o(a){return()=>{if(a in e)return t[a]!==yo.all&&(t[a]=!n||yo.all),r&&(r[a]=!0),e[a]}}i(o,"createGetter");let s={};for(let a in e)Object.defineProperty(s,a,{get:o(a)});return s},"getProxyFormState"),mn=i(e=>lr(e)&&!Object.keys(e).length,"isEmptyObject"),AI=i((e,t,r)=>{let n=jv(e,"name");return mn(n)||Object.keys(n).length>=Object.keys(t).length||Object.keys(n).find(o=>t[o]===(!r||yo.all))},"shouldRenderFormState"),k0=i(e=>Array.isArray(e)?e:[e],"convertToArrayPayload"),EI=i((e,t,r)=>r&&t?e===t:!e||!t||e===t||k0(e).some(n=>n&&(n.startsWith(t)||t.startsWith(n))),"shouldSubscribeByName");function Fv(e){let t=kt.default.useRef(e);t.current=e,kt.default.useEffect(()=>{let r=i(o=>{o&&o.unsubscribe()},"tearDown"),n=!e.disabled&&t.current.subject.subscribe({next:t.current.callback});return()=>r(n)},[e.disabled])}i(Fv,"useSubscribe");function zU(e){let t=zv(),{control:r=t.control,disabled:n,name:o,exact:s}=e||{},[a,l]=kt.default.useState(r._formState),f=kt.default.useRef({isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1}),p=kt.default.useRef(o),w=kt.default.useRef(!0);p.current=o;let A=kt.default.useCallback(_=>w.current&&EI(p.current,_.name,s)&&AI(_,f.current)&&l(Object.assign(Object.assign({},r._formState),_)),[r,s]);return Fv({disabled:n,callback:A,subject:r._subjects.state}),kt.default.useEffect(()=>()=>{w.current=!1},[]),SI(a,r._proxyFormState,f.current,!1)}i(zU,"useFormState");var si=i(e=>typeof e=="string","isString"),_I=i((e,t,r,n)=>{let o=Array.isArray(e);return si(e)?(n&&t.watch.add(e),ge(r,e)):o?e.map(s=>(n&&t.watch.add(s),ge(r,s))):(n&&(t.watchAll=!0),r)},"generateWatchOutput"),U0=i(e=>typeof e=="function","isFunction"),Wv=i(e=>{for(let t in e)if(U0(e[t]))return!0;return!1},"objectHasFunction");function FU(e){let t=zv(),{control:r=t.control,name:n,defaultValue:o,disabled:s,exact:a}=e||{},l=kt.default.useRef(n);l.current=n;let f=kt.default.useCallback(A=>{if(EI(l.current,A.name,a)){let _=_I(l.current,r._names,A.values||r._formValues);w(Ft(l.current)||lr(_)&&!Wv(_)?Object.assign({},_):Array.isArray(_)?[..._]:Ft(_)?o:_)}},[r,a,o]);Fv({disabled:s,subject:r._subjects.watch,callback:f});let[p,w]=kt.default.useState(Ft(o)?r._getWatch(n):o);return kt.default.useEffect(()=>{r._removeUnmounted()}),p}i(FU,"useWatch");function WU(e){let t=zv(),{name:r,control:n=t.control,shouldUnregister:o}=e,s=xI(n._names.array,r),a=FU({control:n,name:r,defaultValue:ge(n._formValues,r,ge(n._defaultValues,r,e.defaultValue)),exact:!s}),l=zU({control:n,name:r}),f=kt.default.useRef(n.register(r,Object.assign(Object.assign({},e.rules),{value:a})));return kt.default.useEffect(()=>{let p=i((w,A)=>{let _=ge(n._fields,w);_&&(_._f.mount=A)},"updateMounted");return p(r,!0),()=>{let w=n._options.shouldUnregister||o;s?w&&n._stateFlags.action:w?n.unregister(r):p(r,!1)}},[r,n,s,o]),{field:{name:r,value:a,onChange:kt.default.useCallback(p=>{f.current.onChange({target:{value:wI(p),name:r},type:Vv.CHANGE})},[r]),onBlur:kt.default.useCallback(()=>{f.current.onBlur({target:{value:ge(n._formValues,r),name:r},type:Vv.BLUR})},[r,n]),ref:kt.default.useCallback(p=>{let w=ge(n._fields,r);p&&w&&p.focus&&(w._f.ref={focus:i(()=>p.focus(),"focus"),setCustomValidity:i(A=>p.setCustomValidity(A),"setCustomValidity"),reportValidity:i(()=>p.reportValidity(),"reportValidity")})},[r,n])},formState:l,fieldState:{invalid:!!ge(l.errors,r),isDirty:!!ge(l.dirtyFields,r),isTouched:!!ge(l.touchedFields,r),error:ge(l.errors,r)}}}i(WU,"useController");var MI=i(e=>e.render(WU(e)),"Controller"),$U=i((e,t,r,n,o)=>t?Object.assign(Object.assign({},r[e]),{types:Object.assign(Object.assign({},r[e]&&r[e].types?r[e].types:{}),{[n]:o||!0})}):{},"appendErrors"),$v=i(e=>/^\w*$/.test(e),"isKey"),II=i(e=>R0(e.replace(/["|']|\]/g,"").split(/\.|\[/)),"stringToPath");function Yt(e,t,r){let n=-1,o=$v(t)?[t]:II(t),s=o.length,a=s-1;for(;++n<s;){let l=o[n],f=r;if(n!==a){let p=e[l];f=lr(p)||Array.isArray(p)?p:isNaN(+o[n+1])?{}:[]}e[l]=f,e=e[l]}return e}i(Yt,"set");var qv=i((e,t,r)=>{for(let n of r||Object.keys(e)){let o=ge(e,n);if(o){let s=o._f,a=jv(o,"_f");if(s&&t(s.name)){if(s.ref.focus&&Ft(s.ref.focus()))break;if(s.refs){s.refs[0].focus();break}}else lr(a)&&qv(a,t)}}},"focusFieldBy");var uI=i((e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(n=>e.startsWith(n)&&/^\.\w+/.test(e.slice(n.length)))),"isWatched");function Ol(e){let t,r=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(r||lr(e)){t=r?[]:{};for(let n in e){if(U0(e[n])){t=e;break}t[n]=Ol(e[n])}}else return e;return t}i(Ol,"cloneObject");function Nv(){let e=[];return{get observers(){return e},next:i(o=>{for(let s of e)s.next(o)},"next"),subscribe:i(o=>(e.push(o),{unsubscribe:i(()=>{e=e.filter(s=>s!==o)},"unsubscribe")}),"subscribe"),unsubscribe:i(()=>{e=[]},"unsubscribe")}}i(Nv,"createSubject");var C0=i(e=>en(e)||!vI(e),"isPrimitive");function du(e,t){if(C0(e)||C0(t))return e===t;if(fu(e)&&fu(t))return e.getTime()===t.getTime();let r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let o of r){let s=e[o];if(!n.includes(o))return!1;if(o!=="ref"){let a=t[o];if(fu(s)&&fu(a)||lr(s)&&lr(a)||Array.isArray(s)&&Array.isArray(a)?!du(s,a):s!==a)return!1}}return!0}i(du,"deepEqual");var lI=i(e=>({isOnSubmit:!e||e===yo.onSubmit,isOnBlur:e===yo.onBlur,isOnChange:e===yo.onChange,isOnAll:e===yo.all,isOnTouch:e===yo.onTouched}),"getValidationModes"),Kl=i(e=>typeof e=="boolean","isBoolean"),Gv=i(e=>e.type==="file","isFileInput"),Hv=i(e=>e instanceof HTMLElement,"isHTMLElement"),TI=i(e=>e.type==="select-multiple","isMultipleSelect"),Zv=i(e=>e.type==="radio","isRadioInput"),GU=i(e=>Zv(e)||Rl(e),"isRadioOrCheckbox"),fI=typeof self<"u"&&typeof self.HTMLElement<"u"&&typeof document<"u",Lv=i(e=>Hv(e)&&e.isConnected,"live");function ZU(e,t){let r=t.slice(0,-1).length,n=0;for(;n<r;)e=Ft(e)?n++:e[t[n++]];return e}i(ZU,"baseGet");function Vr(e,t){let r=$v(t)?[t]:II(t),n=r.length==1?e:ZU(e,r),o=r[r.length-1],s;n&&delete n[o];for(let a=0;a<r.slice(0,-1).length;a++){let l=-1,f,p=r.slice(0,-(a+1)),w=p.length-1;for(a>0&&(s=e);++l<p.length;){let A=p[l];f=f?f[A]:e[A],w===l&&(lr(f)&&mn(f)||Array.isArray(f)&&!f.filter(_=>lr(_)&&!mn(_)||Kl(_)).length)&&(s?delete s[A]:delete e[A]),s=f}}return e}i(Vr,"unset");function O0(e,t={}){let r=Array.isArray(e);if(lr(e)||r)for(let n in e)Array.isArray(e[n])||lr(e[n])&&!Wv(e[n])?(t[n]=Array.isArray(e[n])?[]:{},O0(e[n],t[n])):en(e[n])||(t[n]=!0);return t}i(O0,"markFieldsDirty");function BI(e,t,r){let n=Array.isArray(e);if(lr(e)||n)for(let o in e)Array.isArray(e[o])||lr(e[o])&&!Wv(e[o])?Ft(t)||C0(r[o])?r[o]=Array.isArray(e[o])?O0(e[o],[]):Object.assign({},O0(e[o])):BI(e[o],en(t)?{}:t[o],r[o]):r[o]=!du(e[o],t[o]);return r}i(BI,"getDirtyFieldsFromDefaultValues");var dI=i((e,t)=>BI(e,t,O0(t)),"getDirtyFields"),hI={value:!1,isValid:!1},pI={value:!0,isValid:!0},kI=i(e=>{if(Array.isArray(e)){if(e.length>1){let t=e.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!Ft(e[0].attributes.value)?Ft(e[0].value)||e[0].value===""?pI:{value:e[0].value,isValid:!0}:pI:hI}return hI},"getCheckboxValue"),PI=i((e,{valueAsNumber:t,valueAsDate:r,setValueAs:n})=>Ft(e)?e:t?e===""?NaN:+e:r&&si(e)?new Date(e):n?n(e):e,"getFieldValueAs"),mI={isValid:!1,value:null},CI=i(e=>Array.isArray(e)?e.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,mI):mI,"getRadioValue");function Dv(e){let t=e.ref;if(!(e.refs?e.refs.every(r=>r.disabled):t.disabled))return Gv(t)?t.files:Zv(t)?CI(e.refs).value:TI(t)?[...t.selectedOptions].map(({value:r})=>r):Rl(t)?kI(e.refs).value:PI(Ft(t.value)?e.ref.value:t.value,e)}i(Dv,"getFieldValue");var YU=i((e,t,r,n)=>{let o={};for(let s of e){let a=ge(t,s);a&&Yt(o,s,a._f)}return{criteriaMode:r,names:[...e],fields:o,shouldUseNativeValidation:n}},"getResolverOptions"),K0=i(e=>e instanceof RegExp,"isRegex"),Cl=i(e=>Ft(e)?void 0:K0(e)?e.source:lr(e)?K0(e.value)?e.value.source:e.value:e,"getRuleValue"),JU=i(e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),"hasValidation");function gI(e,t,r){let n=ge(e,r);if(n||$v(r))return{error:n,name:r};let o=r.split(".");for(;o.length;){let s=o.join("."),a=ge(t,s),l=ge(e,s);if(a&&!Array.isArray(a)&&r!==s)return{name:r};if(l&&l.type)return{name:s,error:l};o.pop()}return{name:r}}i(gI,"schemaErrorLookup");var XU=i((e,t,r,n,o)=>o.isOnAll?!1:!r&&o.isOnTouch?!(t||e):(r?n.isOnBlur:o.isOnBlur)?!e:(r?n.isOnChange:o.isOnChange)?e:!0,"skipValidation"),QU=i((e,t)=>!R0(ge(e,t)).length&&Vr(e,t),"unsetEmptyArray"),P0=i(e=>si(e)||kt.default.isValidElement(e),"isMessage");function yI(e,t,r="validate"){if(P0(e)||Array.isArray(e)&&e.every(P0)||Kl(e)&&!e)return{type:r,message:P0(e)?e:"",ref:t}}i(yI,"getValidateError");var lu=i(e=>lr(e)&&!K0(e)?e:{value:e,message:""},"getValueAndMessage"),bI=i(async(e,t,r,n)=>{let{ref:o,refs:s,required:a,maxLength:l,minLength:f,min:p,max:w,pattern:A,validate:_,name:T,valueAsNumber:B,mount:P,disabled:C}=e._f;if(!P||C)return{};let O=s?s[0]:o,L=i(E=>{n&&O.reportValidity&&(O.setCustomValidity(Kl(E)?"":E||" "),O.reportValidity())},"setCustomValidity"),R={},j=Zv(o),Z=Rl(o),X=j||Z,Q=(B||Gv(o))&&!o.value||t===""||Array.isArray(t)&&!t.length,z=$U.bind(null,T,r,R),H=i((E,c,d,h=Ji.maxLength,y=Ji.minLength)=>{let b=E?c:d;R[T]=Object.assign({type:E?h:y,message:b,ref:o},z(E?h:y,b))},"getMinMaxMessage");if(a&&(!X&&(Q||en(t))||Kl(t)&&!t||Z&&!kI(s).isValid||j&&!CI(s).isValid)){let{value:E,message:c}=P0(a)?{value:!!a,message:a}:lu(a);if(E&&(R[T]=Object.assign({type:Ji.required,message:c,ref:O},z(Ji.required,c)),!r))return L(c),R}if(!Q&&(!en(p)||!en(w))){let E,c,d=lu(w),h=lu(p);if(isNaN(t)){let y=o.valueAsDate||new Date(t);si(d.value)&&(E=y>new Date(d.value)),si(h.value)&&(c=y<new Date(h.value))}else{let y=o.valueAsNumber||parseFloat(t);en(d.value)||(E=y>d.value),en(h.value)||(c=y<h.value)}if((E||c)&&(H(!!E,d.message,h.message,Ji.max,Ji.min),!r))return L(R[T].message),R}if((l||f)&&!Q&&si(t)){let E=lu(l),c=lu(f),d=!en(E.value)&&t.length>E.value,h=!en(c.value)&&t.length<c.value;if((d||h)&&(H(d,E.message,c.message),!r))return L(R[T].message),R}if(A&&!Q&&si(t)){let{value:E,message:c}=lu(A);if(K0(E)&&!t.match(E)&&(R[T]=Object.assign({type:Ji.pattern,message:c,ref:o},z(Ji.pattern,c)),!r))return L(c),R}if(_){if(U0(_)){let E=await _(t),c=yI(E,O);if(c&&(R[T]=Object.assign(Object.assign({},c),z(Ji.validate,c.message)),!r))return L(c.message),R}else if(lr(_)){let E={};for(let c in _){if(!mn(E)&&!r)break;let d=yI(await _[c](t),O,c);d&&(E=Object.assign(Object.assign({},d),z(c,d.message)),L(d.message),r&&(R[T]=E))}if(!mn(E)&&(R[T]=Object.assign({ref:O},E),!r))return R}}return L(!0),R},"validateField"),eN={mode:yo.onSubmit,reValidateMode:yo.onChange,shouldFocusError:!0};function tN(e={}){let t=Object.assign(Object.assign({},eN),e),r={isDirty:!1,isValidating:!1,dirtyFields:{},isSubmitted:!1,submitCount:0,touchedFields:{},isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,errors:{}},n={},o=t.defaultValues||{},s=t.shouldUnregister?{}:Ol(o),a={action:!1,mount:!1,watch:!1},l={mount:new Set,unMount:new Set,array:new Set,watch:new Set},f,p=0,w={},A={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},_={watch:Nv(),array:Nv(),state:Nv()},T=lI(t.mode),B=lI(t.reValidateMode),P=t.criteriaMode===yo.all,C=i((N,G)=>(...W)=>{clearTimeout(p),p=self.setTimeout(()=>N(...W),G)},"debounce"),O=i(async N=>{let G=!1;return A.isValid&&(G=t.resolver?mn((await Q()).errors):await H(n,!0),!N&&G!==r.isValid&&(r.isValid=G,_.state.next({isValid:G}))),G},"_updateValid"),L=i((N,G,W,ne=[],le=!0,te=!0)=>{if(a.action=!0,te&&Array.isArray(ge(n,N))){let se=G(ge(n,N),W.argA,W.argB);le&&Yt(n,N,se)}if(A.errors&&te&&Array.isArray(ge(r.errors,N))){let se=G(ge(r.errors,N),W.argA,W.argB);le&&Yt(r.errors,N,se),QU(r.errors,N)}if(A.touchedFields&&Array.isArray(ge(r.touchedFields,N))){let se=G(ge(r.touchedFields,N),W.argA,W.argB);le&&Yt(r.touchedFields,N,se)}A.dirtyFields&&(r.dirtyFields=dI(o,s)),_.state.next({isDirty:c(N,ne),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})},"_updateFieldArray"),R=i((N,G)=>(Yt(r.errors,N,G),_.state.next({errors:r.errors})),"updateErrors"),j=i((N,G,W,ne)=>{let le=ge(n,N);if(le){let te=ge(s,N,Ft(W)?ge(o,N):W);Ft(te)||ne&&ne.defaultChecked||G?Yt(s,N,G?te:Dv(le._f)):y(N,te),a.mount&&O()}},"updateValidAndValue"),Z=i((N,G,W,ne,le)=>{let te=!1,se={name:N},dt=ge(r.touchedFields,N);if(A.isDirty){let Se=r.isDirty;r.isDirty=se.isDirty=c(),te=Se!==se.isDirty}if(A.dirtyFields&&(!W||ne)){let Se=ge(r.dirtyFields,N);du(ge(o,N),G)?Vr(r.dirtyFields,N):Yt(r.dirtyFields,N,!0),se.dirtyFields=r.dirtyFields,te=te||Se!==ge(r.dirtyFields,N)}return W&&!dt&&(Yt(r.touchedFields,N,W),se.touchedFields=r.touchedFields,te=te||A.touchedFields&&dt!==W),te&&le&&_.state.next(se),te?se:{}},"updateTouchAndDirty"),X=i(async(N,G,W,ne,le)=>{let te=ge(r.errors,G),se=A.isValid&&r.isValid!==W;if(e.delayError&&ne?(f=f||C(R,e.delayError),f(G,ne)):(clearTimeout(p),ne?Yt(r.errors,G,ne):Vr(r.errors,G)),((ne?!du(te,ne):te)||!mn(le)||se)&&!N){let dt=Object.assign(Object.assign(Object.assign({},le),se?{isValid:W}:{}),{errors:r.errors,name:G});r=Object.assign(Object.assign({},r),dt),_.state.next(dt)}w[G]--,A.isValidating&&!w[G]&&(_.state.next({isValidating:!1}),w={})},"shouldRenderByError"),Q=i(async N=>t.resolver?await t.resolver(Object.assign({},s),t.context,YU(N||l.mount,n,t.criteriaMode,t.shouldUseNativeValidation)):{},"_executeSchema"),z=i(async N=>{let{errors:G}=await Q();if(N)for(let W of N){let ne=ge(G,W);ne?Yt(r.errors,W,ne):Vr(r.errors,W)}else r.errors=G;return G},"executeSchemaAndUpdateState"),H=i(async(N,G,W={valid:!0})=>{for(let ne in N){let le=N[ne];if(le){let te=le._f,se=jv(le,"_f");if(te){let dt=await bI(le,ge(s,te.name),P,t.shouldUseNativeValidation);if(dt[te.name]&&(W.valid=!1,G))break;G||(dt[te.name]?Yt(r.errors,te.name,dt[te.name]):Vr(r.errors,te.name))}se&&await H(se,G,W)}}return W.valid},"executeBuildInValidation"),E=i(()=>{for(let N of l.unMount){let G=ge(n,N);G&&(G._f.refs?G._f.refs.every(W=>!Lv(W)):!Lv(G._f.ref))&&F(N)}l.unMount=new Set},"_removeUnmounted"),c=i((N,G)=>(N&&G&&Yt(s,N,G),!du(u(),o)),"_getDirty"),d=i((N,G,W)=>{let ne=Object.assign({},a.mount?s:Ft(G)?o:si(N)?{[N]:G}:G);return _I(N,l,ne,W)},"_getWatch"),h=i(N=>R0(ge(a.mount?s:o,N,e.shouldUnregister?ge(o,N,[]):[])),"_getFieldArray"),y=i((N,G,W={})=>{let ne=ge(n,N),le=G;if(ne){let te=ne._f;te&&(!te.disabled&&Yt(s,N,PI(G,te)),le=fI&&Hv(te.ref)&&en(G)?"":G,TI(te.ref)?[...te.ref.options].forEach(se=>se.selected=le.includes(se.value)):te.refs?Rl(te.ref)?te.refs.length>1?te.refs.forEach(se=>se.checked=Array.isArray(le)?!!le.find(dt=>dt===se.value):le===se.value):te.refs[0]&&(te.refs[0].checked=!!le):te.refs.forEach(se=>se.checked=se.value===le):Gv(te.ref)||(te.ref.value=le,te.ref.type||_.watch.next({name:N})))}(W.shouldDirty||W.shouldTouch)&&Z(N,le,W.shouldTouch,W.shouldDirty,!0),W.shouldValidate&&x(N)},"setFieldValue"),b=i((N,G,W)=>{for(let ne in G){let le=G[ne],te=`${N}.${ne}`,se=ge(n,te);(l.array.has(N)||!C0(le)||se&&!se._f)&&!fu(le)?b(te,le,W):y(te,le,W)}},"setValues"),M=i((N,G,W={})=>{let ne=ge(n,N),le=l.array.has(N);Yt(s,N,G),le?(_.array.next({name:N,values:s}),(A.isDirty||A.dirtyFields)&&W.shouldDirty&&(r.dirtyFields=dI(o,s),_.state.next({name:N,dirtyFields:r.dirtyFields,isDirty:c(N,G)}))):ne&&!ne._f&&!en(G)?b(N,G,W):y(N,G,W),uI(N,l)&&_.state.next({}),_.watch.next({name:N})},"setValue"),I=i(async N=>{let G=N.target,W=G.name,ne=ge(n,W);if(ne){let le,te,se=G.type?Dv(ne._f):wI(N),dt=N.type===Vv.BLUR,Se=!JU(ne._f)&&!t.resolver&&!ge(r.errors,W)&&!ne._f.deps||XU(dt,ge(r.touchedFields,W),r.isSubmitted,B,T),Ie=uI(W,l,dt);Yt(s,W,se),dt?ne._f.onBlur&&ne._f.onBlur(N):ne._f.onChange&&ne._f.onChange(N);let gn=Z(W,se,dt,!1),Ke=!mn(gn)||Ie;if(!dt&&_.watch.next({name:W,type:N.type}),Se)return Ke&&_.state.next(Object.assign({name:W},Ie?{}:gn));if(!dt&&Ie&&_.state.next({}),w[W]=(w[W],1),A.isValidating&&_.state.next({isValidating:!0}),t.resolver){let{errors:Pe}=await Q([W]),bo=gI(r.errors,n,W),Ce=gI(Pe,n,bo.name||W);le=Ce.error,W=Ce.name,te=mn(Pe)}else le=(await bI(ne,ge(s,W),P,t.shouldUseNativeValidation))[W],te=await O(!0);ne._f.deps&&x(ne._f.deps),X(!1,W,te,le,gn)}},"onChange"),x=i(async(N,G={})=>{let W,ne,le=k0(N);if(_.state.next({isValidating:!0}),t.resolver){let te=await z(Ft(N)?N:le);W=mn(te),ne=N?!le.some(se=>ge(te,se)):W}else N?(ne=(await Promise.all(le.map(async te=>{let se=ge(n,te);return await H(se&&se._f?{[te]:se}:se)}))).every(Boolean),!(!ne&&!r.isValid)&&O()):ne=W=await H(n);return _.state.next(Object.assign(Object.assign(Object.assign({},!si(N)||A.isValid&&W!==r.isValid?{}:{name:N}),t.resolver?{isValid:W}:{}),{errors:r.errors,isValidating:!1})),G.shouldFocus&&!ne&&qv(n,te=>ge(r.errors,te),N?le:l.mount),ne},"trigger"),u=i(N=>{let G=Object.assign(Object.assign({},o),a.mount?s:{});return Ft(N)?G:si(N)?ge(G,N):N.map(W=>ge(G,W))},"getValues"),S=i(N=>{N?k0(N).forEach(G=>Vr(r.errors,G)):r.errors={},_.state.next({errors:r.errors})},"clearErrors"),V=i((N,G,W)=>{let ne=(ge(n,N,{_f:{}})._f||{}).ref;Yt(r.errors,N,Object.assign(Object.assign({},G),{ref:ne})),_.state.next({name:N,errors:r.errors,isValid:!1}),W&&W.shouldFocus&&ne&&ne.focus&&ne.focus()},"setError"),q=i((N,G)=>U0(N)?_.watch.subscribe({next:i(W=>N(d(void 0,G),W),"next")}):d(N,G,!0),"watch"),F=i((N,G={})=>{for(let W of N?k0(N):l.mount)l.mount.delete(W),l.array.delete(W),ge(n,W)&&(G.keepValue||(Vr(n,W),Vr(s,W)),!G.keepError&&Vr(r.errors,W),!G.keepDirty&&Vr(r.dirtyFields,W),!G.keepTouched&&Vr(r.touchedFields,W),!t.shouldUnregister&&!G.keepDefaultValue&&Vr(o,W));_.watch.next({}),_.state.next(Object.assign(Object.assign({},r),G.keepDirty?{isDirty:c()}:{})),!G.keepIsValid&&O()},"unregister"),ee=i((N,G={})=>{let W=ge(n,N),ne=Kl(G.disabled);return Yt(n,N,{_f:Object.assign(Object.assign(Object.assign({},W&&W._f?W._f:{ref:{name:N}}),{name:N,mount:!0}),G)}),l.mount.add(N),W?ne&&Yt(s,N,G.disabled?void 0:ge(s,N,Dv(W._f))):j(N,!0,G.value),Object.assign(Object.assign(Object.assign({},ne?{disabled:G.disabled}:{}),t.shouldUseNativeValidation?{required:!!G.required,min:Cl(G.min),max:Cl(G.max),minLength:Cl(G.minLength),maxLength:Cl(G.maxLength),pattern:Cl(G.pattern)}:{}),{name:N,onChange:I,onBlur:I,ref:i(le=>{if(le){ee(N,G),W=ge(n,N);let te=Ft(le.value)&&le.querySelectorAll&&le.querySelectorAll("input,select,textarea")[0]||le,se=GU(te),dt=W._f.refs||[];if(se?dt.find(Se=>Se===te):te===W._f.ref)return;Yt(n,N,{_f:Object.assign(Object.assign({},W._f),se?{refs:dt.concat(te).filter(Lv),ref:{type:te.type,name:N}}:{ref:te})}),j(N,!1,void 0,te)}else W=ge(n,N,{}),W._f&&(W._f.mount=!1),(t.shouldUnregister||G.shouldUnregister)&&!(xI(l.array,N)&&a.action)&&l.unMount.add(N)},"ref")})},"register");return{control:{register:ee,unregister:F,_executeSchema:Q,_getWatch:d,_getDirty:c,_updateValid:O,_removeUnmounted:E,_updateFieldArray:L,_getFieldArray:h,_subjects:_,_proxyFormState:A,get _fields(){return n},set _fields(N){n=N},get _formValues(){return s},set _formValues(N){s=N},get _stateFlags(){return a},set _stateFlags(N){a=N},get _defaultValues(){return o},set _defaultValues(N){o=N},get _names(){return l},set _names(N){l=N},get _formState(){return r},set _formState(N){r=N},get _options(){return t},set _options(N){t=Object.assign(Object.assign({},t),N)}},trigger:x,register:ee,handleSubmit:i((N,G)=>async W=>{W&&(W.preventDefault&&W.preventDefault(),W.persist&&W.persist());let ne=!0,le=t.shouldUnregister?Ol(s):Object.assign({},s);_.state.next({isSubmitting:!0});try{if(t.resolver){let{errors:te,values:se}=await Q();r.errors=te,le=se}else await H(n);mn(r.errors)&&Object.keys(r.errors).every(te=>ge(le,te))?(_.state.next({errors:{},isSubmitting:!0}),await N(le,W)):(G&&await G(r.errors,W),t.shouldFocusError&&qv(n,te=>ge(r.errors,te),l.mount))}catch(te){throw ne=!1,te}finally{r.isSubmitted=!0,_.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:mn(r.errors)&&ne,submitCount:r.submitCount+1,errors:r.errors})}},"handleSubmit"),watch:q,setValue:M,getValues:u,reset:i((N,G={})=>{let W=N||o,ne=Ol(W),le=N&&!mn(N)?ne:o;if(G.keepDefaultValues||(o=W),!G.keepValues){if(fI&&Ft(N))for(let te of l.mount){let se=ge(n,te);if(se&&se._f){let dt=Array.isArray(se._f.refs)?se._f.refs[0]:se._f.ref;try{Hv(dt)&&dt.closest("form").reset();break}catch{}}}s=e.shouldUnregister?G.keepDefaultValues?Ol(o):{}:ne,n={},_.array.next({values:le}),_.watch.next({values:le})}l={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},a.mount=!A.isValid||!!G.keepIsValid,a.watch=!!e.shouldUnregister,_.state.next({submitCount:G.keepSubmitCount?r.submitCount:0,isDirty:G.keepDirty?r.isDirty:G.keepDefaultValues?!du(N,o):!1,isSubmitted:G.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:G.keepDirty?r.dirtyFields:G.keepDefaultValues&&N?Object.entries(N).reduce((te,[se,dt])=>Object.assign(Object.assign({},te),{[se]:dt!==ge(o,se)}),{}):{},touchedFields:G.keepTouched?r.touchedFields:{},errors:G.keepErrors?r.errors:{},isSubmitting:!1,isSubmitSuccessful:!1})},"reset"),resetField:i((N,G={})=>{ge(n,N)&&(Ft(G.defaultValue)?M(N,ge(o,N)):(M(N,G.defaultValue),Yt(o,N,G.defaultValue)),G.keepTouched||Vr(r.touchedFields,N),G.keepDirty||(Vr(r.dirtyFields,N),r.isDirty=G.defaultValue?c(N,ge(o,N)):c()),G.keepError||(Vr(r.errors,N),A.isValid&&O()),_.state.next(Object.assign({},r)))},"resetField"),clearErrors:S,unregister:F,setError:V,setFocus:i(N=>{let G=ge(n,N)._f;(G.ref.focus?G.ref:G.refs[0]).focus()},"setFocus")}}i(tN,"createFormControl");function N0(e={}){let t=kt.default.useRef(),[r,n]=kt.default.useState({isDirty:!1,isValidating:!1,dirtyFields:{},isSubmitted:!1,submitCount:0,touchedFields:{},isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,errors:{}});t.current?t.current.control._options=e:t.current=Object.assign(Object.assign({},tN(e)),{formState:r});let o=t.current.control,s=kt.default.useCallback(a=>{AI(a,o._proxyFormState,!0)&&(o._formState=Object.assign(Object.assign({},o._formState),a),n(Object.assign({},o._formState)))},[o]);return Fv({subject:o._subjects.state,callback:s}),kt.default.useEffect(()=>{o._stateFlags.mount||(o._proxyFormState.isValid&&o._updateValid(),o._stateFlags.mount=!0),o._stateFlags.watch&&(o._stateFlags.watch=!1,o._subjects.state.next({})),o._removeUnmounted()}),t.current.formState=SI(r,o._proxyFormState),t.current}i(N0,"useForm");var rN=i(({accounts:e,enabledAddressTypes:t,enableAddressTypes:r,editableAccountMetadata:n,addReadOnlyAccount:o,fetchDomainOwner:s})=>{let a=pn(),{t:l}=ns(),f=Ar(),p=n?.networkID||Yn.Solana.Mainnet,{formState:{errors:w},control:A,clearErrors:_,getValues:T,setValue:B,register:P,handleSubmit:C,watch:O,trigger:L}=N0({mode:"all"}),{networkID:R,name:j,address:Z,resolvedAddress:X}=O(),Q={required:!0},z=(0,L0.useMemo)(()=>({required:{value:!0,message:l("addAccountImportAccountPublicKeyRequired")},validate:(0,OI.default)(async c=>{if(c==="")return!0;if(!Iw(c,R||p))try{let b=(await s(c,R,a,f))?.owner;return b?(B("resolvedAddress",b),e.find(I=>I.addresses.map(x=>x.address).includes(b))?l("addAccountImportAccountDuplicateAddress"):!0):l("addAccountImportAccountIncorrectFormat")}catch{return l("sendFormErrorInvalidDomain")}return B("resolvedAddress",c),e.find(y=>y.addresses.map(b=>b.address).includes(c))?l("addAccountImportAccountDuplicateAddress"):!0},500)}),[l,R,p,B,e,s,a,f]),H=j&&X&&!w.name&&!w.address,E=(0,L0.useCallback)(async({networkID:c,name:d,resolvedAddress:h},y)=>{let b=Va(c,h);t.includes(b)||await r({addressTypes:[b]});let M={};M[b]=h,o({name:d,addresses:M,icon:n?.icon}),y(),f.capture("addReadOnlyAccount",{data:{networkID:c,chainType:b,walletAddress:h}})},[o,n?.icon,r,t,f]);return{Controller:MI,canSubmit:H,control:A,errors:w,nameValidations:Q,address:Z,addressValidations:z,clearErrors:_,getValues:T,handleSubmit:C,onSubmit:E,register:P,setValue:B,trigger:L}},"useAddReadOnlyAccountForm");m();g();function nN(e){let t=$3();return e.map(r=>is.get(r.networkID).addressTooltipNetworkName?.(r.networkID,r.address,t)??be.getNetworkName(r.networkID))}i(nN,"useAddressTooltipNetworkName");m();g();var KI=me(qt());var oN=i(()=>{let{data:e}=hn(),t=(0,KI.useMemo)(()=>{if(!e||!e.addresses.length)return be.getChainID(uw.Mainnet);let r=e.addresses[0];return be.getChainID(r.networkID)},[e]);return{caip19:Mw(Tw(t)),tokenName:be.getChainName(t),tokenSymbol:be.getTokenSymbol(t)}},"useDefaultNativeTokenForSelectedAccount");m();g();var iN=i(()=>vu(),"useDefaultNetworkSettings");m();g();var sN=i(()=>{let{data:e}=hn();return e?e.type===U.Ledger:void 0},"useIsSelectedLedgerAccount");m();g();var aN=i(()=>{let{data:e}=Uv();return!!e?.isDeveloperMode},"useIsTestnetMode"),cN=i(()=>Pl().some(t=>be.isLocalNetworkID(t)),"useIsLocalnetMode");m();g();var UI=me(qt());m();g();var uN=ut(function*({user:e}){let t=zr(),r=yield Ds();if(!t||!r||!e)return null;let{enabledNetworkIDs:n}=t,o=n?.reduce(Jt((w,A)=>{let _=r.find(Jt(T=>T.addresses.some(Jt(B=>B.networkID===A,0,[A])),0,[A]))?.addresses.find(Jt(T=>T.networkID===A,1,[A]))?.address;return _&&(w[A]=_),w},0,[r]),{})??{},s=e?.addresses,a=s?Object.keys(s).filter(be.isNetworkID):[],l=(n??[]).filter(Jt(w=>!a.includes(w),1,[a])).reduce(Jt((w,A)=>{let _=o[A];return _&&(w[A]=_),w},2,[o]),{});return Object.keys(l).length>0?{addresses:{...l,...s},addedAddresses:l}:null}),RI=i(()=>{let{data:e}=Kv(),t=Ht(uN,{user:e});return fr(t)},"usePatchProfileAddresses");var lN=i(()=>{let{data:e}=RI(),{mutate:t}=Rv(),r=Ar();(0,UI.useEffect)(()=>{if(e){let{addresses:n,addedAddresses:o}=e,s=Object.keys(o);r.capture("autoSyncUsernameAddresses",{data:{addedChains:s}}),t({addresses:n})}},[e,t,r])},"usePatchAddressesIfNeeded");m();g();var NI=me(qt());var fN=i(e=>{let t=(0,NI.useCallback)(r=>r.addresses.find(n=>e===be.getChainID(n.networkID))?.networkID,[e]);return hn({select:t})},"useSelectedNetwork");m();g();var LI=me(qt());var dN=i(({accountBalance:e,accountId:t,enabled:r,value:n,setAccountBalance:o})=>{(0,LI.useEffect)(()=>{if(r&&t&&n!==void 0&&n!==e){let s=Date.now();o({identifier:t,balance:{timestamp:s,value:n}})}},[e,t,r,n,o])},"useSetAccountBalanceEffect");m();g();var DI=me(qt());var hN=i(()=>{let{data:e=[]}=T0("local-only"),{data:t=[]}=T0("recoverable-only");return(0,DI.useMemo)(()=>e.length+t.length>1,[e.length,t.length])},"useShowRemoveSecretPhrase");m();g();m();g();m();g();var qr=me(qt());function pN(e){let t,r=new Set,n=i((p,w)=>{let A=typeof p=="function"?p(t):p;if(A!==t){let _=t;t=w?A:Object.assign({},t,A),r.forEach(T=>T(t,_))}},"setState"),o=i(()=>t,"getState"),s=i((p,w=o,A=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let _=w(t);function T(){let B=w(t);if(!A(_,B)){let P=_;p(_=B,P)}}return i(T,"listenerToAdd"),r.add(T),()=>r.delete(T)},"subscribeWithSelector"),f={setState:n,getState:o,subscribe:i((p,w,A)=>w||A?s(p,w,A):(r.add(p),()=>r.delete(p)),"subscribe"),destroy:i(()=>r.clear(),"destroy")};return t=e(n,o,f),f}i(pN,"createStore");var mN=typeof self>"u"||!self.navigator||/ServerSideRendering|^Deno\//.test(self.navigator.userAgent),VI=mN?qr.useEffect:qr.useLayoutEffect;function D0(e){let t=typeof e=="function"?pN(e):e,r=i((n=t.getState,o=Object.is)=>{let[,s]=(0,qr.useReducer)(C=>C+1,0),a=t.getState(),l=(0,qr.useRef)(a),f=(0,qr.useRef)(n),p=(0,qr.useRef)(o),w=(0,qr.useRef)(!1),A=(0,qr.useRef)();A.current===void 0&&(A.current=n(a));let _,T=!1;(l.current!==a||f.current!==n||p.current!==o||w.current)&&(_=n(a),T=!o(A.current,_)),VI(()=>{T&&(A.current=_),l.current=a,f.current=n,p.current=o,w.current=!1});let B=(0,qr.useRef)(a);VI(()=>{let C=i(()=>{try{let L=t.getState(),R=f.current(L);p.current(A.current,R)||(l.current=L,A.current=R,s())}catch{w.current=!0,s()}},"listener"),O=t.subscribe(C);return t.getState()!==B.current&&C(),O},[]);let P=T?_:A.current;return(0,qr.useDebugValue)(P),P},"useStore");return Object.assign(r,t),r[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");let n=[r,t];return{next(){let o=n.length<=0;return{value:n.shift(),done:o}}}},r}i(D0,"create");var gN={editableAccountMetadata:void 0,setEditableAccountMetadata:i(()=>{},"setEditableAccountMetadata")},V0=D0(e=>({...gN,setEditableAccountMetadata:i(t=>{e({editableAccountMetadata:t})},"setEditableAccountMetadata")}));m();g();var qI={username:"",available:null,usernameAvailabilityError:null,icon:null,secretIdentifiers:[],accountIdentifiersToSync:[],addresses:{}},HI=D0((e,t)=>({...qI,setUsername:i(r=>e({username:r}),"setUsername"),setUsernameAvailabilityError:i(r=>e({usernameAvailabilityError:r}),"setUsernameAvailabilityError"),setAvailable:i(r=>e({available:r}),"setAvailable"),setIcon:i(r=>e({icon:r}),"setIcon"),addSecretIdentifier:i(r=>{let n=[...t().secretIdentifiers];n.includes(r)||n.push(r),e({secretIdentifiers:n})},"addSecretIdentifier"),removeSecretIdentifier:i(r=>{e({secretIdentifiers:t().secretIdentifiers.filter(n=>n!==r)})},"removeSecretIdentifier"),addAccountIdentifierToSync:i(r=>{let n=[...t().accountIdentifiersToSync];n.includes(r)||n.push(r),e({accountIdentifiersToSync:n})},"addAccountIdentifierToSync"),removeAccountIdentifierToSync:i(r=>{e({accountIdentifiersToSync:t().accountIdentifiersToSync.filter(n=>n!==r)})},"removeAccountIdentifierToSync"),clearAccountIdentifiersToSync:i(()=>e({accountIdentifiersToSync:[]}),"clearAccountIdentifiersToSync"),setAccountIdentifiersToSync:i(r=>e({accountIdentifiersToSync:r}),"setAccountIdentifiersToSync"),addAddress:i((r,n)=>{let o={...t().addresses};o[r]=n,e({addresses:o})},"addAddress"),removeAddress:i((r,n)=>{let o={...t().addresses};o[r]===n&&delete o[r],e({addresses:o})},"removeAddress"),clearAddresses:i(()=>{e({addresses:{}})},"clearAddresses"),reset:i(()=>{e(qI)},"reset")}));m();g();var jI=me(mu()),ai=me(qt());var yN=i(({importPrivateKeyCallback:e,existingAccounts:t,editableAccountMetadata:r,analytics:n})=>{let{t:o}=ns(),{formState:{errors:s},control:a,clearErrors:l,getValues:f,setValue:p,register:w,handleSubmit:A,watch:_,trigger:T}=N0({mode:"all",defaultValues:{addressType:r?.addressType||K.Solana,networkID:r?.networkID||Yn.Solana.Mainnet}}),[B,P]=(0,ai.useState)(null),C=V0(d=>d.setEditableAccountMetadata),{name:O}=_(),L=r?.secrets,R=f("networkID"),j=f("addressType"),Z=f("privateKey"),X=(0,ai.useMemo)(()=>new yw,[]),Q={required:!0},z=(0,ai.useMemo)(()=>({required:{value:!0,message:o("addAccountImportAccountPrivateKeyRequired")},onChange:i(d=>{d.target.value||P(null)},"onChange"),validate:i(d=>{try{let h=f("networkID"),y=f("addressType");if(/\s/.test(d)||!y)return o("addAccountImportAccountIncorrectFormat");let b=be.getNetworkDefinition(h).value,M=Dl({privateKey:d,addressType:y,networkIDValue:b});C({...r,secrets:M});let I=X.generateKeypairFromPrivateKey(M,y);return t.find(u=>!u.isReadOnly&&(u.addresses.map(S=>S.address).includes(Sr({publicKey:I.publicKey,addressType:y,networkID:h}))||u.addresses.filter(S=>"publicKey"in S).map(S=>S.publicKey).find(S=>S?Buffer.from(S).equals(Buffer.from(I.publicKey)):!1)))?o("addAccountImportAccountDuplicatePrivateKey"):!0}catch{return o("addAccountImportAccountIncorrectFormat")}},"validate")}),[o,X,t,r,C,f]);(0,ai.useEffect)(()=>{if(s.privateKey){P(null);return}if(Z||L)try{let d=be.getNetworkDefinition(R).value,h=L||Dl({privateKey:Z,addressType:j,networkIDValue:d}),y=X.generateKeypairFromPrivateKey(h,j);if(!Z){let b="";switch(j){case K.Solana:{b=jI.default.encode(y.privateKey);break}case K.EVM:{b="0x"+Buffer.from(y.privateKey).toString("hex");break}case K.Sui:{b=vw(y.privateKey);break}}p("privateKey",b)}P(Sr({publicKey:y.publicKey,addressType:j,networkID:R}))}catch{P(null)}},[s.privateKey,j,X,Z,L,p,R]);let H=(0,ai.useMemo)(()=>!!(O&&Z&&!s.name&&!s.privateKey),[s.name,s.privateKey,O,Z]),E=(0,ai.useCallback)(async({networkID:d,name:h,privateKey:y,addressType:b})=>{let M=be.getNetworkDefinition(d).value,I=Dl({privateKey:y,addressType:b,networkIDValue:M});await e({chainType:b,name:h,icon:r?.icon,privateKey:I}),n.capture("addPrivateKeyAccount",{data:{networkID:d,chainType:b,walletAddress:B}})},[e,r?.icon,n,B]);return{formOnSubmitHandler:A(d=>E(d)),canSubmit:H,control:a,getValues:f,register:w,setValue:p,trigger:T,errors:s,clearErrors:l,nameValidations:Q,privateKey:Z,privateKeyValidations:z,addressPreview:B}},"useImportPrivateKeyForm");m();g();m();g();var Xi="@phantom/accounts",C3e=`${Xi}:account-identifier`,O3e=`${Xi}:selected-account`,K3e=`${Xi}:all-accounts`,R3e=`${Xi}:all-seeds`,U3e=`${Xi}:all-secrets`,N3e=`${Xi}:account-balance`,zI={trustedApps(){return[`${Xi}:trusted-apps`]},patchProfileAddresses(e){return[`${Xi}:patch-profile-addresses`,e]},canUseCash(){return[`${Xi}:can-use-cash`]}};var bN=i(e=>{let t=Pt(),r=zI.canUseCash(),n=i(async()=>{if(!t?.canDeriveKMSAuthenticator)return!1;try{return await t.canDeriveKMSAuthenticator()}catch{return!1}},"queryFn"),{data:o,isPending:s}=Tr({queryKey:r,queryFn:n,...e});return{canUseCash:o??!1,isLoading:s}},"useCanAccountUseCash");m();g();var vN=ut(function*(){let e=zr(),{enabledAddressTypes:t,enabledChainIDs:r,enabledMainnetOnlyNetworkIDs:n}=e,[o,s]=yield Fl.all([Cn(xe.DeveloperMode),uu()]),a=yield Ho(),l=yield Vs(a),f=yield V3(l.identifier),p={name:f.name,icon:f.icon,identifier:l.identifier,addresses:S0(l,n,t,r,s,o?.isDeveloperMode??!1)};return l.type===U.Seed?{...p,type:U.Seed,seedIdentifier:l.seedIdentifier,isReadOnly:!1}:l.type===U.Seedless?{...p,type:U.Seedless,seedIdentifier:l.seedIdentifier,isReadOnly:!1}:l.type===U.ReadOnly?{...p,type:U.ReadOnly,isReadOnly:!0}:l.type===U.PrivateKey?{...p,privateKeyIdentifier:l.privateKeyIdentifier,type:U.PrivateKey,isReadOnly:!1}:{...p,type:l.type,isReadOnly:!1}});export{Fa as a,Ww as b,aT as c,cT as d,uT as e,Br as f,lT as g,Zw as h,Pt as i,Ql as j,is as k,dT as l,xp as m,Sp as n,$6 as o,U as p,hT as q,G6 as r,Dx as s,Z6 as t,Ap as u,Mp as v,Hx as w,Y6 as x,Qn as y,X6 as z,jx as A,wu as B,tB as C,vT as D,wT as E,rB as F,nB as G,oB as H,wn as I,_o as J,$x as K,Jx as L,Pm as M,na as N,E4 as O,_4 as P,kr as Q,lc as R,yt as S,Io as T,s2 as U,Ki as V,ia as W,yg as X,Z0 as Y,Ai as Z,vn as _,Eu as $,A6 as aa,I6 as ba,bp as ca,Js as da,Mi as ea,T6 as fa,N6 as ga,L6 as ha,xT as ia,yn as ja,Si as ka,D6 as la,V6 as ma,Tu as na,q6 as oa,H6 as pa,j6 as qa,z6 as ra,F6 as sa,Eg as ta,he as ua,$t as va,Me as wa,Mg as xa,Q2 as ya,nS as za,SA as Aa,_A as Ba,MA as Ca,PA as Da,CA as Ea,RA as Fa,BE as Ga,wh as Ha,kE as Ia,nP as Ja,oP as Ka,iP as La,sP as Ma,aP as Na,Xb as Oa,Qb as Pa,QK as Qa,tR as Ra,$ge as Sa,xe as Ta,pR as Ua,oi as Va,Cn as Wa,K3 as Xa,j3 as Ya,AR as Za,ER as _a,_R as $a,vp as ab,wp as bb,Il as cb,wv as db,kR as eb,xv as fb,PR as gb,CR as hb,$3 as ib,au as jb,twe as kb,rwe as lb,nwe as mb,owe as nb,iwe as ob,swe as pb,yU as qb,bU as rb,Ds as sb,Av as tb,Ev as ub,wU as vb,_v as wb,xU as xb,SU as yb,AU as zb,T0 as Ab,zR as Bb,Uv as Cb,_U as Db,Z3 as Eb,hn as Fb,MU as Gb,IU as Hb,TU as Ib,BU as Jb,kU as Kb,CU as Lb,OU as Mb,KU as Nb,RU as Ob,UU as Pb,NU as Qb,Pl as Rb,LU as Sb,qU as Tb,qs as Ub,tI as Vb,JR as Wb,XR as Xb,eU as Yb,Dr as Zb,cU as _b,WR as $b,pn as ac,Cv as bc,Ra as cc,uU as dc,lU as ec,kl as fc,Ov as gc,Kv as hc,hU as ic,Rv as jc,pU as kc,WU as lc,MI as mc,N0 as nc,rN as oc,nN as pc,oN as qc,iN as rc,sN as sc,aN as tc,cN as uc,lN as vc,mU as wc,fN as xc,dN as yc,hN as zc,D0 as Ac,V0 as Bc,HI as Cc,yN as Dc,bN as Ec,vN as Fc};
/*! Bundled license information:

@noble/ciphers/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)

@noble/hashes/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/p256.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
//# sourceMappingURL=chunk-F236ETGH.js.map
