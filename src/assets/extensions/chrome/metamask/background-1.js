LavaPack.loadBundle([[230,{"../../../shared/constants/metametrics":6190,"../../../shared/modules/hexstring-utils":6324,"@metamask/base-controller":1520,"@metamask/controller-utils":1639,"@metamask/utils":3554,buffer:4474,loglevel:5247},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){(function(t){(function(){Object.defineProperty(s,"__esModule",{value:!0}),s.isEIP1024EncryptedMessage=s.getDefaultState=s.default=void 0;var n,a=(n=e("loglevel"))&&n.__esModule?n:{default:n},r=e("@metamask/base-controller"),i=e("@metamask/controller-utils"),o=e("@metamask/utils"),c=e("../../../shared/constants/metametrics"),l=e("../../../shared/modules/hexstring-utils");function u(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const d={unapprovedDecryptMsgs:{includeInStateLogs:!0,persist:!1,includeInDebugSnapshot:!1,usedInUi:!0},unapprovedDecryptMsgCount:{includeInStateLogs:!0,persist:!1,includeInDebugSnapshot:!1,usedInUi:!0}},p=e=>!!((0,o.isObject)(e.data)&&(0,o.hasProperty)(e.data,"version")&&(0,o.hasProperty)(e.data,"nonce")&&(0,o.hasProperty)(e.data,"ephemPublicKey")&&(0,o.hasProperty)(e.data,"ciphertext"));s.isEIP1024EncryptedMessage=p;const h=()=>({unapprovedDecryptMsgs:{},unapprovedDecryptMsgCount:0});s.getDefaultState=h;class m extends r.BaseController{constructor({getState:e,metricsEvent:t,messenger:s,manager:n}){super({metadata:d,messenger:s,name:"DecryptMessageController",state:{unapprovedDecryptMsgs:{},unapprovedDecryptMsgCount:0}}),u(this,"_getState",void 0),u(this,"_metricsEvent",void 0),u(this,"_decryptMessageManager",void 0),this._getState=e,this._metricsEvent=t,this._decryptMessageManager=n,s.subscribe("DecryptMessageManager:unapprovedMessage",this._requestApproval.bind(this)),this._subscribeToMessageState(s,(e,t,s)=>{e.unapprovedDecryptMsgs=t,e.unapprovedDecryptMsgCount=s})}get unapprovedDecryptMsgCount(){return this._decryptMessageManager.getUnapprovedMessagesCount()}resetState(){this.update(()=>({unapprovedDecryptMsgs:{},unapprovedDecryptMsgCount:0}))}clearUnapproved(){this._decryptMessageManager.clearUnapprovedMessages()}async newRequestDecryptMessage(e,t){return this._decryptMessageManager.addUnapprovedMessageAsync(e,t)}async decryptMessage(e){const t=e.metamaskId;try{const s=await this._decryptMessageManager.approveMessage(e);if(s.data=this._parseMessageData(s.data),!p(s))throw new Error("Invalid encrypted data.");const n=await this.messenger.call("KeyringController:decryptMessage",s);this._decryptMessageManager.setMessageStatusAndResult(t,n,"decrypted"),this._acceptApproval(t)}catch(e){throw a.default.info("MetaMaskController - eth_decrypt failed.",e),this._cancelAbstractMessage(this._decryptMessageManager,t),e}return this._getState()}async decryptMessageInline(e){const t=e.metamaskId;if(e.data=this._parseMessageData(e.data),!p(e))throw new Error("Invalid encrypted data.");const s=await this.messenger.call("KeyringController:decryptMessage",e);return this._decryptMessageManager.setResult(t,s),this._getState()}cancelDecryptMessage(e){return this._decryptMessageManager.rejectMessage(e),this._rejectApproval(e),this._getState()}rejectUnapproved(e){Object.keys(this._decryptMessageManager.getUnapprovedMessages()).forEach(t=>{this._cancelAbstractMessage(this._decryptMessageManager,t,e)})}_acceptApproval(e){this.messenger.call("ApprovalController:acceptRequest",e)}_cancelAbstractMessage(e,t,s){return s&&this._metricsEvent({event:s,category:c.MetaMetricsEventCategory.Messages,properties:{action:"Decrypt Message Request"}}),e.rejectMessage(t),this._rejectApproval(t),this._getState()}_subscribeToMessageState(e,t){e.subscribe("DecryptMessageManager:stateChange",e=>{const s=this._migrateMessages(e.unapprovedMessages);this.update(n=>{t(n,s,e.unapprovedMessagesCount)})})}_migrateMessages(e){const t={};for(const s of Object.keys(e)){const n=e[s],a=this._migrateMessage(n);t[s]=a}return t}_migrateMessage(e){const{messageParams:t,...s}=e;return{...s,rawSig:e.rawSig,msgParams:t,origin:t.origin}}_requestApproval(e){const t=e.metamaskId,s=e.origin||i.ORIGIN_METAMASK;try{this.messenger.call("ApprovalController:addRequest",{id:t,origin:s,type:i.ApprovalType.EthDecrypt},!0)}catch(e){a.default.info("Error adding request to approval controller",e)}}_parseMessageData(e){const s=(0,l.stripHexPrefix)(e),n=t.from(s,"hex");return JSON.parse(n.toString("utf8"))}_rejectApproval(e){try{this.messenger.call("ApprovalController:rejectRequest",e,"Cancel")}catch(e){a.default.info("Error rejecting request to approval controller",e)}}}s.default=m}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"$root$",file:"app/scripts/controllers/decrypt-message.ts"}],[231,{"../../../shared/constants/app":6175,"../../../shared/constants/keyring":6186,"../../../shared/constants/metametrics":6190,"@metamask/base-controller":1520,loglevel:5247},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var n,a=(n=e("loglevel"))&&n.__esModule?n:{default:n},r=e("@metamask/base-controller"),i=e("../../../shared/constants/metametrics"),o=e("../../../shared/constants/keyring"),c=e("../../../shared/constants/app");function l(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const u={unapprovedEncryptionPublicKeyMsgs:{includeInStateLogs:!0,persist:!1,includeInDebugSnapshot:!1,usedInUi:!0},unapprovedEncryptionPublicKeyMsgCount:{includeInStateLogs:!0,persist:!1,includeInDebugSnapshot:!1,usedInUi:!0}};class d extends r.BaseController{constructor({messenger:e,manager:t,getEncryptionPublicKey:s,getAccountKeyringType:n,getState:a,metricsEvent:r}){super({name:"EncryptionPublicKeyController",metadata:u,messenger:e,state:{unapprovedEncryptionPublicKeyMsgs:{},unapprovedEncryptionPublicKeyMsgCount:0}}),l(this,"_getEncryptionPublicKey",void 0),l(this,"_getAccountKeyringType",void 0),l(this,"_getState",void 0),l(this,"_encryptionPublicKeyManager",void 0),l(this,"_metricsEvent",void 0),this._getEncryptionPublicKey=s,this._getAccountKeyringType=n,this._getState=a,this._metricsEvent=r,this._encryptionPublicKeyManager=t,this.messenger.subscribe("EncryptionPublicKeyManager:unapprovedMessage",this._requestApproval.bind(this)),this._subscribeToMessageState(e,(e,t,s)=>{e.unapprovedEncryptionPublicKeyMsgs=t,e.unapprovedEncryptionPublicKeyMsgCount=s})}get unapprovedMsgCount(){return this._encryptionPublicKeyManager.getUnapprovedMessagesCount()}resetState(){this.update(()=>({unapprovedEncryptionPublicKeyMsgs:{},unapprovedEncryptionPublicKeyMsgCount:0}))}async newRequestEncryptionPublicKey(e,t){switch(await this._getAccountKeyringType(e)){case o.KeyringType.ledger:return new Promise((e,t)=>{t(new Error("Ledger does not support eth_getEncryptionPublicKey."))});case o.KeyringType.trezor:return new Promise((e,t)=>{t(new Error("Trezor does not support eth_getEncryptionPublicKey."))});case o.KeyringType.lattice:return new Promise((e,t)=>{t(new Error("Lattice does not support eth_getEncryptionPublicKey."))});case o.KeyringType.qr:return Promise.reject(new Error("QR hardware does not support eth_getEncryptionPublicKey."));default:return this._encryptionPublicKeyManager.addUnapprovedMessageAsync({from:e},t)}}async encryptionPublicKey(e){a.default.info("MetaMaskController - encryptionPublicKey");const t=e.metamaskId;try{const s=await this._encryptionPublicKeyManager.approveMessage(e),n=await this._getEncryptionPublicKey(s.from);return this._encryptionPublicKeyManager.setMessageStatusAndResult(t,n,"received"),this._acceptApproval(t),this._getState()}catch(e){throw a.default.info("MetaMaskController - eth_getEncryptionPublicKey failed.",e),this._cancelAbstractMessage(this._encryptionPublicKeyManager,t),e}}cancelEncryptionPublicKey(e){return this._cancelAbstractMessage(this._encryptionPublicKeyManager,e)}rejectUnapproved(e){Object.keys(this._encryptionPublicKeyManager.getUnapprovedMessages()).forEach(t=>{this._cancelAbstractMessage(this._encryptionPublicKeyManager,t,e)})}clearUnapproved(){this._encryptionPublicKeyManager.clearUnapprovedMessages()}_cancelAbstractMessage(e,t,s){return s&&this._metricsEvent({event:s,category:i.MetaMetricsEventCategory.Messages,properties:{action:"Encryption public key Request"}}),e.rejectMessage(t),this._rejectApproval(t),this._getState()}_subscribeToMessageState(e,t){e.subscribe("EncryptionPublicKeyManager:stateChange",e=>{const s=this._migrateMessages(e.unapprovedMessages);this.update(n=>{t(n,s,e.unapprovedMessagesCount)})})}_migrateMessages(e){const t={};for(const s of Object.keys(e)){const n=e[s],a=this._migrateMessage(n);t[s]=a}return t}_migrateMessage(e){const{messageParams:t,...s}=e;return{...s,rawSig:e.rawSig,msgParams:t.from,origin:t.origin}}_requestApproval(e){const t=e.metamaskId,s=e.origin||c.ORIGIN_METAMASK;this.messenger.call("ApprovalController:addRequest",{id:t,origin:s,type:"eth_getEncryptionPublicKey"},!0).catch(()=>{})}_acceptApproval(e){this.messenger.call("ApprovalController:acceptRequest",e)}_rejectApproval(e){this.messenger.call("ApprovalController:rejectRequest",e,"Cancel")}}s.default=d}}},{package:"$root$",file:"app/scripts/controllers/encryption-public-key.ts"}],[2316,{"./onekey-keyring.cjs":2317,"./trezor-connect-bridge.cjs":2318,"./trezor-keyring.cjs":2319},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){n===undefined&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){n===undefined&&(n=s),e[n]=t[s]}),a=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||n(t,e,s)};Object.defineProperty(s,"__esModule",{value:!0}),a(e("./trezor-keyring.cjs"),s),a(e("./onekey-keyring.cjs"),s),a(e("./trezor-connect-bridge.cjs"),s)}}},{package:"@metamask/eth-trezor-keyring",file:"node_modules/@metamask/eth-trezor-keyring/dist/index.cjs"}],[2317,{"./trezor-keyring.cjs":2319},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.OneKeyKeyring=void 0;const n=e("./trezor-keyring.cjs"),a="OneKey Hardware";class r extends n.TrezorKeyring{constructor(){super(...arguments),this.type=a}}s.OneKeyKeyring=r,r.type=a}}},{package:"@metamask/eth-trezor-keyring",file:"node_modules/@metamask/eth-trezor-keyring/dist/onekey-keyring.cjs"}],[2318,{"@trezor/connect-web":3679},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){n===undefined&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){n===undefined&&(n=s),e[n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t};Object.defineProperty(s,"__esModule",{value:!0}),s.TrezorConnectBridge=void 0;const i=r(e("@trezor/connect-web"));s.TrezorConnectBridge=class{constructor(){this.trezorConnectInitiated=!1}async init(e){i.default.on(i.DEVICE_EVENT,e=>{var t;e.type===i.DEVICE.CONNECT&&(this.model=null===(t=e.payload.features)||void 0===t?void 0:t.model)}),this.trezorConnectInitiated||(await i.default.init(e),this.trezorConnectInitiated=!0)}async dispose(){return i.default.dispose(),Promise.resolve()}getPublicKey(e){return i.default.getPublicKey(e)}ethereumSignTransaction(e){return i.default.ethereumSignTransaction(e)}ethereumSignMessage(e){return i.default.ethereumSignMessage(e)}ethereumSignTypedData(e){return i.default.ethereumSignTypedData(e)}}}}},{package:"@metamask/eth-trezor-keyring",file:"node_modules/@metamask/eth-trezor-keyring/dist/trezor-connect-bridge.cjs"}],[2319,{"@ethereumjs/tx":696,"@ethereumjs/util":717,"@metamask/eth-sig-util":2228,"@metamask/utils":3554,"@trezor/connect-plugin-ethereum":3670,buffer:4474,hdkey:4997},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){(function(t){(function(){var n,a,r,i,o,c,l=this&&this.__classPrivateFieldGet||function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(s,"__esModule",{value:!0}),s.TrezorKeyring=s.TREZOR_CONNECT_MANIFEST=void 0;const d=e("@ethereumjs/tx"),p=e("@ethereumjs/util"),h=e("@metamask/eth-sig-util"),m=e("@metamask/utils"),g=e("@trezor/connect-plugin-ethereum"),f=u(e("hdkey")),w="m/44'/60'/0'/0",v="m/44'/1'/0'/0",y="m/44'/60'/0'",S={[w]:!0,[y]:!0,[v]:!0},b="Trezor Hardware",k=1e3;async function T(e){return new Promise(t=>setTimeout(t,e))}function A(e){return"function"==typeof e.getChainId}s.TREZOR_CONNECT_MANIFEST={appName:"MetaMask",email:"support@metamask.io",appUrl:"https://metamask.io"};class _{constructor({bridge:e}){if(n.add(this),this.type=b,this.accounts=[],this.hdk=new f.default,this.hdPath=w,this.page=0,this.perPage=5,this.unlockedAccount=0,this.paths={},!e)throw new Error("Bridge is a required dependency for the keyring");this.bridge=e}getModel(){return this.bridge.model}async init(){return this.bridge.init({manifest:s.TREZOR_CONNECT_MANIFEST,lazyLoad:!0})}async destroy(){return this.bridge.dispose()}async serialize(){return Promise.resolve({hdPath:this.hdPath,accounts:this.accounts.slice(),page:this.page,paths:this.paths,perPage:this.perPage,unlockedAccount:this.unlockedAccount})}async deserialize(e){var t,s,n,a;return this.hdPath=null!==(t=e.hdPath)&&void 0!==t?t:w,this.accounts=null!==(s=e.accounts)&&void 0!==s?s:[],this.page=null!==(n=e.page)&&void 0!==n?n:0,this.perPage=null!==(a=e.perPage)&&void 0!==a?a:5,Promise.resolve()}isUnlocked(){var e;return Boolean(null===(e=this.hdk)||void 0===e?void 0:e.publicKey)}async unlock(){return this.isUnlocked()?Promise.resolve("already unlocked"):new Promise((e,s)=>{this.bridge.getPublicKey({path:this.hdPath,coin:"ETH"}).then(n=>{var a;n.success?(this.hdk.publicKey=t.from(n.payload.publicKey,"hex"),this.hdk.chainCode=t.from(n.payload.chainCode,"hex"),e("just unlocked")):s(new Error((null===(a=n.payload)||void 0===a?void 0:a.error)||"Unknown error"))}).catch(e=>{s(new Error((null==e?void 0:e.toString())||"Unknown error"))})})}setAccountToUnlock(e){this.unlockedAccount=parseInt(String(e),10)}async addAccounts(e){return new Promise((t,s)=>{this.unlock().then(s=>{const a=this.unlockedAccount,r=a+e,i=[];for(let e=a;e<r;e++){const t=l(this,n,"m",o).call(this,"m",e);this.accounts.includes(t)||(this.accounts=[...this.accounts,t],i.push(t)),this.page=0}t(i)}).catch(e=>{s(e)})})}async getFirstPage(){return this.page=0,l(this,n,"m",a).call(this,1)}async getNextPage(){return l(this,n,"m",a).call(this,1)}async getPreviousPage(){return l(this,n,"m",a).call(this,-1)}async getAccounts(){return Promise.resolve(this.accounts.slice())}removeAccount(e){if(!this.accounts.map(e=>e.toLowerCase()).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter(t=>t.toLowerCase()!==e.toLowerCase())}async signTransaction(e,s){return A(s)?l(this,n,"m",r).call(this,e,s.getChainId(),s,e=>(s.v=t.from(e.v,"hex"),s.r=t.from(e.r,"hex"),s.s=t.from(e.s,"hex"),s)):l(this,n,"m",r).call(this,e,Number(s.common.chainId()),s,e=>{const t=s.toJSON();return t.type=s.type,t.v=(0,m.add0x)(e.v),t.r=(0,m.add0x)(e.r),t.s=(0,m.add0x)(e.s),d.TransactionFactory.fromTxData(t,{common:s.common,freeze:Object.isFrozen(s)})})}async signMessage(e,t){return this.signPersonalMessage(e,t)}async signPersonalMessage(e,t){return new Promise((s,a)=>{this.unlock().then(r=>{setTimeout(()=>{this.bridge.ethereumSignMessage({path:l(this,n,"m",c).call(this,e),message:(0,m.remove0x)(t),hex:!0}).then(t=>{var n;if(t.success){t.payload.address!==(0,m.getChecksumAddress)(e)&&a(new Error("signature doesnt match the right address"));const n=`0x${t.payload.signature}`;s(n)}else a(new Error((null===(n=t.payload)||void 0===n?void 0:n.error)||"Unknown error"))}).catch(e=>{a(new Error((null==e?void 0:e.toString())||"Unknown error"))})},"just unlocked"===r?k:0)}).catch(e=>{a(new Error((null==e?void 0:e.toString())||"Unknown error"))})})}async signTypedData(e,t,s){var a,r;const{version:i}=null!=s?s:{version:h.SignTypedDataVersion.V4},o=(0,g.transformTypedData)(t,i===h.SignTypedDataVersion.V4),{types:u,message:d={},domain:p={},primaryType:f,domain_separator_hash:w,message_hash:v}=o,y=await this.unlock();await T("just unlocked"===y?k:0);const S=await this.bridge.ethereumSignTypedData({path:l(this,n,"m",c).call(this,e),data:{types:Object.assign(Object.assign({},u),{EIP712Domain:null!==(a=u.EIP712Domain)&&void 0!==a?a:[]}),message:d,domain:p,primaryType:f},metamask_v4_compat:!0,domain_separator_hash:w,message_hash:null!=v?v:""});if(S.success){if((0,m.getChecksumAddress)(e)!==S.payload.address)throw new Error("signature doesnt match the right address");return S.payload.signature}throw new Error((null===(r=S.payload)||void 0===r?void 0:r.error)||"Unknown error")}forgetDevice(){this.accounts=[],this.hdk=new f.default,this.page=0,this.unlockedAccount=0,this.paths={}}setHdPath(e){if(!S[e])throw new Error(`The setHdPath method does not support setting HD Path to ${e}`);this.hdPath!==e&&(this.hdk=new f.default,this.accounts=[],this.page=0,this.perPage=5,this.unlockedAccount=0,this.paths={}),this.hdPath=e}}s.TrezorKeyring=_,n=new WeakSet,a=async function(e){return this.page+=e,this.page<=0&&(this.page=1),new Promise((e,t)=>{this.unlock().then(t=>{const s=(this.page-1)*this.perPage,a=s+this.perPage,r=[];for(let e=s;e<a;e++){const t=l(this,n,"m",o).call(this,"m",e);r.push({address:t,balance:null,index:e}),this.paths[(0,m.getChecksumAddress)(t)]=e}e(r)}).catch(e=>{t(e)})})},r=async function(e,s,a,r){var o,u,d,p;let h;h=A(a)?{to:l(this,n,"m",i).call(this,a.to),value:l(this,n,"m",i).call(this,a.value),data:l(this,n,"m",i).call(this,a.data),chainId:s,nonce:l(this,n,"m",i).call(this,a.nonce),gasLimit:l(this,n,"m",i).call(this,a.gasLimit),gasPrice:l(this,n,"m",i).call(this,a.gasPrice)}:Object.assign(Object.assign({},a.toJSON()),{chainId:s,to:l(this,n,"m",i).call(this,t.from(null!==(u=null===(o=a.to)||void 0===o?void 0:o.bytes)&&void 0!==u?u:[]))});try{const t=await this.unlock();await T("just unlocked"===t?k:0);const s=await this.bridge.ethereumSignTransaction({path:l(this,n,"m",c).call(this,e),transaction:h});if(s.success){const t=r(s.payload),n=(0,m.getChecksumAddress)((0,m.add0x)(t.getSenderAddress().toString("hex")));if(n!==(0,m.getChecksumAddress)(e))throw new Error("signature doesn't match the right address");return t}throw new Error((null===(d=s.payload)||void 0===d?void 0:d.error)||"Unknown error")}catch(e){throw new Error(null!==(p=null==e?void 0:e.toString())&&void 0!==p?p:"Unknown error")}},i=function(e){return(0,m.bytesToHex)(e)},o=function(e,t){const s=this.hdk.derive(`${e}/${t}`),n=(0,m.bytesToHex)((0,p.publicToAddress)(s.publicKey,!0));return(0,p.toChecksumAddress)(n)},c=function(e){const t=(0,m.getChecksumAddress)(e);let s=this.paths[t];if(void 0===s)for(let e=0;e<1e3;e++)if(t===l(this,n,"m",o).call(this,"m",e)){s=e;break}if(void 0===s)throw new Error("Unknown address");return`${this.hdPath}/${s}`},_.type=b}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-trezor-keyring",file:"node_modules/@metamask/eth-trezor-keyring/dist/trezor-keyring.cjs"}],[232,{"../../../../shared/lib/accounts/institutional-wallet-snap":6220,"@metamask/base-controller":1520,"@metamask/controller-utils":1639,"@metamask/snaps-utils":3382,"@metamask/transaction-controller":3473},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.InstitutionalSnapController=void 0;var n=e("@metamask/transaction-controller"),a=e("@metamask/snaps-utils"),r=e("@metamask/base-controller"),i=e("@metamask/controller-utils");function o(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function c(e,t,s){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:s;throw new TypeError("Private element is not present on this object")}const l=e("../../../../shared/lib/accounts/institutional-wallet-snap").INSTITUTIONAL_WALLET_SNAP_ID,u="InstitutionalSnapController",d={};var p=new WeakSet;class h extends r.BaseController{constructor({messenger:e}){super({messenger:e,name:u,state:{},metadata:d}),o(this,p),c(p,this,m).call(this)}async deferPublicationHook(e){if(await c(p,this,v).call(this,e)){const t=await c(p,this,f).call(this,e);return await c(p,this,w).call(this,e.id,t),!1}return!0}async beforeCheckPendingTransactionHook(e){return!await c(p,this,v).call(this,e)}}function m(){this.messenger.registerActionHandler(`${u}:publishHook`,this.deferPublicationHook.bind(this)),this.messenger.registerActionHandler(`${u}:beforeCheckPendingTransactionHook`,this.beforeCheckPendingTransactionHook.bind(this))}async function g(e){return await this.messenger.call("SnapController:handleRequest",e)}async function f(e){const t={from:e.txParams.from,to:e.txParams.to,value:e.txParams.value,data:e.txParams.data,chainId:e.chainId},s={snapId:l,origin:i.ORIGIN_METAMASK,handler:a.HandlerType.OnRpcRequest,request:{method:"transactions.getMutableTransactionParameters",params:t}},r=await c(p,this,g).call(this,s);return{hash:r.transaction.transactionHash,nonce:r.transaction.nonce,gasLimit:r.transaction.gasLimit,maxFeePerGas:r.transaction.maxFeePerGas,maxPriorityFeePerGas:r.transaction.maxPriorityFeePerGas,type:r.transaction.type,status:n.TransactionStatus.submitted}}async function w(e,{status:t,hash:s,nonce:n,gasLimit:a,maxFeePerGas:r,maxPriorityFeePerGas:i,type:o}){return await this.messenger.call("TransactionController:updateCustodialTransaction",{transactionId:e,status:t,hash:s,nonce:n,gasLimit:a,maxFeePerGas:r,maxPriorityFeePerGas:i,type:o})}async function v(e){var t;const s=await this.messenger.call("AccountsController:getAccountByAddress",e.txParams.from);return null==s||null===(t=s.options.custodian)||void 0===t?void 0:t.deferPublication}s.InstitutionalSnapController=h}}},{package:"$root$",file:"app/scripts/controllers/institutional-snap/InstitutionalSnapController.ts"}],[233,{"../../../development/build/constants":623,"../../../shared/constants/alarms":6172,"../../../shared/constants/app":6175,"../../../shared/constants/keyring":6186,"../../../shared/constants/metametrics":6190,"../../../shared/constants/time":6211,"../../../shared/constants/transaction":6213,"../../../shared/lib/trace":6299,"../../../shared/modules/mv3.utils":6327,"../lib/util":380,"@metamask/base-controller":1520,"@metamask/name-controller":2739,"@metamask/utils":3554,buffer:4474,"ethereum-cryptography/keccak":4718,lodash:5239,uuid:6134},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){(function(t){(function(){Object.defineProperty(s,"__esModule",{value:!0}),s.overrideAnonymousEventNames=s.getDefaultMetaMetricsControllerState=s.default=void 0;var n=e("lodash"),a=e("ethereum-cryptography/keccak"),r=e("uuid"),i=e("@metamask/name-controller"),o=e("@metamask/utils"),c=e("@metamask/base-controller"),l=e("../../../shared/constants/app"),u=e("../../../shared/constants/metametrics"),d=e("../../../shared/constants/time"),p=e("../../../shared/modules/mv3.utils"),h=e("../../../shared/constants/alarms"),m=e("../lib/util"),g=e("../../../shared/constants/transaction"),f=e("../../../shared/lib/trace"),w=e("../../../development/build/constants"),v=e("../../../shared/constants/keyring");function y(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function S(e,t,s){b(e,t),t.set(e,s)}function b(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function k(e,t){return e.get(A(e,t))}function T(e,t,s){return e.set(A(e,t),s),s}function A(e,t,s){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:s;throw new TypeError("Private element is not present on this object")}const _=s.overrideAnonymousEventNames={[g.TransactionMetaMetricsEvent.added]:g.AnonymousTransactionMetaMetricsEvent.added,[g.TransactionMetaMetricsEvent.approved]:g.AnonymousTransactionMetaMetricsEvent.approved,[g.TransactionMetaMetricsEvent.finalized]:g.AnonymousTransactionMetaMetricsEvent.finalized,[g.TransactionMetaMetricsEvent.rejected]:g.AnonymousTransactionMetaMetricsEvent.rejected,[g.TransactionMetaMetricsEvent.submitted]:g.AnonymousTransactionMetaMetricsEvent.submitted,[u.MetaMetricsEventName.SignatureRequested]:u.MetaMetricsEventName.SignatureRequestedAnon,[u.MetaMetricsEventName.SignatureApproved]:u.MetaMetricsEventName.SignatureApprovedAnon,[u.MetaMetricsEventName.SignatureRejected]:u.MetaMetricsEventName.SignatureRejectedAnon},E=e=>{setTimeout(()=>{throw e})},M=e=>{const t=[];return e.uniqueIdentifier&&t.push(e.uniqueIdentifier),e.actionId&&t.push(e.actionId),t.length&&e.isDuplicateAnonymizedEvent&&t.push("0x000"),t.length?t.join("-"):(0,m.generateRandomId)()},I={'You must pass either an "anonymousId" or a "userId".':!0},P={metaMetricsId:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},participateInMetaMetrics:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},latestNonAnonymousEventTimestamp:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},fragments:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},eventsBeforeMetricsOptIn:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!1},tracesBeforeMetricsOptIn:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!1},traits:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!1},dataCollectionForMarketing:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},marketingCampaignCookieId:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!1},segmentApiCalls:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!1}},C=()=>({participateInMetaMetrics:null,metaMetricsId:null,dataCollectionForMarketing:null,marketingCampaignCookieId:null,latestNonAnonymousEventTimestamp:0,eventsBeforeMetricsOptIn:[],tracesBeforeMetricsOptIn:[],traits:{},fragments:{},segmentApiCalls:{}});s.getDefaultMetaMetricsControllerState=C;var j=new WeakMap,O=new WeakMap,N=new WeakMap,R=new WeakMap,D=new WeakSet,F=new WeakMap;class x extends c.BaseController{constructor({state:e={},messenger:t,segment:s,version:a,environment:r,extension:i,captureException:c=E}){var l,u;super({name:"MetaMetricsController",metadata:P,state:{participateInMetaMetrics:null,metaMetricsId:null,dataCollectionForMarketing:null,marketingCampaignCookieId:null,latestNonAnonymousEventTimestamp:0,eventsBeforeMetricsOptIn:[],tracesBeforeMetricsOptIn:[],traits:{},fragments:{},segmentApiCalls:{},...e},messenger:t}),b(l=this,u=D),u.add(l),S(this,j,void 0),y(this,"chainId",void 0),y(this,"locale",void 0),y(this,"previousUserTraits",void 0),y(this,"version",void 0),S(this,O,void 0),S(this,N,void 0),S(this,R,void 0),S(this,F,(0,n.memoize)((e={})=>Object.values(e).reduce((e,t)=>e.concat(...Object.values(t)),[]))),T(j,this,e=>{const t=(0,o.getErrorMessage)(e);I[t]||c(e)}),this.chainId=A(D,this,B).call(this);const g=this.messenger.call("PreferencesController:getState");this.locale=g.currentLocale.replace("_","-"),this.version="production"===r?a:`${a}-${r}`,T(O,this,i),T(N,this,r),this.messenger.registerActionHandler("MetaMetricsController:trackEvent",this.trackEvent.bind(this)),this.messenger.registerActionHandler("MetaMetricsController:getMetaMetricsId",this.getMetaMetricsId.bind(this)),this.messenger.registerActionHandler("MetaMetricsController:createEventFragment",this.createEventFragment.bind(this)),this.messenger.registerActionHandler("MetaMetricsController:getEventFragmentById",this.getEventFragmentById.bind(this)),this.messenger.registerActionHandler("MetaMetricsController:updateEventFragment",this.updateEventFragment.bind(this)),this.messenger.registerActionHandler("MetaMetricsController:deleteEventFragment",this.deleteEventFragment.bind(this)),this.messenger.registerActionHandler("MetaMetricsController:finalizeEventFragment",this.finalizeEventFragment.bind(this));const f=(0,n.omitBy)(e.fragments,"persist");this.messenger.subscribe("PreferencesController:stateChange",({currentLocale:e})=>{this.locale=null==e?void 0:e.replace("_","-")}),this.messenger.subscribe("NetworkController:networkDidChange",({selectedNetworkClientId:e})=>{this.chainId=A(D,this,B).call(this,e)}),T(R,this,s),Object.values(f).forEach(e=>{this.processAbandonedFragment(e)}),p.isManifestV3&&Object.values(e.segmentApiCalls||{}).forEach(({eventType:e,payload:t})=>{try{A(D,this,Y).call(this,e,t)}catch(e){k(j,this).call(this,e)}}),p.isManifestV3?(k(O,this).alarms.getAll().then(e=>{(0,m.checkAlarmExists)(e,h.METAMETRICS_FINALIZE_EVENT_FRAGMENT_ALARM)||k(O,this).alarms.create(h.METAMETRICS_FINALIZE_EVENT_FRAGMENT_ALARM,{delayInMinutes:1,periodInMinutes:1})}),k(O,this).alarms.onAlarm.addListener(e=>{e.name===h.METAMETRICS_FINALIZE_EVENT_FRAGMENT_ALARM&&this.finalizeAbandonedFragments()})):setInterval(()=>{this.finalizeAbandonedFragments()},30*d.SECOND)}finalizeAbandonedFragments(){Object.values(this.state.fragments).forEach(e=>{e.timeout&&e.lastUpdated&&Date.now()-e.lastUpdated/1e3>e.timeout&&this.processAbandonedFragment(e)})}generateMetaMetricsId(){return(0,o.bytesToHex)((0,a.keccak256)(t.from(String(Date.now())+String(Math.round(Math.random()*Number.MAX_SAFE_INTEGER)))))}createEventFragment(e){if(!e.successEvent)throw new Error(`Must specify success event. Success event was: ${e.event}. Payload keys were: ${Object.keys(e)}. ${"object"==typeof e.properties?`Payload property keys were: ${Object.keys(e.properties)}`:""}`);const{fragments:t}=this.state,s=e.uniqueIdentifier??(0,r.v4)(),a={id:s,...e,lastUpdated:Date.now()},i=e.initialEvent===g.TransactionMetaMetricsEvent.submitted&&t[s]?{...t[s],canDeleteIfAbandoned:!1}:{};return this.update(e=>{e.fragments[s]=(0,n.merge)({},i,a)}),a.initialEvent&&this.trackEvent({event:a.initialEvent,category:a.category,properties:a.properties,sensitiveProperties:a.sensitiveProperties,page:a.page,referrer:a.referrer,revenue:a.revenue,value:a.value,currency:a.currency,environmentType:a.environmentType,actionId:e.actionId,uniqueIdentifier:e.uniqueIdentifier}),a}getEventFragmentById(e){return this.state.fragments[e]}processAbandonedFragment(e){e.canDeleteIfAbandoned?this.deleteEventFragment(e.id):this.finalizeEventFragment(e.id,{abandoned:!0})}updateEventFragment(e,t){const{fragments:s}=this.state,a=s[e];if(!a&&e.includes("transaction-submitted-"))this.update(s=>{s.fragments[e]={canDeleteIfAbandoned:!0,category:u.MetaMetricsEventCategory.Transactions,successEvent:g.TransactionMetaMetricsEvent.finalized,id:e,...t,lastUpdated:Date.now()}});else{if(!a)throw new Error(`Event fragment with id ${e} does not exist.`);this.update(s=>{s.fragments[e]=(0,n.merge)(s.fragments[e],{...t,lastUpdated:Date.now()})})}}deleteEventFragment(e){this.state.fragments[e]&&this.update(t=>{delete t.fragments[e]})}finalizeEventFragment(e,{abandoned:t=!1,page:s,referrer:n}={}){const a=this.state.fragments[e];if(!a)throw new Error(`Funnel with id ${e} does not exist.`);const r=t?a.failureEvent:a.successEvent;this.trackEvent({event:r??"",category:a.category,properties:a.properties,sensitiveProperties:a.sensitiveProperties,page:s??a.page,referrer:a.referrer??n,revenue:a.revenue,value:a.value,currency:a.currency,environmentType:a.environmentType,actionId:a.actionId,uniqueIdentifier:a.uniqueIdentifier?`${a.uniqueIdentifier}-${t?"failure":"success"}`:undefined}),this.update(t=>{delete t.fragments[e]})}identify(e){const{metaMetricsId:t,participateInMetaMetrics:s}=this.state;if(!s||!t||!e)return;if("object"!=typeof e)return void console.warn("MetaMetricsController#identify: userTraits parameter must be an object. Received type: "+typeof e);const n=A(D,this,W).call(this,e);A(D,this,V).call(this,n)}updateExtensionUninstallUrl(e,s){const n={av:this.version};e&&(n.mmi=t.from(s).toString("base64"),n.env=k(N,this));const a=new URLSearchParams(n);k(O,this)&&k(O,this).runtime&&k(O,this).runtime.setUninstallURL(`https://metamask.io/uninstalled?${a}`)}async setParticipateInMetaMetrics(e){const{metaMetricsId:t}=this.state,s=t??this.generateMetaMetricsId();return this.update(t=>{t.participateInMetaMetrics=e,t.metaMetricsId=s}),e?(this.trackEventsAfterMetricsOptIn(),this.clearEventsAfterMetricsOptIn(),this.trackTracesAfterMetricsOptIn(),this.clearTracesAfterMetricsOptIn()):this.state.marketingCampaignCookieId&&this.setMarketingCampaignCookieId(null),k(N,this)!==w.ENVIRONMENT.DEVELOPMENT&&null!==s&&null!==e&&this.updateExtensionUninstallUrl(e,s),s}setDataCollectionForMarketing(e){const{metaMetricsId:t}=this.state;return this.update(t=>{t.dataCollectionForMarketing=e}),!e&&this.state.marketingCampaignCookieId&&this.setMarketingCampaignCookieId(null),t}setMarketingCampaignCookieId(e){this.update(t=>{t.marketingCampaignCookieId=e})}trackPage(e,t){try{if(!1===this.state.participateInMetaMetrics)return;if(null===this.state.participateInMetaMetrics&&(null==t||!t.isOptInPath))return;const{name:s,params:n,environmentType:a,page:r,referrer:i,actionId:o}=e,{metaMetricsId:c}=this.state,l=c?"userId":"anonymousId",d=c??u.METAMETRICS_ANONYMOUS_ID;A(D,this,Y).call(this,"page",{messageId:M({actionId:o}),[l]:d,name:s,properties:{params:n,locale:this.locale,chain_id:this.chainId,environment_type:a},context:A(D,this,G).call(this,i,r)})}catch(e){k(j,this).call(this,e)}}trackEvent(e,t){A(D,this,U).call(this,e),A(D,this,L).call(this,e,t).catch(e=>{k(j,this).call(this,e)})}handleMetaMaskStateUpdate(e){const t=this._buildUserTraitsObject(e);t&&this.identify(t)}trackEventsAfterMetricsOptIn(){const{eventsBeforeMetricsOptIn:e}=this.state;e.forEach(e=>{this.trackEvent(e)})}clearEventsAfterMetricsOptIn(){this.update(e=>{e.eventsBeforeMetricsOptIn=[]})}addEventBeforeMetricsOptIn(e){this.update(t=>{t.eventsBeforeMetricsOptIn.push(e)})}trackTracesAfterMetricsOptIn(){const{tracesBeforeMetricsOptIn:e}=this.state;e.forEach(e=>{"start"===e.type?(0,f.trace)(e.request):"end"===e.type&&(0,f.endTrace)(e.request)})}clearTracesAfterMetricsOptIn(){this.update(e=>{e.tracesBeforeMetricsOptIn=[]})}addTraceBeforeMetricsOptIn(e){this.update(t=>{t.tracesBeforeMetricsOptIn.push(e)})}bufferedTrace(e,t){if(this.state.participateInMetaMetrics)return t?(0,f.trace)(e,t):(0,f.trace)(e);let s;if(e.parentContext&&"object"==typeof e.parentContext){const t=e.parentContext;s=null==t?void 0:t._name}return this.addTraceBeforeMetricsOptIn({type:"start",request:{...e,parentContext:undefined,startTime:e.startTime??Date.now()},parentTraceName:s}),undefined}bufferedEndTrace(e){this.state.participateInMetaMetrics?(0,f.endTrace)(e):this.addTraceBeforeMetricsOptIn({type:"end",request:{...e,timestamp:e.timestamp??Date.now()}})}updateTraits(e){this.update(t=>{t.traits={...t.traits,...e}})}getMetaMetricsId(){let{metaMetricsId:e}=this.state;return e||(e=this.generateMetaMetricsId(),this.update(t=>{t.metaMetricsId=e})),e}_buildUserTraitsObject(e){var t,s,a;const{traits:r}=this.state,i=r[u.MetaMetricsUserTrait.StorageKind],o={[u.MetaMetricsUserTrait.AddressBookEntries]:(0,n.sum)(Object.values(e.addressBook).map(n.size)),[u.MetaMetricsUserTrait.InstallDateExt]:r[u.MetaMetricsUserTrait.InstallDateExt]||"",...i?{[u.MetaMetricsUserTrait.StorageKind]:i}:{},[u.MetaMetricsUserTrait.LedgerConnectionType]:e.ledgerTransportType,[u.MetaMetricsUserTrait.NetworksAdded]:Object.values(e.networkConfigurationsByChainId).map(e=>e.chainId),[u.MetaMetricsUserTrait.NetworksWithoutTicker]:Object.values(e.networkConfigurationsByChainId).filter(({nativeCurrency:e})=>!e).map(({chainId:e})=>e),[u.MetaMetricsUserTrait.ChainIdList]:[...Object.keys(e.networkConfigurationsByChainId).map(e=>`eip155:${parseInt(e,16)}`),...Object.keys((null==e?void 0:e.multichainNetworkConfigurationsByChainId)||{})],[u.MetaMetricsUserTrait.NftAutodetectionEnabled]:e.useNftDetection,[u.MetaMetricsUserTrait.NumberOfAccounts]:Object.values(e.internalAccounts.accounts).length,[u.MetaMetricsUserTrait.NumberOfNftCollections]:A(D,this,H).call(this,e.allNfts),[u.MetaMetricsUserTrait.NumberOfNfts]:k(F,this).call(this,e.allNfts).length,[u.MetaMetricsUserTrait.NumberOfTokens]:A(D,this,q).call(this,e.allTokens),[u.MetaMetricsUserTrait.NumberOfHDEntropies]:A(D,this,K).call(this,e)??(null===(t=this.previousUserTraits)||void 0===t?void 0:t.number_of_hd_entropies),[u.MetaMetricsUserTrait.OpenSeaApiEnabled]:e.openSeaEnabled,[u.MetaMetricsUserTrait.ThreeBoxEnabled]:!1,[u.MetaMetricsUserTrait.Theme]:e.theme||"default",[u.MetaMetricsUserTrait.TokenDetectionEnabled]:e.useTokenDetection,[u.MetaMetricsUserTrait.ShowNativeTokenAsMainBalance]:e.preferences.showNativeTokenAsMainBalance,[u.MetaMetricsUserTrait.CurrentCurrency]:e.currentCurrency,[u.MetaMetricsUserTrait.SecurityProviders]:e.securityAlertsEnabled?["blockaid"]:[],[u.MetaMetricsUserTrait.PetnameAddressCount]:A(D,this,Z).call(this,e),[u.MetaMetricsUserTrait.IsMetricsOptedIn]:e.participateInMetaMetrics,[u.MetaMetricsUserTrait.HasMarketingConsent]:e.dataCollectionForMarketing,[u.MetaMetricsUserTrait.TokenSortPreference]:(null===(s=e.preferences.tokenSortConfig)||void 0===s?void 0:s.key)||"",[u.MetaMetricsUserTrait.PrivacyModeEnabled]:e.preferences.privacyMode,[u.MetaMetricsUserTrait.NetworkFilterPreference]:Object.keys(e.preferences.tokenNetworkFilter||{}),[u.MetaMetricsUserTrait.ProfileId]:null===(a=Object.entries(e.srpSessionData||{}))||void 0===a||null===(a=a[0])||void 0===a||null===(a=a[1])||void 0===a||null===(a=a.profile)||void 0===a?void 0:a.profileId,[u.MetaMetricsUserTrait.Platform]:(0,m.getPlatform)(),[u.MetaMetricsUserTrait.InstallType]:(0,m.getInstallType)()};if(!this.previousUserTraits&&e.participateInMetaMetrics)return this.previousUserTraits=o,o;if(this.previousUserTraits&&!(0,n.isEqual)(this.previousUserTraits,o)){const t=(0,n.pickBy)(o,(e,t)=>{const s=this.previousUserTraits[t];return!(0,n.isEqual)(s,e)});return e.participateInMetaMetrics&&(this.previousUserTraits=o),t}return null}}function B(e){const t=e||this.messenger.call("NetworkController:getState").selectedNetworkClientId,{configuration:{chainId:s}}=this.messenger.call("NetworkController:getNetworkClientById",t);return s}async function L(e,t){const{useExternalServices:s}=this.messenger.call("PreferencesController:getState");if(!s)return;const{participateInMetaMetrics:a,metaMetricsId:r}=this.state;if(!(a||null!=t&&t.isOptIn))return;e.event===u.MetaMetricsEventName.MetricsOptOut&&null!=t&&t.isOptIn&&(t.metaMetricsId=r??undefined);const i=[];if(e.sensitiveProperties){if(!0===(null==t?void 0:t.excludeMetaMetricsId))throw new Error("sensitiveProperties was specified in an event payload that also set the excludeMetaMetricsId flag");const s=_[`${e.event}`],a={...e,event:s??e.event},r=(0,n.merge)({...a.sensitiveProperties},{...a.properties});i.push(A(D,this,X).call(this,A(D,this,$).call(this,{...a,properties:r,isDuplicateAnonymizedEvent:!0}),{...t,excludeMetaMetricsId:!0}))}i.push(A(D,this,X).call(this,A(D,this,$).call(this,e),t)),await Promise.all(i)}function U(e){if(!e.event)throw new Error(`Must specify event. Event was: ${e.event}. Payload keys were: ${Object.keys(e)}. ${"object"==typeof e.properties?`Payload property keys were: ${Object.keys(e.properties)}`:""}`)}function G(e,t=u.METAMETRICS_BACKGROUND_PAGE_OBJECT){return{app:{name:"MetaMask Extension",version:this.version},userAgent:window.navigator.userAgent,page:t,referrer:e,marketingCampaignCookieId:this.state.marketingCampaignCookieId}}function $(e){const{event:t,properties:s,revenue:a,value:r,currency:i,category:o,page:c,referrer:u,environmentType:d=l.ENVIRONMENT_TYPE_BACKGROUND,timestamp:p}=e;let h;return h=s&&"chain_id_caip"in s&&"string"==typeof s.chain_id_caip?null:s&&"chain_id"in s&&"string"==typeof s.chain_id?s.chain_id:this.chainId,{event:t,messageId:M(e),properties:{...(0,n.omit)(s,["revenue","locale","currency","value"]),revenue:a,value:r,currency:i,category:o,locale:this.locale,chain_id:h,environment_type:d},context:A(D,this,G).call(this,u,c),timestamp:p}}function W(e){const t={};for(const[s,n]of Object.entries(e))A(D,this,J).call(this,n)?t[s]=n.toISOString():A(D,this,z).call(this,n)?t[s]=n:console.warn(`MetaMetricsController: "${s}" value is not a valid trait type`);return t}function H(e={}){const t=k(F,this).call(this,e).map(e=>e.address);return new Set(t).size}function q(e){return Object.values(e).reduce((e,t)=>e+(0,n.sum)(Object.values(t).map(n.size)),0)}function K(e){var t;return(null===(t=e.keyrings)||void 0===t?void 0:t.filter(e=>e.type===v.KeyringType.hdKeyTree).length)??0}function V(e){const{metaMetricsId:t}=this.state;if(e&&0!==Object.keys(e).length)try{A(D,this,Y).call(this,"identify",{userId:t??undefined,traits:e})}catch(e){k(j,this).call(this,e)}else console.warn("MetaMetricsController#_identify: No userTraits found")}function z(e){const t=typeof e;return"string"===t||"boolean"===t||"number"===t||A(D,this,Q).call(this,e)||A(D,this,J).call(this,e)}function Q(e){return Array.isArray(e)&&(e.every(e=>"string"==typeof e)||e.every(e=>"boolean"==typeof e)||e.every(e=>"number"==typeof e))}function J(e){return"[object Date]"===Object.prototype.toString.call(e)}function X(e,t){const{isOptIn:s,metaMetricsId:n,matomoEvent:a,flushImmediately:r}=t||{};let i="userId",c=this.state.metaMetricsId,l=(null==t?void 0:t.excludeMetaMetricsId)??!1;const d=Boolean(e.event.match(/^send|^confirm/iu));return!1!==(null==t?void 0:t.excludeMetaMetricsId)&&d&&(l=!0),l||s&&!n?(i="anonymousId",c=u.METAMETRICS_ANONYMOUS_ID):s&&n&&(c=n),e[i]=c??undefined,!0===a&&(e.properties.legacy_event=!0),new Promise((t,s)=>{A(D,this,Y).call(this,"track",e,e=>{if(e){const t=(0,o.isErrorWithMessage)(e)?e.message:"",n=(0,o.isErrorWithStack)(e)?e.stack:undefined,a=new Error(t);return n&&(a.stack=n),s(a)}return t()}),r&&k(R,this).flush()})}function Y(e,t,s){const{useExternalServices:n}=this.messenger.call("PreferencesController:getState");if(!n)return;const{metaMetricsId:a,latestNonAnonymousEventTimestamp:r,participateInMetaMetrics:i}=this.state,o=!i||!a,c=t.event===u.MetaMetricsEventName.MetricsOptOut,d=(0,m.getPlatform)()===l.PLATFORM_FIREFOX;if(o&&!(c&&!d))return;const p=t.messageId||(0,m.generateRandomId)();let h=new Date;if(t.timestamp){const e=new Date(t.timestamp);(0,m.isValidDate)(e)&&(h=e)}const g={...t,messageId:p,timestamp:h};this.update(t=>{t.latestNonAnonymousEventTimestamp=g.anonymousId===u.METAMETRICS_ANONYMOUS_ID?r:h.valueOf(),t.segmentApiCalls[p]={eventType:e,payload:{...g,timestamp:g.timestamp.toString()}}});k(R,this)[e](g,e=>(this.update(e=>{delete e.segmentApiCalls[p]}),null==s?void 0:s(e)))}function Z(e){var t;const s=(null===(t=e.names)||void 0===t?void 0:t[i.NameType.ETHEREUM_ADDRESS])??{};return Object.keys(s).reduce((e,t)=>{const n=s[t];return e+Object.keys(n).reduce((e,t)=>{var s;return e+(Boolean(null===(s=n[t].name)||void 0===s?void 0:s.length)?1:0)},0)},0)}s.default=x}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"$root$",file:"app/scripts/controllers/metametrics-controller.ts"}],[2336,{"./determineGasFeeCalculations.cjs":2337,"./gas-util.cjs":2338,"@metamask/controller-utils":1639,"@metamask/eth-query":2226,"@metamask/polling-controller":2343,uuid:6134},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n,a,r,i=this&&this.__classPrivateFieldSet||function(e,t,s,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?a.call(e,s):a?a.value=s:t.set(e,s),s},o=this&&this.__classPrivateFieldGet||function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(s,"__esModule",{value:!0}),s.GasFeeController=s.GAS_ESTIMATE_TYPES=s.LEGACY_GAS_PRICES_API_URL=void 0;const l=e("@metamask/controller-utils"),u=c(e("@metamask/eth-query")),d=e("@metamask/polling-controller"),p=e("uuid"),h=c(e("./determineGasFeeCalculations.cjs")),m=e("./gas-util.cjs");s.LEGACY_GAS_PRICES_API_URL="https://api.metaswap.codefi.network/gasPrices",s.GAS_ESTIMATE_TYPES={FEE_MARKET:"fee-market",LEGACY:"legacy",ETH_GASPRICE:"eth_gasPrice",NONE:"none"};const g={gasFeeEstimatesByChainId:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},gasFeeEstimates:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},estimatedGasFeeTimeBounds:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},gasEstimateType:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},nonRPCGasFeeApisDisabled:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!1}},f={gasFeeEstimatesByChainId:{},gasFeeEstimates:{},estimatedGasFeeTimeBounds:{},gasEstimateType:s.GAS_ESTIMATE_TYPES.NONE,nonRPCGasFeeApisDisabled:!1};class w extends((0,d.StaticIntervalPollingController)()){constructor({interval:e=15e3,messenger:t,state:c,getCurrentNetworkEIP1559Compatibility:l,getCurrentAccountEIP1559Compatibility:d,getChainId:p,getCurrentNetworkLegacyGasAPICompatibility:h,getProvider:m,onNetworkDidChange:w,legacyAPIEndpoint:v=s.LEGACY_GAS_PRICES_API_URL,EIP1559APIEndpoint:y,clientId:S}){if(super({name:"GasFeeController",metadata:g,messenger:t,state:{...f,...c}}),n.add(this),a.set(this,void 0),this.intervalDelay=e,this.setIntervalLength(e),this.pollTokens=new Set,this.getCurrentNetworkEIP1559Compatibility=l,this.getCurrentNetworkLegacyGasAPICompatibility=h,this.getCurrentAccountEIP1559Compatibility=d,i(this,a,m,"f"),this.EIP1559APIEndpoint=y,this.legacyAPIEndpoint=v,this.clientId=S,this.ethQuery=new u.default(o(this,a,"f").call(this)),w&&p)this.currentChainId=p(),w(async e=>{await o(this,n,"m",r).call(this,e)});else{const{selectedNetworkClientId:e}=this.messenger.call("NetworkController:getState");this.currentChainId=this.messenger.call("NetworkController:getNetworkClientById",e).configuration.chainId,this.messenger.subscribe("NetworkController:networkDidChange",async e=>{await o(this,n,"m",r).call(this,e)})}}async resetPolling(){if(0!==this.pollTokens.size){const e=Array.from(this.pollTokens);this.stopPolling(),await this.getGasFeeEstimatesAndStartPolling(e[0]),e.slice(1).forEach(e=>{this.pollTokens.add(e)})}}async fetchGasFeeEstimates(e){return await this._fetchGasFeeEstimateData(e)}async getGasFeeEstimatesAndStartPolling(e){const t=e||(0,p.v1)();return this.pollTokens.add(t),1===this.pollTokens.size&&(await this._fetchGasFeeEstimateData(),this._poll()),t}async _fetchGasFeeEstimateData(e={}){const{shouldUpdateState:t=!0,networkClientId:s}=e;let n,a,r,i;if(s!==undefined){const e=this.messenger.call("NetworkController:getNetworkClientById",s);r="0x38"===e.configuration.chainId,i=(0,l.convertHexToDecimal)(e.configuration.chainId);try{a=await this.messenger.call("NetworkController:getEIP1559Compatibility",s)||!1}catch{a=!1}n=new u.default(e.provider)}n??(n=this.ethQuery),r??(r=this.getCurrentNetworkLegacyGasAPICompatibility()),i??(i=(0,l.convertHexToDecimal)(this.currentChainId));try{a??(a=await this.getEIP1559Compatibility())}catch(e){console.error(e),a??(a=!1)}const o=await(0,h.default)({isEIP1559Compatible:a,isLegacyGasAPICompatible:r,fetchGasEstimates:m.fetchGasEstimates,fetchGasEstimatesUrl:this.EIP1559APIEndpoint.replace("<chain_id>",`${i}`),fetchLegacyGasPriceEstimates:m.fetchLegacyGasPriceEstimates,fetchLegacyGasPriceEstimatesUrl:this.legacyAPIEndpoint.replace("<chain_id>",`${i}`),fetchEthGasPriceEstimate:m.fetchEthGasPriceEstimate,calculateTimeEstimate:m.calculateTimeEstimate,clientId:this.clientId,ethQuery:n,nonRPCGasFeeApisDisabled:this.state.nonRPCGasFeeApisDisabled});if(t){const e=(0,l.toHex)(i);this.update(t=>{this.currentChainId===e&&(t.gasFeeEstimates=o.gasFeeEstimates,t.estimatedGasFeeTimeBounds=o.estimatedGasFeeTimeBounds,t.gasEstimateType=o.gasEstimateType),t.gasFeeEstimatesByChainId??(t.gasFeeEstimatesByChainId={}),t.gasFeeEstimatesByChainId[e]={gasFeeEstimates:o.gasFeeEstimates,estimatedGasFeeTimeBounds:o.estimatedGasFeeTimeBounds,gasEstimateType:o.gasEstimateType}})}return o}disconnectPoller(e){this.pollTokens.delete(e),0===this.pollTokens.size&&this.stopPolling()}stopPolling(){this.intervalId&&clearInterval(this.intervalId),this.pollTokens.clear(),this.resetState()}destroy(){super.destroy(),this.stopPolling()}_poll(){this.intervalId&&clearInterval(this.intervalId),this.intervalId=setInterval(async()=>{await(0,l.safelyExecute)(()=>this._fetchGasFeeEstimateData())},this.intervalDelay)}async _executePoll({networkClientId:e}){await this._fetchGasFeeEstimateData({networkClientId:e})}resetState(){this.update(()=>f)}async getEIP1559Compatibility(){const e=await this.getCurrentNetworkEIP1559Compatibility(),t=this.getCurrentAccountEIP1559Compatibility?.()??!0;return e&&t}getTimeEstimate(e,t){return this.state.gasFeeEstimates&&this.state.gasEstimateType===s.GAS_ESTIMATE_TYPES.FEE_MARKET?(0,m.calculateTimeEstimate)(e,t,this.state.gasFeeEstimates):{}}enableNonRPCGasFeeApis(){this.update(e=>{e.nonRPCGasFeeApisDisabled=!1})}disableNonRPCGasFeeApis(){this.update(e=>{e.nonRPCGasFeeApisDisabled=!0})}}s.GasFeeController=w,a=new WeakMap,n=new WeakSet,r=async function({selectedNetworkClientId:e}){const t=this.messenger.call("NetworkController:getNetworkClientById",e).configuration.chainId;t!==this.currentChainId&&(this.ethQuery=new u.default(o(this,a,"f").call(this)),await this.resetPolling(),this.currentChainId=t)},s.default=w}}},{package:"@metamask/gas-fee-controller",file:"node_modules/@metamask/gas-fee-controller/dist/GasFeeController.cjs"}],[2337,{"./GasFeeController.cjs":2336},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0});const n=e("./GasFeeController.cjs");s.default=async function(e){try{return await async function(e){const{isEIP1559Compatible:t,isLegacyGasAPICompatible:s,nonRPCGasFeeApisDisabled:a}=e;try{if(t&&!a)return await async function(e){const{fetchGasEstimates:t,fetchGasEstimatesUrl:s,clientId:a,calculateTimeEstimate:r}=e,i=await t(s,a),{suggestedMaxPriorityFeePerGas:o,suggestedMaxFeePerGas:c}=i.medium,l=r(o,c,i);return{gasFeeEstimates:i,estimatedGasFeeTimeBounds:l,gasEstimateType:n.GAS_ESTIMATE_TYPES.FEE_MARKET}}(e);if(s&&!a)return await async function(e){const{fetchLegacyGasPriceEstimates:t,fetchLegacyGasPriceEstimatesUrl:s,clientId:a}=e;return{gasFeeEstimates:await t(s,a),estimatedGasFeeTimeBounds:{},gasEstimateType:n.GAS_ESTIMATE_TYPES.LEGACY}}(e);throw new Error("Main gas fee/price estimation failed. Use fallback")}catch{return await async function(e){const{ethQuery:t,fetchEthGasPriceEstimate:s}=e;return{gasFeeEstimates:await s(t),estimatedGasFeeTimeBounds:{},gasEstimateType:n.GAS_ESTIMATE_TYPES.ETH_GASPRICE}}(e)}}(e)}catch(e){if(e instanceof Error)throw new Error(`Gas fee/price estimation failed. Message: ${e.message}`);throw e}}}}},{package:"@metamask/gas-fee-controller",file:"node_modules/@metamask/gas-fee-controller/dist/determineGasFeeCalculations.cjs"}],[2338,{"@metamask/controller-utils":1639,"bn.js":4413},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(s,"__esModule",{value:!0}),s.calculateTimeEstimate=s.fetchEthGasPriceEstimate=s.fetchLegacyGasPriceEstimates=s.fetchGasEstimates=s.normalizeGWEIDecimalNumbers=void 0;const a=e("@metamask/controller-utils"),r=n(e("bn.js")),i=e=>({"X-Client-Id":e});function o(e){const t=(0,a.gweiDecToWEIBN)(e).toString(16);return(0,a.weiHexToGweiDec)(t)}s.normalizeGWEIDecimalNumbers=o,s.fetchGasEstimates=async function(e,t){const s=await(0,a.handleFetch)(e,t?{headers:i(t)}:undefined);return{low:{...s.low,suggestedMaxPriorityFeePerGas:o(s.low.suggestedMaxPriorityFeePerGas),suggestedMaxFeePerGas:o(s.low.suggestedMaxFeePerGas)},medium:{...s.medium,suggestedMaxPriorityFeePerGas:o(s.medium.suggestedMaxPriorityFeePerGas),suggestedMaxFeePerGas:o(s.medium.suggestedMaxFeePerGas)},high:{...s.high,suggestedMaxPriorityFeePerGas:o(s.high.suggestedMaxPriorityFeePerGas),suggestedMaxFeePerGas:o(s.high.suggestedMaxFeePerGas)},estimatedBaseFee:o(s.estimatedBaseFee),historicalBaseFeeRange:s.historicalBaseFeeRange,baseFeeTrend:s.baseFeeTrend,latestPriorityFeeRange:s.latestPriorityFeeRange,historicalPriorityFeeRange:s.historicalPriorityFeeRange,priorityFeeTrend:s.priorityFeeTrend,networkCongestion:s.networkCongestion}},s.fetchLegacyGasPriceEstimates=async function(e,t){const s=await(0,a.handleFetch)(e,{referrer:e,referrerPolicy:"no-referrer-when-downgrade",method:"GET",mode:"cors",headers:{"Content-Type":"application/json",...t&&i(t)}});return{low:s.SafeGasPrice,medium:s.ProposeGasPrice,high:s.FastGasPrice}},s.fetchEthGasPriceEstimate=async function(e){const t=await(0,a.query)(e,"gasPrice");return{gasPrice:(0,a.weiHexToGweiDec)(t).toString()}},s.calculateTimeEstimate=function(e,t,s){const{low:n,medium:i,high:o,estimatedBaseFee:c}=s,l=(0,a.gweiDecToWEIBN)(e),u=(0,a.gweiDecToWEIBN)(t),d=(0,a.gweiDecToWEIBN)(c),p=r.default.min(l,u.sub(d)),h=(0,a.gweiDecToWEIBN)(n.suggestedMaxPriorityFeePerGas),m=(0,a.gweiDecToWEIBN)(i.suggestedMaxPriorityFeePerGas),g=(0,a.gweiDecToWEIBN)(o.suggestedMaxPriorityFeePerGas);let f,w;return p.lt(h)?(f=null,w="unknown"):p.gte(h)&&p.lt(m)?(f=n.minWaitTimeEstimate,w=n.maxWaitTimeEstimate):p.gte(m)&&p.lt(g)?(f=i.minWaitTimeEstimate,w=i.maxWaitTimeEstimate):p.eq(g)?(f=o.minWaitTimeEstimate,w=o.maxWaitTimeEstimate):(f=0,w=o.maxWaitTimeEstimate),{lowerTimeBound:f,upperTimeBound:w}}}}},{package:"@metamask/gas-fee-controller",file:"node_modules/@metamask/gas-fee-controller/dist/gas-util.cjs"}],[2339,{"./GasFeeController.cjs":2336},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){n===undefined&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){n===undefined&&(n=s),e[n]=t[s]}),a=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||n(t,e,s)};Object.defineProperty(s,"__esModule",{value:!0}),a(e("./GasFeeController.cjs"),s)}}},{package:"@metamask/gas-fee-controller",file:"node_modules/@metamask/gas-fee-controller/dist/index.cjs"}],[234,{"@metamask/base-controller":1520},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.MetaMetricsDataDeletionController=void 0;var n=e("@metamask/base-controller");function a(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function r(e,t){return e.get(i(e,t))}function i(e,t,s){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:s;throw new TypeError("Private element is not present on this object")}const o="MetaMetricsDataDeletionController",c={metaMetricsDataDeletionId:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},metaMetricsDataDeletionTimestamp:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},metaMetricsDataDeletionStatus:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0}};var l=new WeakMap,u=new WeakSet;class d extends n.BaseController{constructor({dataDeletionService:e,messenger:t,state:s}){var n,r;super({messenger:t,metadata:c,name:o,state:{metaMetricsDataDeletionId:null,metaMetricsDataDeletionTimestamp:0,...s}}),a(n=this,r=u),r.add(n),function(e,t,s){a(e,t),t.set(e,s)}(this,l,void 0),function(e,t,s){e.set(i(e,t),s)}(l,this,e),i(u,this,p).call(this)}async createMetaMetricsDataDeletionTask(){const{metaMetricsId:e}=this.messenger.call("MetaMetricsController:getState");if(!e)throw new Error("MetaMetrics ID not found");const t=await r(l,this).createDataDeletionRegulationTask(e);this.update(e=>{e.metaMetricsDataDeletionId=t??null,e.metaMetricsDataDeletionTimestamp=Date.now()}),await this.updateDataDeletionTaskStatus()}async updateDataDeletionTaskStatus(){const e=this.state.metaMetricsDataDeletionId;if(!e)throw new Error("Delete Regulation id not found");const t=await r(l,this).fetchDeletionRegulationStatus(e);this.update(e=>{e.metaMetricsDataDeletionStatus=t??undefined})}}function p(){this.messenger.registerActionHandler(`${o}:createMetaMetricsDataDeletionTask`,this.createMetaMetricsDataDeletionTask.bind(this)),this.messenger.registerActionHandler(`${o}:updateDataDeletionTaskStatus`,this.updateDataDeletionTaskStatus.bind(this))}s.MetaMetricsDataDeletionController=d}}},{package:"$root$",file:"app/scripts/controllers/metametrics-data-deletion/metametrics-data-deletion.ts"}],[2340,{"fast-json-stable-stringify":4789,uuid:6134},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n=this&&this.__classPrivateFieldGet||function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(s,"__esModule",{value:!0}),s.AbstractPollingControllerBaseMixin=s.getKey=void 0;const r=a(e("fast-json-stable-stringify")),i=e("uuid");s.getKey=e=>(0,r.default)(e),s.AbstractPollingControllerBaseMixin=function(e){var t,a;return t=new WeakMap,a=new WeakMap,class extends e{constructor(){super(...arguments),t.set(this,new Map),a.set(this,new Map)}startPolling(e){const a=(0,i.v4)(),r=(0,s.getKey)(e),o=n(this,t,"f").get(r)??new Set;return o.add(a),n(this,t,"f").set(r,o),1===o.size&&this._startPolling(e),a}stopAllPolling(){n(this,t,"f").forEach((e,t)=>{e.forEach(e=>{this.stopPollingByPollingToken(e)})})}stopPollingByPollingToken(e){if(!e)throw new Error("pollingToken required");let s=null;for(const[a,r]of n(this,t,"f"))if(r.delete(e)){0===r.size&&(s=a);break}if(s){this._stopPollingByPollingTokenSetId(s),n(this,t,"f").delete(s);const e=n(this,a,"f").get(s);if(e){for(const t of e)t(JSON.parse(s));e.clear()}}}onPollingComplete(e,t){const r=(0,s.getKey)(e),i=n(this,a,"f").get(r)??new Set;i.add(t),n(this,a,"f").set(r,i)}}}}}},{package:"@metamask/gas-fee-controller>@metamask/polling-controller",file:"node_modules/@metamask/gas-fee-controller/node_modules/@metamask/polling-controller/dist/AbstractPollingController.cjs"}],[2341,{"./AbstractPollingController.cjs":2340,"@metamask/base-controller":1520},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n=this&&this.__classPrivateFieldGet||function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)};Object.defineProperty(s,"__esModule",{value:!0}),s.BlockTrackerPollingController=s.BlockTrackerPollingControllerOnly=void 0;const a=e("@metamask/base-controller"),r=e("./AbstractPollingController.cjs");function i(e){var t;class s extends((0,r.AbstractPollingControllerBaseMixin)(e)){constructor(){super(...arguments),t.set(this,{})}_startPolling(e){const s=(0,r.getKey)(e);if(n(this,t,"f")[s])return;const a=this._getNetworkClientById(e.networkClientId);if(!a)throw new Error(`Unable to retrieve blockTracker for networkClientId ${e.networkClientId}`);{const r=this._executePoll.bind(this,e);a.blockTracker.addListener("latest",r),n(this,t,"f")[s]=r}}_stopPollingByPollingTokenSetId(e){const{networkClientId:s}=JSON.parse(e),a=this._getNetworkClientById(s);if(a&&n(this,t,"f")[e]){const s=n(this,t,"f")[e];s&&(a.blockTracker.removeListener("latest",s),delete n(this,t,"f")[e])}}}return t=new WeakMap,s}class o{}s.BlockTrackerPollingControllerOnly=()=>i(o);s.BlockTrackerPollingController=()=>i(a.BaseController)}}},{package:"@metamask/gas-fee-controller>@metamask/polling-controller",file:"node_modules/@metamask/gas-fee-controller/node_modules/@metamask/polling-controller/dist/BlockTrackerPollingController.cjs"}],[2342,{"./AbstractPollingController.cjs":2340,"@metamask/base-controller":1520},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n=this&&this.__classPrivateFieldSet||function(e,t,s,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?a.call(e,s):a?a.value=s:t.set(e,s),s},a=this&&this.__classPrivateFieldGet||function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)};Object.defineProperty(s,"__esModule",{value:!0}),s.StaticIntervalPollingController=s.StaticIntervalPollingControllerOnly=void 0;const r=e("@metamask/base-controller"),i=e("./AbstractPollingController.cjs");function o(e){var t,s;class r extends((0,i.AbstractPollingControllerBaseMixin)(e)){constructor(){super(...arguments),t.set(this,{}),s.set(this,1e3)}setIntervalLength(e){n(this,s,e,"f")}getIntervalLength(){return a(this,s,"f")}_startPolling(e){if(!a(this,s,"f"))throw new Error("intervalLength must be defined and greater than 0");const n=(0,i.getKey)(e),r=a(this,t,"f")[n];this._stopPollingByPollingTokenSetId(n);const o=a(this,t,"f")[n]=setTimeout(async()=>{try{await this._executePoll(e)}catch(e){console.error(e)}o===a(this,t,"f")[n]&&this._startPolling(e)},r?a(this,s,"f"):0)}_stopPollingByPollingTokenSetId(e){const s=a(this,t,"f")[e];s&&(clearTimeout(s),delete a(this,t,"f")[e])}}return t=new WeakMap,s=new WeakMap,r}class c{}s.StaticIntervalPollingControllerOnly=()=>o(c);s.StaticIntervalPollingController=()=>o(r.BaseController)}}},{package:"@metamask/gas-fee-controller>@metamask/polling-controller",file:"node_modules/@metamask/gas-fee-controller/node_modules/@metamask/polling-controller/dist/StaticIntervalPollingController.cjs"}],[2343,{"./BlockTrackerPollingController.cjs":2341,"./StaticIntervalPollingController.cjs":2342},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.StaticIntervalPollingController=s.StaticIntervalPollingControllerOnly=s.BlockTrackerPollingController=s.BlockTrackerPollingControllerOnly=void 0;var n=e("./BlockTrackerPollingController.cjs");Object.defineProperty(s,"BlockTrackerPollingControllerOnly",{enumerable:!0,get:function(){return n.BlockTrackerPollingControllerOnly}}),Object.defineProperty(s,"BlockTrackerPollingController",{enumerable:!0,get:function(){return n.BlockTrackerPollingController}});var a=e("./StaticIntervalPollingController.cjs");Object.defineProperty(s,"StaticIntervalPollingControllerOnly",{enumerable:!0,get:function(){return a.StaticIntervalPollingControllerOnly}}),Object.defineProperty(s,"StaticIntervalPollingController",{enumerable:!0,get:function(){return a.StaticIntervalPollingController}})}}},{package:"@metamask/gas-fee-controller>@metamask/polling-controller",file:"node_modules/@metamask/gas-fee-controller/node_modules/@metamask/polling-controller/dist/index.cjs"}],[235,{"../../../shared/constants/network":6194,"@metamask/base-controller":1520,"@metamask/keyring-api":2510,"@metamask/multichain-network-controller":2682},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.NetworkOrderController=void 0;var n=e("@metamask/keyring-api"),a=e("@metamask/base-controller"),r=e("@metamask/multichain-network-controller"),i=e("../../../shared/constants/network");const o={orderedNetworkList:[]},c={orderedNetworkList:{includeInStateLogs:!1,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0}};class l extends a.BaseController{constructor({messenger:e,state:t}){super({messenger:e,metadata:c,name:"NetworkOrderController",state:{...o,...t}}),this.messenger.subscribe("NetworkController:stateChange",e=>{this.onNetworkControllerStateChange(e)})}onNetworkControllerStateChange({networkConfigurationsByChainId:e}){this.update(t=>{const s=Object.keys(e).filter(e=>!i.TEST_CHAINS.includes(e)).map(r.toEvmCaipChainId),a=[n.BtcScope.Mainnet,n.SolScope.Mainnet,n.TrxScope.Mainnet],o=s.filter(e=>!t.orderedNetworkList.some(({networkId:t})=>t===e)).map(e=>({networkId:e}));t.orderedNetworkList=t.orderedNetworkList.filter(({networkId:e})=>s.includes(e)||a.includes(e)).concat(o)})}updateNetworksList(e){this.update(t=>{t.orderedNetworkList=e.map(e=>({networkId:e}))})}}s.NetworkOrderController=l}}},{package:"$root$",file:"app/scripts/controllers/network-order.ts"}],[236,{"../../../shared/constants/onboarding":6197,"../../../shared/modules/environment":6319,"@metamask/base-controller":1520,loglevel:5247},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.getDefaultOnboardingControllerState=s.default=void 0;var n,a=e("@metamask/base-controller"),r=(n=e("loglevel"))&&n.__esModule?n:{default:n},i=e("../../../shared/constants/onboarding"),o=e("../../../shared/modules/environment");function c(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const l=()=>({seedPhraseBackedUp:null,firstTimeFlowType:null,completedOnboarding:!1});s.getDefaultOnboardingControllerState=l;const u={onboardingTabs:{}},d={seedPhraseBackedUp:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},firstTimeFlowType:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},completedOnboarding:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},onboardingTabs:{includeInStateLogs:!0,persist:!1,includeInDebugSnapshot:!1,usedInUi:!0}};class p extends a.BaseController{constructor({messenger:e,state:t}){super({messenger:e,metadata:d,name:"OnboardingController",state:{seedPhraseBackedUp:null,firstTimeFlowType:null,completedOnboarding:!1,...t,...u}}),c(this,"registerOnboarding",async(e,t)=>{if(this.state.completedOnboarding)return void r.default.debug("Ignoring registerOnboarding; user already onboarded");const{onboardingTabs:s}={...this.state};s&&(s[e]&&s[e]===t||(r.default.debug(`Registering onboarding tab at location '${e}' with tabId '${t}'`),this.update(n=>{n.onboardingTabs={...s,[e]:t}})))})}setSeedPhraseBackedUp(e){this.update(t=>{t.seedPhraseBackedUp=e})}completeOnboarding(){return this.update(e=>{e.completedOnboarding=!0}),!0}setFirstTimeFlowType(e){this.update(t=>{t.firstTimeFlowType=e})}getIsSocialLoginFlow(){if(!(0,o.getIsSeedlessOnboardingFeatureEnabled)())return!1;const{firstTimeFlowType:e}=this.state;return e===i.FirstTimeFlowType.socialCreate||e===i.FirstTimeFlowType.socialImport}resetOnboarding(){this.update(e=>{e.completedOnboarding=!1,e.firstTimeFlowType=null,e.seedPhraseBackedUp=null,e.onboardingTabs={}})}}s.default=p}}},{package:"$root$",file:"app/scripts/controllers/onboarding.ts"}],[24,{"./assets-contract-controller-init":23,"./network-order-controller-init":26,"./nft-controller-init":27,"./nft-detection-controller-init":28,"./token-rates-controller-init":29},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"AssetsContractControllerInit",{enumerable:!0,get:function(){return i.AssetsContractControllerInit}}),Object.defineProperty(s,"NetworkOrderControllerInit",{enumerable:!0,get:function(){return o.NetworkOrderControllerInit}}),Object.defineProperty(s,"NftControllerInit",{enumerable:!0,get:function(){return a.NftControllerInit}}),Object.defineProperty(s,"NftDetectionControllerInit",{enumerable:!0,get:function(){return r.NftDetectionControllerInit}}),Object.defineProperty(s,"TokenRatesControllerInit",{enumerable:!0,get:function(){return n.TokenRatesControllerInit}});var n=e("./token-rates-controller-init"),a=e("./nft-controller-init"),r=e("./nft-detection-controller-init"),i=e("./assets-contract-controller-init"),o=e("./network-order-controller-init")}}},{package:"$root$",file:"app/scripts/controller-init/assets/index.ts"}],[242,{"../../../../../shared/constants/keyring":6186,"../../../../../shared/constants/snaps/permissions":6205,"@metamask/keyring-controller":2537,"@metamask/snaps-rpc-methods":3209,"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.getSnapPermissionSpecifications=function(e,t){return{...(0,n.buildSnapEndowmentSpecifications)(Object.keys(i.ExcludedSnapEndowments)),...(0,n.buildSnapRestrictedMethodSpecifications)(Object.keys(i.ExcludedSnapPermissions),{getPreferences:()=>{const t=e.call("CurrencyRateController:getState").currentCurrency,{currentLocale:s,openSeaEnabled:n,preferences:{privacyMode:a,showTestNetworks:r},securityAlertsEnabled:i,useCurrencyRateCheck:o,useTransactionSimulations:c,useTokenDetection:l,useMultiAccountBalanceChecker:u,useNftDetection:d}=e.call("PreferencesController:getState");return{locale:s,currency:t,hideBalances:a,useSecurityAlerts:i,useExternalPricingData:o,simulateOnChainActions:c,useTokenDetection:l,batchCheckBalances:u,displayNftMedia:n,useNftDetection:d,showTestnets:r}},clearSnapState:e.call.bind(e,"SnapController:clearSnapState"),getMnemonic:async t=>{if(!t){const[t]=e.call("KeyringController:getKeyringsByType",o.KeyringType.hdKeyTree);if(!t.mnemonic)throw new Error("Primary keyring mnemonic unavailable.");return t.mnemonic}try{const{type:s,mnemonic:n}=await e.call("KeyringController:withKeyring",{id:t},async({keyring:e})=>({type:e.type,mnemonic:(0,r.hasProperty)(e,"mnemonic")?e.mnemonic:undefined}));if(s!==a.KeyringTypes.hd||!n)throw new Error(`Entropy source with ID "${t}" not found.`);return n}catch{throw new Error(`Entropy source with ID "${t}" not found.`)}},getMnemonicSeed:async t=>{if(!t){const[t]=e.call("KeyringController:getKeyringsByType",o.KeyringType.hdKeyTree);if(!t.seed)throw new Error("Primary keyring mnemonic unavailable.");return t.seed}try{const{type:s,seed:n}=await e.call("KeyringController:withKeyring",{id:t},async({keyring:e})=>({type:e.type,seed:(0,r.hasProperty)(e,"seed")?e.seed:undefined}));if(s!==a.KeyringTypes.hd||!n)throw new Error(`Entropy source with ID "${t}" not found.`);return n}catch{throw new Error(`Entropy source with ID "${t}" not found.`)}},getUnlockPromise:e.call.bind(e,"AppStateController:getUnlockPromise"),getSnap:e.call.bind(e,"SnapController:get"),handleSnapRpcRequest:e.call.bind(e,"SnapController:handleRequest"),getSnapState:e.call.bind(e,"SnapController:getSnapState"),requestUserApproval:t.addAndShowApprovalRequest,showNativeNotification:(t,s)=>e.call("RateLimitController:call",t,"showNativeNotification",t,s.message),showInAppNotification:(t,s)=>{const{content:n,message:a,title:r,footerLink:i}=s,o={interfaceId:n,message:a,title:r,footerLink:i};return e.call("RateLimitController:call",t,"showInAppNotification",t,o)},updateSnapState:e.call.bind(e,"SnapController:updateSnapState"),maybeUpdatePhishingList:()=>{const{usePhishDetect:t}=e.call("PreferencesController:getState");t&&e.call("PhishingController:maybeUpdateState")},isOnPhishingList:t=>{const{usePhishDetect:s}=e.call("PreferencesController:getState");return!!s&&e.call("PhishingController:testOrigin",t).result},createInterface:e.call.bind(e,"SnapInterfaceController:createInterface"),getInterface:e.call.bind(e,"SnapInterfaceController:getInterface"),getClientCryptography:()=>({}),getSnapKeyring:async()=>{const[s]=e.call("KeyringController:getKeyringsByType",o.KeyringType.snap);return s||(await t.addNewKeyring(o.KeyringType.snap),e.call("KeyringController:getKeyringsByType",o.KeyringType.snap)[0])}})}};var n=e("@metamask/snaps-rpc-methods"),a=e("@metamask/keyring-controller"),r=e("@metamask/utils"),i=e("../../../../../shared/constants/snaps/permissions"),o=e("../../../../../shared/constants/keyring")}}},{package:"$root$",file:"app/scripts/controllers/permissions/snaps/specifications.ts"}],[244,{"../../../shared/constants/defi-referrals":6179,"../../../shared/constants/hardware-wallets":6184,"../../../shared/constants/network":6194,"../../../shared/constants/preferences":6199,"@metamask/base-controller":1520},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.getDefaultPreferencesControllerState=s.ReferralStatus=s.PreferencesController=void 0;var n=e("@metamask/base-controller"),a=e("../../../shared/constants/network"),r=e("../../../shared/constants/hardware-wallets"),i=e("../../../shared/constants/preferences"),o=e("../../../shared/constants/defi-referrals");function c(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}let l=s.ReferralStatus=function(e){return e.Approved="approved",e.Passed="passed",e.Declined="declined",e}({});const u=()=>({addSnapAccountEnabled:!1,advancedGasFee:{},currentLocale:"",dismissSeedBackUpReminder:!1,enableMV3TimestampSave:!0,featureFlags:{},forgottenPassword:!1,identities:{},ipfsGateway:a.IPFS_DEFAULT_GATEWAY_URL,isIpfsGatewayEnabled:!0,knownMethodData:{},ledgerTransportType:window.navigator.hid?r.LedgerTransportTypes.webhid:r.LedgerTransportTypes.u2f,lostIdentities:{},manageInstitutionalWallets:!1,openSeaEnabled:!0,overrideContentSecurityPolicyHeader:!0,preferences:{autoLockTimeLimit:undefined,avatarType:"maskicon",dismissSmartAccountSuggestionEnabled:!1,featureNotificationsEnabled:!1,hideZeroBalanceTokens:!1,petnamesEnabled:!0,privacyMode:!1,showConfirmationAdvancedDetails:!1,showExtensionInFullSizeView:!1,showFiatInTestnets:!1,showMultiRpcModal:!1,showNativeTokenAsMainBalance:!1,showTestNetworks:!1,skipDeepLinkInterstitial:!1,smartAccountOptIn:!0,smartTransactionsOptInStatus:!0,smartTransactionsMigrationApplied:!1,tokenNetworkFilter:{},tokenSortConfig:{key:"tokenFiatAmount",order:"dsc",sortCallback:"stringNumeric"},useNativeCurrencyAsPrimaryCurrency:!0,useSidePanelAsDefault:!1},securityAlertsEnabled:!0,selectedAddress:"",snapRegistryList:{},snapsAddSnapAccountModalDismissed:!1,theme:i.ThemeType.os,use4ByteResolution:!0,useAddressBarEnsResolution:!0,useBlockie:!1,useCurrencyRateCheck:!0,useExternalNameSources:!0,useExternalServices:!0,isMultiAccountBalancesEnabled:!0,useMultiAccountBalanceChecker:!0,useNftDetection:!0,usePhishDetect:!0,useSafeChainsListValidation:!0,useTokenDetection:!0,useTransactionSimulations:!0,watchEthereumAccountEnabled:!1,referrals:{[o.DefiReferralPartner.Hyperliquid]:{}}});s.getDefaultPreferencesControllerState=u;const d={addSnapAccountEnabled:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},advancedGasFee:{persist:!0,includeInStateLogs:!0,includeInDebugSnapshot:!0,usedInUi:!0},currentLocale:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},dismissSeedBackUpReminder:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},enableMV3TimestampSave:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},featureFlags:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},forgottenPassword:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},identities:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},ipfsGateway:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},isIpfsGatewayEnabled:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},knownMethodData:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},ledgerTransportType:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},lostIdentities:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},manageInstitutionalWallets:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},openSeaEnabled:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},overrideContentSecurityPolicyHeader:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},preferences:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},securityAlertsEnabled:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},selectedAddress:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},snapRegistryList:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},snapsAddSnapAccountModalDismissed:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},textDirection:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},theme:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},use4ByteResolution:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},useAddressBarEnsResolution:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},useBlockie:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},useCurrencyRateCheck:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},useExternalNameSources:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},useExternalServices:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},isMultiAccountBalancesEnabled:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},useMultiAccountBalanceChecker:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},useNftDetection:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},usePhishDetect:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},useSafeChainsListValidation:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},useTokenDetection:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},useTransactionSimulations:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!0,usedInUi:!0},watchEthereumAccountEnabled:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},referrals:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0}};var p=new WeakSet;class h extends n.BaseController{constructor({messenger:e,state:t}){const s=u(),n={...s,...t,preferences:{...s.preferences,...null==t?void 0:t.preferences},referrals:{...s.referrals,...null==t?void 0:t.referrals},isMultiAccountBalancesEnabled:(null==t?void 0:t.useMultiAccountBalanceChecker)??s.isMultiAccountBalancesEnabled};super({messenger:e,metadata:d,name:"PreferencesController",state:n}),c(this,p),this.messenger.subscribe("AccountsController:stateChange",function(e,t,s){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:s;throw new TypeError("Private element is not present on this object")}(p,this,m).bind(this)),globalThis.setPreference=(e,t)=>this.setFeatureFlag(e,t)}setPasswordForgotten(e){this.update(t=>{t.forgottenPassword=e})}setUseBlockie(e){this.update(t=>{t.useBlockie=e})}setUsePhishDetect(e){this.update(t=>{t.usePhishDetect=e})}setUseMultiAccountBalanceChecker(e){this.update(t=>{t.useMultiAccountBalanceChecker=e,t.isMultiAccountBalancesEnabled=e})}setUseSafeChainsListValidation(e){this.update(t=>{t.useSafeChainsListValidation=e})}toggleExternalServices(e){this.update(t=>{t.useExternalServices=e}),this.setUseTokenDetection(e),this.setUseCurrencyRateCheck(e),this.setUsePhishDetect(e),this.setUseAddressBarEnsResolution(e),this.setOpenSeaEnabled(e),this.setUseNftDetection(e),this.setUseSafeChainsListValidation(e)}setUseTokenDetection(e){this.update(t=>{t.useTokenDetection=e})}setUseNftDetection(e){this.update(t=>{t.useNftDetection=e})}setUse4ByteResolution(e){this.update(t=>{t.use4ByteResolution=e})}setUseCurrencyRateCheck(e){this.update(t=>{t.useCurrencyRateCheck=e})}setOpenSeaEnabled(e){this.update(t=>{t.openSeaEnabled=e})}setSecurityAlertsEnabled(e){this.update(t=>{t.securityAlertsEnabled=e})}setAddSnapAccountEnabled(e){this.update(t=>{t.addSnapAccountEnabled=e})}setUseExternalNameSources(e){this.update(t=>{t.useExternalNameSources=e})}setUseTransactionSimulations(e){this.update(t=>{t.useTransactionSimulations=e})}setAdvancedGasFee({chainId:e,gasFeePreferences:t}){const{advancedGasFee:s}=this.state;this.update(n=>{n.advancedGasFee={...s,[e]:t}})}setTheme(e){this.update(t=>{t.theme=e})}addKnownMethodData(e,t){const{knownMethodData:s}=this.state,n={...s};n[e]=t,this.update(e=>{e.knownMethodData=n})}setCurrentLocale(e){const t=["ar","dv","fa","he","ku"].includes(e)?"rtl":"auto";return this.update(s=>{s.currentLocale=e,s.textDirection=t}),t}setSelectedAddress(e){const t=this.messenger.call("AccountsController:getAccountByAddress",e);if(!t)throw new Error(`Identity for '${e} not found`);this.messenger.call("AccountsController:setSelectedAccount",t.id)}getSelectedAddress(){return this.messenger.call("AccountsController:getSelectedAccount").address}setAccountLabel(e,t){if(!e)throw new Error(`setAccountLabel requires a valid address, got ${String(e)}`);const s=this.messenger.call("AccountsController:getAccountByAddress",e);return s?(this.messenger.call("AccountsController:setAccountName",s.id,t),t):undefined}setFeatureFlag(e,t){const s={...this.state.featureFlags,[e]:t};return this.update(e=>{e.featureFlags=s}),s}setPreference(e,t){const s={...this.getPreferences(),[e]:t};return this.update(e=>{e.preferences=s}),s}getPreferences(){return this.state.preferences}getIpfsGateway(){return this.state.ipfsGateway}setIpfsGateway(e){return this.update(t=>{t.ipfsGateway=e}),e}setIsIpfsGatewayEnabled(e){this.update(t=>{t.isIpfsGatewayEnabled=e})}setUseAddressBarEnsResolution(e){this.update(t=>{t.useAddressBarEnsResolution=e})}setLedgerTransportPreference(e){return this.update(t=>{t.ledgerTransportType=e}),e}setDismissSeedBackUpReminder(e){this.update(t=>{t.dismissSeedBackUpReminder=e})}setOverrideContentSecurityPolicyHeader(e){this.update(t=>{t.overrideContentSecurityPolicyHeader=e})}setManageInstitutionalWallets(e){this.update(t=>{t.manageInstitutionalWallets=e})}setServiceWorkerKeepAlivePreference(e){this.update(t=>{t.enableMV3TimestampSave=e})}setUseSidePanelAsDefault(e){this.update(t=>{t.preferences.useSidePanelAsDefault=e})}setSnapsAddSnapAccountModalDismissed(e){this.update(t=>{t.snapsAddSnapAccountModalDismissed=e})}addReferralApprovedAccount(e,t){this.update(s=>{s.referrals[e][t]=l.Approved})}addReferralPassedAccount(e,t){this.update(s=>{s.referrals[e][t]=l.Passed})}addReferralDeclinedAccount(e,t){this.update(s=>{s.referrals[e][t]=l.Declined})}removeReferralDeclinedAccount(e,t){this.update(s=>{delete s.referrals[e][t]})}setAccountsReferralApproved(e,t){this.update(s=>{t.forEach(t=>{s.referrals[e][t]=l.Approved})})}}function m(e){const{accounts:t,selectedAccount:s}=e.internalAccounts,n=t[s],{identities:a,lostIdentities:r}=this.state,i=Object.values(t).map(e=>e.address.toLowerCase()),o=Object.keys(a).reduce((e,t)=>(i.includes(t.toLowerCase())&&(e[t]=a[t]),e),{...r}),c=Object.values(t).reduce((e,t)=>(e[t.address]={address:t.address,name:t.metadata.name,lastSelected:t.metadata.lastSelected},e),{});this.update(e=>{e.identities=c,e.lostIdentities=o,e.selectedAddress=(null==n?void 0:n.address)||""})}s.PreferencesController=h}}},{package:"$root$",file:"app/scripts/controllers/preferences-controller.ts"}],[245,{"webextension-polyfill":6163},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.getNotificationImage=async function(){return await a.default.runtime.getURL("../../images/icon-64.png")};var n,a=(n=e("webextension-polyfill"))&&n.__esModule?n:{default:n}}}},{package:"$root$",file:"app/scripts/controllers/push-notifications/get-notification-image.ts"}],[246,{"../../../../shared/lib/translate":6304,"@metamask/notification-services-controller":2812},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.createNotificationMessage=function(e){return n.NotificationServicesPushController.Utils.createOnChainPushNotificationMessage(e,i)};var n=e("@metamask/notification-services-controller"),a=e("../../../../shared/lib/translate");const r=(...e)=>(0,a.t)(...e)??"",i={...{pushPlatformNotificationsFundsSentTitle:()=>r("pushPlatformNotificationsFundsSentTitle"),pushPlatformNotificationsFundsSentDescriptionDefault:()=>r("pushPlatformNotificationsFundsSentDescriptionDefault"),pushPlatformNotificationsFundsSentDescription:(e,t)=>r("pushPlatformNotificationsFundsSentDescription",e,t),pushPlatformNotificationsFundsReceivedTitle:()=>r("pushPlatformNotificationsFundsReceivedTitle"),pushPlatformNotificationsFundsReceivedDescriptionDefault:()=>r("pushPlatformNotificationsFundsReceivedDescriptionDefault"),pushPlatformNotificationsFundsReceivedDescription:(e,t)=>r("pushPlatformNotificationsFundsReceivedDescription",e,t),pushPlatformNotificationsSwapCompletedTitle:()=>r("pushPlatformNotificationsSwapCompletedTitle"),pushPlatformNotificationsSwapCompletedDescription:()=>r("pushPlatformNotificationsSwapCompletedDescription"),pushPlatformNotificationsNftSentTitle:()=>r("pushPlatformNotificationsNftSentTitle"),pushPlatformNotificationsNftSentDescription:()=>r("pushPlatformNotificationsNftSentDescription"),pushPlatformNotificationsNftReceivedTitle:()=>r("pushPlatformNotificationsNftReceivedTitle"),pushPlatformNotificationsNftReceivedDescription:()=>r("pushPlatformNotificationsNftReceivedDescription"),pushPlatformNotificationsStakingRocketpoolStakeCompletedTitle:()=>r("pushPlatformNotificationsStakingRocketpoolStakeCompletedTitle"),pushPlatformNotificationsStakingRocketpoolStakeCompletedDescription:()=>r("pushPlatformNotificationsStakingRocketpoolStakeCompletedDescription"),pushPlatformNotificationsStakingRocketpoolUnstakeCompletedTitle:()=>r("pushPlatformNotificationsStakingRocketpoolUnstakeCompletedTitle"),pushPlatformNotificationsStakingRocketpoolUnstakeCompletedDescription:()=>r("pushPlatformNotificationsStakingRocketpoolUnstakeCompletedDescription"),pushPlatformNotificationsStakingLidoStakeCompletedTitle:()=>r("pushPlatformNotificationsStakingLidoStakeCompletedTitle"),pushPlatformNotificationsStakingLidoStakeCompletedDescription:()=>r("pushPlatformNotificationsStakingLidoStakeCompletedDescription"),pushPlatformNotificationsStakingLidoStakeReadyToBeWithdrawnTitle:()=>r("pushPlatformNotificationsStakingLidoStakeReadyToBeWithdrawnTitle"),pushPlatformNotificationsStakingLidoStakeReadyToBeWithdrawnDescription:()=>r("pushPlatformNotificationsStakingLidoStakeReadyToBeWithdrawnDescription"),pushPlatformNotificationsStakingLidoWithdrawalRequestedTitle:()=>r("pushPlatformNotificationsStakingLidoWithdrawalRequestedTitle"),pushPlatformNotificationsStakingLidoWithdrawalRequestedDescription:()=>r("pushPlatformNotificationsStakingLidoWithdrawalRequestedDescription"),pushPlatformNotificationsStakingLidoWithdrawalCompletedTitle:()=>r("pushPlatformNotificationsStakingLidoWithdrawalCompletedTitle"),pushPlatformNotificationsStakingLidoWithdrawalCompletedDescription:()=>r("pushPlatformNotificationsStakingLidoWithdrawalCompletedDescription")},...{PositionLiquidatedTitle:()=>r("pushNotificationPositionLiquidatedTitle"),PositionLiquidatedDescriptionLong:e=>r("pushNotificationPositionLiquidatedDescriptionLong",e),PositionLiquidatedDescriptionShort:e=>r("pushNotificationPositionLiquidatedDescriptionShort",e),StopLossTriggeredTitle:()=>r("pushNotificationStopLossTriggeredTitle"),StopLossTriggeredDescriptionLong:e=>r("pushNotificationStopLossTriggeredDescriptionLong",e),StopLossTriggeredDescriptionShort:e=>r("pushNotificationStopLossTriggeredDescriptionShort",e),TakeProfitTriggeredTitle:()=>r("pushNotificationTakeProfitTriggeredTitle"),TakeProfitTriggeredDescriptionLong:e=>r("pushNotificationTakeProfitTriggeredDescriptionLong",e),TakeProfitTriggeredDescriptionShort:e=>r("pushNotificationTakeProfitTriggeredDescriptionShort",e),LimitOrderFilledTitle:()=>r("pushNotificationLimitOrderFilledTitle"),LimitOrderFilledDescriptionLong:e=>r("pushNotificationLimitOrderFilledDescriptionLong",e),LimitOrderFilledDescriptionShort:e=>r("pushNotificationLimitOrderFilledDescriptionShort",e)},...{ShieldSubscriptionTitle:()=>r("pushNotificationShieldSubscriptionTitle"),ShieldSubscriptionCreatedDescriptionShort:()=>r("pushNotificationShieldSubscriptionCreatedDescriptionShort"),ShieldSubscriptionPaymentFailedDescriptionShort:()=>r("pushNotificationShieldSubscriptionPaymentFailedDescriptionShort"),ShieldSubscriptionUpdatePaymentCta:()=>r("pushNotificationShieldUpdatePaymentCta"),ShieldSubscriptionLearnMoreCta:()=>r("pushNotificationShieldLearnMoreCta"),ShieldClaimCreatedTitle:()=>r("pushNotificationShieldClaimCreatedTitle"),ShieldClaimCreatedDescriptionShort:()=>r("pushNotificationShieldClaimCreatedDescriptionShort"),ShieldClaimStatusUpdatedTitle:()=>r("pushNotificationShieldClaimStatusUpdatedTitle"),ShieldClaimStatusUpdatedDescriptionShort:()=>r("pushNotificationShieldClaimStatusUpdatedDescriptionShort")}}}}},{package:"$root$",file:"app/scripts/controllers/push-notifications/get-notification-message.ts"}],[247,{"../../platforms/extension":608,"./get-notification-image":245,"./get-notification-message":246},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.onPushNotificationClicked=async function(e,t){var s;e.notification.close();const n=t??(null==e||null===(s=e.notification)||void 0===s?void 0:s.data),a=`${c.getExtensionURL(null,null)}#notifications/${n.id}`;e.waitUntil(o.clients.openWindow(a))},s.onPushNotificationReceived=async function(e){const t=(0,i.createNotificationMessage)(e);if(!t)return;const s=null==o?void 0:o.registration;if(!s)return;const n=await(0,r.getNotificationImage)();await s.showNotification(t.title,{body:t.description,icon:n,tag:null==e?void 0:e.id,data:e})};var n,a=(n=e("../../platforms/extension"))&&n.__esModule?n:{default:n},r=e("./get-notification-image"),i=e("./get-notification-message");const o=self,c=new a.default}}},{package:"$root$",file:"app/scripts/controllers/push-notifications/index.ts"}],[248,{"../../../../shared/lib/accounts":6219,"../../../../shared/lib/multichain/accounts":6284,"./rewards-data-service":249,"./utils/bitcoin-snap":250,"./utils/solana-snap":251,"./utils/sortAccounts":252,"./utils/tron-snap":253,"@metamask/base-controller":1520,"@metamask/utils":3554,"@solana/addresses":3636,buffer:4474,"ethers/lib/utils":4766,loglevel:5247},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){(function(t){(function(){Object.defineProperty(s,"__esModule",{value:!0}),s.getRewardsControllerDefaultState=s.defaultRewardsControllerState=s.RewardsController=s.DEFAULT_BLOCKED_REGIONS=void 0,s.wrapWithCache=M;var n,a=e("@metamask/base-controller"),r=(n=e("loglevel"))&&n.__esModule?n:{default:n},i=e("@solana/addresses"),o=e("@metamask/utils"),c=e("ethers/lib/utils"),l=e("../../../../shared/lib/accounts"),u=e("../../../../shared/lib/multichain/accounts"),d=e("./rewards-data-service"),p=e("./utils/solana-snap"),h=e("./utils/bitcoin-snap"),m=e("./utils/tron-snap"),g=e("./utils/sortAccounts");function f(e,t,s){w(e,t),t.set(e,s)}function w(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function v(e,t){return e.get(S(e,t))}function y(e,t,s){return e.set(S(e,t),s),s}function S(e,t,s){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:s;throw new TypeError("Private element is not present on this object")}const b=s.DEFAULT_BLOCKED_REGIONS=["UK"],k=36e5,T={rewardsActiveAccount:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},rewardsAccounts:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},rewardsSubscriptions:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},rewardsSeasons:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},rewardsSeasonStatuses:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0},rewardsSubscriptionTokens:{includeInStateLogs:!1,persist:!0,includeInDebugSnapshot:!0,usedInUi:!1},rewardsEnabled:{includeInStateLogs:!0,persist:!1,includeInDebugSnapshot:!1,usedInUi:!0},rewardsPointsEstimateHistory:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!1}},A=()=>({rewardsActiveAccount:null,rewardsAccounts:{},rewardsSubscriptions:{},rewardsSeasons:{},rewardsSeasonStatuses:{},rewardsSubscriptionTokens:{},rewardsPointsEstimateHistory:[]});s.getRewardsControllerDefaultState=A;const _=s.defaultRewardsControllerState={rewardsActiveAccount:null,rewardsAccounts:{},rewardsSubscriptions:{},rewardsSeasons:{},rewardsSeasonStatuses:{},rewardsSubscriptionTokens:{},rewardsPointsEstimateHistory:[]},E=new Date("2025-10-27T00:00:00.000Z");async function M({key:e,ttl:t,readCache:s,fetchFresh:n,writeCache:a,swrCallback:i}){try{const o=s(e);if(o){if(!(!o.lastFetched||Date.now()-o.lastFetched>t))return o.payload;if(i)return(async()=>{try{const t=await n();a(e,t),i(o.payload,t)}catch(e){r.default.error("SWR revalidation failed:",e instanceof Error?e.message:String(e))}})(),o.payload}}catch(e){r.default.error("RewardsController: wrapWithCache cache read failed, fetching fresh",e instanceof Error?e.message:String(e))}const o=await n();try{a(e,o)}catch(e){r.default.error("RewardsController: wrapWithCache writeCache failed",e instanceof Error?e.message:String(e))}return o}var I=new WeakMap,P=new WeakMap,C=new WeakMap,j=new WeakMap,O=new WeakSet;class N extends a.BaseController{calculateTierStatus(e,t,s){const n=[...e].sort((e,t)=>e.pointsNeeded-t.pointsNeeded),a=n.find(e=>e.id===t);if(!a)throw new Error(`Current tier ${t} not found in season tiers`);const r=n.findIndex(e=>e.id===t),i=r<n.length-1?n[r+1]:null;return{currentTier:a,nextTier:i,nextTierPointsNeeded:i?Math.max(0,i.pointsNeeded-s):null}}convertToSeasonStatusDto(e,t){return{season:{id:e.id,name:e.name,startDate:new Date(e.startDate),endDate:new Date(e.endDate),tiers:e.tiers},balance:{total:t.balance,updatedAt:t.updatedAt},currentTierId:t.currentTierId}}constructor({messenger:e,state:t,isDisabled:s,isBitcoinDisabled:n,isTronDisabled:a}){super({name:"RewardsController",metadata:T,messenger:e,state:{..._,...t}}),function(e,t){w(e,t),t.add(e)}(this,O),f(this,I,null),f(this,P,void 0),f(this,C,void 0),f(this,j,void 0),S(O,this,F).call(this),S(O,this,x).call(this),y(P,this,s),y(C,this,n),y(j,this,a)}resetState(){this.update(()=>({rewardsActiveAccount:null,rewardsAccounts:{},rewardsSubscriptions:{},rewardsSeasons:{},rewardsSeasonStatuses:{},rewardsSubscriptionTokens:{},rewardsPointsEstimateHistory:[]}))}getActualSubscriptionId(e){const t=S(O,this,B).call(this,e);return(null==t?void 0:t.subscriptionId)||null}async handleAuthenticationTrigger(e){if(this.isRewardsFeatureEnabled())try{const e=this.messenger.call("AccountTreeController:getAccountsFromSelectedAccountGroup");if(e&&0!==e.length){const t=(0,g.sortAccounts)(e);try{await this.getOptInStatus({addresses:t.map(e=>e.address)})}catch{}let s=null;for(const e of t)try{await this.performSilentAuth(e,!1,!0)&&!s&&(s=e)}catch{}const n=s||t[0];if(n){const e=this.convertInternalAccountToCaipAccountId(n);if(e){const t=S(O,this,B).call(this,e);t&&this.update(e=>{e.rewardsActiveAccount=t})}}}else await this.performSilentAuth(null,!0,!0)}catch{}else await this.performSilentAuth(null,!0,!0)}shouldSkipSilentAuth(e,t){if(!this.isOptInSupported(t))return!0;const s=S(O,this,B).call(this,e);return!!s&&(!1===s.hasOptedIn?!!s.lastFreshOptInStatusCheck&&Date.now()-s.lastFreshOptInStatusCheck<=k:Boolean(s.subscriptionId)&&Boolean(S(O,this,W).call(this,s.subscriptionId)))}isOptInSupported(e){try{return!(0,l.isHardwareAccount)(e)&&(!!(0,c.isAddress)(e.address)||(!!(0,i.isAddress)(e.address)||((0,u.isBtcMainnetAddress)(e.address)||(0,u.isBtcTestnetAddress)(e.address)?!v(C,this).call(this):!!(0,u.isTronAddress)(e.address)&&!v(j,this).call(this))))}catch(e){return r.default.error("RewardsController: Exception checking opt-in support, assuming not supported:",e),!1}}convertInternalAccountToCaipAccountId(e){try{const[t]=e.scopes,{namespace:s,reference:n}=(0,o.parseCaipChainId)(t);return(0,o.toCaipAccountId)(s,n,e.address)}catch(e){return r.default.error("RewardsController: Failed to convert address to CAIP-10 format:",e),null}}async performSilentAuth(e,t=!0,s=!0){var n;if(!e)return t&&this.update(e=>{e.rewardsActiveAccount=null}),null;const a=this.convertInternalAccountToCaipAccountId(e),i=!!a&&this.shouldSkipSilentAuth(a,e);if(i&&s){var o;let e=S(O,this,B).call(this,a);return e?this.update(s=>{t&&(s.rewardsActiveAccount=e)}):(e={account:a,hasOptedIn:!1,subscriptionId:null,perpsFeeDiscount:null,lastPerpsDiscountRateFetched:null},this.update(s=>{s.rewardsAccounts[a]=e,t&&(s.rewardsActiveAccount=e)})),(null===(o=e)||void 0===o?void 0:o.subscriptionId)||null}let c=null,l=!1;if(s&&!i)try{const s=await this.getOptInStatus({addresses:[e.address]});if(s.ois&&!1===s.ois[0])return c=null,this.update(e=>{if(!a)return;const s={account:a,hasOptedIn:!1,subscriptionId:null,perpsFeeDiscount:null,lastPerpsDiscountRateFetched:null,lastFreshOptInStatusCheck:Date.now()};e.rewardsAccounts[a]=s,t&&(e.rewardsActiveAccount=s)}),null}catch{}try{let t,s=Math.floor(Date.now()/1e3),n=0;const a=1;try{t=await S(O,this,U).call(this,e,s)}catch(e){if(r.default.error("RewardsController: Failed to generate signature:",e),e&&"object"==typeof e&&"message"in e){if(e.message.includes("controller is locked"))return null}throw e}const i=async(r,o)=>{try{return await this.messenger.call("RewardsDataService:login",{account:e.address,timestamp:r,signature:o})}catch(r){if(r instanceof d.InvalidTimestampError&&n<a)return n+=1,s=r.timestamp,t=await S(O,this,U).call(this,e,s),await i(s,t);throw r}},o=await i(s,t);c=o.subscription,S(O,this,$).call(this,c.id,o.sessionId)}catch(e){e instanceof Error&&e.message.includes("401")?r.default.error("RewardsController: Account not opt-in",a):(c=null,l=!0)}finally{this.update(e=>{var s;if(!a)return;const n={account:a,hasOptedIn:l?undefined:Boolean(c),subscriptionId:(null===(s=c)||void 0===s?void 0:s.id)||null,perpsFeeDiscount:null,lastPerpsDiscountRateFetched:null};if(e.rewardsAccounts[a]=n,t&&(e.rewardsActiveAccount=n),c){var r;if(null===(r=e.rewardsSubscriptions[c.id])||void 0===r||!r.candidateAt){const t=Object.keys(e.rewardsSubscriptions??{}).length>0?new Date:E;c.candidateAt=t.toISOString()}e.rewardsSubscriptions[c.id]=c}})}return(null===(n=c)||void 0===n?void 0:n.id)||null}async getHasAccountOptedIn(e){var t;return!!this.isRewardsFeatureEnabled()&&((null===(t=S(O,this,B).call(this,e))||void 0===t?void 0:t.hasOptedIn)??!1)}checkOptInStatusAgainstCache(e,t){const s=new Array(e.length).fill(null),n=new Array(e.length).fill(null),a=[];for(let r=0;r<e.length;r++){const i=e[r],o=t.get(i.toLowerCase());if(o){const e=this.convertInternalAccountToCaipAccountId(o);if(e){const t=S(O,this,B).call(this,e);if((null==t?void 0:t.hasOptedIn)!==undefined){const e=!t.lastFreshOptInStatusCheck||Date.now()-t.lastFreshOptInStatusCheck>k;if(!1===t.hasOptedIn&&e){a.push(i);continue}s[r]=t.hasOptedIn,n[r]=t.subscriptionId||null;continue}}}a.push(i)}return{cachedOptInResults:s,cachedSubscriptionIds:n,addressesNeedingFresh:a}}async getOptInStatus(e){if(!this.isRewardsFeatureEnabled())return{ois:e.addresses.map(()=>!1),sids:e.addresses.map(()=>null)};try{const t=this.messenger.call("AccountsController:listMultichainAccounts"),s=new Map;for(const e of t)s.set(e.address.toLowerCase(),e);const{cachedOptInResults:n,cachedSubscriptionIds:a,addressesNeedingFresh:r}=this.checkOptInStatusAgainstCache(e.addresses,s);let i=[],o=[];if(r.length>0){const e=await this.messenger.call("RewardsDataService:getOptInStatus",{addresses:r});i=e.ois,o=e.sids;for(let e=0;e<r.length;e++){const t=r[e],n=i[e],a=Array.isArray(o)&&e<o.length?o[e]:null,c=s.get(t.toLowerCase());if(c){const e=this.convertInternalAccountToCaipAccountId(c);if(e){const t=Date.now();this.update(s=>{var r;s.rewardsAccounts[e]?(s.rewardsAccounts[e].hasOptedIn=n,s.rewardsAccounts[e].subscriptionId=a,s.rewardsAccounts[e].lastFreshOptInStatusCheck=t):s.rewardsAccounts[e]={account:e,hasOptedIn:n,subscriptionId:a,perpsFeeDiscount:null,lastPerpsDiscountRateFetched:null,lastFreshOptInStatusCheck:t},(null===(r=s.rewardsActiveAccount)||void 0===r?void 0:r.account)===e&&(s.rewardsActiveAccount.hasOptedIn=n,s.rewardsActiveAccount.subscriptionId=a,s.rewardsActiveAccount.lastFreshOptInStatusCheck=t)})}}}}const c=[],l=[];let u=0;for(let t=0;t<e.addresses.length;t++)null===n[t]?(c[t]=i[u],l[t]=o[u],u+=1):(c[t]=n[t],l[t]=a[t]);return{ois:c,sids:l}}catch(e){throw r.default.error("RewardsController: Failed to get opt-in status:",e instanceof Error?e.message:String(e)),e}}async estimatePoints(e){if(!this.isRewardsFeatureEnabled())return{pointsEstimate:0,bonusBips:0};try{const t=await this.messenger.call("RewardsDataService:estimatePoints",e);try{this.addPointsEstimateToHistory(e,t)}catch(e){r.default.error("RewardsController: Failed to add points estimate to history:",e instanceof Error?e.message:String(e))}return t}catch(e){throw r.default.error("RewardsController: Failed to estimate points:",e instanceof Error?e.message:String(e)),e}}addPointsEstimateToHistory(e,t){const{activityContext:s}=e,n={timestamp:Date.now(),requestActivityType:e.activityType,requestAccount:e.account,...s.swapContext&&{requestSwapSrcAssetId:s.swapContext.srcAsset.id,requestSwapSrcAssetAmount:s.swapContext.srcAsset.amount,requestSwapSrcAssetUsdPrice:s.swapContext.srcAsset.usdPrice,requestSwapDestAssetId:s.swapContext.destAsset.id,requestSwapDestAssetAmount:s.swapContext.destAsset.amount,requestSwapDestAssetUsdPrice:s.swapContext.destAsset.usdPrice,requestSwapFeeAssetId:s.swapContext.feeAsset.id,requestSwapFeeAssetAmount:s.swapContext.feeAsset.amount,requestSwapFeeAssetUsdPrice:s.swapContext.feeAsset.usdPrice},...s.perpsContext&&!Array.isArray(s.perpsContext)&&{requestPerpsType:s.perpsContext.type,requestPerpsUsdFeeValue:s.perpsContext.usdFeeValue,requestPerpsCoin:s.perpsContext.coin},...s.shieldContext&&{requestShieldRecurringInterval:s.shieldContext.recurringInterval},responsePointsEstimate:t.pointsEstimate,responseBonusBips:t.bonusBips};this.update(e=>{e.rewardsPointsEstimateHistory.unshift(n),e.rewardsPointsEstimateHistory.length>50&&(e.rewardsPointsEstimateHistory=e.rewardsPointsEstimateHistory.slice(0,50))})}isRewardsFeatureEnabled(){return!v(P,this).call(this)}async getSeasonMetadata(e="current"){return await M({key:e,ttl:6e5,readCache:e=>{const t=this.state.rewardsSeasons[e]||undefined;return t?{payload:t,lastFetched:t.lastFetched}:undefined},fetchFresh:async()=>{var t;const s=await this.messenger.call("RewardsDataService:getDiscoverSeasons");let n=null;if("current"===e?n=s.current:"next"===e&&(n=s.next),null!==(t=n)&&void 0!==t&&t.startDate){const e=await this.messenger.call("RewardsDataService:getSeasonMetadata",n.id);return{...S(O,this,R).call(this,{id:e.id,name:e.name,startDate:e.startDate,endDate:e.endDate,tiers:e.tiers}),lastFetched:Date.now()}}throw new Error(`No valid season metadata could be found for type: ${e}`)},writeCache:(e,t)=>{this.update(s=>{s.rewardsSeasons[e]=t,s.rewardsSeasons[t.id]=t})}})}async getSeasonStatus(e,t){if(!this.isRewardsFeatureEnabled())return null;const s=this.state.rewardsSeasons[t];if(!s)throw new Error(`Failed to get season status: season not found for seasonId: ${t}`);return await M({key:S(O,this,L).call(this,t,e),ttl:6e4,readCache:e=>{const t=this.state.rewardsSeasonStatuses[e]||undefined;return t?{payload:t,lastFetched:t.lastFetched}:undefined},fetchFresh:async()=>{try{const n=S(O,this,W).call(this,e);if(!n)throw new d.AuthorizationFailedError(`No subscription token found for subscription ID: ${e}`);const a=await this.messenger.call("RewardsDataService:getSeasonStatus",t,n),r=this.convertToSeasonStatusDto(s,a);return S(O,this,D).call(this,r)}catch(t){if(t instanceof d.AuthorizationFailedError)try{var n;if((null===(n=this.state.rewardsActiveAccount)||void 0===n?void 0:n.subscriptionId)===e){const e=await this.messenger.call("AccountsController:getSelectedMultichainAccount");await this.performSilentAuth(e,!1,!1)}else if(this.state.rewardsAccounts&&Object.values(this.state.rewardsAccounts).length>0){const t=Object.values(this.state.rewardsAccounts).find(t=>t.subscriptionId===e);if(t){const e=await this.messenger.call("AccountsController:listMultichainAccounts"),{convertInternalAccountToCaipAccountId:s}=this,n=e.find(e=>s(e)===t.account);n&&await this.performSilentAuth(n,!1,!1)}}const t=S(O,this,W).call(this,e);if(!t)throw new Error(`No subscription token found for subscription ID: ${e}`);const a=await this.messenger.call("RewardsDataService:getSeasonStatus",s.id,t),r=this.convertToSeasonStatusDto(s,a);return S(O,this,D).call(this,r)}catch{throw r.default.error("RewardsController: Failed to reauth with a valid account after 403 error",t instanceof Error?t.message:String(t)),this.invalidateSubscriptionCache(e),this.invalidateAccountsAndSubscriptions(),t}else if(t instanceof d.SeasonNotFoundError)throw this.update(e=>{e.rewardsSeasons={}}),t;throw r.default.error("RewardsController: Failed to get season status:",t instanceof Error?t.message:String(t)),t}},writeCache:(e,t)=>{this.update(s=>{s.rewardsSeasonStatuses[e]=t})}})}invalidateAccountsAndSubscriptions(){this.update(e=>{e.rewardsActiveAccount&&(e.rewardsActiveAccount={...e.rewardsActiveAccount,hasOptedIn:!1,subscriptionId:null,lastFreshOptInStatusCheck:null,account:e.rewardsActiveAccount.account}),e.rewardsAccounts={},e.rewardsSubscriptions={},e.rewardsSubscriptionTokens={}})}async optIn(e,t){var s;if(!this.isRewardsFeatureEnabled())return null;if(!e||0===e.length)return null;const n=(0,g.sortAccounts)(e);let a=null,r=null;for(const e of n){try{r=await S(O,this,H).call(this,e,t)}catch{}if(r){a=e;break}}if(!a||!r)throw new Error("Failed to opt in any account from the account group");const i=n.filter(e=>{var t;return e.address!==(null===(t=a)||void 0===t?void 0:t.address)});return i.length>0&&await this.linkAccountsToSubscriptionCandidate(i),(null===(s=r)||void 0===s?void 0:s.subscription.id)||null}async getRewardsGeoMetadata(){if(!this.isRewardsFeatureEnabled())return{geoLocation:"UNKNOWN",optinAllowedForGeo:!1};if(v(I,this))return v(I,this);try{const e=await this.messenger.call("RewardsDataService:fetchGeoLocation"),t=!b.some(t=>e.startsWith(t)),s={geoLocation:e,optinAllowedForGeo:t};return y(I,this,s),s}catch(e){return{geoLocation:"UNKNOWN",optinAllowedForGeo:!0}}}async validateReferralCode(e){if(!this.isRewardsFeatureEnabled())return!1;if(!e.trim())return!1;if(6!==e.length)return!1;return(await this.messenger.call("RewardsDataService:validateReferralCode",e)).valid}async getCandidateSubscriptionId(){var e;if(!this.isRewardsFeatureEnabled())return null;if(null!==(e=this.state.rewardsActiveAccount)&&void 0!==e&&e.subscriptionId)return this.state.rewardsActiveAccount.subscriptionId;const t=Object.keys(this.state.rewardsSubscriptions);if(1===t.length)return t[0];if(t.length>1){const e=Object.values(this.state.rewardsSubscriptions).sort((e,t)=>{try{const s=(null==e?void 0:e.candidateAt)||(null==e?void 0:e.createdAt),n=(null==t?void 0:t.candidateAt)||(null==t?void 0:t.createdAt);return new Date(s).getTime()-new Date(n).getTime()}catch{return 0}});return e.length>0?e[0].id:t[0]}try{var s;const e=this.messenger.call("AccountsController:listMultichainAccounts"),t=(null==e?void 0:e.filter(e=>this.isOptInSupported(e)))||[];if(!t||0===t.length)return null;const n=t.map(e=>e.address),a=await this.getOptInStatus({addresses:n});if(null==a||null===(s=a.ois)||void 0===s||!s.filter(e=>e).length)return null;const i=Math.min(10,a.ois.length);let o=0;for(let e=0;e<t.length&&!(o>i);e++){const s=t[e];if(!s||!1===a.ois[e])continue;let n=Array.isArray(null==a?void 0:a.sids)&&e<a.sids.length?a.sids[e]:null;const i=n?this.state.rewardsSubscriptionTokens[n]:undefined;if(n&&Boolean(i)&&this.state.rewardsSubscriptions[n])return n;try{if(o+=1,n=await this.performSilentAuth(s,!1,!1),n)return n}catch(e){r.default.error("RewardsController: Silent auth failed for account during candidate search:",s.address,e instanceof Error?e.message:String(e))}}}catch(e){r.default.error("RewardsController: Failed to get candidate subscription ID:",e instanceof Error?e.message:String(e))}throw new Error("No candidate subscription ID found after all silent auth attempts. There is an opted in account but we cannot use it to fetch the season status.")}async linkAccountToSubscriptionCandidate(e,t=!0){if(!this.isRewardsFeatureEnabled())return!1;const s=this.convertInternalAccountToCaipAccountId(e);if(!s)throw new Error("Failed to convert account to CAIP-10 format");const n=S(O,this,B).call(this,s);if(null!=n&&n.subscriptionId){if(this.state.rewardsSubscriptions[n.subscriptionId])return!0}const a=await this.getCandidateSubscriptionId();if(!a)throw new Error("No valid subscription found to link account to");if(!this.isOptInSupported(e))return!1;try{let n=Math.floor(Date.now()/1e3),r=await S(O,this,U).call(this,e,n),i=0;const o=1,c=async(t,s)=>{try{const n=S(O,this,W).call(this,a);if(!n)throw new Error(`No subscription token found for subscription ID: ${a}`);return await this.messenger.call("RewardsDataService:mobileJoin",{account:e.address,timestamp:t,signature:s},n)}catch(t){if(t instanceof d.InvalidTimestampError&&i<o)return i+=1,n=t.timestamp,r=await S(O,this,U).call(this,e,n),await c(n,r);if(t instanceof d.AccountAlreadyRegisteredError){const t=await this.performSilentAuth(e,!1,!1);if(t&&this.state.rewardsSubscriptions[t])return this.state.rewardsSubscriptions[t]}throw t}},l=await c(n,r);return this.update(e=>{var t;e.rewardsAccounts[s]={account:s,hasOptedIn:!0,subscriptionId:l.id,perpsFeeDiscount:null,lastPerpsDiscountRateFetched:null},(null===(t=e.rewardsActiveAccount)||void 0===t?void 0:t.account)===s&&(e.rewardsActiveAccount=e.rewardsAccounts[s])}),t&&(this.invalidateSubscriptionCache(l.id),this.messenger.publish("RewardsController:accountLinked",{subscriptionId:l.id,account:s})),!0}catch(e){return r.default.error("RewardsController: Failed to link account to subscription",s,a,e),!1}}async linkAccountsToSubscriptionCandidate(e){var t;if(!this.isRewardsFeatureEnabled())return e.map(e=>({account:e,success:!1}));if(0===e.length)return[];let s=null;const n=[];for(const t of e)try{const e=this.convertInternalAccountToCaipAccountId(t),a=S(O,this,B).call(this,e);if(null!=a&&a.subscriptionId)continue;const r=await this.linkAccountToSubscriptionCandidate(t,!1);if(r){const a=S(O,this,B).call(this,e);a&&(s=a),n.push({account:t,success:r})}else n.push({account:t,success:!1})}catch{n.push({account:t,success:!1})}return null!==(t=s)&&void 0!==t&&t.subscriptionId&&(this.invalidateSubscriptionCache(s.subscriptionId),this.messenger.publish("RewardsController:accountLinked",{subscriptionId:s.subscriptionId,account:s.account})),n}invalidateSubscriptionCache(e,t){if(t){const s=S(O,this,L).call(this,t,e);this.update(e=>{delete e.rewardsSeasonStatuses[s]})}else this.update(t=>{Object.keys(t.rewardsSeasonStatuses).forEach(s=>{s.includes(e)&&delete t.rewardsSeasonStatuses[s]})})}}function R(e){return{id:e.id,name:e.name,startDate:e.startDate.getTime(),endDate:e.endDate.getTime(),tiers:e.tiers}}function D(e){var t;const s=this.calculateTierStatus(e.season.tiers,e.currentTierId,e.balance.total);return{season:S(O,this,R).call(this,e.season),balance:{total:e.balance.total,updatedAt:null===(t=e.balance.updatedAt)||void 0===t?void 0:t.getTime()},tier:s,lastFetched:Date.now()}}function F(){this.messenger.registerActionHandler("RewardsController:getHasAccountOptedIn",this.getHasAccountOptedIn.bind(this)),this.messenger.registerActionHandler("RewardsController:estimatePoints",this.estimatePoints.bind(this)),this.messenger.registerActionHandler("RewardsController:isRewardsFeatureEnabled",this.isRewardsFeatureEnabled.bind(this)),this.messenger.registerActionHandler("RewardsController:getSeasonMetadata",this.getSeasonMetadata.bind(this)),this.messenger.registerActionHandler("RewardsController:getSeasonStatus",this.getSeasonStatus.bind(this)),this.messenger.registerActionHandler("RewardsController:optIn",this.optIn.bind(this)),this.messenger.registerActionHandler("RewardsController:getGeoRewardsMetadata",this.getRewardsGeoMetadata.bind(this)),this.messenger.registerActionHandler("RewardsController:validateReferralCode",this.validateReferralCode.bind(this)),this.messenger.registerActionHandler("RewardsController:linkAccountToSubscriptionCandidate",this.linkAccountToSubscriptionCandidate.bind(this)),this.messenger.registerActionHandler("RewardsController:linkAccountsToSubscriptionCandidate",this.linkAccountsToSubscriptionCandidate.bind(this)),this.messenger.registerActionHandler("RewardsController:getCandidateSubscriptionId",this.getCandidateSubscriptionId.bind(this)),this.messenger.registerActionHandler("RewardsController:getOptInStatus",this.getOptInStatus.bind(this)),this.messenger.registerActionHandler("RewardsController:isOptInSupported",this.isOptInSupported.bind(this)),this.messenger.registerActionHandler("RewardsController:getActualSubscriptionId",this.getActualSubscriptionId.bind(this))}function x(){this.messenger.subscribe("AccountTreeController:selectedAccountGroupChange",()=>this.handleAuthenticationTrigger("Account Group changed")),this.messenger.subscribe("KeyringController:unlock",()=>this.handleAuthenticationTrigger("KeyringController unlocked"))}function B(e){let t=null;var s;null!=e&&e.startsWith("eip155")&&(t=this.state.rewardsAccounts[`eip155:0:${null===(s=e.split(":")[2])||void 0===s?void 0:s.toLowerCase()}`]||this.state.rewardsAccounts[`eip155:0:${e.split(":")[2]}`]);return t||(t=this.state.rewardsAccounts[e]),t||null}function L(e,t){return`${e}:${t}`}async function U(e,s){const n=`rewards,${e.address},${s}`;if((0,i.isAddress)(e.address)){const s=await(0,p.signSolanaRewardsMessage)(this.messenger.call.bind(this.messenger,"SnapController:handleRequest"),e.id,t.from(n,"utf8").toString("base64"));return`0x${t.from(c.base58.decode(s.signature)).toString("hex")}`}if((0,u.isBtcMainnetAddress)(e.address)||(0,u.isBtcTestnetAddress)(e.address)){if(v(C,this).call(this))throw new Error("Unsupported account type for signing rewards message");const s=await(0,h.signBitcoinRewardsMessage)(this.messenger.call.bind(this.messenger,"SnapController:handleRequest"),e.id,t.from(n,"utf8").toString("base64"));return s.signature.startsWith("0x")?s.signature:`0x${s.signature}`}if((0,u.isTronAddress)(e.address)){if(v(j,this).call(this))throw new Error("Unsupported account type for signing rewards message");const s=await(0,m.signTronRewardsMessage)(this.messenger.call.bind(this.messenger,"SnapController:handleRequest"),e.id,t.from(n,"utf8").toString("base64"));return s.signature.startsWith("0x")?s.signature:`0x${s.signature}`}if((0,c.isAddress)(e.address)){return await S(O,this,G).call(this,e,n)}throw new Error("Unsupported account type for signing rewards message")}async function G(e,s){const n=`0x${t.from(s,"utf8").toString("hex")}`;return await this.messenger.call("KeyringController:signPersonalMessage",{data:n,from:e.address})}function $(e,t){this.update(s=>{s.rewardsSubscriptionTokens[e]=t})}function W(e){return this.state.rewardsSubscriptionTokens[e]}async function H(e,t){var s;if(!this.isRewardsFeatureEnabled())return null;let n=Math.floor(Date.now()/1e3),a=await S(O,this,U).call(this,e,n),r=0;const i=async(s,o)=>{try{return await this.messenger.call("RewardsDataService:mobileOptin",{account:e.address,timestamp:s,signature:o,referralCode:t})}catch(t){if(t instanceof d.InvalidTimestampError&&r<1)return r+=1,n=t.timestamp,a=await S(O,this,U).call(this,e,n),await i(n,a);if(t instanceof d.AccountAlreadyRegisteredError){const t=await this.performSilentAuth(e,!1,!1);if(t&&this.state.rewardsSubscriptions[t]){const e=this.state.rewardsSubscriptions[t],s=S(O,this,W).call(this,t);if(s)return{sessionId:s,subscription:e}}}throw t}},o=await i(n,a);return null!==(s=o.subscription)&&void 0!==s&&s.id&&o.sessionId&&S(O,this,$).call(this,o.subscription.id,o.sessionId),this.update(t=>{var s,n;const a=this.convertInternalAccountToCaipAccountId(e);if(!a)return;const r={account:a,hasOptedIn:!0,subscriptionId:o.subscription.id,perpsFeeDiscount:null,lastPerpsDiscountRateFetched:null};if(t.rewardsActiveAccount&&t.rewardsActiveAccount.account===a&&(t.rewardsActiveAccount=r),t.rewardsAccounts[a]=r,null!=o&&null!==(s=o.subscription)&&void 0!==s&&s.id&&(null===(n=t.rewardsSubscriptions[o.subscription.id])||void 0===n||!n.candidateAt)){const e=Object.keys(t.rewardsSubscriptions??{}).length>0?new Date:E;o.subscription.candidateAt=e.toISOString()}t.rewardsSubscriptions[o.subscription.id]=o.subscription}),{subscription:o.subscription,sessionId:o.sessionId}}s.RewardsController=N}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"$root$",file:"app/scripts/controllers/rewards/rewards-controller.ts"}],[249,{"../../../../development/build/constants":623,"../../../../shared/constants/rewards":6201,"../../../../shared/modules/i18n":6325,"../../platforms/extension":608,loglevel:5247},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.getNormalisedLocale=s.SeasonNotFoundError=s.RewardsDataService=s.InvalidTimestampError=s.AuthorizationFailedError=s.AccountAlreadyRegisteredError=void 0;var n=c(e("loglevel")),a=e("../../../../development/build/constants"),r=c(e("../../platforms/extension")),i=e("../../../../shared/constants/rewards"),o=e("../../../../shared/modules/i18n");function c(e){return e&&e.__esModule?e:{default:e}}function l(e,t,s){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,s)}function u(e,t){return e.get(p(e,t))}function d(e,t,s){return e.set(p(e,t),s),s}function p(e,t,s){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:s;throw new TypeError("Private element is not present on this object")}function h(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class m extends Error{constructor(e,t){super(e),h(this,"timestamp",void 0),this.name="InvalidTimestampError",this.timestamp=t}}s.InvalidTimestampError=m;class g extends Error{constructor(e=g.defaultMessage){super(e),this.name="AuthorizationFailedError"}}s.AuthorizationFailedError=g,h(g,"defaultMessage",i.REWARDS_ERROR_MESSAGES.AUTHORIZATION_FAILED);class f extends Error{constructor(e=f.defaultMessage){super(e),this.name="SeasonNotFoundError"}}s.SeasonNotFoundError=f,h(f,"defaultMessage",i.REWARDS_ERROR_MESSAGES.SEASON_NOT_FOUND);class w extends Error{constructor(e){super(e),this.name="AccountAlreadyRegisteredError"}}s.AccountAlreadyRegisteredError=w;const v="RewardsDataService",y="https://on-ramp.api.cx.metamask.io/geolocation",S=e=>Intl.getCanonicalLocales(e?e.replace(/_/gu,"-"):o.FALLBACK_LOCALE)[0];s.getNormalisedLocale=S;var b=new WeakMap,k=new WeakMap,T=new WeakMap;s.RewardsDataService=class{constructor({messenger:e,fetch:t}){h(this,"name",v),l(this,b,void 0),l(this,k,void 0),l(this,T,void 0),d(b,this,e),d(k,this,t),d(T,this,this.getRewardsApiBaseUrl()),u(b,this).registerActionHandler(`${v}:login`,this.login.bind(this)),u(b,this).registerActionHandler(`${v}:estimatePoints`,this.estimatePoints.bind(this)),u(b,this).registerActionHandler(`${v}:mobileOptin`,this.mobileOptin.bind(this)),u(b,this).registerActionHandler(`${v}:getSeasonStatus`,this.getSeasonStatus.bind(this)),u(b,this).registerActionHandler(`${v}:fetchGeoLocation`,this.fetchGeoLocation.bind(this)),u(b,this).registerActionHandler(`${v}:validateReferralCode`,this.validateReferralCode.bind(this)),u(b,this).registerActionHandler(`${v}:mobileJoin`,this.mobileJoin.bind(this)),u(b,this).registerActionHandler(`${v}:getOptInStatus`,this.getOptInStatus.bind(this)),u(b,this).registerActionHandler(`${v}:getSeasonMetadata`,this.getSeasonMetadata.bind(this)),u(b,this).registerActionHandler(`${v}:getDiscoverSeasons`,this.getDiscoverSeasons.bind(this))}getRewardsApiBaseUrl(){return"production"===a.ENVIRONMENT.PRODUCTION||"production"===a.ENVIRONMENT.RELEASE_CANDIDATE?i.REWARDS_API_URL.PRD:i.REWARDS_API_URL.UAT}getLocale(){try{const e=u(b,this).call("PreferencesController:getState"),t=(null==e?void 0:e.currentLocale)||"en-US";return/^[a-z]{2}[-_][a-z]{2}$/iu.test(t)?t:S(t)}catch(e){n.default.warn("Failed to get locale from PreferencesController:",e);try{const e=u(b,this).call("PreferencesController:getState");return(null==e?void 0:e.currentLocale)||"en-US"}catch{return"en-US"}}}async makeRequest(e,t={},s,n=1e4){const a={"Content-Type":"application/json"};try{const e=(new r.default).getVersion();a["rewards-client-id"]=`extension-${e}`}catch(e){console.warn("Failed to retrieve app version for client header:",e)}s&&(a["rewards-access-token"]=s);const i=this.getLocale();i&&(a["Accept-Language"]=i);const o=`${u(T,this)}${e}`,c=new AbortController,l=setTimeout(()=>{c.abort()},n);try{const e=await u(k,this).call(this,o,{credentials:"omit",...t,headers:{...a,...t.headers},signal:c.signal});return clearTimeout(l),e}catch(e){if(clearTimeout(l),e instanceof Error&&"AbortError"===e.name)throw new Error(`Request timeout after ${n}ms`);throw e}}checkForAccountAlreadyRegisteredError(e,t){var s;if(409===e.status&&null!=t&&null!==(s=t.message)&&void 0!==s&&s.toLowerCase().includes("already registered"))throw new w(t.message||"Account is already registered")}async login(e){const t=await this.makeRequest("/auth/mobile-login",{method:"POST",body:JSON.stringify(e)});if(!t.ok){var s;const e=await t.json();if(null!=e&&null!==(s=e.message)&&void 0!==s&&s.includes("Invalid timestamp"))throw new m("Invalid timestamp. Please try again with a new timestamp.",Math.floor(Number(e.serverTimestamp)/1e3));throw this.checkForAccountAlreadyRegisteredError(t,e),new Error(`Login failed: ${t.status}`)}return await t.json()}async estimatePoints(e){const t=await this.makeRequest("/points-estimation",{method:"POST",body:JSON.stringify(e)});if(!t.ok)throw new Error(`Points estimation failed: ${t.status}`);return await t.json()}async mobileOptin(e){const t=await this.makeRequest("/auth/mobile-optin",{method:"POST",body:JSON.stringify(e)});if(!t.ok){var s;const e=await t.json();if(n.default.error("RewardsDataService: mobileOptin errorData",e),null!=e&&null!==(s=e.message)&&void 0!==s&&s.includes("Invalid timestamp"))throw new m("Invalid timestamp. Please try again with a new timestamp.",Math.floor(Number(e.serverTimestamp)/1e3));throw this.checkForAccountAlreadyRegisteredError(t,e),new Error(`Optin failed: ${t.status}`)}return await t.json()}async getSeasonStatus(e,t){const s=await this.makeRequest(`/seasons/${e}/state`,{method:"GET"},t);if(!s.ok){var n,a;const e=await s.json();if(null!=e&&null!==(n=e.message)&&void 0!==n&&n.includes("Rewards authorization failed"))throw new g;if(null!=e&&null!==(a=e.message)&&void 0!==a&&a.includes("Season not found"))throw new f;throw new Error(`Get season state failed: ${s.status}`)}const r=await s.json();return r.updatedAt&&(r.updatedAt=new Date(r.updatedAt)),r}async fetchGeoLocation(){let e="UNKNOWN";try{const t=await u(k,this).call(this,y);return t.ok?(e=await(null==t?void 0:t.text()),e):e}catch(t){return console.error("RewardsDataService: Failed to fetch geolocation",t),e}}async validateReferralCode(e){const t=await this.makeRequest(`/referral/validate?code=${encodeURIComponent(e)}`,{method:"GET"});if(!t.ok)throw new Error("Failed to validate referral code. Please try again shortly.");return await t.json()}async mobileJoin(e,t){const s=await this.makeRequest("/wr/subscriptions/mobile-join",{method:"POST",body:JSON.stringify(e)},t);if(!s.ok){var a;const e=await s.json();if(n.default.error("RewardsDataService: mobileJoin errorData",e),null!=e&&null!==(a=e.message)&&void 0!==a&&a.includes("Invalid timestamp"))throw new m("Invalid timestamp. Please try again with a new timestamp.",Math.floor(Number(e.serverTimestamp)/1e3));throw this.checkForAccountAlreadyRegisteredError(s,e),new Error(`Mobile join failed: ${s.status} ${(null==e?void 0:e.message)||""}`)}return await s.json()}async getOptInStatus(e){if(!e.addresses||0===e.addresses.length)throw new Error("Addresses are required");if(e.addresses.length>500)throw new Error("Addresses must be less than 500");const t=await this.makeRequest("/public/rewards/ois",{method:"POST",body:JSON.stringify(e)});if(!t.ok)throw new Error(`Get opt-in status failed: ${t.status}`);return await t.json()}async getDiscoverSeasons(){const e=await this.makeRequest("/public/seasons/status",{method:"GET"});if(!e.ok)throw new Error(`Get discover seasons failed: ${e.status}`);const t=await e.json();return t.current&&(t.current.startDate&&(t.current.startDate=new Date(t.current.startDate)),t.current.endDate&&(t.current.endDate=new Date(t.current.endDate))),t.next&&(t.next.startDate&&(t.next.startDate=new Date(t.next.startDate)),t.next.endDate&&(t.next.endDate=new Date(t.next.endDate))),t}async getSeasonMetadata(e){const t=await this.makeRequest(`/public/seasons/${e}/meta`,{method:"GET"});if(!t.ok)throw new Error(`Get season metadata failed: ${t.status}`);const s=await t.json();return s.startDate&&(s.startDate=new Date(s.startDate)),s.endDate&&(s.endDate=new Date(s.endDate)),s}}}}},{package:"$root$",file:"app/scripts/controllers/rewards/rewards-data-service.ts"}],[25,{"../../../../shared/constants/network":6194,"@metamask/keyring-api":2510,"@metamask/network-enablement-controller":2758,"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.NetworkEnablementControllerInit=void 0;var n=e("@metamask/network-enablement-controller"),a=e("@metamask/keyring-api"),r=e("@metamask/utils"),i=e("../../../../shared/constants/network");const o=(e,t)=>{const s={[r.KnownCaipNamespace.Eip155]:{}};return Object.keys(e).forEach(e=>{s[r.KnownCaipNamespace.Eip155][e]=t.includes(e)}),s},c=(e,t=[])=>{const s={};return Object.keys(e).forEach(e=>{const n=t.includes(e),{namespace:a}=(0,r.parseCaipChainId)(e);(s[a]??(s[a]={}))[e]=n}),s},l=(e,t)=>{const{networkConfigurationsByChainId:s}=e,{multichainNetworkConfigurationsByChainId:n}=t;const r=[a.SolScope.Mainnet];return r.push(a.BtcScope.Mainnet),r.push(a.TrxScope.Mainnet),{enabledNetworkMap:{...o(s,i.FEATURED_NETWORK_CHAIN_IDS),...c(n,r)},nativeAssetIdentifiers:{}}};s.NetworkEnablementControllerInit=({controllerMessenger:e,initMessenger:t,persistedState:s,getController:i})=>{const o=i("MultichainNetworkController").state,c=i("NetworkController").state,u=new n.NetworkEnablementController({messenger:e,state:{...l(c,o),...s.NetworkEnablementController}});return u.init(),t.subscribe("AccountsController:selectedAccountChange",e=>{e.type===a.SolAccountType.DataAccount&&u.enableNetworkInNamespace(a.SolScope.Mainnet,r.KnownCaipNamespace.Solana)}),t.subscribe("AccountTreeController:selectedAccountGroupChange",()=>{const e=t.call("AccountTreeController:getAccountsFromSelectedAccountGroup",{scopes:[a.SolScope.Mainnet]}),s=t.call("AccountTreeController:getAccountsFromSelectedAccountGroup",{scopes:[a.BtcScope.Mainnet]}),n=t.call("AccountTreeController:getAccountsFromSelectedAccountGroup",{scopes:[a.TrxScope.Mainnet]}),r={};for(const e of Object.values(u.state.enabledNetworkMap))Object.assign(r,e);if(1===Object.keys(r).length){const t=Object.keys(r)[0];let i=!1;t===a.SolScope.Mainnet&&0===e.length&&(i=!0),t===a.BtcScope.Mainnet&&0===s.length&&(i=!0),t===a.TrxScope.Mainnet&&0===n.length&&(i=!0),i&&u.enableNetwork("0x1")}}),{controller:u}}}}},{package:"$root$",file:"app/scripts/controller-init/assets/network-enablement-controller-init.ts"}],[250,{"../../../../../shared/lib/accounts":6219,"@metamask/snaps-utils":3382,loglevel:5247},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.signBitcoinRewardsMessage=async function(e,t,s){try{return await e({origin:"metamask",snapId:i.BITCOIN_WALLET_SNAP_ID,handler:a.HandlerType.OnClientRequest,request:{jsonrpc:"2.0",id:Date.now(),method:"signRewardsMessage",params:{accountId:t,message:s}}})}catch(e){throw r.default.error("Error signing Bitcoin rewards message:",e),e}};var n,a=e("@metamask/snaps-utils"),r=(n=e("loglevel"))&&n.__esModule?n:{default:n},i=e("../../../../../shared/lib/accounts")}}},{package:"$root$",file:"app/scripts/controllers/rewards/utils/bitcoin-snap.ts"}],[251,{"../../../../../shared/lib/accounts":6219,"@metamask/snaps-utils":3382,loglevel:5247},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.signSolanaRewardsMessage=async function(e,t,s){try{return await e({origin:"metamask",snapId:i.SOLANA_WALLET_SNAP_ID,handler:a.HandlerType.OnClientRequest,request:{jsonrpc:"2.0",id:Date.now(),method:"signRewardsMessage",params:{accountId:t,message:s}}})}catch(e){throw r.default.error("Error signing Solana rewards message:",e),e}};var n,a=e("@metamask/snaps-utils"),r=(n=e("loglevel"))&&n.__esModule?n:{default:n},i=e("../../../../../shared/lib/accounts")}}},{package:"$root$",file:"app/scripts/controllers/rewards/utils/solana-snap.ts"}],[252,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.sortAccounts=function(e){return[...e].sort((e,t)=>{const s=e.type.startsWith("eip155:"),n=t.type.startsWith("eip155:");return s&&!n?-1:!s&&n?1:0})}}}},{package:"$root$",file:"app/scripts/controllers/rewards/utils/sortAccounts.ts"}],[253,{"../../../../../shared/lib/accounts":6219,"@metamask/snaps-utils":3382,loglevel:5247},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.signTronRewardsMessage=async function(e,t,s){try{return await e({origin:"metamask",snapId:i.TRON_WALLET_SNAP_ID,handler:a.HandlerType.OnClientRequest,request:{jsonrpc:"2.0",id:Date.now(),method:"signRewardsMessage",params:{accountId:t,message:s}}})}catch(e){throw r.default.error("Error signing Tron rewards message:",e),e}};var n,a=e("@metamask/snaps-utils"),r=(n=e("loglevel"))&&n.__esModule?n:{default:n},i=e("../../../../../shared/lib/accounts")}}},{package:"$root$",file:"app/scripts/controllers/rewards/utils/tron-snap.ts"}],[254,{"../../../shared/lib/fetch-with-cache":6272,"@metamask/multichain-network-controller":2682,"@metamask/polling-controller":2889,"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.StaticAssetsController=s.DEFAULT_TOP_X=s.DEFAULT_INTERVAL_MS=s.DEFAULT_CACHE_EXPIRATION_MS=void 0;var n,a=e("@metamask/utils"),r=e("@metamask/polling-controller"),i=e("@metamask/multichain-network-controller"),o=(n=e("../../../shared/lib/fetch-with-cache"))&&n.__esModule?n:{default:n};function c(e,t,s){l(e,t),t.set(e,s)}function l(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function u(e,t){return e.get(p(e,t))}function d(e,t,s){return e.set(p(e,t),s),s}function p(e,t,s){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:s;throw new TypeError("Private element is not present on this object")}const h=s.DEFAULT_INTERVAL_MS=108e5,m=s.DEFAULT_CACHE_EXPIRATION_MS=36e5;s.DEFAULT_TOP_X=10;function g(e,t){const s=(0,a.parseCaipAssetType)(e);return`https://static.cx.metamask.io/api/v2/tokenIcons/assets/${s.chain.namespace}/${s.chain.reference}/${s.assetNamespace}/${s.assetReference.toLowerCase()}.${t}`}var f=new WeakMap,w=new WeakMap,v=new WeakMap,y=new WeakSet;class S extends((0,r.StaticIntervalPollingController)()){constructor({messenger:e,interval:t=h,getSupportedChains:s,getCacheExpirationTime:n,getTopX:a}){super({name:"StaticAssetsController",messenger:e,metadata:{},state:{}}),function(e,t){l(e,t),t.add(e)}(this,y),c(this,f,void 0),c(this,w,void 0),c(this,v,void 0),d(f,this,s),this.setIntervalLength(t),d(w,this,n),d(v,this,a)}async _executePoll({chainIds:e,selectedAccountAddress:t}){t&&await Promise.allSettled(e.map(e=>p(y,this,k).call(this,e,t)))}}function b(e){return{address:(0,a.parseCaipAssetType)(e.assetId).assetReference,decimals:e.decimals,symbol:e.symbol,aggregators:[],image:g(e.assetId,"png"),name:e.name}}async function k(e,t){if(!await p(y,this,E).call(this,e))return;const s=await p(y,this,_).call(this,e);s.length>0&&await p(y,this,T).call(this,s,e,t)}async function T(e,t,s){try{if(!(0,a.isStrictHexString)(t))return;const[n,r]=await Promise.all([this.messenger.call("NetworkController:findNetworkClientIdByChainId",t),p(y,this,A).call(this,e,t,s)]);await this.messenger.call("TokensController:addTokens",r,n)}catch(e){console.error(`[StaticAssetsController] Error adding tokens to TokensController for chainId ${t}`,e)}}async function A(e,t,s){var n;const a=await this.messenger.call("TokensController:getState");if(!a.allIgnoredTokens||!(t in a.allIgnoredTokens))return e;const r=(null===(n=a.allIgnoredTokens[t])||void 0===n?void 0:n[s])??[];if(0===r.length)return e;const i=new Set(r.map(e=>e.toLowerCase()));return e.filter(e=>!i.has(e.address.toLowerCase()))}async function _(e){const t=[],s=u(v,this).call(this),n=await async function({chainId:e,cacheExpirationTime:t}){try{if(!(0,a.isStrictHexString)(e))return[];const s=(0,i.toEvmCaipChainId)(e),n=new URL("https://token.api.cx.metamask.io/v3/tokens/trending");return n.searchParams.set("chainIds",s),n.searchParams.set("minVolume24hUsd","1"),n.searchParams.set("minLiquidity","1"),n.searchParams.set("minMarketCap","1"),await(0,o.default)({url:n.toString(),fetchOptions:{method:"GET"},cacheOptions:{cacheRefreshTime:t},functionName:"fetchTopAssets"})}catch(e){return[]}}({chainId:e,cacheExpirationTime:u(w,this).call(this)??m});if(n.length>0)for(const e of n)try{const n=(0,a.parseCaipAssetType)(e.assetId);if("slip44"===n.assetNamespace||"0x0000000000000000000000000000000000000000"===n.assetReference||null===e.decimals)continue;const r=p(y,this,b).call(this,e);if(t.push(r),t.length>=s)break}catch(e){}return t}async function E(e){try{return!!((0,a.isStrictHexString)(e)&&u(f,this).call(this).has(e)&&await this.messenger.call("NetworkController:findNetworkClientIdByChainId",e))}catch(e){return!1}}s.StaticAssetsController=S}}},{package:"$root$",file:"app/scripts/controllers/static-assets-controller.ts"}],[255,{"../../../../shared/constants/common":6177,"../../../../shared/constants/gas":6183,"../../../../shared/constants/metametrics":6190,"../../../../shared/constants/network":6194,"../../../../shared/constants/smartTransactions":6204,"../../../../shared/constants/swaps":6209,"../../../../shared/constants/time":6211,"../../../../shared/lib/fetch-with-cache":6272,"../../../../shared/lib/sentry":6292,"../../../../shared/lib/swaps-utils":6296,"../../../../shared/lib/transactions-controller-utils":6301,"../../../../shared/modules/Numeric":6308,"../../../../shared/modules/conversion.utils":6315,"../../../../shared/modules/string-utils":6346,"../../../../shared/modules/swaps.utils":6347,"./swaps.constants":256,"./swaps.utils":257,"@ethersproject/contracts":786,"@ethersproject/providers":824,"@metamask/base-controller":1520,"bignumber.js":4362,"human-standard-token-abi":5005,lodash:5239},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var n=e("@ethersproject/contracts"),a=e("@ethersproject/providers"),r=e("@metamask/base-controller"),i=e("bignumber.js"),o=E(e("human-standard-token-abi")),c=e("lodash"),l=e("../../../../shared/lib/sentry"),u=e("../../../../shared/constants/common"),d=e("../../../../shared/constants/gas"),p=e("../../../../shared/constants/metametrics"),h=e("../../../../shared/constants/network"),m=e("../../../../shared/constants/smartTransactions"),g=e("../../../../shared/constants/swaps"),f=e("../../../../shared/constants/time"),w=E(e("../../../../shared/lib/fetch-with-cache")),v=e("../../../../shared/lib/swaps-utils"),y=e("../../../../shared/lib/transactions-controller-utils"),S=e("../../../../shared/modules/conversion.utils"),b=e("../../../../shared/modules/Numeric"),k=e("../../../../shared/modules/string-utils"),T=e("../../../../shared/modules/swaps.utils"),A=e("./swaps.constants"),_=e("./swaps.utils");function E(e){return e&&e.__esModule?e:{default:e}}function M(e,t,s){I(e,t),t.set(e,s)}function I(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function P(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function C(e,t){return e.get(O(e,t))}function j(e,t,s){return e.set(O(e,t),s),s}function O(e,t,s){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:s;throw new TypeError("Private element is not present on this object")}const N={swapsState:{includeInStateLogs:!0,persist:!1,includeInDebugSnapshot:!1,usedInUi:!0}};var R=new WeakMap,D=new WeakMap,F=new WeakMap,x=new WeakMap,B=new WeakMap,L=new WeakMap,U=new WeakSet;class G extends r.BaseController{constructor(e,t){var s,n,a;super({name:A.controllerName,metadata:N,messenger:e.messenger,state:{swapsState:{...(0,A.getDefaultSwapsControllerState)().swapsState,swapsFeatureFlags:(null==t||null===(s=t.swapsState)||void 0===s?void 0:s.swapsFeatureFlags)||{}}}}),I(n=this,a=U),a.add(n),P(this,"getBufferedGasLimit",void 0),P(this,"resetState",void 0),P(this,"trackMetaMetricsEvent",void 0),M(this,R,void 0),M(this,D,void 0),M(this,F,null),M(this,x,void 0),M(this,B,void 0),M(this,L,void 0),P(this,"_fetchTradesInfo",v.fetchTradesInfo),P(this,"__test__updateState",e=>{this.update(t=>({swapsState:{...t.swapsState,...e.swapsState}}))}),this.messenger.registerActionHandler("SwapsController:fetchAndSetQuotes",this.fetchAndSetQuotes.bind(this)),this.messenger.registerActionHandler("SwapsController:setSelectedQuoteAggId",this.setSelectedQuoteAggId.bind(this)),this.messenger.registerActionHandler("SwapsController:resetSwapsState",this.resetSwapsState.bind(this)),this.messenger.registerActionHandler("SwapsController:setSwapsTokens",this.setSwapsTokens.bind(this)),this.messenger.registerActionHandler("SwapsController:clearSwapsQuotes",this.clearSwapsQuotes.bind(this)),this.messenger.registerActionHandler("SwapsController:setApproveTxId",this.setApproveTxId.bind(this)),this.messenger.registerActionHandler("SwapsController:setTradeTxId",this.setTradeTxId.bind(this)),this.messenger.registerActionHandler("SwapsController:setSwapsTxGasPrice",this.setSwapsTxGasPrice.bind(this)),this.messenger.registerActionHandler("SwapsController:setSwapsTxGasLimit",this.setSwapsTxGasLimit.bind(this)),this.messenger.registerActionHandler("SwapsController:setSwapsTxMaxFeePerGas",this.setSwapsTxMaxFeePerGas.bind(this)),this.messenger.registerActionHandler("SwapsController:setSwapsTxMaxFeePriorityPerGas",this.setSwapsTxMaxFeePriorityPerGas.bind(this)),this.messenger.registerActionHandler("SwapsController:safeRefetchQuotes",this.safeRefetchQuotes.bind(this)),this.messenger.registerActionHandler("SwapsController:stopPollingForQuotes",this.stopPollingForQuotes.bind(this)),this.messenger.registerActionHandler("SwapsController:setBackgroundSwapRouteState",this.setBackgroundSwapRouteState.bind(this)),this.messenger.registerActionHandler("SwapsController:resetPostFetchState",this.resetPostFetchState.bind(this)),this.messenger.registerActionHandler("SwapsController:setSwapsErrorKey",this.setSwapsErrorKey.bind(this)),this.messenger.registerActionHandler("SwapsController:setInitialGasEstimate",this.setInitialGasEstimate.bind(this)),this.messenger.registerActionHandler("SwapsController:setCustomApproveTxData",this.setCustomApproveTxData.bind(this)),this.messenger.registerActionHandler("SwapsController:setSwapsLiveness",this.setSwapsLiveness.bind(this)),this.messenger.registerActionHandler("SwapsController:setSwapsFeatureFlags",this.setSwapsFeatureFlags.bind(this)),this.messenger.registerActionHandler("SwapsController:setSwapsUserFeeLevel",this.setSwapsUserFeeLevel.bind(this)),this.messenger.registerActionHandler("SwapsController:setSwapsQuotesPollingLimitEnabled",this.setSwapsQuotesPollingLimitEnabled.bind(this)),this.getBufferedGasLimit=e.getBufferedGasLimit,this.trackMetaMetricsEvent=e.trackMetaMetricsEvent,this.resetState=()=>{this.update(e=>{e.swapsState={...(0,A.getDefaultSwapsControllerState)().swapsState,swapsFeatureFlags:null==e?void 0:e.swapsState.swapsFeatureFlags}})},j(x,this,e.getEIP1559GasFeeEstimates),j(B,this,e.getLayer1GasFee),j(R,this,0),j(D,this,0),this._fetchTradesInfo=e.fetchTradesInfo||v.fetchTradesInfo}clearSwapsQuotes(){this.update(e=>{e.swapsState.quotes={},e.swapsState.selectedAggId=null,e.swapsState.topAggId=null})}async fetchAndSetQuotes(e,t,s=!1){var n;if(!e)return null;let a;a=(null===(n=C(L,this))||void 0===n?void 0:n.clientId)===t.networkClientId?C(L,this):O(U,this,$).call(this,t.networkClientId);const{quotesPollingLimitEnabled:r,saveFetchedQuotes:i}=this.state.swapsState;s||j(D,this,0),C(F,this)&&clearTimeout(C(F,this)),s||this.setSwapsErrorKey("");const o=C(R,this)+1;j(R,this,o),i||this._setSaveFetchedQuotes(!0);let[l]=await Promise.all([this._fetchTradesInfo(e,{chainId:a.chainId}),this._setSwapsNetworkConfig(a)]);const{saveFetchedQuotes:u}=this.state.swapsState;if(!u)return[{},null];l=(0,c.mapValues)(l,e=>({...e,sourceTokenInfo:null==t?void 0:t.sourceTokenInfo,destinationTokenInfo:null==t?void 0:t.destinationTokenInfo}));const d=a.chainId===h.CHAIN_IDS.OPTIMISM.toString(),p=a.chainId===h.CHAIN_IDS.BASE.toString();(d||p)&&Object.values(l).length>0&&await Promise.all(Object.values(l).map(async e=>{if(e.trade){const t=await C(B,this).call(this,{transactionParams:e.trade,networkClientId:a.clientId});e.multiLayerL1TradeFeeTotal=t}return e}));const m=Date.now();let f=!1;if(!(0,T.isSwapsDefaultTokenAddress)(e.sourceToken,a.chainId)&&Object.values(l).length){const t=await this._getERC20Allowance(e.sourceToken,e.fromAddress,a),[n]=Object.values(l);if(f=n.approvalNeeded&&(t.eq(0)||t.lt(n.sourceAmount))&&"wrappedNative"!==n.aggregator,f){if(!s&&n.approvalNeeded){const{gasLimit:e}=await this._timedoutGasReturn(n.approvalNeeded,n.aggregator);l=(0,c.mapValues)(l,t=>t.approvalNeeded?{...t,approvalNeeded:{...t.approvalNeeded,gas:e||g.DEFAULT_ERC20_APPROVE_GAS}}:t)}}else l=(0,c.mapValues)(l,e=>({...e,approvalNeeded:null}))}let w=null;if(f||null!=e&&e.balanceError||(l=await this._getAllQuotesWithGasEstimates(l)),0===Object.values(l).length)this.setSwapsErrorKey(g.QUOTES_NOT_AVAILABLE_ERROR);else{const e=await this.getTopQuoteWithCalculatedSavings({quotes:l});Array.isArray(e)&&(w=e[0],l=e[1])}if(C(R,this)!==o)throw new Error(g.SWAPS_FETCH_ORDER_CONFLICT);let{selectedAggId:v}=this.state.swapsState;return v&&l[v]||(v=null),this.update(s=>{s.swapsState.quotes=l,s.swapsState.fetchParams={...e,metaData:t},s.swapsState.quotesLastFetched=m,s.swapsState.selectedAggId=v,s.swapsState.topAggId=w}),r&&j(D,this,C(D,this)+1),!r||C(D,this)<A.POLL_COUNT_LIMIT+1?(this._pollForNewQuotes(),[l,w]):(this.resetPostFetchState(),this.setSwapsErrorKey(g.QUOTES_EXPIRED_ERROR),null)}async getTopQuoteWithCalculatedSavings({quotes:e,networkClientId:t}){var s;let n;if(t){const e=this.messenger.call("NetworkController:getNetworkClientById",t);n=e.configuration.chainId}else{if(C(L,this)===undefined)throw new Error("There is no network set");n=C(L,this).chainId}const{marketData:a}=this._getTokenRatesState(),r=(null==a?void 0:a[n])??{},{customGasPrice:o,customMaxPriorityFeePerGas:l}=this.state.swapsState;if(0===Object.keys(e).length)return{};const p=(0,c.cloneDeep)(e),{gasFeeEstimates:h,gasEstimateType:m}=await C(x,this).call(this,{networkClientId:t});let g="0x0";if(m===d.GasEstimateTypes.feeMarket){const{high:{suggestedMaxPriorityFeePerGas:e},estimatedBaseFee:t}=h,s=(0,S.decGWEIToHexWEI)(Number(e)),n=new b.Numeric(t,10,u.EtherDenomination.GWEI).toDenomination(u.EtherDenomination.WEI);g=new b.Numeric(l||s,16).add(n).round(6).toString()}else m===d.GasEstimateTypes.legacy?g=o||(0,S.decGWEIToHexWEI)(Number(h.high)):m===d.GasEstimateTypes.ethGasPrice&&(g=o||(0,S.decGWEIToHexWEI)(Number(h.gasPrice)));let f,w="";Object.values(p).forEach(e=>{const{aggregator:t,approvalNeeded:s,averageGas:a,destinationAmount:o,destinationToken:c,destinationTokenInfo:l,gasEstimateWithRefund:d,sourceAmount:p,sourceToken:h,trade:m,fee:v,multiLayerL1TradeFeeTotal:_}=e;if(!m||!c)return;const E=(d?new i.BigNumber(d,16):new i.BigNumber(a||A.MAX_GAS_LIMIT,10)).plus((null==s?void 0:s.gas)||"0x0",16).toString(16);let M=(0,y.calcGasTotal)(E,g);null!==_&&(M=(0,S.sumHexes)(M||"0x0",_||"0x0"));const I=new b.Numeric(M,16,u.EtherDenomination.WEI).add(new b.Numeric(m.value,16,u.EtherDenomination.WEI)),P=I.toDenomination(u.EtherDenomination.ETH).round(6).value,C=(0,T.isSwapsDefaultTokenAddress)(h,n)?I.minus(new b.Numeric(p,10)).toDenomination(u.EtherDenomination.ETH).round(6).value:P,j=(0,y.calcTokenAmount)(o??"0",l.decimals),O=new i.BigNumber(100,10).minus(v,10).div(100),N=j.div(O).minus(j),R=Object.keys(r).find(e=>(0,k.isEqualCaseInsensitive)(e,c)),D=R?r[R]:null,F=(null==D?void 0:D.price)||1,x=j.times(F.toString(10),10),B=(0,T.isSwapsDefaultTokenAddress)(c,n)?1:null==D?void 0:D.price,L=B?x.minus(C,10):x;e.ethFee=C.toString(10),B&&(e.ethValueOfTokens=x.toString(10),e.overallValueOfQuote=L.toString(10),e.metaMaskFeeInEth=N.times(B.toString(10)).toString(10)),f&&!L.gt(f||0)||(w=t,f=L)});const v=Object.keys(r).find(e=>{var t;return(0,k.isEqualCaseInsensitive)(e,null===(t=p[w])||void 0===t?void 0:t.destinationToken)}),E=v?r[v]:null;if((0,T.isSwapsDefaultTokenAddress)(null===(s=p[w])||void 0===s?void 0:s.destinationToken,n)||Boolean(null==E?void 0:E.price)){const e=p[w],{ethFee:t,metaMaskFeeInEth:s,ethValueOfTokens:n}=(0,_.getMedianEthValueQuote)(Object.values(p)),a=new i.BigNumber(e.ethValueOfTokens,10).minus(n,10).toString(10),r=new i.BigNumber(t).minus(e.ethFee,10).toString(10),o=e.metaMaskFeeInEth,c={performance:a,fee:r,total:new i.BigNumber(a).plus(r).minus(o).toString(10),metaMaskFee:o,medianMetaMaskFee:s};p[w].isBestQuote=!0,p[w].savings=c}return[w,p]}resetPostFetchState(){this.update(e=>{e.swapsState={...(0,A.getDefaultSwapsControllerState)().swapsState,tokens:e.swapsState.tokens,fetchParams:e.swapsState.fetchParams,swapsFeatureIsLive:e.swapsState.swapsFeatureIsLive,swapsQuoteRefreshTime:e.swapsState.swapsQuoteRefreshTime,swapsQuotePrefetchingRefreshTime:e.swapsState.swapsQuotePrefetchingRefreshTime,swapsFeatureFlags:e.swapsState.swapsFeatureFlags}}),C(F,this)&&clearTimeout(C(F,this))}resetSwapsState(){this.update(e=>{e.swapsState={...(0,A.getDefaultSwapsControllerState)().swapsState,swapsQuoteRefreshTime:e.swapsState.swapsQuoteRefreshTime,swapsQuotePrefetchingRefreshTime:e.swapsState.swapsQuotePrefetchingRefreshTime,swapsFeatureFlags:e.swapsState.swapsFeatureFlags}}),C(F,this)&&clearTimeout(C(F,this))}safeRefetchQuotes(){!C(F,this)&&this.state.swapsState.fetchParams&&this.fetchAndSetQuotes(this.state.swapsState.fetchParams,{...this.state.swapsState.fetchParams.metaData})}setApproveTxId(e){this.update(t=>{t.swapsState.approveTxId=e})}setBackgroundSwapRouteState(e){this.update(t=>{t.swapsState.routeState=e})}setCustomApproveTxData(e){this.update(t=>{t.swapsState.customApproveTxData=e})}async setInitialGasEstimate(e){const t={...this.state.swapsState.quotes[e]},{gasLimit:s,simulationFails:n}=t.trade?await this._timedoutGasReturn(t.trade,t.aggregator):{gasLimit:null,simulationFails:!0};if(s&&!n){const e=(0,_.calculateGasEstimateWithRefund)(t.maxGas,t.estimatedRefund,s);t.gasEstimate=s,t.gasEstimateWithRefund=e}this.update(s=>{s.swapsState.quotes={...s.swapsState.quotes,[e]:t}})}setSelectedQuoteAggId(e){this.update(t=>{t.swapsState.selectedAggId=e})}setSwapsFeatureFlags(e){this.update(t=>{t.swapsState.swapsFeatureFlags=e})}setSwapsErrorKey(e){this.update(t=>{t.swapsState.errorKey=e})}setSwapsLiveness(e){const{swapsFeatureIsLive:t}=e;this.update(e=>{e.swapsState.swapsFeatureIsLive=t})}setSwapsQuotesPollingLimitEnabled(e){this.update(t=>{t.swapsState.quotesPollingLimitEnabled=e})}setSwapsTokens(e){this.update(t=>{t.swapsState.tokens=e})}setSwapsTxGasLimit(e){this.update(t=>{t.swapsState.customMaxGas=e})}setSwapsTxGasPrice(e){this.update(t=>{t.swapsState.customGasPrice=e})}setSwapsTxMaxFeePerGas(e){this.update(t=>{t.swapsState.customMaxFeePerGas=e})}setSwapsTxMaxFeePriorityPerGas(e){this.update(t=>{t.swapsState.customMaxPriorityFeePerGas=e})}setSwapsUserFeeLevel(e){this.update(t=>{t.swapsState.swapsUserFeeLevel=e})}setTradeTxId(e){this.update(t=>{t.swapsState.tradeTxId=e})}stopPollingForQuotes(){C(F,this)&&clearTimeout(C(F,this))}async _fetchSwapsNetworkConfig(e){const t=await(0,w.default)({url:(0,v.getBaseApi)("network",e.chainId),fetchOptions:{method:"GET"},cacheOptions:{cacheRefreshTime:6e5},functionName:"_fetchSwapsNetworkConfig"}),{refreshRates:s,parameters:n={}}=t||{};if(!s||"number"!=typeof s.quotes||"number"!=typeof s.quotesPrefetching)throw new Error(`MetaMask - invalid response for refreshRates: ${t}`);return{quotes:1e3*s.quotes,quotesPrefetching:1e3*s.quotesPrefetching,stxGetTransactions:1e3*s.stxGetTransactions,stxBatchStatus:1e3*s.stxBatchStatus,stxStatusDeadline:s.stxStatusDeadline,stxMaxFeeMultiplier:n.stxMaxFeeMultiplier}}async _getAllQuotesWithGasEstimates(e){const t=await Promise.all(Object.values(e).map(async e=>{if(!e.trade)return{gasLimit:null,simulationFails:!0,aggId:e.aggregator};const{gasLimit:t,simulationFails:s}=await this._timedoutGasReturn(e.trade,e.aggregator);return{gasLimit:t,simulationFails:s,aggId:e.aggregator}})),s={};return t.forEach(({gasLimit:t,simulationFails:n,aggId:a})=>{if(t&&!n){const n=(0,_.calculateGasEstimateWithRefund)(e[a].maxGas,e[a].estimatedRefund,t);s[a]={...e[a],gasEstimate:t,gasEstimateWithRefund:n}}else e[a].approvalNeeded&&(s[a]=e[a])}),s}async _getERC20Allowance(e,t,s){const a=new n.Contract(e,o.default,s.ethersProvider);return await a.allowance(t,g.SWAPS_CHAINID_CONTRACT_ADDRESS_MAP[s.chainId])}_getTokenRatesState(){const{marketData:e}=this.messenger.call("TokenRatesController:getState");return{marketData:e}}_pollForNewQuotes(){const{swapsQuoteRefreshTime:e,swapsQuotePrefetchingRefreshTime:t,quotesPollingLimitEnabled:s}=this.state.swapsState;j(F,this,setTimeout(()=>{var e;this.fetchAndSetQuotes(this.state.swapsState.fetchParams,null===(e=this.state.swapsState.fetchParams)||void 0===e?void 0:e.metaData,!0)},s?e:t))}_setSaveFetchedQuotes(e){this.update(t=>{t.swapsState.saveFetchedQuotes=e})}async _setSwapsNetworkConfig(e){let t=null;try{t=await this._fetchSwapsNetworkConfig(e)}catch(e){console.error("Request for Swaps network config failed: ",e)}this.update(e=>{var s,n,a,r,i,o;e.swapsState.swapsQuoteRefreshTime=(null===(s=t)||void 0===s?void 0:s.quotes)||A.FALLBACK_QUOTE_REFRESH_TIME,e.swapsState.swapsQuotePrefetchingRefreshTime=(null===(n=t)||void 0===n?void 0:n.quotesPrefetching)||A.FALLBACK_QUOTE_REFRESH_TIME,e.swapsState.swapsStxGetTransactionsRefreshTime=(null===(a=t)||void 0===a?void 0:a.stxGetTransactions)||m.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME,e.swapsState.swapsStxBatchStatusRefreshTime=(null===(r=t)||void 0===r?void 0:r.stxBatchStatus)||m.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME,e.swapsState.swapsStxMaxFeeMultiplier=(null===(i=t)||void 0===i?void 0:i.stxMaxFeeMultiplier)||m.FALLBACK_SMART_TRANSACTIONS_MAX_FEE_MULTIPLIER,e.swapsState.swapsStxStatusDeadline=(null===(o=t)||void 0===o?void 0:o.stxStatusDeadline)||m.FALLBACK_SMART_TRANSACTIONS_DEADLINE})}_timedoutGasReturn(e,t=""){return new Promise(s=>{let n=!1;const a=setTimeout(()=>{n=!0,this.trackMetaMetricsEvent({event:p.MetaMetricsEventName.QuoteError,category:p.MetaMetricsEventCategory.Swaps,properties:{error_type:p.MetaMetricsEventErrorType.GasTimeout,aggregator:t}}),s({gasLimit:null,simulationFails:!0})},5*f.SECOND),r={data:e.data,from:e.from,to:e.to,value:e.value};this.getBufferedGasLimit({txParams:r},1).then(({gasLimit:e,simulationFails:t})=>{n||(clearTimeout(a),s({gasLimit:e,simulationFails:t}))}).catch(e=>{(0,l.captureException)(e,{extra:{aggregator:t}}),n||(clearTimeout(a),s({gasLimit:null,simulationFails:!0}))})})}}function $(e){const t=this.messenger.call("NetworkController:getNetworkClientById",e),{chainId:s}=t.configuration,n={client:t,clientId:e,chainId:s,ethersProvider:new a.Web3Provider(t.provider)};return j(L,this,n),n}s.default=G}}},{package:"$root$",file:"app/scripts/controllers/swaps/index.ts"}],[256,{"../../../../shared/constants/smartTransactions":6204,"../../../../shared/constants/time":6211},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.controllerName=s.POLL_COUNT_LIMIT=s.MAX_GAS_LIMIT=s.FALLBACK_QUOTE_REFRESH_TIME=void 0,s.getDefaultSwapsControllerState=function(){return{swapsState:{quotes:{},quotesPollingLimitEnabled:!1,fetchParams:null,tokens:null,tradeTxId:null,approveTxId:null,quotesLastFetched:null,customMaxGas:"",customGasPrice:null,customMaxFeePerGas:null,customMaxPriorityFeePerGas:null,swapsUserFeeLevel:"",selectedAggId:null,customApproveTxData:"",errorKey:"",topAggId:null,routeState:"",swapsFeatureIsLive:!0,saveFetchedQuotes:!1,swapsQuoteRefreshTime:r,swapsQuotePrefetchingRefreshTime:r,swapsStxBatchStatusRefreshTime:n.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME,swapsStxStatusDeadline:n.FALLBACK_SMART_TRANSACTIONS_DEADLINE,swapsStxGetTransactionsRefreshTime:n.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME,swapsStxMaxFeeMultiplier:n.FALLBACK_SMART_TRANSACTIONS_MAX_FEE_MULTIPLIER,swapsFeatureFlags:{}}}};var n=e("../../../../shared/constants/smartTransactions"),a=e("../../../../shared/constants/time");s.controllerName="SwapsController",s.MAX_GAS_LIMIT=25e5,s.POLL_COUNT_LIMIT=3;const r=s.FALLBACK_QUOTE_REFRESH_TIME=a.MINUTE}}},{package:"$root$",file:"app/scripts/controllers/swaps/swaps.constants.ts"}],[257,{"./swaps.constants":256,"bignumber.js":4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.calculateGasEstimateWithRefund=function(e=a.MAX_GAS_LIMIT,t="0",s="0"){const r=new n.BigNumber(e,10).minus(t,10),i=r.lt(0);return!i&&r.lt(s,16)?`0x${r.toString(16)}`:s},s.getMedianEthValueQuote=function(e){if(!Array.isArray(e)||0===e.length)throw new Error("Expected non-empty array param.");const t=[...e];if(t.sort((e,t)=>{const s=new n.BigNumber(e.overallValueOfQuote,10),a=new n.BigNumber(t.overallValueOfQuote,10);return s.equals(a)?0:s.lessThan(a)?-1:1}),t.length%2==1){const e=t[(t.length-1)/2].overallValueOfQuote;return r(t.filter(t=>e===t.overallValueOfQuote))}const s=t.length/2,a=s-1,i=t[s].overallValueOfQuote,o=t[a].overallValueOfQuote,c=t.filter(e=>i===e.overallValueOfQuote),l=t.filter(e=>o===e.overallValueOfQuote),u=r(c),d=r(l);return{ethFee:new n.BigNumber(u.ethFee,10).plus(d.ethFee,10).dividedBy(2).toString(10),metaMaskFeeInEth:new n.BigNumber(u.metaMaskFeeInEth,10).plus(d.metaMaskFeeInEth,10).dividedBy(2).toString(10),ethValueOfTokens:new n.BigNumber(u.ethValueOfTokens,10).plus(d.ethValueOfTokens,10).dividedBy(2).toString(10)}},s.meansOfQuotesFeesAndValue=r;var n=e("bignumber.js"),a=e("./swaps.constants");function r(e){const t=e.reduce((e,t)=>({ethFee:e.ethFee.plus(t.ethFee,10),metaMaskFeeInEth:e.metaMaskFeeInEth.plus(t.metaMaskFeeInEth,10),ethValueOfTokens:e.ethValueOfTokens.plus(t.ethValueOfTokens,10)}),{ethFee:new n.BigNumber(0,10),metaMaskFeeInEth:new n.BigNumber(0,10),ethValueOfTokens:new n.BigNumber(0,10)});return{ethFee:t.ethFee.div(e.length,10).toString(10),metaMaskFeeInEth:t.metaMaskFeeInEth.div(e.length,10).toString(10),ethValueOfTokens:t.ethValueOfTokens.div(e.length,10).toString(10)}}}}},{package:"$root$",file:"app/scripts/controllers/swaps/swaps.utils.ts"}],[258,{"../../shared/constants/app":6175,"./lib/util":380,"webextension-polyfill":6163},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.onMessageReceived=s.checkForMultipleVersionsRunning=void 0;var n,a=(n=e("webextension-polyfill"))&&n.__esModule?n:{default:n},r=e("../../shared/constants/app"),i=e("./lib/util");const o="isRunning";s.onMessageReceived=e=>{e===o&&console.warn("Warning! You have multiple instances of MetaMask running!")};s.checkForMultipleVersionsRunning=async()=>{if((0,i.getPlatform)()!==r.PLATFORM_CHROME&&(0,i.getPlatform)()!==r.PLATFORM_FIREFOX)return;const e=(0,i.getPlatform)()===r.PLATFORM_CHROME?r.CHROME_BUILD_IDS:r.FIREFOX_BUILD_IDS,t=a.default.runtime.id;for(const s of e)if(s!==t)try{await a.default.runtime.sendMessage(s,o)}catch(e){}}}}},{package:"$root$",file:"app/scripts/detect-multiple-instances.js"}],[2586,{"@metamask/base-controller":1520,events:4770,uuid:6134},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.AbstractMessageManager=void 0;const n=e("@metamask/base-controller"),a=e("events"),r=e("uuid"),i={unapprovedMessages:{includeInStateLogs:!0,persist:!1,includeInDebugSnapshot:!1,usedInUi:!0},unapprovedMessagesCount:{includeInStateLogs:!0,persist:!1,includeInDebugSnapshot:!1,usedInUi:!0}};class o extends n.BaseController{constructor({additionalFinishStatuses:e,messenger:t,name:s,securityProviderRequest:n,state:r={}}){super({messenger:t,metadata:i,name:s,state:{unapprovedMessages:{},unapprovedMessagesCount:0,...r}}),this.internalEvents=new a.EventEmitter,this.messages=[],this.securityProviderRequest=n,this.additionalFinishStatuses=e??[]}addRequestToMessageParams(e,t){const s={...e};return t&&(s.requestId=t.id,s.origin=t.origin),s}createUnapprovedMessage(e,t,s){return{id:(0,r.v1)(),messageParams:e,securityAlertResponse:s?.securityAlertResponse,status:"unapproved",time:Date.now(),type:t}}saveMessageList(e=!0){this.update(e=>{e.unapprovedMessages=this.getUnapprovedMessages(),e.unapprovedMessagesCount=this.getUnapprovedMessagesCount()}),e&&this.messenger.publish(`${this.name}:updateBadge`)}setMessageStatus(e,t){const s=this.getMessage(e);if(!s)throw new Error(`${this.name}: Message not found for id: ${e}.`);const n={...s,status:t};this.updateMessage(n),this.internalEvents.emit(`${e}:${t}`,n),("rejected"===t||"signed"===t||"errored"===t||this.additionalFinishStatuses.includes(t))&&this.internalEvents.emit(`${e}:finished`,n)}updateMessage(e,t=!0){const s=this.messages.findIndex(t=>e.id===t.id);-1!==s&&(this.messages[s]=e),this.saveMessageList(t)}async securityCheck(e){if(this.securityProviderRequest){const t=await this.securityProviderRequest(e,e.type);return{...e,securityProviderResponse:t}}return e}clearUnapprovedMessages(){this.update(e=>{e.unapprovedMessages={},e.unapprovedMessagesCount=0})}getUnapprovedMessagesCount(){return Object.keys(this.getUnapprovedMessages()).length}getUnapprovedMessages(){return this.messages.filter(e=>"unapproved"===e.status).reduce((e,t)=>(e[t.id]=t,e),{})}async addMessage(e){const t=await this.securityCheck(e);this.messages.push(t),this.saveMessageList()}getMessage(e){return this.messages.find(t=>t.id===e)}getAllMessages(){return this.messages}approveMessage(e){return this.setMessageStatusApproved(e.metamaskId),this.prepMessageForSigning(e)}setMessageStatusApproved(e){this.setMessageStatus(e,"approved")}setMessageStatusInProgress(e){this.setMessageStatus(e,"inProgress")}setMessageStatusSigned(e,t){this.setMessageStatusAndResult(e,t,"signed")}setMessageStatusAndResult(e,t,s){this.setResult(e,t),this.setMessageStatus(e,s)}setResult(e,t){const s=this.getMessage(e);s&&this.updateMessage({...s,rawSig:t},!1)}setMetadata(e,t){const s=this.getMessage(e);if(!s)throw new Error(`${this.name}: Message not found for id: ${e}.`);this.updateMessage({...s,metadata:t},!1)}rejectMessage(e){this.setMessageStatus(e,"rejected")}async waitForFinishStatus(e,t){const{metamaskId:s,...n}=e;return new Promise((e,a)=>{this.internalEvents.once(`${s}:finished`,s=>{switch(s.status){case"signed":return e(s.rawSig);case"rejected":return a(new Error(`MetaMask ${t} Signature: User denied message signature.`));case"errored":return a(new Error(`MetaMask ${t} Signature: ${s.error}`));default:return a(new Error(`MetaMask ${t} Signature: Unknown problem: ${JSON.stringify(n)}`))}})})}}s.AbstractMessageManager=o,s.default=o}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/AbstractMessageManager.cjs"}],[2587,{"./AbstractMessageManager.cjs":2586,"./utils.cjs":2590,"@metamask/controller-utils":1639},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.DecryptMessageManager=void 0;const n=e("@metamask/controller-utils"),a=e("./AbstractMessageManager.cjs"),r=e("./utils.cjs"),i="DecryptMessageManager";class o extends a.AbstractMessageManager{constructor({additionalFinishStatuses:e,messenger:t,securityProviderRequest:s,state:n}){super({additionalFinishStatuses:e,messenger:t,name:i,securityProviderRequest:s,state:n})}async addUnapprovedMessageAsync(e,t){(0,r.validateDecryptedMessageData)(e);const s=await this.addUnapprovedMessage(e,t);return new Promise((t,n)=>{this.internalEvents.once(`${s}:finished`,s=>{switch(s.status){case"decrypted":return t(s.rawSig);case"rejected":return n(new Error("MetaMask DecryptMessage: User denied message decryption."));case"errored":return n(new Error("MetaMask DecryptMessage: This message cannot be decrypted."));default:return n(new Error(`MetaMask DecryptMessage: Unknown problem: ${JSON.stringify(e)}`))}})})}async addUnapprovedMessage(e,t){const s=this.addRequestToMessageParams(e,t);e.data=(0,r.normalizeMessageData)(e.data);const a=this.createUnapprovedMessage(s,n.ApprovalType.EthDecrypt,t),o=a.id;return await this.addMessage(a),this.messenger.publish(`${i}:unapprovedMessage`,{...s,metamaskId:o}),o}prepMessageForSigning(e){return delete e.metamaskId,Promise.resolve(e)}}s.DecryptMessageManager=o}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/DecryptMessageManager.cjs"}],[2588,{"./AbstractMessageManager.cjs":2586,"./utils.cjs":2590,"@metamask/controller-utils":1639},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.EncryptionPublicKeyManager=void 0;const n=e("@metamask/controller-utils"),a=e("./AbstractMessageManager.cjs"),r=e("./utils.cjs");class i extends a.AbstractMessageManager{constructor({additionalFinishStatuses:e,messenger:t,securityProviderRequest:s,state:n}){super({additionalFinishStatuses:e,messenger:t,name:"EncryptionPublicKeyManager",securityProviderRequest:s,state:n})}async addUnapprovedMessageAsync(e,t){(0,r.validateEncryptionPublicKeyMessageData)(e);const s=await this.addUnapprovedMessage(e,t);return new Promise((t,n)=>{this.internalEvents.once(`${s}:finished`,s=>{switch(s.status){case"received":return t(s.rawSig);case"rejected":return n(new Error("MetaMask EncryptionPublicKey: User denied message EncryptionPublicKey."));default:return n(new Error(`MetaMask EncryptionPublicKey: Unknown problem: ${JSON.stringify(e)}`))}})})}async addUnapprovedMessage(e,t){const s=this.addRequestToMessageParams(e,t),a=this.createUnapprovedMessage(s,n.ApprovalType.EthGetEncryptionPublicKey,t),r=a.id;return await this.addMessage(a),this.messenger.publish(`${this.name}:unapprovedMessage`,{...s,metamaskId:r}),r}prepMessageForSigning(e){return delete e.metamaskId,Promise.resolve({from:e.data})}}s.EncryptionPublicKeyManager=i,s.default=i}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/EncryptionPublicKeyManager.cjs"}],[2589,{"./AbstractMessageManager.cjs":2586,"./DecryptMessageManager.cjs":2587,"./EncryptionPublicKeyManager.cjs":2588},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){n===undefined&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){n===undefined&&(n=s),e[n]=t[s]}),a=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||n(t,e,s)};Object.defineProperty(s,"__esModule",{value:!0}),a(e("./AbstractMessageManager.cjs"),s),a(e("./EncryptionPublicKeyManager.cjs"),s),a(e("./DecryptMessageManager.cjs"),s)}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/index.cjs"}],[259,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;s.default={config:{}}}}},{package:"$root$",file:"app/scripts/first-time-state.js"}],[2590,{"@metamask/controller-utils":1639,"@metamask/utils":3554,buffer:4474},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){(function(t){(function(){Object.defineProperty(s,"__esModule",{value:!0}),s.validateDecryptedMessageData=s.validateEncryptionPublicKeyMessageData=s.normalizeMessageData=void 0;const n=e("@metamask/controller-utils"),a=e("@metamask/utils"),r=/^[0-9A-Fa-f]+$/gu;function i(e,t){if(!e||"string"!=typeof e||!(0,n.isValidHexAddress)(e))throw new Error(`Invalid "${t}" address: ${e} must be a valid string.`)}s.normalizeMessageData=function(e){try{const t=(0,a.remove0x)(e);if(t.match(r))return(0,a.add0x)(t)}catch(e){}return(0,a.bytesToHex)(t.from(e,"utf8"))},s.validateEncryptionPublicKeyMessageData=function(e){const{from:t}=e;i(t,"from")},s.validateDecryptedMessageData=function(e){const{from:t}=e;i(t,"from")}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/utils.cjs"}],[2598,{"./logger.cjs":2605,"./utils.cjs":2616,"@metamask/account-api":1264},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n,a,r,i,o,c,l,u,d,p=this&&this.__classPrivateFieldSet||function(e,t,s,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?a.call(e,s):a?a.value=s:t.set(e,s),s},h=this&&this.__classPrivateFieldGet||function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)};Object.defineProperty(s,"__esModule",{value:!0}),s.MultichainAccountGroup=void 0;const m=e("@metamask/account-api"),g=e("@metamask/account-api"),f=e("./logger.cjs"),w=e("./utils.cjs");s.MultichainAccountGroup=class{constructor({groupIndex:e,wallet:t,providers:s,messenger:m}){n.set(this,void 0),a.set(this,void 0),r.set(this,void 0),i.set(this,void 0),o.set(this,void 0),c.set(this,void 0),l.set(this,void 0),u.set(this,void 0),d.set(this,!1),p(this,n,(0,g.toMultichainAccountGroupId)(t.id,e),"f"),p(this,r,e,"f"),p(this,a,t,"f"),p(this,i,s,"f"),p(this,l,m,"f"),p(this,o,new Map,"f"),p(this,c,new Map,"f"),p(this,u,(0,f.createModuleLogger)(f.projectLogger,`[${h(this,n,"f")}]`),"f"),this.sync(),p(this,d,!0,"f")}sync(){h(this,u,"f").call(this,"Synchronizing with account providers..."),h(this,c,"f").clear();for(const e of h(this,i,"f")){const t=[];for(const s of e.getAccounts())s.options.entropy.id===this.wallet.entropySource&&s.options.entropy.groupIndex===this.groupIndex&&t.push(s.id);h(this,o,"f").set(e,t);for(const s of t)h(this,c,"f").set(s,e)}h(this,d,"f")&&h(this,l,"f").publish("MultichainAccountService:multichainAccountGroupUpdated",this),h(this,u,"f").call(this,"Synchronized")}get id(){return h(this,n,"f")}get type(){return m.AccountGroupType.MultichainAccount}get wallet(){return h(this,a,"f")}get groupIndex(){return h(this,r,"f")}hasAccounts(){return h(this,c,"f").size>0}getAccounts(){const e=[];for(const[t,s]of h(this,o,"f").entries())for(const n of s){const s=t.getAccount(n);s&&e.push(s)}return e}getAccount(e){const t=h(this,c,"f").get(e);return t?t.getAccount(e):undefined}get(e){return(0,m.selectOne)(this.getAccounts(),e)}select(e){return(0,m.select)(this.getAccounts(),e)}async alignAccounts(){h(this,u,"f").call(this,"Aligning accounts...");if((await Promise.allSettled(h(this,i,"f").map(async e=>{try{const t=h(this,o,"f").get(e);if(!t||0===t.length){h(this,u,"f").call(this,`Found missing accounts for account provider "${e.getName()}", creating them now...`);const t=await e.createAccounts({entropySource:this.wallet.entropySource,groupIndex:this.groupIndex});return h(this,u,"f").call(this,`Created ${t.length} accounts`),t}return Promise.resolve()}catch(t){h(this,u,"f").call(this,`${f.WARNING_PREFIX} ${t instanceof Error?t.message:String(t)}`);const s=(0,w.createSentryError)(`Unable to align accounts with provider "${e.getName()}"`,t,{groupIndex:this.groupIndex,provider:e.getName()});throw h(this,l,"f").captureException?.(s),t}}))).some(e=>"rejected"===e.status)){const e=`Failed to fully align multichain account group for entropy ID: ${this.wallet.entropySource} and group index: ${this.groupIndex}, some accounts might be missing`;h(this,u,"f").call(this,`${f.WARNING_PREFIX} ${e}`),console.warn(e)}h(this,u,"f").call(this,"Aligned")}},n=new WeakMap,a=new WeakMap,r=new WeakMap,i=new WeakMap,o=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,d=new WeakMap}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/MultichainAccountGroup.cjs"}],[2599,{"./MultichainAccountWallet.cjs":2600,"./analytics/index.cjs":2601,"./logger.cjs":2605,"./providers/AccountProviderWrapper.cjs":2606,"./providers/EvmAccountProvider.cjs":2609,"./providers/SolAccountProvider.cjs":2611,"./providers/index.cjs":2613,"./snaps/SnapPlatformWatcher.cjs":2615,"./utils.cjs":2616,"@metamask/account-api":1264,"@metamask/key-tree":2466,"@metamask/keyring-controller":2537,"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n,a,r,i,o,c,l,u,d,p=this&&this.__classPrivateFieldSet||function(e,t,s,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?a.call(e,s):a?a.value=s:t.set(e,s),s},h=this&&this.__classPrivateFieldGet||function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)};Object.defineProperty(s,"__esModule",{value:!0}),s.MultichainAccountService=s.serviceName=void 0;const m=e("@metamask/account-api"),g=e("@metamask/key-tree"),f=e("@metamask/keyring-controller"),w=e("@metamask/utils"),v=e("./analytics/index.cjs"),y=e("./logger.cjs"),S=e("./MultichainAccountWallet.cjs"),b=e("./providers/index.cjs"),k=e("./providers/AccountProviderWrapper.cjs"),T=e("./providers/EvmAccountProvider.cjs"),A=e("./providers/SolAccountProvider.cjs"),_=e("./providers/SolAccountProvider.cjs"),E=e("./snaps/SnapPlatformWatcher.cjs"),M=e("./utils.cjs");s.serviceName="MultichainAccountService";s.MultichainAccountService=class{constructor({messenger:e,providers:t=[],providerConfigs:d,config:m}){n.add(this),a.set(this,void 0),r.set(this,void 0),i.set(this,void 0),o.set(this,void 0),c.set(this,void 0),this.name=s.serviceName,p(this,a,e,"f"),p(this,o,new Map,"f"),p(this,c,new Map,"f");const g=m?.trace??v.traceFallback;p(this,i,[new T.EvmAccountProvider(h(this,a,"f"),d?.[b.EVM_ACCOUNT_PROVIDER_NAME],g),new k.AccountProviderWrapper(h(this,a,"f"),new A.SolAccountProvider(h(this,a,"f"),d?.[_.SOL_ACCOUNT_PROVIDER_NAME],g)),...t],"f"),p(this,r,new E.SnapPlatformWatcher(e),"f"),h(this,a,"f").registerActionHandler("MultichainAccountService:getMultichainAccountGroup",(...e)=>this.getMultichainAccountGroup(...e)),h(this,a,"f").registerActionHandler("MultichainAccountService:getMultichainAccountGroups",(...e)=>this.getMultichainAccountGroups(...e)),h(this,a,"f").registerActionHandler("MultichainAccountService:getMultichainAccountWallet",(...e)=>this.getMultichainAccountWallet(...e)),h(this,a,"f").registerActionHandler("MultichainAccountService:getMultichainAccountWallets",(...e)=>this.getMultichainAccountWallets(...e)),h(this,a,"f").registerActionHandler("MultichainAccountService:createNextMultichainAccountGroup",(...e)=>this.createNextMultichainAccountGroup(...e)),h(this,a,"f").registerActionHandler("MultichainAccountService:createMultichainAccountGroup",(...e)=>this.createMultichainAccountGroup(...e)),h(this,a,"f").registerActionHandler("MultichainAccountService:setBasicFunctionality",(...e)=>this.setBasicFunctionality(...e)),h(this,a,"f").registerActionHandler("MultichainAccountService:alignWallets",(...e)=>this.alignWallets(...e)),h(this,a,"f").registerActionHandler("MultichainAccountService:alignWallet",(...e)=>this.alignWallet(...e)),h(this,a,"f").registerActionHandler("MultichainAccountService:createMultichainAccountWallet",(...e)=>this.createMultichainAccountWallet(...e)),h(this,a,"f").registerActionHandler("MultichainAccountService:resyncAccounts",(...e)=>this.resyncAccounts(...e)),h(this,a,"f").registerActionHandler("MultichainAccountService:ensureCanUseSnapPlatform",(...e)=>this.ensureCanUseSnapPlatform(...e)),h(this,a,"f").subscribe("AccountsController:accountAdded",e=>h(this,n,"m",l).call(this,e)),h(this,a,"f").subscribe("AccountsController:accountRemoved",e=>h(this,n,"m",u).call(this,e))}async init(){(0,y.projectLogger)("Initializing..."),h(this,o,"f").clear(),h(this,c,"f").clear();const{keyrings:e}=h(this,a,"f").call("KeyringController:getState");for(const t of e)if(t.type===f.KeyringTypes.hd){const e=t.metadata.id;(0,y.projectLogger)(`Adding new wallet for entropy: "${e}"`);const s=new S.MultichainAccountWallet({entropySource:e,providers:h(this,i,"f"),messenger:h(this,a,"f")});h(this,o,"f").set(s.id,s);for(const e of s.getMultichainAccountGroups())for(const t of e.getAccounts())h(this,c,"f").set(t.id,{wallet:s,group:e})}(0,y.projectLogger)("Initialized")}async resyncAccounts(){(0,y.projectLogger)("Re-sync provider accounts if needed...");const e=h(this,a,"f").call("AccountsController:listMultichainAccounts").filter(m.isBip44Account);await Promise.all(h(this,i,"f").map(async t=>{try{await t.resyncAccounts(e)}catch(e){const s=`Unable to re-sync provider "${t.getName()}"`;(0,y.projectLogger)(s),console.error(s);const n=(0,M.createSentryError)(s,e,{provider:t.getName()});h(this,a,"f").captureException?.(n)}})),(0,y.projectLogger)("Providers got re-synced!")}ensureCanUseSnapPlatform(){return h(this,r,"f").ensureCanUseSnapPlatform()}getAccountContext(e){return h(this,c,"f").get(e)}getMultichainAccountWallet({entropySource:e}){return h(this,n,"m",d).call(this,e)}getMultichainAccountWallets(){return Array.from(h(this,o,"f").values())}async createMultichainAccountWallet({mnemonic:e}){const t=h(this,a,"f").call("KeyringController:getKeyringsByType",f.KeyringTypes.hd),s=(0,g.mnemonicPhraseToBytes)(e);if(t.some(e=>!!e.mnemonic&&(0,w.areUint8ArraysEqual)(e.mnemonic,s)))throw new Error("This Secret Recovery Phrase has already been imported.");(0,y.projectLogger)("Creating new wallet...");const n=await h(this,a,"f").call("KeyringController:addNewKeyring",f.KeyringTypes.hd,{mnemonic:e}),r=new S.MultichainAccountWallet({providers:h(this,i,"f"),entropySource:n.id,messenger:h(this,a,"f")});return h(this,o,"f").set(r.id,r),(0,y.projectLogger)(`Wallet created: [${r.id}]`),r}getMultichainAccountGroup({entropySource:e,groupIndex:t}){const s=h(this,n,"m",d).call(this,e).getMultichainAccountGroup(t);if(!s)throw new Error(`No multichain account for index: ${t}`);return s}getMultichainAccountGroups({entropySource:e}){return h(this,n,"m",d).call(this,e).getMultichainAccountGroups()}async createNextMultichainAccountGroup({entropySource:e}){return await h(this,n,"m",d).call(this,e).createNextMultichainAccountGroup()}async createMultichainAccountGroup({groupIndex:e,entropySource:t}){return await h(this,n,"m",d).call(this,t).createMultichainAccountGroup(e)}async setBasicFunctionality(e){(0,y.projectLogger)("Turning basic functionality: "+(e?"ON":"OFF"));for(const t of h(this,i,"f"))(0,k.isAccountProviderWrapper)(t)&&((0,y.projectLogger)(`${e?"Enabling":"Disabling"} account provider: "${t.getName()}"`),t.setEnabled(e));e&&await this.alignWallets()}async alignWallets(){(0,y.projectLogger)("Triggering alignment on all wallets...");const e=this.getMultichainAccountWallets();await Promise.all(e.map(e=>e.alignAccounts())),(0,y.projectLogger)("Wallets aligned")}async alignWallet(e){const t=this.getMultichainAccountWallet({entropySource:e});(0,y.projectLogger)(`Triggering alignment for wallet: [${t.id}]`),await t.alignAccounts(),(0,y.projectLogger)(`Wallet [${t.id}] aligned`)}},a=new WeakMap,r=new WeakMap,i=new WeakMap,o=new WeakMap,c=new WeakMap,n=new WeakSet,l=function(e){if(!(0,m.isBip44Account)(e))return;let t=!0,s=h(this,o,"f").get((0,m.toMultichainAccountWalletId)(e.options.entropy.id));s||((0,y.projectLogger)(`Adding new wallet for entropy: "${e.options.entropy.id}" (for account: "${e.id}")`),s=new S.MultichainAccountWallet({entropySource:e.options.entropy.id,providers:h(this,i,"f"),messenger:h(this,a,"f")}),h(this,o,"f").set(s.id,s),t=!1);let n=s.getMultichainAccountGroup(e.options.entropy.groupIndex);n||(t&&s.sync(),n=s.getMultichainAccountGroup(e.options.entropy.groupIndex),t=!1),n&&(t&&n.sync(),h(this,c,"f").set(e.id,{wallet:s,group:n}))},u=function(e){const t=h(this,c,"f").get(e);if(t){const{wallet:s}=t;(0,y.projectLogger)(`Re-synchronize wallet [${s.id}] since account "${e}" got removed`),s.sync()}h(this,c,"f").delete(e)},d=function(e){const t=h(this,o,"f").get((0,m.toMultichainAccountWalletId)(e));if(!t)throw new Error("Unknown wallet, no wallet matching this entropy source");return t}}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/MultichainAccountService.cjs"}],[26,{"../../controllers/network-order":235},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.NetworkOrderControllerInit=void 0;var n=e("../../controllers/network-order");s.NetworkOrderControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new n.NetworkOrderController({messenger:e,state:{orderedNetworkList:[],...t.NetworkOrderController}})})}}},{package:"$root$",file:"app/scripts/controller-init/assets/network-order-controller-init.ts"}],[260,{"@metamask/name-controller":2739},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.ChangeType=s.AbstractPetnamesBridge=void 0;var n=e("@metamask/name-controller");function a(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function r(e,t,s){i(e,t),t.set(e,s)}function i(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function o(e,t){return e.get(l(e,t))}function c(e,t,s){return e.set(l(e,t),s),s}function l(e,t,s){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:s;throw new TypeError("Private element is not present on this object")}let u=s.ChangeType=function(e){return e.ADDED="ADDED",e.UPDATED="UPDATED",e.DELETED="DELETED",e}({});var d=function(e){return e.SOURCE_TO_PETNAMES="Source->Petnames",e.PETNAMES_TO_SOURCE="Petnames->Source",e}(d||{});function p({type:e,variation:t,value:s}){return`${e}/${t}/${e===n.NameType.ETHEREUM_ADDRESS?s.toLowerCase():s}`}var h=new WeakMap,m=new WeakMap,g=new WeakMap,f=new WeakSet;function w(e){if(o(g,this)===e)throw new Error(`Attempted to synchronize recursively in same direction: ${e}`);if(null!==o(g,this))return;c(g,this,e);const[t,s]="Source->Petnames"===e?[this.getSourceEntries(),l(f,this,v).call(this)]:[l(f,this,v).call(this),this.getSourceEntries()],n=l(f,this,S).call(this,s,t);l(f,this,b).call(this,n),c(g,this,null)}function v(){const{names:e}=o(m,this).state,t=[];for(const s of Object.values(n.NameType))for(const n of Object.keys(e[s]))for(const a of Object.keys(e[s][n])){const{name:r,sourceId:i,origin:o}=e[s][n][a];if(!r)continue;const c={value:n,type:s,name:r,variation:a,sourceId:i??undefined,origin:o??undefined};this.shouldSyncPetname(c)&&t.push(c)}return t}function y(e,t){e===u.DELETED?(delete t.sourceId,delete t.origin,o(m,this).setName({...t,name:null})):o(m,this).setName(t)}function S(e,t){const s=[],n=[],a=[],r=new Map(e.map(e=>[p(e),e])),i=new Map(t.map(e=>[p(e),e]));return i.forEach((e,t)=>{const a=r.get(t);a?e.name!==a.name&&n.push(e):s.push(e)}),r.forEach((e,t)=>{i.has(t)||a.push(e)}),{[u.ADDED]:s,[u.UPDATED]:n,[u.DELETED]:a}}function b(e){const t=o(g,this)===d.SOURCE_TO_PETNAMES?l(f,this,y).bind(this):this.updateSourceEntry.bind(this);for(const s of Object.values(u))for(const n of e[s])t(s,n)}s.AbstractPetnamesBridge=class{constructor({isTwoWay:e,nameController:t,messenger:s}){var n,o;i(n=this,o=f),o.add(n),r(this,h,void 0),r(this,m,void 0),r(this,g,null),a(this,"messenger",void 0),c(h,this,e),c(m,this,t),this.messenger=s}init(){o(h,this)&&this.messenger.subscribe("NameController:stateChange",()=>l(f,this,w).call(this,d.PETNAMES_TO_SOURCE)),this.onSourceChange(()=>l(f,this,w).call(this,d.SOURCE_TO_PETNAMES))}updateSourceEntry(e,t){throw new Error("updateSourceEntry must be overridden for two-way bridges")}shouldSyncPetname(e){return!0}}}}},{package:"$root$",file:"app/scripts/lib/AbstractPetnamesBridge.ts"}],[2600,{"./MultichainAccountGroup.cjs":2598,"./logger.cjs":2605,"./providers/index.cjs":2613,"./utils.cjs":2616,"@metamask/account-api":1264,"@metamask/utils":3554,"async-mutex":4345},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n,a,r,i,o,c,l,u,d,p,h,m,g,f=this&&this.__classPrivateFieldSet||function(e,t,s,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?a.call(e,s):a?a.value=s:t.set(e,s),s},w=this&&this.__classPrivateFieldGet||function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)};Object.defineProperty(s,"__esModule",{value:!0}),s.MultichainAccountWallet=void 0;const v=e("@metamask/account-api"),y=e("@metamask/utils"),S=e("async-mutex"),b=e("./logger.cjs"),k=e("./MultichainAccountGroup.cjs"),T=e("./providers/index.cjs"),A=e("./utils.cjs");s.MultichainAccountWallet=class{constructor({providers:e,entropySource:t,messenger:s}){n.add(this),a.set(this,new S.Mutex),r.set(this,void 0),i.set(this,void 0),o.set(this,void 0),c.set(this,void 0),l.set(this,void 0),u.set(this,void 0),d.set(this,!1),p.set(this,void 0),f(this,r,(0,v.toMultichainAccountWalletId)(t),"f"),f(this,i,e,"f"),f(this,o,t,"f"),f(this,l,s,"f"),f(this,c,new Map,"f"),f(this,u,(0,b.createModuleLogger)(b.projectLogger,`[${w(this,r,"f")}]`),"f"),f(this,p,"uninitialized","f"),this.sync(),f(this,d,!0,"f"),f(this,p,"ready","f")}sync(){w(this,u,"f").call(this,"Synchronizing with account providers...");for(const e of w(this,i,"f"))for(const t of e.getAccounts()){const{entropy:e}=t.options;if(e.id!==this.entropySource)continue;let s=w(this,c,"f").get(e.groupIndex);s||(s=new k.MultichainAccountGroup({groupIndex:e.groupIndex,wallet:this,providers:w(this,i,"f"),messenger:w(this,l,"f")}),w(this,u,"f").call(this,`Found a new group: [${s.id}]`),w(this,c,"f").set(e.groupIndex,s))}for(const[e,t]of w(this,c,"f").entries())t.sync(),t.hasAccounts()||(w(this,u,"f").call(this,`Deleting group: [${t.id}]`),w(this,c,"f").delete(e));w(this,u,"f").call(this,"Synchronized")}get id(){return w(this,r,"f")}get type(){return v.AccountWalletType.Entropy}get entropySource(){return w(this,o,"f")}get status(){return w(this,p,"f")}getAccountGroup(e){if(e===(0,v.toDefaultAccountGroupId)(this.id))return w(this,c,"f").get(0);if(!(0,v.isMultichainAccountGroupId)(e))return undefined;const t=(0,v.getGroupIndexFromMultichainAccountGroupId)(e);return w(this,c,"f").get(t)}getAccountGroups(){return this.getMultichainAccountGroups()}getMultichainAccountGroup(e){return w(this,c,"f").get(e)}getMultichainAccountGroups(){return Array.from(w(this,c,"f").values())}getNextGroupIndex(){return Math.max(-1,...w(this,c,"f").keys())+1}async createMultichainAccountGroup(e,t={waitForAllProvidersToFinishCreatingAccounts:!1}){return await w(this,n,"m",h).call(this,"in-progress:create-accounts",async()=>{const s=this.getNextGroupIndex();if(e>s)throw new Error(`You cannot use a group index that is higher than the next available one: expected <=${s}, got ${e}`);let a=this.getMultichainAccountGroup(e);if(a)return a.sync(),w(this,u,"f").call(this,`Trying to re-create existing group: [${a.id}] (idempotent)`),a;w(this,u,"f").call(this,`Creating new group for index ${e}...`);const[r,...p]=w(this,i,"f");(0,y.assert)(r instanceof T.EvmAccountProvider,"EVM account provider must be first");try{await r.createAccounts({entropySource:w(this,o,"f"),groupIndex:e})}catch(t){const s=`Unable to create multichain account group for index: ${e} with provider "${r.getName()}". Error: ${t.message}`;w(this,u,"f").call(this,`${b.ERROR_PREFIX} ${s}:`,t);const n=(0,A.createSentryError)(`Unable to create account with provider "${r.getName()}"`,t,{groupIndex:e,provider:r.getName()});throw w(this,l,"f").captureException?.(n),new Error(s)}return t?.waitForAllProvidersToFinishCreatingAccounts?await w(this,n,"m",m).call(this,{groupIndex:e,providers:p,awaitAll:!0}):w(this,n,"m",m).call(this,{groupIndex:e,providers:p,awaitAll:!1}),a=this.getMultichainAccountGroup(e),a||(a=new k.MultichainAccountGroup({wallet:this,providers:w(this,i,"f"),groupIndex:e,messenger:w(this,l,"f")})),w(this,c,"f").set(e,a),w(this,u,"f").call(this,`New group created: [${a.id}]`),w(this,d,"f")&&w(this,l,"f").publish("MultichainAccountService:multichainAccountGroupCreated",a),a})}async createNextMultichainAccountGroup(){return this.createMultichainAccountGroup(this.getNextGroupIndex(),{waitForAllProvidersToFinishCreatingAccounts:!0})}async alignAccounts(){await w(this,n,"m",h).call(this,"in-progress:alignment",async()=>{await w(this,n,"m",g).call(this)})}async alignAccountsOf(e){await w(this,n,"m",h).call(this,"in-progress:alignment",async()=>{const t=this.getMultichainAccountGroup(e);t&&await t.alignAccounts()})}async discoverAccounts(){return w(this,n,"m",h).call(this,"in-progress:discovery",async()=>{let e=this.getNextGroupIndex();const t=w(this,i,"f").map(t=>({provider:t,stopped:!1,groupIndex:e,accounts:[]}));return await Promise.all(t.map(async t=>{const s=t.provider.getName(),n=(e,t)=>`[${s}] Discovery ${e} for group index: ${t}`;for(;!t.stopped;){const a=Math.max(t.groupIndex,e);(0,b.projectLogger)(n("started",a));let r=[];try{r=await t.provider.discoverAccounts({entropySource:w(this,o,"f"),groupIndex:a})}catch(e){t.stopped=!0,console.error(e),(0,b.projectLogger)(n(`failed (with: "${e.message}")`,a),e);const r=(0,A.createSentryError)("Unable to discover accounts",e,{provider:s,groupIndex:a});w(this,l,"f").captureException?.(r);break}if(!r.length){(0,b.projectLogger)(n("stopped (no accounts got discovered)",a)),t.stopped=!0;break}(0,b.projectLogger)(n("**succeeded**",a)),t.accounts=t.accounts.concat(r);const i=a+1;t.groupIndex=i,i>e&&(e=i)}})),this.sync(),await w(this,n,"m",g).call(this),t.flatMap(e=>e.accounts)})}},a=new WeakMap,r=new WeakMap,i=new WeakMap,o=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,d=new WeakMap,p=new WeakMap,n=new WeakSet,h=async function(e,t){const s=await w(this,a,"f").acquire();try{return w(this,u,"f").call(this,`Locking wallet with status "${e}"...`),f(this,p,e,"f"),w(this,l,"f").publish("MultichainAccountService:walletStatusChange",this.id,w(this,p,"f")),await t()}finally{f(this,p,"ready","f"),w(this,l,"f").publish("MultichainAccountService:walletStatusChange",this.id,w(this,p,"f")),s(),w(this,u,"f").call(this,`Releasing wallet lock (was "${e}")`)}},m=async function({groupIndex:e,providers:t,awaitAll:s}){if(s){const s=t.map(t=>t.createAccounts({entropySource:w(this,o,"f"),groupIndex:e}).catch(s=>{const n=(0,A.createSentryError)(`Unable to create account with provider "${t.getName()}"`,s,{groupIndex:e,provider:t.getName()});throw w(this,l,"f").captureException?.(n),s})),n=await Promise.allSettled(s);if(n.some(e=>"rejected"===e.status)){const t=(0,A.toRejectedErrorMessage)(`Unable to create multichain account group for index: ${e}`,n);throw w(this,u,"f").call(this,`${b.WARNING_PREFIX} ${t}`),console.warn(t),new Error(t)}return}t.forEach(t=>{t.createAccounts({entropySource:w(this,o,"f"),groupIndex:e}).catch(s=>{const n=`Unable to create multichain account group for index: ${e} (background mode with provider "${t.getName()}")`;w(this,u,"f").call(this,`${b.WARNING_PREFIX} ${n}:`,s);const a=(0,A.createSentryError)(`Unable to create account with provider "${t.getName()}"`,s,{groupIndex:e,provider:t.getName()});w(this,l,"f").captureException?.(a)})})},g=async function(){const e=this.getMultichainAccountGroups();await Promise.all(e.map(e=>e.alignAccounts()))}}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/MultichainAccountWallet.cjs"}],[2601,{"./traces.cjs":2602},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){n===undefined&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){n===undefined&&(n=s),e[n]=t[s]}),a=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||n(t,e,s)};Object.defineProperty(s,"__esModule",{value:!0}),a(e("./traces.cjs"),s)}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/analytics/index.cjs"}],[2602,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.traceFallback=void 0;s.traceFallback=async(e,t)=>t?await Promise.resolve(t()):undefined}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/analytics/traces.cjs"}],[2603,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n;Object.defineProperty(s,"__esModule",{value:!0}),s.TraceName=void 0,function(e){e.SnapDiscoverAccounts="Snap Discover Accounts",e.EvmDiscoverAccounts="EVM Discover Accounts"}(n||(s.TraceName=n={}))}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/constants/traces.cjs"}],[2604,{"./MultichainAccountGroup.cjs":2598,"./MultichainAccountService.cjs":2599,"./MultichainAccountWallet.cjs":2600,"./providers/index.cjs":2613},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.MultichainAccountService=s.MultichainAccountGroup=s.MultichainAccountWallet=s.TrxAccountProvider=s.TRX_ACCOUNT_PROVIDER_NAME=s.BtcAccountProvider=s.BTC_ACCOUNT_PROVIDER_NAME=s.SolAccountProvider=s.SOL_ACCOUNT_PROVIDER_NAME=s.EvmAccountProvider=s.EVM_ACCOUNT_PROVIDER_NAME=s.TimeoutError=s.SnapAccountProvider=s.BaseBip44AccountProvider=s.AccountProviderWrapper=void 0;var n=e("./providers/index.cjs");Object.defineProperty(s,"AccountProviderWrapper",{enumerable:!0,get:function(){return n.AccountProviderWrapper}}),Object.defineProperty(s,"BaseBip44AccountProvider",{enumerable:!0,get:function(){return n.BaseBip44AccountProvider}}),Object.defineProperty(s,"SnapAccountProvider",{enumerable:!0,get:function(){return n.SnapAccountProvider}}),Object.defineProperty(s,"TimeoutError",{enumerable:!0,get:function(){return n.TimeoutError}}),Object.defineProperty(s,"EVM_ACCOUNT_PROVIDER_NAME",{enumerable:!0,get:function(){return n.EVM_ACCOUNT_PROVIDER_NAME}}),Object.defineProperty(s,"EvmAccountProvider",{enumerable:!0,get:function(){return n.EvmAccountProvider}}),Object.defineProperty(s,"SOL_ACCOUNT_PROVIDER_NAME",{enumerable:!0,get:function(){return n.SOL_ACCOUNT_PROVIDER_NAME}}),Object.defineProperty(s,"SolAccountProvider",{enumerable:!0,get:function(){return n.SolAccountProvider}}),Object.defineProperty(s,"BTC_ACCOUNT_PROVIDER_NAME",{enumerable:!0,get:function(){return n.BTC_ACCOUNT_PROVIDER_NAME}}),Object.defineProperty(s,"BtcAccountProvider",{enumerable:!0,get:function(){return n.BtcAccountProvider}}),Object.defineProperty(s,"TRX_ACCOUNT_PROVIDER_NAME",{enumerable:!0,get:function(){return n.TRX_ACCOUNT_PROVIDER_NAME}}),Object.defineProperty(s,"TrxAccountProvider",{enumerable:!0,get:function(){return n.TrxAccountProvider}});var a=e("./MultichainAccountWallet.cjs");Object.defineProperty(s,"MultichainAccountWallet",{enumerable:!0,get:function(){return a.MultichainAccountWallet}});var r=e("./MultichainAccountGroup.cjs");Object.defineProperty(s,"MultichainAccountGroup",{enumerable:!0,get:function(){return r.MultichainAccountGroup}});var i=e("./MultichainAccountService.cjs");Object.defineProperty(s,"MultichainAccountService",{enumerable:!0,get:function(){return i.MultichainAccountService}})}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/index.cjs"}],[2605,{"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.ERROR_PREFIX=s.WARNING_PREFIX=s.createModuleLogger=s.projectLogger=void 0;const n=e("@metamask/utils");Object.defineProperty(s,"createModuleLogger",{enumerable:!0,get:function(){return n.createModuleLogger}}),s.projectLogger=(0,n.createProjectLogger)("multichain-account-service"),s.WARNING_PREFIX="WARNING --",s.ERROR_PREFIX="ERROR --"}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/logger.cjs"}],[2606,{"./BaseBip44AccountProvider.cjs":2607},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.isAccountProviderWrapper=s.AccountProviderWrapper=void 0;const n=e("./BaseBip44AccountProvider.cjs");class a extends n.BaseBip44AccountProvider{constructor(e,t){super(e),this.isEnabled=!0,this.provider=t}getName(){return this.provider.getName()}setEnabled(e){this.isEnabled=e}async resyncAccounts(e){this.isEnabled&&await this.provider.resyncAccounts(e)}getAccounts(){return this.isEnabled?this.provider.getAccounts():[]}getAccount(e){if(!this.isEnabled)throw new Error("Provider is disabled");return this.provider.getAccount(e)}isAccountCompatible(e){return this.provider.isAccountCompatible(e)}async createAccounts(e){return this.isEnabled?this.provider.createAccounts(e):[]}async discoverAccounts(e){return this.isEnabled?this.provider.discoverAccounts(e):[]}}s.AccountProviderWrapper=a,s.isAccountProviderWrapper=function(e){return e instanceof a}}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/providers/AccountProviderWrapper.cjs"}],[2607,{"@metamask/account-api":1264},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n,a,r=this&&this.__classPrivateFieldGet||function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)};Object.defineProperty(s,"__esModule",{value:!0}),s.BaseBip44AccountProvider=s.assertAreBip44Accounts=s.assertIsBip44Account=void 0;const i=e("@metamask/account-api");function o(e){if(!(0,i.isBip44Account)(e))throw new Error("Created account is not BIP-44 compatible")}s.assertIsBip44Account=o,s.assertAreBip44Accounts=function(e){e.forEach(o)};s.BaseBip44AccountProvider=class{constructor(e){n.add(this),this.messenger=e}getAccounts(){return r(this,n,"m",a).call(this)}getAccount(e){const[t]=r(this,n,"m",a).call(this,t=>t.id===e);if(!t)throw new Error(`Unable to find account: ${e}`);return t}async withKeyring(e,t){return await this.messenger.call("KeyringController:withKeyring",e,({keyring:e,metadata:s})=>t({keyring:e,metadata:s}))}},n=new WeakSet,a=function(e=()=>!0){const t=[];for(const s of this.messenger.call("AccountsController:listMultichainAccounts"))(0,i.isBip44Account)(s)&&this.isAccountCompatible(s)&&e(s)&&t.push(s);return t}}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/providers/BaseBip44AccountProvider.cjs"}],[2608,{"../analytics/index.cjs":2601,"../constants/traces.cjs":2603,"./SnapAccountProvider.cjs":2610,"./utils.cjs":2614,"@metamask/account-api":1264,"@metamask/keyring-api":2510},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n,a,r=this&&this.__classPrivateFieldGet||function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)};Object.defineProperty(s,"__esModule",{value:!0}),s.BtcAccountProvider=s.BTC_ACCOUNT_PROVIDER_DEFAULT_CONFIG=s.BTC_ACCOUNT_PROVIDER_NAME=void 0;const i=e("@metamask/account-api"),o=e("@metamask/keyring-api"),c=e("./SnapAccountProvider.cjs"),l=e("./utils.cjs"),u=e("../analytics/index.cjs"),d=e("../constants/traces.cjs");s.BTC_ACCOUNT_PROVIDER_NAME="Bitcoin",s.BTC_ACCOUNT_PROVIDER_DEFAULT_CONFIG={maxConcurrency:3,createAccounts:{timeoutMs:3e3},discovery:{enabled:!0,timeoutMs:2e3,maxAttempts:3,backOffMs:1e3}};class p extends c.SnapAccountProvider{constructor(e,t=s.BTC_ACCOUNT_PROVIDER_DEFAULT_CONFIG,a=u.traceFallback){super(p.BTC_SNAP_ID,e,t,a),n.add(this)}getName(){return p.NAME}isAccountCompatible(e){return e.type===o.BtcAccountType.P2wpkh&&Object.values(o.BtcAccountType).includes(e.type)}async createAccounts({entropySource:e,groupIndex:t}){return this.withSnap(async({keyring:s})=>r(this,n,"m",a).call(this,{keyring:s,entropySource:e,groupIndex:t}))}async discoverAccounts({entropySource:e,groupIndex:t}){return this.withSnap(async({client:s,keyring:i})=>await super.trace({name:d.TraceName.SnapDiscoverAccounts,data:{provider:this.getName()}},async()=>{if(!this.config.discovery.enabled)return[];const c=await(0,l.withRetry)(()=>(0,l.withTimeout)(s.discoverAccounts([o.BtcScope.Mainnet],e,t),this.config.discovery.timeoutMs),{maxAttempts:this.config.discovery.maxAttempts,backOffMs:this.config.discovery.backOffMs});if(!Array.isArray(c)||0===c.length)return[];return await r(this,n,"m",a).call(this,{keyring:i,entropySource:e,groupIndex:t})}))}}s.BtcAccountProvider=p,n=new WeakSet,a=async function({keyring:e,entropySource:t,groupIndex:s}){return this.withMaxConcurrency(async()=>{const n=await(0,l.withTimeout)(e.createAccount({entropySource:t,index:s,addressType:o.BtcAccountType.P2wpkh,scope:o.BtcScope.Mainnet}),this.config.createAccounts.timeoutMs);return(0,i.assertIsBip44Account)(n),[n]})},p.NAME=s.BTC_ACCOUNT_PROVIDER_NAME,p.BTC_SNAP_ID="npm:@metamask/bitcoin-wallet-snap"}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/providers/BtcAccountProvider.cjs"}],[2609,{"../analytics/index.cjs":2601,"../constants/traces.cjs":2603,"../logger.cjs":2605,"./BaseBip44AccountProvider.cjs":2607,"./utils.cjs":2614,"@ethereumjs/util":717,"@metamask/keyring-api":2510,"@metamask/keyring-controller":2537,"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n,a,r,i,o,c,l=this&&this.__classPrivateFieldSet||function(e,t,s,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?a.call(e,s):a?a.value=s:t.set(e,s),s},u=this&&this.__classPrivateFieldGet||function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)};Object.defineProperty(s,"__esModule",{value:!0}),s.EvmAccountProvider=s.EVM_ACCOUNT_PROVIDER_DEFAULT_CONFIG=s.EVM_ACCOUNT_PROVIDER_NAME=void 0;const d=e("@ethereumjs/util"),p=e("@metamask/keyring-api"),h=e("@metamask/keyring-controller"),m=e("@metamask/utils"),g=e("./BaseBip44AccountProvider.cjs"),f=e("./utils.cjs"),w=e("../analytics/index.cjs"),v=e("../constants/traces.cjs"),y=e("../logger.cjs");function S(e){if(!e)throw new Error("Internal account does not exist")}s.EVM_ACCOUNT_PROVIDER_NAME="EVM",s.EVM_ACCOUNT_PROVIDER_DEFAULT_CONFIG={discovery:{maxAttempts:3,timeoutMs:500,backOffMs:500}};class b extends g.BaseBip44AccountProvider{constructor(e,t=s.EVM_ACCOUNT_PROVIDER_DEFAULT_CONFIG,i){super(e),n.add(this),a.set(this,void 0),r.set(this,void 0),l(this,a,{...t,discovery:{...t.discovery,enabled:t.discovery.enabled??!0}},"f"),l(this,r,i??w.traceFallback,"f")}isAccountCompatible(e){return e.type===p.EthAccountType.Eoa&&e.metadata.keyring.type===h.KeyringTypes.hd}getName(){return b.NAME}getEvmProvider(){const e=this.messenger.call("NetworkController:findNetworkClientIdByChainId","0x1"),{provider:t}=this.messenger.call("NetworkController:getNetworkClientById",e);return t}async createAccounts({entropySource:e,groupIndex:t}){const[s]=await u(this,n,"m",i).call(this,{entropySource:e,groupIndex:t,throwOnGap:!0}),a=this.messenger.call("AccountsController:getAccountByAddress",s);S(a);const r=[a];return(0,g.assertAreBip44Accounts)(r),r}async discoverAccounts(e){return u(this,r,"f").call(this,{name:v.TraceName.EvmDiscoverAccounts,data:{provider:this.getName()}},async()=>{if(!u(this,a,"f").discovery.enabled)return[];const t=this.getEvmProvider(),{entropySource:s,groupIndex:r}=e,l=await u(this,n,"m",c).call(this,{entropySource:s,groupIndex:r});if(0===await u(this,n,"m",o).call(this,t,l))return[];const[d]=await u(this,n,"m",i).call(this,{entropySource:s,groupIndex:r});(0,m.assert)(l===d,"Created account does not match address from group index.");const p=this.messenger.call("AccountsController:getAccountByAddress",d);return S(p),(0,g.assertIsBip44Account)(p),[p]})}async resyncAccounts(){}}s.EvmAccountProvider=b,a=new WeakMap,r=new WeakMap,n=new WeakSet,i=async function({entropySource:e,groupIndex:t,throwOnGap:s=!1}){return await this.withKeyring({id:e},async({keyring:e})=>{const n=await e.getAccounts();if(t<n.length)return[n[t],!1];if(s&&t!==n.length)throw new Error("Trying to create too many accounts");const[a]=await e.addAccounts(1);return[a,!0]})},o=async function(e,t){const s="eth_getTransactionCount",n=await(0,f.withRetry)(()=>(0,f.withTimeout)(e.request({method:s,params:[t,"latest"]}),u(this,a,"f").discovery.timeoutMs),{maxAttempts:u(this,a,"f").discovery.maxAttempts,backOffMs:u(this,a,"f").discovery.backOffMs});if(!(0,m.isStrictHexString)(n)){const e=`Received invalid hex response from "${s}" request: ${JSON.stringify(n)}`;return(0,y.projectLogger)(`${y.WARNING_PREFIX} ${e}`),console.warn(e),0}return parseInt(n,16)},c=async function({entropySource:e,groupIndex:t}){return await this.withKeyring({id:e},async({keyring:e})=>{const s=await e.getAccounts();if(t<s.length)return s[t];(0,m.assert)(e.root,"Expected HD keyring.root to be set");const n=e.root.deriveChild(t);return(0,m.assert)(n.publicKey,"Expected public key to be set"),(0,m.add0x)((0,m.bytesToHex)((0,d.publicToAddress)(n.publicKey,!0)).toLowerCase())})},b.NAME=s.EVM_ACCOUNT_PROVIDER_NAME}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/providers/EvmAccountProvider.cjs"}],[261,{"./AbstractPetnamesBridge":260,"@metamask/name-controller":2739},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.AccountIdentitiesPetnamesBridge=void 0;var n=e("@metamask/name-controller"),a=e("./AbstractPetnamesBridge");class r extends a.AbstractPetnamesBridge{constructor({nameController:e,messenger:t}){super({isTwoWay:!1,nameController:e,messenger:t})}getSourceEntries(){return this.messenger.call("AccountsController:listAccounts").map(e=>({value:e.address,type:n.NameType.ETHEREUM_ADDRESS,name:e.metadata.name,sourceId:undefined,variation:n.FALLBACK_VARIATION,origin:n.NameOrigin.ACCOUNT_IDENTITY}))}onSourceChange(e){this.messenger.subscribe("AccountsController:stateChange",e)}shouldSyncPetname(e){return e.origin===n.NameOrigin.ACCOUNT_IDENTITY}}s.AccountIdentitiesPetnamesBridge=r}}},{package:"$root$",file:"app/scripts/lib/AccountIdentitiesPetnamesBridge.ts"}],[2610,{"../analytics/index.cjs":2601,"../utils.cjs":2616,"./BaseBip44AccountProvider.cjs":2607,"@metamask/keyring-controller":2537,"@metamask/keyring-snap-client":2548,"@metamask/snaps-utils":2645,"async-mutex":4345},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n,a,r,i,o,c,l,u=this&&this.__classPrivateFieldGet||function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)},d=this&&this.__classPrivateFieldSet||function(e,t,s,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?a.call(e,s):a?a.value=s:t.set(e,s),s};Object.defineProperty(s,"__esModule",{value:!0}),s.isSnapAccountProvider=s.SnapAccountProvider=void 0;const p=e("@metamask/keyring-controller"),h=e("@metamask/keyring-snap-client"),m=e("@metamask/snaps-utils"),g=e("async-mutex"),f=e("./BaseBip44AccountProvider.cjs"),w=e("../analytics/index.cjs"),v=e("../utils.cjs");class y extends f.BaseBip44AccountProvider{constructor(e,t,s,o=w.traceFallback){super(t),n.add(this),a.set(this,void 0),r.set(this,void 0),i.set(this,void 0),this.snapId=e,d(this,a,u(this,n,"m",c).call(this,e),"f");const l=s.maxConcurrency??Infinity;this.config={...s,discovery:{...s.discovery,enabled:s.discovery.enabled??!0},maxConcurrency:l},isFinite(l)&&d(this,r,new g.Semaphore(l),"f"),d(this,i,o,"f")}async ensureCanUseSnapPlatform(){return this.messenger.call("MultichainAccountService:ensureCanUseSnapPlatform")}async withMaxConcurrency(e){return u(this,r,"f")?u(this,r,"f").runExclusive(e):e()}async trace(e,t){return u(this,i,"f").call(this,e,t)}async resyncAccounts(e){await this.withSnap(async({keyring:t})=>{const s=e.filter(e=>e.metadata.snap&&e.metadata.snap.id===this.snapId),n=new Set((await u(this,a,"f").listAccounts()).map(e=>e.id));if(s.length<n.size){const e=new Set(s.map(e=>e.id));await Promise.all([...n].map(async t=>{try{e.has(t)||(await u(this,a,"f").deleteAccount(t),n.delete(t))}catch(e){const s=(0,v.createSentryError)(`Unable to delete de-synced Snap account: ${this.snapId}`,e,{provider:this.getName(),snapAccountId:t});this.messenger.captureException?.(s)}}))}s.length>n.size&&await Promise.all(s.map(async e=>{const{id:s,groupIndex:a}=e.options.entropy;try{n.has(e.id)||(await t.removeAccount(e.address),await this.createAccounts({entropySource:s,groupIndex:a}))}catch(e){const t=(0,v.createSentryError)(`Unable to re-sync account: ${a}`,e,{provider:this.getName(),groupIndex:a});this.messenger.captureException?.(t)}}))})}async withSnap(e){return await this.ensureCanUseSnapPlatform(),await e({client:u(this,a,"f"),keyring:await u(this,n,"m",o).call(this)})}}s.SnapAccountProvider=y,a=new WeakMap,r=new WeakMap,i=new WeakMap,n=new WeakSet,o=async function(){const e=await u(this,n,"m",l).call(this,async({keyring:e})=>e.createAccount.bind(e));return{createAccount:async t=>await e(this.snapId,t,{displayAccountNameSuggestion:!1,displayConfirmation:!1,setSelectedAccount:!1}),removeAccount:async e=>await u(this,n,"m",l).call(this,async({keyring:t})=>{await t.removeAccount(e)})}},c=function(e){return new h.KeyringClient({send:async t=>await this.messenger.call("SnapController:handleRequest",{snapId:e,origin:"metamask",handler:m.HandlerType.OnKeyringRequest,request:t})})},l=async function(e){return this.withKeyring({type:p.KeyringTypes.snap},t=>e(t))};s.isSnapAccountProvider=e=>e instanceof y}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/providers/SnapAccountProvider.cjs"}],[2611,{"../analytics/index.cjs":2601,"../constants/traces.cjs":2603,"./SnapAccountProvider.cjs":2610,"./utils.cjs":2614,"@metamask/account-api":1264,"@metamask/keyring-api":2510,"@metamask/keyring-controller":2537},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n,a,r=this&&this.__classPrivateFieldGet||function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)};Object.defineProperty(s,"__esModule",{value:!0}),s.SolAccountProvider=s.SOL_ACCOUNT_PROVIDER_DEFAULT_CONFIG=s.SOL_ACCOUNT_PROVIDER_NAME=void 0;const i=e("@metamask/account-api"),o=e("@metamask/keyring-api"),c=e("@metamask/keyring-api"),l=e("@metamask/keyring-controller"),u=e("./SnapAccountProvider.cjs"),d=e("./utils.cjs"),p=e("../analytics/index.cjs"),h=e("../constants/traces.cjs");s.SOL_ACCOUNT_PROVIDER_NAME="Solana",s.SOL_ACCOUNT_PROVIDER_DEFAULT_CONFIG={maxConcurrency:3,discovery:{enabled:!0,timeoutMs:2e3,maxAttempts:3,backOffMs:1e3},createAccounts:{timeoutMs:3e3}};class m extends u.SnapAccountProvider{constructor(e,t=s.SOL_ACCOUNT_PROVIDER_DEFAULT_CONFIG,a=p.traceFallback){super(m.SOLANA_SNAP_ID,e,t,a),n.add(this)}getName(){return m.NAME}isAccountCompatible(e){return e.type===c.SolAccountType.DataAccount&&e.metadata.keyring.type===l.KeyringTypes.snap}async createAccounts({entropySource:e,groupIndex:t}){return this.withSnap(async({keyring:s})=>this.withMaxConcurrency(async()=>{const i=`m/44'/501'/${t}'/0'`;return[await r(this,n,"m",a).call(this,{keyring:s,entropySource:e,groupIndex:t,derivationPath:i})]}))}async discoverAccounts({entropySource:e,groupIndex:t}){return this.withSnap(async({client:s,keyring:i})=>await super.trace({name:h.TraceName.SnapDiscoverAccounts,data:{provider:this.getName()}},async()=>{if(!this.config.discovery.enabled)return[];const c=await(0,d.withRetry)(()=>(0,d.withTimeout)(s.discoverAccounts([o.SolScope.Mainnet],e,t),this.config.discovery.timeoutMs),{maxAttempts:this.config.discovery.maxAttempts,backOffMs:this.config.discovery.backOffMs});if(!c.length)return[];return await Promise.all(c.map(s=>r(this,n,"m",a).call(this,{keyring:i,entropySource:e,groupIndex:t,derivationPath:s.derivationPath})))}))}}s.SolAccountProvider=m,n=new WeakSet,a=async function({keyring:e,entropySource:t,groupIndex:s,derivationPath:n}){const a=await(0,d.withTimeout)(e.createAccount({entropySource:t,derivationPath:n}),this.config.createAccounts.timeoutMs);return a.options.entropy={type:c.KeyringAccountEntropyTypeOption.Mnemonic,id:t,groupIndex:s,derivationPath:n},(0,i.assertIsBip44Account)(a),a},m.NAME=s.SOL_ACCOUNT_PROVIDER_NAME,m.SOLANA_SNAP_ID="npm:@metamask/solana-wallet-snap"}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/providers/SolAccountProvider.cjs"}],[2612,{"../analytics/index.cjs":2601,"../constants/traces.cjs":2603,"./SnapAccountProvider.cjs":2610,"./utils.cjs":2614,"@metamask/account-api":1264,"@metamask/keyring-api":2510,"@metamask/keyring-controller":2537},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n,a,r=this&&this.__classPrivateFieldGet||function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)};Object.defineProperty(s,"__esModule",{value:!0}),s.TrxAccountProvider=s.TRX_ACCOUNT_PROVIDER_DEFAULT_CONFIG=s.TRX_ACCOUNT_PROVIDER_NAME=void 0;const i=e("@metamask/account-api"),o=e("@metamask/keyring-api"),c=e("@metamask/keyring-controller"),l=e("./SnapAccountProvider.cjs"),u=e("./utils.cjs"),d=e("../analytics/index.cjs"),p=e("../constants/traces.cjs");s.TRX_ACCOUNT_PROVIDER_NAME="Tron",s.TRX_ACCOUNT_PROVIDER_DEFAULT_CONFIG={maxConcurrency:3,discovery:{enabled:!0,timeoutMs:2e3,maxAttempts:3,backOffMs:1e3},createAccounts:{timeoutMs:3e3}};class h extends l.SnapAccountProvider{constructor(e,t=s.TRX_ACCOUNT_PROVIDER_DEFAULT_CONFIG,a=d.traceFallback){super(h.TRX_SNAP_ID,e,t,a),n.add(this)}getName(){return h.NAME}isAccountCompatible(e){return e.type===o.TrxAccountType.Eoa&&e.metadata.keyring.type===c.KeyringTypes.snap}async createAccounts({entropySource:e,groupIndex:t}){return this.withSnap(async({keyring:s})=>r(this,n,"m",a).call(this,{keyring:s,entropySource:e,groupIndex:t}))}async discoverAccounts({entropySource:e,groupIndex:t}){return this.withSnap(async({client:s,keyring:i})=>await super.trace({name:p.TraceName.SnapDiscoverAccounts,data:{provider:this.getName()}},async()=>{if(!this.config.discovery.enabled)return[];if(!(await(0,u.withRetry)(()=>(0,u.withTimeout)(s.discoverAccounts([o.TrxScope.Mainnet],e,t),this.config.discovery.timeoutMs),{maxAttempts:this.config.discovery.maxAttempts,backOffMs:this.config.discovery.backOffMs})).length)return[];return await r(this,n,"m",a).call(this,{keyring:i,entropySource:e,groupIndex:t})}))}}s.TrxAccountProvider=h,n=new WeakSet,a=async function({keyring:e,entropySource:t,groupIndex:s}){return this.withMaxConcurrency(async()=>{const n=await(0,u.withTimeout)(e.createAccount({entropySource:t,index:s,addressType:o.TrxAccountType.Eoa,scope:o.TrxScope.Mainnet}),this.config.createAccounts.timeoutMs);return(0,i.assertIsBip44Account)(n),[n]})},h.NAME=s.TRX_ACCOUNT_PROVIDER_NAME,h.TRX_SNAP_ID="npm:@metamask/tron-wallet-snap"}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/providers/TrxAccountProvider.cjs"}],[2613,{"./AccountProviderWrapper.cjs":2606,"./BaseBip44AccountProvider.cjs":2607,"./BtcAccountProvider.cjs":2608,"./EvmAccountProvider.cjs":2609,"./SnapAccountProvider.cjs":2610,"./SolAccountProvider.cjs":2611,"./TrxAccountProvider.cjs":2612,"./utils.cjs":2614},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){n===undefined&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){n===undefined&&(n=s),e[n]=t[s]}),a=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||n(t,e,s)};Object.defineProperty(s,"__esModule",{value:!0}),s.TimeoutError=void 0,a(e("./BaseBip44AccountProvider.cjs"),s),a(e("./SnapAccountProvider.cjs"),s),a(e("./AccountProviderWrapper.cjs"),s);var r=e("./utils.cjs");Object.defineProperty(s,"TimeoutError",{enumerable:!0,get:function(){return r.TimeoutError}}),a(e("./SolAccountProvider.cjs"),s),a(e("./EvmAccountProvider.cjs"),s),a(e("./BtcAccountProvider.cjs"),s),a(e("./TrxAccountProvider.cjs"),s)}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/providers/index.cjs"}],[2614,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.withTimeout=s.withRetry=s.TimeoutError=void 0;class n extends Error{constructor(e){super(e),this.name="TimeoutError"}}s.TimeoutError=n,s.withRetry=async function(e,{maxAttempts:t=3,backOffMs:s=500}={}){let n,a=s;for(let s=1;s<=t;s++)try{return await e()}catch(e){if(n=e,s>=t)break;const r=a;await new Promise(e=>setTimeout(e,r)),a*=2}throw n},s.withTimeout=async function(e,t=500){let s;try{return await Promise.race([e,new Promise((e,a)=>{s=setTimeout(()=>a(new n("Timed out")),t)})])}finally{s&&clearTimeout(s)}}}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/providers/utils.cjs"}],[2615,{"../logger.cjs":2605,"@metamask/utils":3554,lodash:5239},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n,a,r,i,o,c=this&&this.__classPrivateFieldSet||function(e,t,s,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?a.call(e,s):a?a.value=s:t.set(e,s),s},l=this&&this.__classPrivateFieldGet||function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)};Object.defineProperty(s,"__esModule",{value:!0}),s.SnapPlatformWatcher=void 0;const u=e("@metamask/utils"),d=e("lodash"),p=e("../logger.cjs");s.SnapPlatformWatcher=class{constructor(e){n.add(this),a.set(this,void 0),r.set(this,void 0),i.set(this,void 0),c(this,a,e,"f"),c(this,i,!1,"f"),c(this,r,(0,u.createDeferredPromise)(),"f"),l(this,n,"m",o).call(this)}get isReady(){return l(this,i,"f")}async ensureCanUseSnapPlatform(){if(await l(this,r,"f").promise,!l(this,i,"f"))throw new Error("Snap platform cannot be used now.")}},a=new WeakMap,r=new WeakMap,i=new WeakMap,n=new WeakSet,o=function(){const e=(0,d.once)(()=>(0,p.projectLogger)("Snap platform is ready!"));l(this,a,"f").call("SnapController:getState").isReady&&(c(this,i,!0,"f"),l(this,r,"f").resolve()),l(this,a,"f").subscribe("SnapController:stateChange",t=>{c(this,i,t,"f"),t&&(e(),l(this,r,"f").resolve())},e=>e.isReady)}}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/snaps/SnapPlatformWatcher.cjs"}],[2616,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.createSentryError=s.toRejectedErrorMessage=void 0;s.toRejectedErrorMessage=(e,t)=>{let s=`${e}:`;for(const e of t)"rejected"===e.status&&(s+=`\n- ${e.reason}`);return s};s.createSentryError=(e,t,s)=>{const n=new Error(e);return n.cause=t,n.context=s,n}}}},{package:"@metamask/multichain-account-service",file:"node_modules/@metamask/multichain-account-service/dist/utils.cjs"}],[2617,{"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.snapOwnsAccount=s.createChainIdList=s.createAccountList=void 0;const n=e("@metamask/utils");s.createAccountList=function(e,t){return t.map(t=>`${t}:${e}`)},s.createChainIdList=function(e,t){return t&&0!==t.length?e.reduce((e,s)=>{if("eip155:0"===s){const s=t.filter(e=>{const{namespace:t}=(0,n.parseCaipChainId)(e);return t===n.KnownCaipNamespace.Eip155});e.push(...s)}else t.includes(s)&&e.push(s);return e},[]):e},s.snapOwnsAccount=function(e,t){var s;return(null===(s=t.metadata.snap)||void 0===s?void 0:s.id)===e}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/account.cjs"}],[2618,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.isEqual=void 0,s.isEqual=function(e,t){return e.length===t.length&&e.every((e,s)=>e===t[s])}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/array.cjs"}],[2619,{"./base64.cjs":2620,"./constants.cjs":2624,"@metamask/snaps-sdk":3265,"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.validateAuxiliaryFiles=s.encodeAuxiliaryFile=void 0;const n=e("@metamask/snaps-sdk"),a=e("@metamask/utils"),r=e("./base64.cjs"),i=e("./constants.cjs");s.encodeAuxiliaryFile=async function(e,t){if(t===n.AuxiliaryFileEncoding.Base64)return e;const s=await(0,r.decodeBase64)(e);return t===n.AuxiliaryFileEncoding.Utf8?(0,a.bytesToString)(s):(0,a.bytesToHex)(s)},s.validateAuxiliaryFiles=function(e){for(const t of e)(0,a.assert)(t.size<i.MAX_FILE_SIZE,"Static files required by the Snap must be smaller than 64 MB.")}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/auxiliary-files.cjs"}],[262,{"./AbstractPetnamesBridge":260,"@metamask/name-controller":2739,"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.AddressBookPetnamesBridge=void 0;var n=e("@metamask/name-controller"),a=e("@metamask/utils"),r=e("./AbstractPetnamesBridge");function i(e,t,s){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,s)}function o(e,t){return e.get(c(e,t))}function c(e,t,s){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:s;throw new TypeError("Private element is not present on this object")}var l=new WeakMap;class u extends r.AbstractPetnamesBridge{constructor({addressBookController:e,nameController:t,messenger:s}){var n,a,r;super({isTwoWay:!0,nameController:t,messenger:s}),i(this,l,void 0),a=this,r=e,(n=l).set(c(n,a),r)}getSourceEntries(){const e=[],{state:t}=o(l,this);for(const s of Object.keys(t.addressBook)){if(!(0,a.isStrictHexString)(s))continue;const r=t.addressBook[s];for(const a of Object.keys(r)){const r=t.addressBook[s][a],i=s.toLowerCase(),{name:o,isEns:c}=r;null!=o&&o.length&&null!=a&&a.length&&e.push({value:a,name:o,variation:i,type:n.NameType.ETHEREUM_ADDRESS,sourceId:c?"ens":undefined,origin:n.NameOrigin.ADDRESS_BOOK})}}return e}updateSourceEntry(e,t){e===r.ChangeType.DELETED?o(l,this).delete(t.variation,t.value):o(l,this).set(t.value,t.name,t.variation)}onSourceChange(e){this.messenger.subscribe("AddressBookController:stateChange",e)}}s.AddressBookPetnamesBridge=u}}},{package:"$root$",file:"app/scripts/lib/AddressBookPetnamesBridge.ts"}],[2620,{"./bytes.cjs":2621,"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.decodeBase64=s.encodeBase64=void 0;const n=e("@metamask/utils"),a=e("./bytes.cjs");s.encodeBase64=async function(e){const t=(0,a.getBytes)(e),s="undefined"!=typeof navigator&&"ReactNative"===navigator.product;return"FileReader"in globalThis&&!s?await new Promise((e,s)=>{const n=Object.assign(new FileReader,{onload:()=>e(n.result.replace("data:application/octet-stream;base64,","")),onerror:()=>s(n.error)});n.readAsDataURL(new File([t],"",{type:"application/octet-stream"}))}):(0,n.bytesToBase64)(t)},s.decodeBase64=async function(e){const t=await fetch(`data:application/octet-stream;base64,${e}`);return new Uint8Array(await t.arrayBuffer())}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/base64.cjs"}],[2621,{"./virtual-file/VirtualFile.cjs":2664,"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.getBytes=void 0;const n=e("@metamask/utils"),a=e("./virtual-file/VirtualFile.cjs");s.getBytes=function(e){const t=e instanceof a.VirtualFile?e.value:e;return"string"==typeof t?(0,n.stringToBytes)(t):t}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/bytes.cjs"}],[2622,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n;Object.defineProperty(s,"__esModule",{value:!0}),s.SnapCaveatType=void 0,function(e){e.PermittedDerivationPaths="permittedDerivationPaths",e.PermittedCoinTypes="permittedCoinTypes",e.SnapCronjob="snapCronjob",e.TransactionOrigin="transactionOrigin",e.SignatureOrigin="signatureOrigin",e.RpcOrigin="rpcOrigin",e.KeyringOrigin="keyringOrigin",e.SnapIds="snapIds",e.ChainIds="chainIds",e.LookupMatchers="lookupMatchers",e.MaxRequestTime="maxRequestTime",e.ProtocolSnapScopes="protocolSnapScopes"}(n||(s.SnapCaveatType=n={}))}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/caveats.cjs"}],[2623,{"./bytes.cjs":2621,"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.checksumFiles=s.checksum=void 0;const n=e("@metamask/utils"),a=e("./bytes.cjs");async function r(e){return await(0,n.sha256)((0,a.getBytes)(e))}s.checksum=r,s.checksumFiles=async function(e){const t=await Promise.all([...e].sort((e,t)=>((0,n.assert)(e.path!==t.path,"Tried to sort files with non-unique paths."),e.path<t.path?-1:1)).map(async e=>r(e)));return r((0,n.concatBytes)(t))}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/checksum.cjs"}],[2624,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.MAX_FILE_SIZE=void 0,s.MAX_FILE_SIZE=64e6}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/constants.cjs"}],[2625,{"./time.cjs":2658,"@metamask/snaps-sdk":3265,"@metamask/superstruct":3415,"@metamask/utils":3554,"cron-parser":4579},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.isCronjobSpecificationArray=s.CronjobSpecificationArrayStruct=s.isCronjobSpecification=s.CronjobSpecificationStruct=s.CronExpressionStruct=s.CronjobRpcRequestStruct=void 0;const n=e("@metamask/snaps-sdk"),a=e("@metamask/superstruct"),r=e("@metamask/utils"),i=e("cron-parser"),o=e("./time.cjs");s.CronjobRpcRequestStruct=(0,a.object)({jsonrpc:(0,a.optional)(r.JsonRpcVersionStruct),id:(0,a.optional)(r.JsonRpcIdStruct),method:(0,a.string)(),params:(0,a.optional)(r.JsonRpcParamsStruct)}),s.CronExpressionStruct=(0,a.refine)((0,a.string)(),"cronjob expression",e=>{try{return(0,i.parseExpression)(e),!0}catch{return`Expected a cronjob expression, but received: "${e}"`}});const c=(0,a.object)({expression:s.CronExpressionStruct,request:s.CronjobRpcRequestStruct}),l=(0,a.object)({duration:o.ISO8601DurationStruct,request:s.CronjobRpcRequestStruct});s.CronjobSpecificationStruct=(0,n.selectiveUnion)(e=>(0,r.isObject)(e)&&(0,r.hasProperty)(e,"duration")?l:c),s.isCronjobSpecification=function(e){try{return(0,a.create)(e,s.CronjobSpecificationStruct),!0}catch{return!1}},s.CronjobSpecificationArrayStruct=(0,a.array)(s.CronjobSpecificationStruct),s.isCronjobSpecificationArray=function(e){try{return(0,a.create)(e,s.CronjobSpecificationArrayStruct),!0}catch{return!1}}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/cronjob.cjs"}],[2626,{"@metamask/superstruct":3415},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.currency=void 0;const n=e("@metamask/superstruct");s.currency=function(e){const t=e.toLowerCase();return(0,n.coerce)((0,n.literal)(t),(0,n.literal)(e.toUpperCase()),e=>(0,n.create)(e.toLowerCase(),(0,n.literal)(t)))}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/currency.cjs"}],[2627,{rfdc:5710},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(s,"__esModule",{value:!0}),s.deepClone=void 0;const a=n(e("rfdc"));s.deepClone=(0,a.default)({proto:!1,circles:!1})}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/deep-clone.cjs"}],[2628,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.DEFAULT_ENDOWMENTS=void 0,s.DEFAULT_ENDOWMENTS=Object.freeze(["atob","btoa","BigInt","console","crypto","Date","Math","setTimeout","clearTimeout","SubtleCrypto","TextDecoder","TextEncoder","URL","URLSearchParams","setInterval","clearInterval","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","isSecureContext","Intl","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array","DataView","ArrayBuffer","AbortController","AbortSignal"])}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/default-endowments.cjs"}],[2629,{"./array.cjs":2618,"@metamask/slip44":3066},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(s,"__esModule",{value:!0}),s.getSlip44ProtocolName=s.getSnapDerivationPathName=s.SNAPS_DERIVATION_PATHS=void 0;const a=n(e("@metamask/slip44")),r=e("./array.cjs");function i(e){var t;return"1"===String(e)?"Test Networks":(null===(t=a.default[e])||void 0===t?void 0:t.name)??null}s.SNAPS_DERIVATION_PATHS=[{path:["m","44'","0'"],curve:"ed25519",name:"Test BIP-32 Path (ed25519)"},{path:["m","44'","1'"],curve:"secp256k1",name:"Testnet"},{path:["m","44'","0'"],curve:"secp256k1",name:"Bitcoin Legacy"},{path:["m","49'","0'"],curve:"secp256k1",name:"Bitcoin Nested SegWit"},{path:["m","49'","1'"],curve:"secp256k1",name:"Bitcoin Testnet Nested SegWit"},{path:["m","84'","0'"],curve:"secp256k1",name:"Bitcoin Native SegWit"},{path:["m","84'","1'"],curve:"secp256k1",name:"Bitcoin Testnet Native SegWit"},{path:["m","86'","0'"],curve:"secp256k1",name:"Bitcoin Taproot"},{path:["m","86'","1'"],curve:"secp256k1",name:"Bitcoin Testnet Taproot"},{path:["m","44'","501'"],curve:"ed25519",name:"Solana"},{path:["m","44'","501'","0'","0'"],curve:"ed25519",name:"Solana"},{path:["m","44'","2'"],curve:"secp256k1",name:"Litecoin"},{path:["m","44'","3'"],curve:"secp256k1",name:"Dogecoin"},{path:["m","44'","60'"],curve:"secp256k1",name:"Ethereum"},{path:["m","44'","118'"],curve:"secp256k1",name:"Atom"},{path:["m","44'","145'"],curve:"secp256k1",name:"Bitcoin Cash"},{path:["m","44'","637'"],curve:"ed25519",name:"Aptos"},{path:["m","44'","714'"],curve:"secp256k1",name:"Binance (BNB)"},{path:["m","44'","784'"],curve:"ed25519",name:"Sui"},{path:["m","44'","931'"],curve:"secp256k1",name:"THORChain (RUNE)"},{path:["m","44'","330'"],curve:"secp256k1",name:"Terra (LUNA)"},{path:["m","44'","459'"],curve:"secp256k1",name:"Kava"},{path:["m","44'","529'"],curve:"secp256k1",name:"Secret Network"},{path:["m","44'","397'","0'"],curve:"ed25519",name:"NEAR Protocol"},{path:["m","44'","1'","0'"],curve:"ed25519",name:"Testnet"},{path:["m","44'","472'"],curve:"ed25519",name:"Arweave"},{path:["m","44'","12586'"],curve:"secp256k1",name:"Mina"},{path:["m","44'","242'"],curve:"ed25519",name:"Nimiq"},{path:["m","44'","1729'","0'","0'"],curve:"ed25519",name:"Tezos"},{path:["m","1789'","0'"],curve:"ed25519",name:"Vega"},{path:["m","1852'","1815'"],curve:"ed25519Bip32",name:"Cardano"},{path:["m","44'","508'","0'","0'","0'"],curve:"ed25519",name:"MultiversX"},{path:["m","44'","709'"],curve:"secp256k1",name:"Avail"},{path:["m","44'","626'"],curve:"ed25519",name:"Kadena"},{path:["m","44'","632'"],curve:"ed25519",name:"Massa"},{path:["m","44'","4218'"],curve:"ed25519",name:"IOTA"}],s.getSnapDerivationPathName=function(e,t){const n=s.SNAPS_DERIVATION_PATHS.find(s=>s.curve===t&&(0,r.isEqual)(s.path,e));if(n)return n.name;if("secp256k1"===t&&"m"===e[0]&&"44'"===e[1]&&e[2].endsWith("'")){return i(e[2].slice(0,-1))??null}return null},s.getSlip44ProtocolName=i}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/derivation-paths.cjs"}],[263,{"@metamask/base-controller":1520,"@metamask/obs-store":2840},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var n=e("@metamask/obs-store"),a=e("@metamask/base-controller");function r(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function i(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function o(e,t,s){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:s;throw new TypeError("Private element is not present on this object")}function c(e,t){return(0,a.deriveStateFromMetadata)(e,t,"persist")}var l=new WeakSet;class u extends n.ObservableStore{constructor({config:e,controllerMessenger:t,state:s,persist:n}){super(s),r(this,l),i(this,"config",{}),this.persist=n,this.controllerMessenger=t,e&&this.updateStructure(e)}updateStructure(e){this.config=e,this.removeAllListeners();const t={};for(const n of Object.keys(e)){var s;if(!e[n])throw new Error(`Undefined '${n}'`);const a=e[n];a.subscribe?e[n].subscribe(e=>{o(l,this,d).call(this,n,e)}):this.persist?this.controllerMessenger.subscribe(`${a.name}:stateChange`,(t,s)=>{o(l,this,p).call(this,e[n].metadata,s)&&o(l,this,d).call(this,n,c(t,e[n].metadata),s)}):this.controllerMessenger.subscribe(`${a.name}:stateChange`,(e,t)=>o(l,this,d).call(this,n,e,t));const r=a.state??(null===(s=a.getState)||void 0===s?void 0:s.call(a));t[n]=this.persist&&e[n].metadata?c(r,e[n].metadata):r}this.updateState(t)}getFlatState(){if(!this.config)return{};const e={};for(const t of Object.keys(this.config)){const s=this.config[t],n=s.getState?s.getState():s.state;Object.assign(e,n)}return e}}function d(e,t,s){const n=this.getState()[e];this.updateState({[e]:t}),this.emit("stateChange",{controllerKey:e,newState:t,oldState:n,patches:s})}function p(e,t){return t.some(t=>{if(0===t.path.length)return!0;const s=t.path[0];return!e[s]||e[s].persist})}s.default=u}}},{package:"$root$",file:"app/scripts/lib/ComposableObservableStore.js"}],[2630,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.STATE_ENCRYPTION_MAGIC_VALUE=s.SIP_6_MAGIC_VALUE=void 0,s.SIP_6_MAGIC_VALUE="1399742832'",s.STATE_ENCRYPTION_MAGIC_VALUE="572232532'"}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/entropy.cjs"}],[2631,{"@metamask/rpc-errors":3026,"@metamask/snaps-sdk":3265,"@metamask/superstruct":3415,"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){function n(e,t,s){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,s)}function a(e,t){return e.get(i(e,t))}function r(e,t,s){return e.set(i(e,t),s),s}function i(e,t,s){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:s;throw new TypeError("Private element is not present on this object")}Object.defineProperty(s,"__esModule",{value:!0}),s.TrackableErrorStruct=s.unwrapError=s.isWrappedSnapError=s.isSerializedSnapError=s.isSnapError=s.WrappedSnapError=s.SNAP_ERROR_WRAPPER_MESSAGE=s.SNAP_ERROR_WRAPPER_CODE=void 0;const o=e("@metamask/rpc-errors"),c=e("@metamask/snaps-sdk"),l=e("@metamask/superstruct"),u=e("@metamask/utils");s.SNAP_ERROR_WRAPPER_CODE=-31001,s.SNAP_ERROR_WRAPPER_MESSAGE="Wrapped Snap Error";var d=new WeakMap,p=new WeakMap,h=new WeakMap;class m extends Error{constructor(e){const t=(0,c.getErrorMessage)(e);super(t),n(this,d,void 0),n(this,p,void 0),n(this,h,void 0),r(d,this,e),r(p,this,t),r(h,this,(0,c.getErrorStack)(e)??undefined)}get name(){return"WrappedSnapError"}get message(){return a(p,this)}get stack(){return a(h,this)}toJSON(){const e=g(a(d,this))?a(d,this).serialize():(0,o.serializeCause)(a(d,this));return{code:s.SNAP_ERROR_WRAPPER_CODE,message:s.SNAP_ERROR_WRAPPER_MESSAGE,data:{cause:e}}}serialize(){return this.toJSON()}}function g(e){if((0,u.isObject)(e)&&"serialize"in e&&"function"==typeof e.serialize){const t=e.serialize();return(0,u.isJsonRpcError)(t)&&f(t)}return!1}function f(e){return e.code===c.SNAP_ERROR_CODE&&e.message===c.SNAP_ERROR_MESSAGE}function w(e){return(0,u.isJsonRpcError)(e)&&e.code===s.SNAP_ERROR_WRAPPER_CODE&&e.message===s.SNAP_ERROR_WRAPPER_MESSAGE}function v(e,t,s,n){const a=new o.JsonRpcError(e,t,n);return a.stack=s??undefined,a}s.WrappedSnapError=m,s.isSnapError=g,s.isSerializedSnapError=f,s.isWrappedSnapError=w,s.unwrapError=function(e){if(w(e)){if((0,u.isJsonRpcError)(e.data.cause)){if(f(e.data.cause)){const{code:t,message:s,stack:n,data:a}=e.data.cause.data.cause;return[v(t,s,n,a),!0]}if((0,u.isObject)(e.data.cause.data)&&(0,u.isObject)(e.data.cause.data.cause)&&e.data.cause.message===e.data.cause.data.cause.message){const t=e.data.cause.data.cause,{code:s,message:n}=e.data.cause;return[v(s,n,(0,c.getErrorStack)(t)),!1]}const{code:t,message:s,stack:n,data:a}=e.data.cause;return[v(t,s,n,a),!1]}return[v(o.errorCodes.rpc.internal,(0,c.getErrorMessage)(e.data.cause),(0,c.getErrorStack)(e.data.cause)),!1]}if((0,u.isJsonRpcError)(e)){const{code:t,message:s,stack:n,data:a}=e;return[v(t,s,n,a),!1]}return[v(o.errorCodes.rpc.internal,(0,c.getErrorMessage)(e),(0,c.getErrorStack)(e)),!1]},s.TrackableErrorStruct=(0,l.object)({name:(0,l.string)(),message:(0,l.string)(),stack:(0,l.nullable)((0,l.string)()),cause:(0,l.nullable)((0,l.lazy)(()=>s.TrackableErrorStruct))})}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/errors.cjs"}],[2632,{"../time.cjs":2658,"@metamask/snaps-sdk":3265,"@metamask/superstruct":3415},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.OnAssetHistoricalPriceResponseStruct=s.AssetHistoricalPriceStruct=s.HistoricalPriceStruct=void 0;const n=e("@metamask/snaps-sdk"),a=e("@metamask/superstruct"),r=e("../time.cjs");s.HistoricalPriceStruct=(0,n.nonEmptyRecord)((0,a.union)([(0,a.literal)("all"),r.ISO8601DurationStruct]),(0,a.array)((0,a.tuple)([(0,a.number)(),(0,a.string)()]))),s.AssetHistoricalPriceStruct=(0,a.nullable)((0,a.object)({intervals:s.HistoricalPriceStruct,updateTime:(0,a.number)(),expirationTime:(0,a.optional)((0,a.number)())})),s.OnAssetHistoricalPriceResponseStruct=(0,a.object)({historicalPrice:s.AssetHistoricalPriceStruct})}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/handlers/asset-historical-price.cjs"}],[2633,{"@metamask/superstruct":3415,"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.OnAssetsConversionResponseStruct=s.AssetConversionStruct=void 0;const n=e("@metamask/superstruct"),a=e("@metamask/utils");s.AssetConversionStruct=(0,n.object)({rate:(0,n.string)(),conversionTime:(0,n.number)(),expirationTime:(0,n.optional)((0,n.number)())}),s.OnAssetsConversionResponseStruct=(0,n.object)({conversionRates:(0,n.record)(a.CaipAssetTypeStruct,(0,n.record)(a.CaipAssetTypeStruct,(0,n.nullable)(s.AssetConversionStruct)))})}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/handlers/assets-conversion.cjs"}],[2634,{"../time.cjs":2658,"@metamask/snaps-sdk":3265,"@metamask/superstruct":3415,"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.OnAssetsMarketDataResponseStruct=s.AssetMarketDataStruct=s.NonFungibleAssetMarketDataStruct=s.AssetValueStruct=s.FungibleAssetMarketDataStruct=s.PricePercentChangeStruct=void 0;const n=e("@metamask/snaps-sdk"),a=e("@metamask/superstruct"),r=e("@metamask/utils"),i=e("../time.cjs");s.PricePercentChangeStruct=(0,n.nonEmptyRecord)((0,a.union)([(0,a.literal)("all"),i.ISO8601DurationStruct]),(0,a.number)()),s.FungibleAssetMarketDataStruct=(0,a.object)({fungible:(0,a.literal)(!0),marketCap:(0,a.optional)((0,a.string)()),totalVolume:(0,a.optional)((0,a.string)()),circulatingSupply:(0,a.optional)((0,a.string)()),allTimeHigh:(0,a.optional)((0,a.string)()),allTimeLow:(0,a.optional)((0,a.string)()),pricePercentChange:(0,a.optional)(s.PricePercentChangeStruct)}),s.AssetValueStruct=(0,a.object)({asset:r.CaipAssetTypeOrIdStruct,amount:(0,a.string)()}),s.NonFungibleAssetMarketDataStruct=(0,a.object)({fungible:(0,a.literal)(!1),lastSale:(0,a.optional)(s.AssetValueStruct),topBid:(0,a.optional)(s.AssetValueStruct),floorPrice:(0,a.optional)(s.AssetValueStruct),rarity:(0,a.optional)((0,a.object)({ranking:(0,a.optional)((0,a.object)({source:(0,a.string)(),rank:(0,a.number)()})),metadata:(0,a.optional)((0,a.record)((0,a.string)(),(0,a.number)()))}))}),s.AssetMarketDataStruct=(0,n.selectiveUnion)(e=>(0,r.isObject)(e)&&e.fungible?s.FungibleAssetMarketDataStruct:s.NonFungibleAssetMarketDataStruct),s.OnAssetsMarketDataResponseStruct=(0,a.object)({marketData:(0,a.record)(r.CaipAssetTypeOrIdStruct,(0,a.record)(r.CaipAssetTypeStruct,(0,a.nullable)(s.AssetMarketDataStruct)))})}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/handlers/assets-market-data.cjs"}],[2635,{"./types.cjs":2642},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.SNAP_EXPORT_NAMES=s.SNAP_EXPORTS=void 0;const n=e("./types.cjs");s.SNAP_EXPORTS={[n.HandlerType.OnRpcRequest]:{type:n.HandlerType.OnRpcRequest,required:!0,validator:e=>"function"==typeof e},[n.HandlerType.OnTransaction]:{type:n.HandlerType.OnTransaction,required:!0,validator:e=>"function"==typeof e},[n.HandlerType.OnCronjob]:{type:n.HandlerType.OnCronjob,required:!0,validator:e=>"function"==typeof e},[n.HandlerType.OnNameLookup]:{type:n.HandlerType.OnNameLookup,required:!0,validator:e=>"function"==typeof e},[n.HandlerType.OnInstall]:{type:n.HandlerType.OnInstall,required:!1,validator:e=>"function"==typeof e},[n.HandlerType.OnUpdate]:{type:n.HandlerType.OnUpdate,required:!1,validator:e=>"function"==typeof e},[n.HandlerType.OnStart]:{type:n.HandlerType.OnStart,required:!1,validator:e=>"function"==typeof e},[n.HandlerType.OnActive]:{type:n.HandlerType.OnActive,required:!1,validator:e=>"function"==typeof e},[n.HandlerType.OnInactive]:{type:n.HandlerType.OnInactive,required:!1,validator:e=>"function"==typeof e},[n.HandlerType.OnKeyringRequest]:{type:n.HandlerType.OnKeyringRequest,required:!0,validator:e=>"function"==typeof e},[n.HandlerType.OnHomePage]:{type:n.HandlerType.OnHomePage,required:!0,validator:e=>"function"==typeof e},[n.HandlerType.OnSettingsPage]:{type:n.HandlerType.OnSettingsPage,required:!0,validator:e=>"function"==typeof e},[n.HandlerType.OnSignature]:{type:n.HandlerType.OnSignature,required:!0,validator:e=>"function"==typeof e},[n.HandlerType.OnUserInput]:{type:n.HandlerType.OnUserInput,required:!1,validator:e=>"function"==typeof e},[n.HandlerType.OnAssetHistoricalPrice]:{type:n.HandlerType.OnAssetHistoricalPrice,required:!0,validator:e=>"function"==typeof e},[n.HandlerType.OnAssetsLookup]:{type:n.HandlerType.OnAssetsLookup,required:!0,validator:e=>"function"==typeof e},[n.HandlerType.OnAssetsConversion]:{type:n.HandlerType.OnAssetsConversion,required:!0,validator:e=>"function"==typeof e},[n.HandlerType.OnAssetsMarketData]:{type:n.HandlerType.OnAssetsMarketData,required:!0,validator:e=>"function"==typeof e},[n.HandlerType.OnProtocolRequest]:{type:n.HandlerType.OnProtocolRequest,required:!0,validator:e=>"function"==typeof e},[n.HandlerType.OnClientRequest]:{type:n.HandlerType.OnClientRequest,required:!0,validator:e=>"function"==typeof e},[n.HandlerType.OnWebSocketEvent]:{type:n.HandlerType.OnWebSocketEvent,required:!0,validator:e=>"function"==typeof e}},s.SNAP_EXPORT_NAMES=Object.values(n.HandlerType)}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/handlers/exports.cjs"}],[2636,{"@metamask/snaps-sdk":3265,"@metamask/superstruct":3415},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.OnHomePageResponseStruct=s.OnHomePageResponseWithIdStruct=s.OnHomePageResponseWithContentStruct=void 0;const n=e("@metamask/snaps-sdk"),a=e("@metamask/superstruct");s.OnHomePageResponseWithContentStruct=(0,a.object)({content:n.ComponentOrElementStruct}),s.OnHomePageResponseWithIdStruct=(0,a.object)({id:(0,a.string)()}),s.OnHomePageResponseStruct=(0,a.union)([s.OnHomePageResponseWithContentStruct,s.OnHomePageResponseWithIdStruct])}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/handlers/home-page.cjs"}],[2637,{"./asset-historical-price.cjs":2632,"./assets-conversion.cjs":2633,"./assets-market-data.cjs":2634,"./exports.cjs":2635,"./home-page.cjs":2636,"./name-lookup.cjs":2638,"./settings-page.cjs":2639,"./signature.cjs":2640,"./transaction.cjs":2641,"./types.cjs":2642},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n=Object.create?function(e,t,s,n){n===undefined&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){n===undefined&&(n=s),e[n]=t[s]},a=function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||n(t,e,s)};Object.defineProperty(s,"__esModule",{value:!0}),a(e("./asset-historical-price.cjs"),s),a(e("./assets-conversion.cjs"),s),a(e("./assets-market-data.cjs"),s),a(e("./exports.cjs"),s),a(e("./home-page.cjs"),s),a(e("./name-lookup.cjs"),s),a(e("./settings-page.cjs"),s),a(e("./signature.cjs"),s),a(e("./transaction.cjs"),s),a(e("./types.cjs"),s)}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/handlers/index.cjs"}],[2638,{"@metamask/superstruct":3415},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.OnNameLookupResponseStruct=s.DomainResolutionResponseStruct=s.AddressResolutionResponseStruct=s.DomainResolutionStruct=s.AddressResolutionStruct=void 0;const n=e("@metamask/superstruct");s.AddressResolutionStruct=(0,n.object)({protocol:(0,n.string)(),resolvedDomain:(0,n.string)()}),s.DomainResolutionStruct=(0,n.object)({protocol:(0,n.string)(),resolvedAddress:(0,n.string)(),domainName:(0,n.string)()}),s.AddressResolutionResponseStruct=(0,n.object)({resolvedDomains:(0,n.size)((0,n.array)(s.AddressResolutionStruct),1,Infinity)}),s.DomainResolutionResponseStruct=(0,n.object)({resolvedAddresses:(0,n.size)((0,n.array)(s.DomainResolutionStruct),1,Infinity)}),s.OnNameLookupResponseStruct=(0,n.nullable)((0,n.union)([s.AddressResolutionResponseStruct,s.DomainResolutionResponseStruct]))}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/handlers/name-lookup.cjs"}],[2639,{"./home-page.cjs":2636},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.OnSettingsPageResponseStruct=void 0;const n=e("./home-page.cjs");s.OnSettingsPageResponseStruct=n.OnHomePageResponseStruct}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/handlers/settings-page.cjs"}],[264,{"webextension-polyfill":6163},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.CronjobControllerStorageManager=s.CronjobControllerStorageKey=void 0;var n,a=(n=e("webextension-polyfill"))&&n.__esModule?n:{default:n};function r(e,t,s){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,s)}function i(e,t){return e.get(c(e,t))}function o(e,t,s){return e.set(c(e,t),s),s}function c(e,t,s){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:s;throw new TypeError("Private element is not present on this object")}const l=s.CronjobControllerStorageKey="temp-cronjob-storage";var u=new WeakMap,d=new WeakMap;s.CronjobControllerStorageManager=class{constructor(){r(this,u,null),r(this,d,!1)}async init(){o(u,this,(await a.default.storage.local.get(l))[l]),o(d,this,!0)}getInitialState(){if(!i(d,this))throw new Error("CronjobControllerStorageManager not yet initialized");return i(u,this)}set(e){if(!i(d,this))throw new Error("CronjobControllerStorageManager not yet initialized");a.default.storage.local.set({[l]:e}).catch(console.error)}}}}},{package:"$root$",file:"app/scripts/lib/CronjobControllerStorageManager.ts"}],[2640,{"./transaction.cjs":2641},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.OnSignatureResponseStruct=void 0;const n=e("./transaction.cjs");s.OnSignatureResponseStruct=n.OnTransactionResponseStruct}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/handlers/signature.cjs"}],[2641,{"@metamask/snaps-sdk":3265,"@metamask/superstruct":3415},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.OnTransactionResponseStruct=s.OnTransactionResponseWithContentStruct=s.OnTransactionResponseWithIdStruct=s.OnTransactionSeverityResponseStruct=void 0;const n=e("@metamask/snaps-sdk"),a=e("@metamask/superstruct");s.OnTransactionSeverityResponseStruct=(0,a.object)({severity:(0,a.optional)((0,a.literal)(n.SeverityLevel.Critical))}),s.OnTransactionResponseWithIdStruct=(0,a.assign)(s.OnTransactionSeverityResponseStruct,(0,a.object)({id:(0,a.string)()})),s.OnTransactionResponseWithContentStruct=(0,a.assign)(s.OnTransactionSeverityResponseStruct,(0,a.object)({content:n.ComponentOrElementStruct})),s.OnTransactionResponseStruct=(0,a.nullable)((0,a.union)([s.OnTransactionResponseWithContentStruct,s.OnTransactionResponseWithIdStruct]))}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/handlers/transaction.cjs"}],[2642,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n;Object.defineProperty(s,"__esModule",{value:!0}),s.HandlerType=void 0,function(e){e.OnRpcRequest="onRpcRequest",e.OnSignature="onSignature",e.OnTransaction="onTransaction",e.OnCronjob="onCronjob",e.OnInstall="onInstall",e.OnUpdate="onUpdate",e.OnStart="onStart",e.OnActive="onActive",e.OnInactive="onInactive",e.OnNameLookup="onNameLookup",e.OnKeyringRequest="onKeyringRequest",e.OnHomePage="onHomePage",e.OnSettingsPage="onSettingsPage",e.OnUserInput="onUserInput",e.OnAssetsLookup="onAssetsLookup",e.OnAssetsConversion="onAssetsConversion",e.OnAssetHistoricalPrice="onAssetHistoricalPrice",e.OnAssetsMarketData="onAssetsMarketData",e.OnProtocolRequest="onProtocolRequest",e.OnClientRequest="onClientRequest",e.OnWebSocketEvent="onWebSocketEvent"}(n||(s.HandlerType=n={}))}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/handlers/types.cjs"}],[2643,{"./svg.cjs":2657,"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.getSvgDimensions=s.assertIsSnapIcon=s.SVG_MAX_BYTE_SIZE_TEXT=s.SVG_MAX_BYTE_SIZE=void 0;const n=e("@metamask/utils"),a=e("./svg.cjs");s.SVG_MAX_BYTE_SIZE=1e5,s.SVG_MAX_BYTE_SIZE_TEXT=`${Math.floor(s.SVG_MAX_BYTE_SIZE/1e3)}kb`,s.assertIsSnapIcon=function(e){(0,n.assert)(e.path.endsWith(".svg"),'Expected snap icon to end in ".svg".');const t="string"==typeof e.value?(0,n.stringToBytes)(e.value).byteLength:e.value.byteLength;(0,n.assert)(t<=s.SVG_MAX_BYTE_SIZE,`The specified SVG icon exceeds the maximum size of ${s.SVG_MAX_BYTE_SIZE_TEXT}.`),(0,n.assert)((0,a.isSvg)(e.toString()),"Snap icon must be a valid SVG.")},s.getSvgDimensions=function(e){try{const t=(0,a.parseSvg)(e),s=t["@_height"],r=t["@_width"];if(s&&r)return{height:s,width:r};const i=t["@_viewBox"];if(i){const[e,t,s,a]=i.split(" ");if(s&&a){const e=parseInt(s,10),t=parseInt(a,10);return(0,n.assert)(Number.isInteger(e)&&e>0),(0,n.assert)(Number.isInteger(t)&&t>0),{width:e,height:t}}}}catch{throw new Error("Snap icon must be a valid SVG.")}return null}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/icon.cjs"}],[2644,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.createWindow=void 0,s.createWindow=async function({uri:e,id:t,sandbox:s=!0,testId:n="snaps-iframe"}){return await new Promise((a,r)=>{const i=document.createElement("iframe");i.setAttribute("id",t),i.setAttribute("data-testid",n),s&&i.setAttribute("sandbox","allow-scripts"),i.setAttribute("src",e),document.body.appendChild(i),i.addEventListener("load",()=>{i.contentWindow?a(i.contentWindow):r(new Error(`iframe.contentWindow not present on load for job "${t}".`))},{once:!0})})}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/iframe.cjs"}],[2645,{"./account.cjs":2617,"./array.cjs":2618,"./auxiliary-files.cjs":2619,"./base64.cjs":2620,"./bytes.cjs":2621,"./caveats.cjs":2622,"./checksum.cjs":2623,"./constants.cjs":2624,"./cronjob.cjs":2625,"./currency.cjs":2626,"./deep-clone.cjs":2627,"./default-endowments.cjs":2628,"./derivation-paths.cjs":2629,"./entropy.cjs":2630,"./errors.cjs":2631,"./handlers/index.cjs":2637,"./iframe.cjs":2644,"./json-rpc.cjs":2646,"./json.cjs":2647,"./localization.cjs":2648,"./logging.cjs":2649,"./manifest/index.cjs":2650,"./path.cjs":2652,"./platform-version.cjs":2653,"./snaps.cjs":2654,"./strings.cjs":2655,"./structs.cjs":2656,"./time.cjs":2658,"./types.cjs":2659,"./ui.cjs":2660,"./url.cjs":2661,"./validation.cjs":2662,"./versions.cjs":2663,"./virtual-file/index.cjs":2665},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n=Object.create?function(e,t,s,n){n===undefined&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){n===undefined&&(n=s),e[n]=t[s]},a=function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||n(t,e,s)};Object.defineProperty(s,"__esModule",{value:!0}),a(e("./account.cjs"),s),a(e("./array.cjs"),s),a(e("./auxiliary-files.cjs"),s),a(e("./base64.cjs"),s),a(e("./bytes.cjs"),s),a(e("./caveats.cjs"),s),a(e("./checksum.cjs"),s),a(e("./constants.cjs"),s),a(e("./cronjob.cjs"),s),a(e("./currency.cjs"),s),a(e("./deep-clone.cjs"),s),a(e("./default-endowments.cjs"),s),a(e("./derivation-paths.cjs"),s),a(e("./entropy.cjs"),s),a(e("./errors.cjs"),s),a(e("./handlers/index.cjs"),s),a(e("./iframe.cjs"),s),a(e("./json.cjs"),s),a(e("./json-rpc.cjs"),s),a(e("./localization.cjs"),s),a(e("./logging.cjs"),s),a(e("./manifest/index.cjs"),s),a(e("./path.cjs"),s),a(e("./platform-version.cjs"),s),a(e("./snaps.cjs"),s),a(e("./strings.cjs"),s),a(e("./structs.cjs"),s),a(e("./time.cjs"),s),a(e("./types.cjs"),s),a(e("./ui.cjs"),s),a(e("./url.cjs"),s),a(e("./validation.cjs"),s),a(e("./versions.cjs"),s),a(e("./virtual-file/index.cjs"),s)}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/index.cjs"}],[2646,{"@metamask/permission-controller":2862,"@metamask/superstruct":3415,"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.assertIsJsonRpcSuccess=s.isOriginAllowed=s.assertIsKeyringOrigins=s.KeyringOriginsStruct=s.assertIsRpcOrigins=s.RpcOriginsStruct=void 0;const n=e("@metamask/permission-controller"),a=e("@metamask/superstruct"),r=e("@metamask/utils"),i=(0,a.array)((0,a.refine)((0,a.string)(),"Allowed origin",e=>!(e.split("*").length-1>2)||'No more than two wildcards ("*") are allowed in an origin specifier.'));function o(e,t){if("*"===e||e===t)return!0;const s=function(e){const t=e.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&").replace(/\\\*/gu,".*");return RegExp(`^${t}$`,"u")}(e);return s.test(t)}s.RpcOriginsStruct=(0,a.refine)((0,a.object)({dapps:(0,a.optional)((0,a.boolean)()),snaps:(0,a.optional)((0,a.boolean)()),allowedOrigins:(0,a.optional)(i)}),"RPC origins",e=>!!Boolean(!0===e.snaps||!0===e.dapps||e.allowedOrigins&&e.allowedOrigins.length>0)||"Must specify at least one JSON-RPC origin."),s.assertIsRpcOrigins=function(e,t){(0,r.assertStruct)(e,s.RpcOriginsStruct,"Invalid JSON-RPC origins",t)},s.KeyringOriginsStruct=(0,a.object)({allowedOrigins:(0,a.optional)(i)}),s.assertIsKeyringOrigins=function(e,t){(0,r.assertStruct)(e,s.KeyringOriginsStruct,"Invalid keyring origins",t)},s.isOriginAllowed=function(e,t,s){var a;return"metamask"===s||(!(null===(a=e.allowedOrigins)||void 0===a||!a.some(e=>o(e,s)))||(!(t!==n.SubjectType.Website||!e.dapps)||Boolean(t===n.SubjectType.Snap&&e.snaps)))},s.assertIsJsonRpcSuccess=function(e){if(!(0,r.isJsonRpcSuccess)(e)){if((0,r.isJsonRpcFailure)(e))throw new Error(`JSON-RPC request failed: ${e.error.message}`);throw new Error("Invalid JSON-RPC response.")}}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/json-rpc.cjs"}],[2647,{"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.getJsonSizeUnsafe=s.parseJson=void 0;const n=e("@metamask/utils");s.parseJson=function(e){return(0,n.getSafeJson)(JSON.parse(e))},s.getJsonSizeUnsafe=function(e,t=!1){const s=JSON.stringify(e);return t?(new TextEncoder).encode(s).byteLength:s.length}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/json.cjs"}],[2648,{"./json.cjs":2647,"@metamask/snaps-sdk":3265,"@metamask/superstruct":3415},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.validateSnapManifestLocalizations=s.getLocalizedSnapManifest=s.translate=s.TRANSLATION_REGEX=s.getLocalizationFile=s.getValidatedLocalizationFiles=s.LocalizationFileStruct=s.LOCALIZABLE_FIELDS=void 0;const n=e("@metamask/snaps-sdk"),a=e("@metamask/superstruct"),r=e("./json.cjs");function i(e,t){const s=t.find(t=>t.locale===e);return s||t.find(e=>"en"===e.locale)}function o(e,t){const n=e.matchAll(s.TRANSLATION_REGEX);return Array.from(n).reduce((s,[n,a])=>{if(!t)throw new Error(`Failed to translate "${e}": No localization file found.`);const r=t.messages[a.trim()];if(!r)throw new Error(`Failed to translate "${e}": No translation found for "${a.trim()}" in "${t.locale}" file.`);return s.replace(n,r.message)},e)}function c(e,t,n){const a=i(t,n);return s.LOCALIZABLE_FIELDS.reduce((e,t)=>{const s=o(e[t],a);return{...e,[t]:s}},e)}s.LOCALIZABLE_FIELDS=["description","proposedName"],s.LocalizationFileStruct=(0,a.object)({locale:(0,a.string)(),messages:(0,a.record)((0,a.string)(),(0,a.object)({message:(0,a.string)(),description:(0,a.optional)((0,a.string)())}))}),s.getValidatedLocalizationFiles=function(e){for(const t of e)try{t.result=(0,a.create)((0,r.parseJson)(t.toString()),s.LocalizationFileStruct)}catch(e){if(e instanceof a.StructError)throw new Error(`Failed to validate localization file "${t.path}": ${e.message}.`);if(e instanceof SyntaxError)throw new Error(`Failed to parse localization file "${t.path}" as JSON.`);throw e}return e},s.getLocalizationFile=i,s.TRANSLATION_REGEX=/\{\{\s?([a-zA-Z0-9-_\s]+)\s?\}\}/gu,s.translate=o,s.getLocalizedSnapManifest=c,s.validateSnapManifestLocalizations=function(e,t){try{t.filter(e=>"en"!==e.locale).forEach(s=>{c(e,s.locale,t)}),c(e,"en",t)}catch(e){throw new Error(`Failed to localize Snap manifest: ${(0,n.getErrorMessage)(e)}`)}}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/localization.cjs"}],[2649,{"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.logWarning=s.logError=s.logInfo=s.snapsLogger=void 0;const n=e("@metamask/utils");s.snapsLogger=(0,n.createProjectLogger)("snaps"),s.logInfo=function(e,...t){console.log(e,...t)},s.logError=function(e,...t){console.error(e,...t)},s.logWarning=function(e,...t){console.warn(e,...t)}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/logging.cjs"}],[265,{"./state-utils":352,"@metamask/utils":3554,lodash:5239,uuid:6134},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.PatchStore=void 0;var n=e("@metamask/utils"),a=e("uuid"),r=e("lodash"),i=e("./state-utils");function o(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const c=(0,n.createProjectLogger)("patch-store");s.PatchStore=class{constructor(e){o(this,"id",void 0),o(this,"observableStore",void 0),o(this,"pendingPatches",[]),o(this,"listener",void 0),this.id=(0,a.v4)(),this.observableStore=e,this.listener=this._onStateChange.bind(this),c("Created",this.id)}init(){this.observableStore.on("stateChange",this.listener)}flushPendingPatches(){const e=this.pendingPatches;this.pendingPatches=[];for(const t of e)c("Flushed",t.path.join("."),this.id,t);return e}destroy(){this.observableStore.removeListener("stateChange",this.listener),c("Destroyed",this.id)}_onStateChange({newState:e,oldState:t,patches:s}){let n=[];if(s){const e=this._normalizeEventPatches(s,t);n=(0,i.sanitizePatches)(e??[])}else{const s=(0,i.sanitizeUIState)(e);n=this._generatePatches(t,s)}const a=Boolean(e.vault);if(a&&n.push({op:"replace",path:["isInitialized"],value:a}),n.length)for(const e of n){const t=e.path.join(".");this.pendingPatches.push(e),c("Added",t,this.id,e)}}_generatePatches(e,t){return Object.keys(t).map(s=>{const n=e[s],a=t[s];return n===a?null:{op:"replace",path:[s],value:a}}).filter(Boolean)}_normalizeEventPatches(e,t){return null==e?void 0:e.flatMap(e=>{if(e.path.length>0)return[e];return(0,r.uniq)([...Object.keys(t),...Object.keys(e.value)]).map(t=>({op:t in e.value?"replace":"remove",path:[t],...t in e.value?{value:e.value[t]}:{}}))})}}}}},{package:"$root$",file:"app/scripts/lib/PatchStore.ts"}],[2650,{"./validation.cjs":2651},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n=Object.create?function(e,t,s,n){n===undefined&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){n===undefined&&(n=s),e[n]=t[s]},a=function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||n(t,e,s)};Object.defineProperty(s,"__esModule",{value:!0}),a(e("./validation.cjs"),s)}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/manifest/index.cjs"}],[2651,{"../array.cjs":2618,"../cronjob.cjs":2625,"../entropy.cjs":2630,"../json-rpc.cjs":2646,"../snaps.cjs":2654,"../structs.cjs":2656,"../types.cjs":2659,"@metamask/key-tree":2466,"@metamask/superstruct":3415,"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.createSnapManifest=s.assertIsSnapManifest=s.isSnapManifest=s.SnapManifestStruct=s.InitialConnectionsStruct=s.SnapAuxilaryFilesStruct=s.SnapAuxiliaryFilesStruct=s.PermissionsStruct=s.EmptyObjectStruct=s.HandlerCaveatsStruct=s.ProtocolScopesStruct=s.MaxRequestTimeStruct=s.MAXIMUM_REQUEST_TIMEOUT=s.MINIMUM_REQUEST_TIMEOUT=s.LookupMatchersStruct=s.ChainIdsStruct=s.SnapIdsStruct=s.SemVerRangeStruct=s.SnapGetBip32EntropyPermissionsStruct=s.Bip32EntropyStruct=s.CurveStruct=s.bip32entropy=s.Bip32PathStruct=s.FORBIDDEN_COIN_TYPES=void 0;const n=e("@metamask/key-tree"),a=e("@metamask/superstruct"),r=e("@metamask/utils"),i=e("../array.cjs"),o=e("../cronjob.cjs"),c=e("../entropy.cjs"),l=e("../json-rpc.cjs"),u=e("../snaps.cjs"),d=e("../structs.cjs"),p=e("../types.cjs"),h=[c.SIP_6_MAGIC_VALUE,c.STATE_ENCRYPTION_MAGIC_VALUE];s.FORBIDDEN_COIN_TYPES=[60];const m=s.FORBIDDEN_COIN_TYPES.map(e=>["m","44'",`${e}'`]);s.Bip32PathStruct=(0,a.refine)((0,a.array)((0,a.string)()),"BIP-32 path",e=>0===e.length?"Path must be a non-empty BIP-32 derivation path array":"m"!==e[0]?'Path must start with "m".':e.length<3?"Paths must have a length of at least three.":e.slice(1).some(e=>!(0,n.isValidBIP32PathSegment)(e))?"Path must be a valid BIP-32 derivation path array.":h.includes(e[1])?`The purpose "${e[1]}" is not allowed for entropy derivation.`:!m.some(t=>(0,i.isEqual)(e.slice(0,t.length),t))||`The path "${e.join("/")}" is not allowed for entropy derivation.`);s.bip32entropy=e=>(0,a.refine)(e,"BIP-32 entropy",e=>"ed25519"!==e.curve||!e.path.slice(1).some(e=>!e.endsWith("'"))||"Ed25519 does not support unhardened paths."),s.CurveStruct=(0,a.enums)(["ed25519","secp256k1","ed25519Bip32"]),s.Bip32EntropyStruct=(0,s.bip32entropy)((0,a.type)({path:s.Bip32PathStruct,curve:s.CurveStruct})),s.SnapGetBip32EntropyPermissionsStruct=(0,a.size)((0,a.array)(s.Bip32EntropyStruct),1,Infinity),s.SemVerRangeStruct=(0,a.refine)((0,a.string)(),"SemVer range",e=>!!(0,r.isValidSemVerRange)(e)||"Expected a valid SemVer range."),s.SnapIdsStruct=(0,a.refine)((0,a.record)(u.SnapIdStruct,(0,a.object)({version:(0,a.optional)(s.SemVerRangeStruct)})),"SnapIds",e=>0!==Object.keys(e).length),s.ChainIdsStruct=(0,a.size)((0,a.array)(r.CaipChainIdStruct),1,Infinity),s.LookupMatchersStruct=(0,a.union)([(0,a.object)({tlds:(0,a.size)((0,a.array)((0,a.string)()),1,Infinity)}),(0,a.object)({schemes:(0,a.size)((0,a.array)((0,a.string)()),1,Infinity)}),(0,a.object)({tlds:(0,a.size)((0,a.array)((0,a.string)()),1,Infinity),schemes:(0,a.size)((0,a.array)((0,a.string)()),1,Infinity)})]),s.MINIMUM_REQUEST_TIMEOUT=(0,r.inMilliseconds)(5,r.Duration.Second),s.MAXIMUM_REQUEST_TIMEOUT=(0,r.inMilliseconds)(3,r.Duration.Minute),s.MaxRequestTimeStruct=(0,a.size)((0,a.integer)(),s.MINIMUM_REQUEST_TIMEOUT,s.MAXIMUM_REQUEST_TIMEOUT),s.ProtocolScopesStruct=(0,a.record)(r.CaipChainIdStruct,(0,a.object)({methods:(0,a.array)((0,a.string)())})),s.HandlerCaveatsStruct=(0,a.object)({maxRequestTime:(0,a.optional)(s.MaxRequestTimeStruct)}),s.EmptyObjectStruct=(0,a.object)({}),s.PermissionsStruct=(0,a.type)({"endowment:assets":(0,a.optional)((0,d.mergeStructs)(s.HandlerCaveatsStruct,(0,a.object)({scopes:s.ChainIdsStruct}))),"endowment:cronjob":(0,a.optional)((0,d.mergeStructs)(s.HandlerCaveatsStruct,(0,a.object)({jobs:(0,a.optional)(o.CronjobSpecificationArrayStruct)}))),"endowment:ethereum-provider":(0,a.optional)(s.EmptyObjectStruct),"endowment:keyring":(0,a.optional)((0,d.mergeStructs)(s.HandlerCaveatsStruct,l.KeyringOriginsStruct)),"endowment:protocol":(0,a.optional)((0,d.mergeStructs)(s.HandlerCaveatsStruct,(0,a.object)({scopes:s.ProtocolScopesStruct}))),"endowment:lifecycle-hooks":(0,a.optional)(s.HandlerCaveatsStruct),"endowment:name-lookup":(0,a.optional)((0,d.mergeStructs)(s.HandlerCaveatsStruct,(0,a.object)({chains:(0,a.optional)(s.ChainIdsStruct),matchers:(0,a.optional)(s.LookupMatchersStruct)}))),"endowment:network-access":(0,a.optional)(s.EmptyObjectStruct),"endowment:page-home":(0,a.optional)(s.HandlerCaveatsStruct),"endowment:rpc":(0,a.optional)((0,d.mergeStructs)(s.HandlerCaveatsStruct,l.RpcOriginsStruct)),"endowment:signature-insight":(0,a.optional)((0,d.mergeStructs)(s.HandlerCaveatsStruct,(0,a.object)({allowSignatureOrigin:(0,a.optional)((0,a.boolean)())}))),"endowment:transaction-insight":(0,a.optional)((0,d.mergeStructs)(s.HandlerCaveatsStruct,(0,a.object)({allowTransactionOrigin:(0,a.optional)((0,a.boolean)())}))),"endowment:webassembly":(0,a.optional)(s.EmptyObjectStruct),snap_dialog:(0,a.optional)(s.EmptyObjectStruct),snap_manageState:(0,a.optional)(s.EmptyObjectStruct),snap_manageAccounts:(0,a.optional)(s.EmptyObjectStruct),snap_notify:(0,a.optional)(s.EmptyObjectStruct),snap_getBip32Entropy:(0,a.optional)(s.SnapGetBip32EntropyPermissionsStruct),snap_getBip32PublicKey:(0,a.optional)(s.SnapGetBip32EntropyPermissionsStruct),snap_getBip44Entropy:(0,a.optional)((0,a.size)((0,a.array)((0,a.object)({coinType:(0,a.size)((0,a.integer)(),0,2**32-1)})),1,Infinity)),snap_getEntropy:(0,a.optional)(s.EmptyObjectStruct),snap_getLocale:(0,a.optional)(s.EmptyObjectStruct),wallet_snap:(0,a.optional)(s.SnapIdsStruct)}),s.SnapAuxiliaryFilesStruct=(0,a.array)((0,a.string)()),s.SnapAuxilaryFilesStruct=s.SnapAuxiliaryFilesStruct,s.InitialConnectionsStruct=(0,a.record)((0,a.intersection)([(0,a.string)(),(0,p.uri)()]),(0,a.object)({})),s.SnapManifestStruct=(0,a.object)({version:r.VersionStruct,description:(0,a.size)((0,a.string)(),1,280),proposedName:(0,a.size)((0,a.string)(),1,214),repository:(0,a.optional)((0,a.type)({type:(0,a.size)((0,a.string)(),1,Infinity),url:(0,a.size)((0,a.string)(),1,Infinity)})),source:(0,a.object)({shasum:r.ChecksumStruct,location:(0,a.object)({npm:(0,a.object)({filePath:(0,a.size)((0,a.string)(),1,Infinity),iconPath:(0,a.optional)((0,a.size)((0,a.string)(),1,Infinity)),packageName:p.NameStruct,registry:(0,a.union)([(0,a.literal)("https://registry.npmjs.org"),(0,a.literal)("https://registry.npmjs.org/")])})}),files:(0,a.optional)(s.SnapAuxiliaryFilesStruct),locales:(0,a.optional)(s.SnapAuxiliaryFilesStruct)}),initialConnections:(0,a.optional)(s.InitialConnectionsStruct),initialPermissions:s.PermissionsStruct,manifestVersion:(0,a.literal)("0.1"),platformVersion:(0,a.optional)(r.VersionStruct),$schema:(0,a.optional)((0,a.string)())}),s.isSnapManifest=function(e){return(0,a.is)(e,s.SnapManifestStruct)},s.assertIsSnapManifest=function(e){(0,r.assertStruct)(e,s.SnapManifestStruct,`"${p.NpmSnapFileNames.Manifest}" is invalid`)},s.createSnapManifest=function(e){return(0,a.create)(e,s.SnapManifestStruct)}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/manifest/validation.cjs"}],[2652,{"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.normalizeRelative=void 0;const n=e("@metamask/utils");s.normalizeRelative=function(e){return(0,n.assert)(!e.startsWith("/")),(0,n.assert)(-1===e.search(/:|\/\//u),`Path "${e}" potentially an URI instead of local relative`),e.startsWith("./")?e.slice(2):e}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/path.cjs"}],[2653,{"@metamask/snaps-sdk/package.json":3353},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(s,"__esModule",{value:!0}),s.getPlatformVersion=void 0;const a=n(e("@metamask/snaps-sdk/package.json"));s.getPlatformVersion=function(){return a.default.version}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/platform-version.cjs"}],[2654,{"./caveats.cjs":2622,"./checksum.cjs":2623,"./types.cjs":2659,"@metamask/snaps-sdk":3265,"@metamask/superstruct":3415,"@metamask/utils":3554,"@scure/base":3634,"fast-json-stable-stringify":4789,"validate-npm-package-name":6150},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(s,"__esModule",{value:!0}),s.verifyRequestedSnapPermissions=s.isSnapPermitted=s.assertIsValidSnapId=s.isSnapId=s.stripSnapPrefix=s.getSnapPrefix=s.SnapIdStruct=s.SnapIdPrefixStruct=s.HttpSnapIdStruct=s.NpmSnapIdStruct=s.LocalSnapIdStruct=s.BaseSnapIdStruct=s.LOCALHOST_HOSTNAMES=s.validateSnapShasum=s.getSnapChecksum=s.SnapStatusEvents=s.SnapStatus=s.PROPOSED_NAME_REGEX=void 0;const a=e("@metamask/snaps-sdk"),r=e("@metamask/superstruct"),i=e("@metamask/utils"),o=e("@scure/base"),c=n(e("fast-json-stable-stringify")),l=n(e("validate-npm-package-name")),u=e("./caveats.cjs"),d=e("./checksum.cjs"),p=e("./types.cjs");var h,m;function g(e){const t=e.clone();return delete t.result.source.shasum,t.value=(0,c.default)(t.result),t}async function f(e){const{manifest:t,sourceCode:s,svgIcon:n,auxiliaryFiles:a,localizationFiles:r}=e,i=[g(t),s,n,...a,...r].filter(e=>e!==undefined);return o.base64.encode(await(0,d.checksumFiles)(i))}s.PROPOSED_NAME_REGEX=/^(?:[A-Za-z0-9-_]+( [A-Za-z0-9-_]+)*)|(?:(?:@[A-Za-z0-9-*~][A-Za-z0-9-*._~]*\/)?[A-Za-z0-9-~][A-Za-z0-9-._~]*)$/u,function(e){e.Installing="installing",e.Updating="updating",e.Running="running",e.Stopped="stopped",e.Crashed="crashed"}(h||(s.SnapStatus=h={})),function(e){e.Start="START",e.Stop="STOP",e.Crash="CRASH",e.Update="UPDATE"}(m||(s.SnapStatusEvents=m={})),s.getSnapChecksum=f,s.validateSnapShasum=async function(e,t="Invalid Snap manifest: manifest shasum does not match computed shasum."){if(e.manifest.result.source.shasum!==await f(e))throw new Error(t)},s.LOCALHOST_HOSTNAMES=["localhost","127.0.0.1","[::1]"],s.BaseSnapIdStruct=(0,i.definePattern)("Base Snap Id",/^[\x21-\x7E]*$/u);const w=(0,p.uri)({protocol:(0,r.enums)(["http:","https:"]),hostname:(0,r.enums)(s.LOCALHOST_HOSTNAMES),hash:(0,r.empty)((0,r.string)()),search:(0,r.empty)((0,r.string)())});function v(e){const t=Object.values(p.SnapIdPrefixes).find(t=>e.startsWith(t));if(t!==undefined)return t;throw new Error(`Invalid or no prefix found for "${e}"`)}s.LocalSnapIdStruct=(0,r.refine)(s.BaseSnapIdStruct,"local Snap Id",e=>{if(!e.startsWith(p.SnapIdPrefixes.local))return`Expected local snap ID, got "${e}".`;const[t]=(0,r.validate)(e.slice(p.SnapIdPrefixes.local.length),w);return t??!0}),s.NpmSnapIdStruct=(0,r.intersection)([s.BaseSnapIdStruct,(0,p.uri)({protocol:(0,r.literal)(p.SnapIdPrefixes.npm),pathname:(0,r.refine)((0,r.string)(),"package name",function*(e){const t=e.startsWith("/")?e.slice(1):e,{errors:s,validForNewPackages:n,warnings:a}=(0,l.default)(t);return n||(s===undefined?((0,i.assert)(a!==undefined),yield*a):yield*s),!0}),search:(0,r.empty)((0,r.string)()),hash:(0,r.empty)((0,r.string)())})]),s.HttpSnapIdStruct=(0,r.intersection)([s.BaseSnapIdStruct,(0,p.uri)({protocol:(0,r.enums)(["http:","https:"]),search:(0,r.empty)((0,r.string)()),hash:(0,r.empty)((0,r.string)())})]),s.SnapIdPrefixStruct=(0,r.refine)((0,r.string)(),"Snap ID prefix",e=>{if(Object.values(p.SnapIdPrefixes).some(t=>e.startsWith(t)))return!0;return`Invalid or no prefix found. Expected Snap ID to start with one of: ${Object.values(p.SnapIdPrefixes).map(e=>`"${e}"`).join(", ")}, but received: "${e}"`}),s.SnapIdStruct=(0,a.selectiveUnion)(e=>"string"==typeof e&&e.startsWith(p.SnapIdPrefixes.npm)?s.NpmSnapIdStruct:"string"==typeof e&&e.startsWith(p.SnapIdPrefixes.local)?s.LocalSnapIdStruct:s.SnapIdPrefixStruct),s.getSnapPrefix=v,s.stripSnapPrefix=function(e){return e.replace(v(e),"")},s.isSnapId=function(e){return(0,r.is)(e,s.SnapIdStruct)},s.assertIsValidSnapId=function(e){(0,i.assertStruct)(e,s.SnapIdStruct,"Invalid snap ID")},s.isSnapPermitted=function(e,t){var s,n;return Boolean(null===(s=((null==e||null===(n=e.wallet_snap)||void 0===n||null===(n=n.caveats)||void 0===n?void 0:n.find(e=>e.type===u.SnapCaveatType.SnapIds))??{}).value)||void 0===s?void 0:s[t])},s.verifyRequestedSnapPermissions=function(e){(0,i.assert)((0,i.isObject)(e),"Requested permissions must be an object.");const{wallet_snap:t}=e;(0,i.assert)((0,i.isObject)(t),"wallet_snap is missing from the requested permissions.");const{caveats:s}=t;(0,i.assert)(Array.isArray(s)&&1===s.length,"wallet_snap must have a caveat property with a single-item array value.");const[n]=s;(0,i.assert)((0,i.isObject)(n)&&n.type===u.SnapCaveatType.SnapIds&&(0,i.isObject)(n.value),`The requested permissions do not have a valid ${u.SnapCaveatType.SnapIds} caveat.`)}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/snaps.cjs"}],[2655,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.indent=void 0,s.indent=function(e,t=2){return e.replace(/^/gmu," ".repeat(t))}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/strings.cjs"}],[2656,{"./strings.cjs":2655,"@metamask/snaps-sdk":3265,"@metamask/superstruct":3415,"@metamask/utils":3554,chalk:4496},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.mergeStructs=s.createUnion=s.validateUnion=s.getStructErrorMessage=s.getStructFailureMessage=s.getStructErrorPrefix=s.getUnionStructNames=s.getStructFromPath=s.createFromStruct=s.getError=s.arrayToGenerator=s.SnapsStructError=s.named=void 0;const n=e("@metamask/snaps-sdk"),a=e("@metamask/superstruct"),r=e("@metamask/utils"),i=e("chalk"),o=e("./strings.cjs");function c(e,t,s){return s?t(e):e}s.named=function(e,t){return new a.Struct({...t,type:e})};class l extends a.StructError{constructor(e,t,s,n,a,r=!0){super(n,a),this.name="SnapsStructError",this.message=`${t}.\n\n${f(e,[...a()],r)}${s?`\n\n${s}`:""}`}}function*u(e){for(const t of e)yield t}function d({struct:e,prefix:t,suffix:s="",error:n,colorize:a}){return new l(e,t,s,n,()=>u(n.failures()),a)}function p(e,t){return t.reduce((t,s)=>(0,r.isObject)(e.schema)&&e.schema[s]?e.schema[s]:t,e)}function h(e,t=!0){return Array.isArray(e.schema)?e.schema.map(({type:e})=>c(e,i.green,t)):null}function m(e,t=!0){return"never"===e.type||0===e.path.length?"":`At path: ${c(e.path.join("."),i.bold,t)}  `}function g(e,t,s=!0){const n=c(JSON.stringify(t.value),i.red,s),a=m(t,s);if("union"===t.type){const r=h(p(e,t.path),s);return r?`${a}Expected the value to be one of: ${r.join(", ")}, but received: ${n}.`:`${a}${t.message}.`}if("literal"===t.type){return`${a}${t.message.replace(/the literal `(.+)`,/u,`the value to be \`${c("$1",i.green,s)}\`,`).replace(/, but received: (.+)/u,`, but received: ${c("$1",i.red,s)}`)}.`}if("never"===t.type)return`Unknown key: ${c(t.path.join("."),i.bold,s)}, received: ${n}.`;if("size"===t.refinement){return`${a}${t.message.replace(/length between `(\d+)` and `(\d+)`/u,`length between ${c("$1",i.green,s)} and ${c("$2",i.green,s)},`).replace(/length of `(\d+)`/u,`length of ${c("$1",i.red,s)}`).replace(/a array/u,"an array")}.`}return t.refinement!==undefined?`${a}${t.message}.`:`${a}Expected a value of type ${c(t.type,i.green,s)}, but received: ${n}.`}function f(e,t,s=!0){return t.map(t=>(0,o.indent)(` ${g(e,t,s)}`)).join("\n")}function w(e,t,s,i=!1){(0,r.assert)(t.schema,"Expected a struct with a schema. Make sure to use `union` from `@metamask/snaps-sdk`."),(0,r.assert)(t.schema.length>0,"Expected a non-empty array of structs.");const o=t.schema.map(e=>e.schema[s]),c=(0,a.type)({[s]:(0,n.union)(o)}),[l]=(0,a.validate)(e,c,{coerce:i});if(l)throw new Error(g(c,l.failures()[0],!1));const u=e,d=t.schema.filter(e=>(0,a.is)(u[s],e.schema[s]));(0,r.assert)(d.length>0,"Expected a struct to match the value.");const p=d.map(e=>(0,a.validate)(u,e,{coerce:i})),h=p.find(([e])=>!e);if(h)return h[1];(0,r.assert)(p[0][0],"Expected at least one error.");const m=p.reduce((e,[t])=>((0,r.assert)(t,"Expected an error."),t.failures().length<e.failures().length?t:e),p[0][0]);throw new Error(g(t,m.failures()[0],!1))}s.SnapsStructError=l,s.arrayToGenerator=u,s.getError=d,s.createFromStruct=function(e,t,s,n=""){try{return(0,a.create)(e,t)}catch(e){if(e instanceof a.StructError)throw d({struct:t,prefix:s,suffix:n,error:e});throw e}},s.getStructFromPath=p,s.getUnionStructNames=h,s.getStructErrorPrefix=m,s.getStructFailureMessage=g,s.getStructErrorMessage=f,s.validateUnion=w,s.createUnion=function(e,t,s){return w(e,t,s,!0)},s.mergeStructs=function(...e){const t=a.assign(...e);return new a.Struct({...t,*refiner(t,s){for(const n of e)yield*n.refiner(t,s)}})}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/structs.cjs"}],[2657,{"@metamask/utils":3554,"fast-xml-parser":4791},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.isSvg=s.parseSvg=void 0;const n=e("@metamask/utils"),a=e("fast-xml-parser");function r(e){try{const t=e.trim();(0,n.assert)(t.length>0);const s=new a.XMLParser({ignoreAttributes:!1,parseAttributeValue:!0}).parse(t,!0);return(0,n.assert)((0,n.hasProperty)(s,"svg")),(0,n.isObject)(s.svg)?s.svg:{}}catch{throw new Error("Snap icon must be a valid SVG.")}}s.parseSvg=r,s.isSvg=function(e){try{return r(e),!0}catch{return!1}}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/svg.cjs"}],[2658,{"@metamask/snaps-sdk":3265,"@metamask/superstruct":3415,luxon:5250},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.ISO8601DateStruct=s.toCensoredISO8601String=s.ISO8601DurationStruct=void 0;const n=e("@metamask/superstruct"),a=e("luxon");s.ISO8601DurationStruct=(0,n.refine)((0,n.string)(),"ISO 8601 duration",e=>!!a.Duration.fromISO(e).isValid||"Not a valid ISO 8601 duration"),s.toCensoredISO8601String=function(e){return a.DateTime.fromISO(e,{setZone:!0}).startOf("second").toISO({suppressMilliseconds:!0})};var r=e("@metamask/snaps-sdk");Object.defineProperty(s,"ISO8601DateStruct",{enumerable:!0,get:function(){return r.ISO8601DateStruct}})}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/time.cjs"}],[2659,{"@metamask/snaps-sdk":3265,"@metamask/superstruct":3415,"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.WALLET_SNAP_PERMISSION_KEY=s.isValidUrl=s.uri=s.SNAP_STREAM_NAMES=s.SnapIdPrefixes=s.NpmSnapPackageJsonStruct=s.NameStruct=s.NpmSnapFileNames=void 0;const n=e("@metamask/snaps-sdk"),a=e("@metamask/superstruct"),r=e("@metamask/utils");var i,o,c;!function(e){e.PackageJson="package.json",e.Manifest="snap.manifest.json"}(i||(s.NpmSnapFileNames=i={})),s.NameStruct=(0,a.size)((0,r.definePattern)("Snap Name",/^(?:@[a-z0-9-*~][a-z0-9-*._~]*\/)?[a-z0-9-~][a-z0-9-._~]*$/u),1,214),s.NpmSnapPackageJsonStruct=(0,a.type)({version:r.VersionStruct,name:s.NameStruct,main:(0,a.optional)((0,a.size)((0,a.string)(),1,Infinity)),repository:(0,a.optional)((0,a.type)({type:(0,a.size)((0,a.string)(),1,Infinity),url:(0,a.size)((0,a.string)(),1,Infinity)}))}),function(e){e.npm="npm:",e.local="local:"}(o||(s.SnapIdPrefixes=o={})),function(e){e.JSON_RPC="jsonRpc",e.COMMAND="command"}(c||(s.SNAP_STREAM_NAMES=c={}));var l=e("@metamask/snaps-sdk");Object.defineProperty(s,"uri",{enumerable:!0,get:function(){return l.uri}}),s.isValidUrl=function(e,t={}){return(0,a.is)(e,(0,n.uri)(t))},s.WALLET_SNAP_PERMISSION_KEY="wallet_snap"}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/types.cjs"}],[266,{"@metamask/name-controller":2739,"@metamask/snaps-rpc-methods":3209,"@metamask/snaps-utils":3382,loglevel:5247},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.SnapsNameProvider=void 0;var n,a=e("@metamask/name-controller"),r=e("@metamask/snaps-utils"),i=(n=e("loglevel"))&&n.__esModule?n:{default:n},o=e("@metamask/snaps-rpc-methods");function c(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function l(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function u(e,t){return e.get(d(e,t))}function d(e,t,s){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:s;throw new TypeError("Private element is not present on this object")}var p=new WeakMap,h=new WeakSet;function m(e){const t=u(p,this).call("PermissionController:getState").subjects;return u(p,this).call("SnapController:getAll").filter(({id:s})=>{var n;const a=null===(n=t[s])||void 0===n?void 0:n.permissions["endowment:name-lookup"];if(!a)return!1;const r=(0,o.getChainIdsCaveat)(a);return!(e&&r&&!r.includes(e))})}async function g(e,t,s){const n=e,a={chainId:t,address:s};let o,c;try{const t=await u(p,this).call("SnapController:handleRequest",{snapId:e,origin:"metamask",handler:r.HandlerType.OnNameLookup,request:{jsonrpc:"2.0",method:" ",params:a}}),s=null==t?void 0:t.resolvedDomains;o=s?[...new Set(s.map(e=>e.resolvedDomain))]:[]}catch(t){i.default.error("Snap name provider request failed",{snapId:e,request:a,error:t}),c=t}return{sourceId:n,result:{proposedNames:o,error:c}}}s.SnapsNameProvider=class{constructor({messenger:e}){var t,s,n;!function(e,t){c(e,t),t.add(e)}(this,h),l(this,"name","SnapsNameProvider"),l(this,"state",null),function(e,t,s){c(e,t),t.set(e,s)}(this,p,void 0),s=this,n=e,(t=p).set(d(t,s),n)}getMetadata(){const e=d(h,this,m).call(this);return{sourceIds:{[a.NameType.ETHEREUM_ADDRESS]:e.map(e=>e.id)},sourceLabels:e.reduce((e,t)=>{const s=u(p,this).call("SnapController:get",t.id),n=null==s?void 0:s.manifest.proposedName;return{...e,[t.id]:n||t.id}},{})}}async getProposedNames(e){const{variation:t,value:s}=e,n=`eip155:${parseInt(t,16)}`,a=d(h,this,m).call(this,n);return{results:(await Promise.all(a.map(e=>d(h,this,g).call(this,e.id,n,s)))).reduce((e,t)=>{const{sourceId:s,result:n}=t;return{...e,[s]:n}},{})}}}}}},{package:"$root$",file:"app/scripts/lib/SnapsNameProvider.ts"}],[2660,{"./types.cjs":2659,"./url.cjs":2661,"@metamask/snaps-sdk":3265,"@metamask/snaps-sdk/jsx":3352,"@metamask/snaps-sdk/jsx-runtime":3351,"@metamask/utils":3554,marked:5251},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.serialiseJsx=s.walkJsx=s.getJsxChildren=s.hasChildren=s.getTotalTextLength=s.validateJsxElements=s.validateAssetSelector=s.validateTextLinks=s.validateLink=s.getJsxElementFromComponent=s.getTextChildren=void 0;const n=e("@metamask/snaps-sdk/jsx-runtime"),a=e("@metamask/snaps-sdk"),r=e("@metamask/snaps-sdk/jsx"),i=e("@metamask/utils"),o=e("marked"),c=e("./types.cjs"),l=e("./url.cjs"),u=["https:","mailto:","metamask:"];function d(e){switch(e){case"primary":return"primary";case"secondary":return"destructive";default:return undefined}}function p(e){return 1===e.length?e[0]:e}function h(e){return e.tokens&&e.tokens.length>0?p(e.tokens.flatMap(g)):e.href}function m(e){return p(e.flatMap(g))}function g(e){switch(e.type){case"link":return(0,n.jsx)(r.Link,{href:e.href,children:h(e)});case"text":return e.text;case"strong":return(0,n.jsx)(r.Bold,{children:m(e.tokens)});case"em":return(0,n.jsx)(r.Italic,{children:m(e.tokens)});default:return null}}function f(e){const t=(0,o.lexer)(e,{gfm:!1}),s=[];return(0,o.walkTokens)(t,e=>{if("paragraph"===e.type){s.length>0&&s.push("\n\n");const{tokens:t}=e;s.push(...t.flatMap(g))}}),s.filter(e=>null!==e)}function w(e,t,s){try{const n=new URL(e);if((0,i.assert)(u.includes(n.protocol),`Protocol must be one of: ${u.join(", ")}.`),"metamask:"===n.protocol){const t=(0,l.parseMetaMaskUrl)(e);t.snapId&&(0,i.assert)(s(t.snapId),"The Snap being navigated to is not installed.")}else if("mailto:"===n.protocol){const e=n.pathname.split(",");for(const s of e){const e=s.split("@")[1];(0,i.assert)(!e.includes(":"));const n=`https://${e}`;(0,i.assert)(!t(n),"The specified URL is not allowed.")}return}(0,i.assert)(!t(n.href),"The specified URL is not allowed.")}catch(e){throw new Error(`Invalid URL: ${"ERR_ASSERTION"===(null==e?void 0:e.code)?e.message:"Unable to parse URL."}`)}}function v(e,t){const s=t(e);(0,i.assert)(s,`Could not find account for address: ${e}`)}function y(e){const{type:t}=e;switch(t){case a.NodeType.Panel:return e.children.reduce((e,t)=>e+y(t),0);case a.NodeType.Row:return y(e.value);case a.NodeType.Text:return e.value.length;default:return 0}}function S(e){return(0,i.hasProperty)(e.props,"children")}function b(e){return Boolean(e)&&!0!==e}function k(e){if(S(e)){if(Array.isArray(e.props.children))return e.props.children.filter(b).flat(Infinity);if(e.props.children)return[e.props.children]}return[]}function T(e,t,s=0){if(Array.isArray(e)){for(const n of e){const e=T(n,t,s);if(e!==undefined)return e}return undefined}const n=t(e,s);if(n!==undefined)return n;if((0,i.hasProperty)(e,"props")&&(0,i.isPlainObject)(e.props)&&(0,i.hasProperty)(e.props,"children")){const n=k(e);for(const e of n)if((0,i.isPlainObject)(e)){const n=T(e,t,s+1);if(n!==undefined)return n}}return undefined}function A(e){return Object.entries(e).filter(([e])=>"children"!==e).sort(([e],[t])=>e.localeCompare(t)).map(([e,t])=>{return` ${e}=${s=t,"string"==typeof s?`"${s}"`:`{${JSON.stringify(s)}}`}`;var s}).join("")}s.getTextChildren=f,s.getJsxElementFromComponent=function(e){return function(e){const t=y(e);(0,i.assert)(t<=5e4,"The text in a Snap UI may not be larger than 50 kB.")}(e),function e(t){switch(t.type){case a.NodeType.Address:return(0,n.jsx)(r.Address,{address:t.value});case a.NodeType.Button:return(0,n.jsx)(r.Button,{name:t.name,variant:d(t.variant),type:t.buttonType,children:t.value});case a.NodeType.Copyable:return(0,n.jsx)(r.Copyable,{value:t.value,sensitive:t.sensitive});case a.NodeType.Divider:return(0,n.jsx)(r.Divider,{});case a.NodeType.Form:return(0,n.jsx)(r.Form,{name:t.name,children:p(t.children.map(e))});case a.NodeType.Heading:return(0,n.jsx)(r.Heading,{children:t.value});case a.NodeType.Image:return(0,n.jsx)(r.Image,{src:t.value});case a.NodeType.Input:return(0,n.jsx)(r.Field,{label:t.label,error:t.error,children:(0,n.jsx)(r.Input,{name:t.name,type:t.inputType,value:t.value,placeholder:t.placeholder})});case a.NodeType.Panel:return(0,n.jsx)(r.Box,{children:p(t.children.map(e))});case a.NodeType.Row:return(0,n.jsx)(r.Row,{label:t.label,variant:t.variant,children:e(t.value)});case a.NodeType.Spinner:return(0,n.jsx)(r.Spinner,{});case a.NodeType.Text:return(0,n.jsx)(r.Text,{children:p(f(t.value))});default:return(0,i.assertExhaustive)(t)}}(e)},s.validateLink=w,s.validateTextLinks=function(e,t,s){const n=function(e){const t=(0,o.lexer)(e,{gfm:!1}),s=[];return(0,o.walkTokens)(t,e=>{"link"===e.type&&s.push(e)}),s}(e);for(const e of n)w(e.href,t,s)},s.validateAssetSelector=v,s.validateJsxElements=function(e,{isOnPhishingList:t,getSnap:s,getAccountByAddress:n,hasPermission:a}){T(e,e=>{switch(e.type){case"Link":w(e.props.href,t,s);break;case"AssetSelector":v(e.props.addresses[0],n);break;case"Image":{const{src:t}=e.props,s=(0,c.isValidUrl)(t);(0,i.assert)(!s||s&&a("endowment:network-access"),"Using external images is only permitted with the `endowment:network-access` permission.");break}}})},s.getTotalTextLength=y,s.hasChildren=S,s.getJsxChildren=k,s.walkJsx=T,s.serialiseJsx=function e(t,s=0){if(Array.isArray(t))return t.map(t=>e(t,s)).join("");const n="  ".repeat(s);if("string"==typeof t)return`${n}${t}\n`;if(!t)return"";const{type:a,props:r}=t,o=s>0?"\n":"";if((0,i.hasProperty)(r,"children")){const t=e(r.children,s+1);return`${n}<${a}${A(r)}>\n${t}${n}</${a}>${o}`}return`${n}<${a}${A(r)} />${o}`}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/ui.cjs"}],[2661,{"./snaps.cjs":2654,"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.parseMetaMaskUrl=s.SNAP_PATHS=s.CLIENT_PATHS=void 0;const n=e("@metamask/utils"),a=e("./snaps.cjs");s.CLIENT_PATHS=["/"],s.SNAP_PATHS=["/home"],s.parseMetaMaskUrl=function(e){const t=new URL(e),{protocol:r}=t;if("metamask:"!==r)throw new Error(`Unable to parse URL. Expected the protocol to be "metamask:", but received "${r}".`);const[i,...o]=t.href.replace("metamask://","").split("/"),c=`/${o.join("/")}`;switch(i){case"client":return(0,n.assert)(s.CLIENT_PATHS.includes(c),`Unable to navigate to "${c}". The provided path is not allowed.`),{authority:i,path:c};case"snap":return function(e){const t="Invalid MetaMask url:",r=(0,a.stripSnapPrefix)(e.slice(1)),i=e.slice(1).startsWith("npm:")?"npm:":"local:",o=r.startsWith("@"),c=r.split("/"),l=`/${c[c.length-1]}`;let u;if("local:"===i){const[e,,...a]=c.slice(0,-1);u=`${e}//${a.join("/")}`,(0,n.assert)(s.SNAP_PATHS.includes(l),`${t} invalid snap path.`)}else u=o?`${c[0]}/${c[1]}`:c[0],(0,n.assert)(o?3===c.length&&s.SNAP_PATHS.includes(l):2===c.length&&s.SNAP_PATHS.includes(l),`${t} invalid snap path.`);const d=`${i}${u}`;return(0,a.assertIsValidSnapId)(d),{authority:"snap",snapId:d,path:l}}(c);default:throw new Error(`Expected "metamask:" URL to start with "client" or "snap", but received "${i}".`)}}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/url.cjs"}],[2662,{"./icon.cjs":2643,"./localization.cjs":2648,"./manifest/validation.cjs":2651,"./snaps.cjs":2654},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.validateFetchedSnap=void 0;const n=e("./icon.cjs"),a=e("./localization.cjs"),r=e("./manifest/validation.cjs"),i=e("./snaps.cjs");s.validateFetchedSnap=async function(e){(0,r.assertIsSnapManifest)(e.manifest.result),await(0,i.validateSnapShasum)(e),(0,a.validateSnapManifestLocalizations)(e.manifest.result,e.localizationFiles.map(e=>e.result)),e.svgIcon&&(0,n.assertIsSnapIcon)(e.svgIcon)}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/validation.cjs"}],[2663,{"@metamask/superstruct":3415,"@metamask/utils":3554,semver:5987},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.resolveVersionRange=s.getTargetVersion=s.DEFAULT_REQUESTED_SNAP_VERSION=void 0;const n=e("@metamask/superstruct"),a=e("@metamask/utils"),r=e("semver");s.DEFAULT_REQUESTED_SNAP_VERSION="*",s.getTargetVersion=function(e,t){const s=(0,r.maxSatisfying)(e,t);return s||(0,r.maxSatisfying)(e,t,{includePrerelease:!0})},s.resolveVersionRange=function(e){return e===undefined||"latest"===e?[undefined,s.DEFAULT_REQUESTED_SNAP_VERSION]:(0,n.validate)(e,a.VersionRangeStruct)}}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/versions.cjs"}],[2664,{"../deep-clone.cjs":2627,"@metamask/utils":3554,"@scure/base":3634},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){function n(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}Object.defineProperty(s,"__esModule",{value:!0}),s.VirtualFile=void 0;const a=e("@metamask/utils"),r=e("@scure/base"),i=e("../deep-clone.cjs");class o{constructor(e){var t,s,a,r;let i;n(this,"value",void 0),n(this,"result",void 0),n(this,"data",void 0),n(this,"path",void 0),i="string"==typeof e||e instanceof Uint8Array?{value:e}:e,this.value=(null===(t=i)||void 0===t?void 0:t.value)??"",this.result=(null===(s=i)||void 0===s?void 0:s.result)??undefined,this.data=(null===(a=i)||void 0===a?void 0:a.data)??{},this.path=(null===(r=i)||void 0===r?void 0:r.path)??"/"}get size(){return"string"==typeof this.value?this.value.length:this.value.byteLength}toString(e){if("string"==typeof this.value)return(0,a.assert)(e===undefined,"Tried to encode string."),this.value;if(this.value instanceof Uint8Array&&"hex"===e)return(0,a.bytesToHex)(this.value);if(this.value instanceof Uint8Array&&"base64"===e)return r.base64.encode(this.value);return new TextDecoder(e).decode(this.value)}clone(){const e=new o;return"string"==typeof this.value?e.value=this.value:e.value=this.value.slice(0),e.result=(0,i.deepClone)(this.result),e.data=(0,i.deepClone)(this.data),e.path=this.path,e}}s.VirtualFile=o}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/virtual-file/VirtualFile.cjs"}],[2665,{"./VirtualFile.cjs":2664},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n=Object.create?function(e,t,s,n){n===undefined&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){n===undefined&&(n=s),e[n]=t[s]},a=function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||n(t,e,s)};Object.defineProperty(s,"__esModule",{value:!0}),a(e("./VirtualFile.cjs"),s)}}},{package:"@metamask/multichain-account-service>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-account-service/node_modules/@metamask/snaps-utils/dist/virtual-file/index.cjs"}],[2666,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n;Object.defineProperty(s,"__esModule",{value:!0}),s.MultichainApiNotifications=void 0,function(e){e.sessionChanged="wallet_sessionChanged",e.walletNotify="wallet_notify"}(n||(s.MultichainApiNotifications=n={}))}}},{package:"@metamask/multichain-api-middleware",file:"node_modules/@metamask/multichain-api-middleware/dist/handlers/types.cjs"}],[2667,{"@metamask/chain-agnostic-permission":1610,"@metamask/controller-utils":1639,"@metamask/permission-controller":2862,"@metamask/rpc-errors":3026,"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.walletCreateSession=void 0;const n=e("@metamask/chain-agnostic-permission"),a=e("@metamask/controller-utils"),r=e("@metamask/permission-controller"),i=e("@metamask/rpc-errors"),o=e("@metamask/utils");s.walletCreateSession={methodNames:["wallet_createSession"],implementation:async function(e,t,s,c,l){if(!(0,o.isPlainObject)(e.params))return c((0,r.invalidParams)({data:{request:e}}));const{requiredScopes:u,optionalScopes:d,sessionProperties:p}=e.params;if(p&&0===Object.keys(p).length)return c(new i.JsonRpcError(5302,"Invalid sessionProperties requested"));const h=Object.fromEntries(Object.entries(p??{}).filter(([e])=>(0,n.isKnownSessionPropertyValue)(e)));try{const{normalizedRequiredScopes:e,normalizedOptionalScopes:s}=(0,n.validateAndNormalizeScopes)(u||{},d||{}),r=(0,n.getSupportedScopeObjects)(e,{getNonEvmSupportedMethods:l.getNonEvmSupportedMethods}),p=(0,n.getSupportedScopeObjects)(s,{getNonEvmSupportedMethods:l.getNonEvmSupportedMethods}),m=e=>{try{return l.findNetworkClientIdByChainId(e),!0}catch{return!1}},g=(0,n.isNamespaceInScopesObject)(r,o.KnownCaipNamespace.Solana)||(0,n.isNamespaceInScopesObject)(p,o.KnownCaipNamespace.Solana);let f=!1;if(g){f=0===l.getNonEvmAccountAddresses("solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp").length}const{supportedScopes:w}=(0,n.bucketScopes)(r,{isEvmChainIdSupported:m,isEvmChainIdSupportable:()=>!1,getNonEvmSupportedMethods:l.getNonEvmSupportedMethods,isNonEvmScopeSupported:l.isNonEvmScopeSupported}),{supportedScopes:v}=(0,n.bucketScopes)(p,{isEvmChainIdSupported:m,isEvmChainIdSupportable:()=>!1,getNonEvmSupportedMethods:l.getNonEvmSupportedMethods,isNonEvmScopeSupported:l.isNonEvmScopeSupported}),y=(0,n.getCaipAccountIdsFromScopesObjects)([w,v]),S=(0,n.getAllScopesFromScopesObjects)([w,v]),b=l.listAccounts().map(e=>e.address),k=y.filter(e=>{const{address:t,chain:{namespace:s},chainId:n}=(0,o.parseCaipAccountId)(e);return s===o.KnownCaipNamespace.Eip155.toString()?b.some(e=>(0,a.isEqualCaseInsensitive)(t,e)):l.getNonEvmAccountAddresses(n).some(t=>e===t)}),T={requiredScopes:(0,n.getInternalScopesObject)(w),optionalScopes:(0,n.getInternalScopesObject)(v),isMultichainOrigin:!0,sessionProperties:h},A=(0,n.setNonSCACaipAccountIdsInCaip25CaveatValue)(T,k);if(0===S.length){if(!f)return c(new i.JsonRpcError(5100,"Requested scopes are not supported"));A.optionalScopes[o.KnownCaipNamespace.Wallet]={accounts:[]}}const[_]=await l.requestPermissionsForOrigin({[n.Caip25EndowmentPermissionName]:{caveats:[{type:n.Caip25CaveatType,value:A}]}},{metadata:{promptToCreateSolanaAccount:f}}),E=_[n.Caip25EndowmentPermissionName],M=E?.caveats?.find(e=>e.type===n.Caip25CaveatType)?.value;if(!M)throw i.rpcErrors.internal();const I=(0,n.getSessionScopes)(M,{getNonEvmSupportedMethods:l.getNonEvmSupportedMethods}),{sessionProperties:P={}}=M;return l.trackSessionCreatedEvent?.(M),t.result={sessionScopes:I,sessionProperties:P},c()}catch(e){return c(e)}},hookNames:{findNetworkClientIdByChainId:!0,listAccounts:!0,requestPermissionsForOrigin:!0,getNonEvmSupportedMethods:!0,isNonEvmScopeSupported:!0,getNonEvmAccountAddresses:!0,trackSessionCreatedEvent:!0}}}}},{package:"@metamask/multichain-api-middleware",file:"node_modules/@metamask/multichain-api-middleware/dist/handlers/wallet-createSession.cjs"}],[2668,{"@metamask/chain-agnostic-permission":1610},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.walletGetSession=void 0;const n=e("@metamask/chain-agnostic-permission");s.walletGetSession={methodNames:["wallet_getSession"],implementation:async function(e,t,s,a,r){let i;try{i=r.getCaveatForOrigin(n.Caip25EndowmentPermissionName,n.Caip25CaveatType)}catch{}return i?(t.result={sessionScopes:(0,n.getSessionScopes)(i.value,{getNonEvmSupportedMethods:r.getNonEvmSupportedMethods})},a()):(t.result={sessionScopes:{}},a())},hookNames:{getCaveatForOrigin:!0,getNonEvmSupportedMethods:!0}}}}},{package:"@metamask/multichain-api-middleware",file:"node_modules/@metamask/multichain-api-middleware/dist/handlers/wallet-getSession.cjs"}],[2669,{"@metamask/chain-agnostic-permission":1610,"@metamask/rpc-errors":3026,"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.walletInvokeMethod=void 0;const n=e("@metamask/chain-agnostic-permission"),a=e("@metamask/rpc-errors"),r=e("@metamask/utils");s.walletInvokeMethod={methodNames:["wallet_invokeMethod"],implementation:async function(e,t,s,i,o){const{scope:c,request:l}=e.params;let u;(0,n.assertIsInternalScopeString)(c);try{u=o.getCaveatForOrigin(n.Caip25EndowmentPermissionName,n.Caip25CaveatType)}catch{}if(!u)return i(a.providerErrors.unauthorized());const d=(0,n.getSessionScopes)(u.value,{getNonEvmSupportedMethods:o.getNonEvmSupportedMethods})[c];if(!d?.methods?.includes(l.method))return i(a.providerErrors.unauthorized());const{namespace:p,reference:h}=(0,n.parseScopeString)(c),m=p===r.KnownCaipNamespace.Wallet&&(!h||h===r.KnownCaipNamespace.Eip155)||p===r.KnownCaipNamespace.Eip155,g={...e,scope:c,method:l.method,params:l.params};if(m){let t;return p===r.KnownCaipNamespace.Wallet?t=o.getSelectedNetworkClientId():p===r.KnownCaipNamespace.Eip155&&h&&(t=o.findNetworkClientIdByChainId((0,r.numberToHex)(parseInt(h,10)))),t?(Object.assign(e,{...g,networkClientId:t}),s()):(console.error("failed to resolve network client for wallet_invokeMethod",e),i(a.rpcErrors.internal()))}try{t.result=await o.handleNonEvmRequestForOrigin({connectedAddresses:d.accounts,scope:c,request:g})}catch(e){return i(e)}return i()},hookNames:{getCaveatForOrigin:!0,findNetworkClientIdByChainId:!0,getSelectedNetworkClientId:!0,getNonEvmSupportedMethods:!0,handleNonEvmRequestForOrigin:!0}}}}},{package:"@metamask/multichain-api-middleware",file:"node_modules/@metamask/multichain-api-middleware/dist/handlers/wallet-invokeMethod.cjs"}],[267,{"../../../shared/constants/onboarding":6197,"../../../shared/lib/wallet-funds-obtained-metric":6307,"@metamask/notification-services-controller/notification-services":2781,loglevel:5247},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.WalletFundsObtainedMonitor=void 0;var n,a=e("@metamask/notification-services-controller/notification-services"),r=(n=e("loglevel"))&&n.__esModule?n:{default:n},i=e("../../../shared/lib/wallet-funds-obtained-metric"),o=e("../../../shared/constants/onboarding");function c(e,t,s){l(e,t),t.set(e,s)}function l(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function u(e,t){return e.get(p(e,t))}function d(e,t,s){return e.set(p(e,t),s),s}function p(e,t,s){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:s;throw new TypeError("Private element is not present on this object")}var h=new WeakMap,m=new WeakMap,g=new WeakMap,f=new WeakSet;function w(){try{const e=u(h,this).call("TokenBalancesController:getState"),t=u(h,this).call("MultichainBalancesController:getState");return(0,i.hasNonZeroTokenBalance)(e.tokenBalances)||(0,i.hasNonZeroMultichainBalance)(t.balances)}catch(e){return r.default.error("Error checking for existing funds: ",e),!1}}function v(){return e=>{const t=e.filter(e=>e.type===a.TRIGGER_TYPES.ERC20_RECEIVED||e.type===a.TRIGGER_TYPES.ETH_RECEIVED);if(t.length<1)return;const s=t.at(-1);if(!s)return;const{payload:{chain_id:n}}=s,r=s.type===a.TRIGGER_TYPES.ERC20_RECEIVED?s.payload.data.token.usd:s.payload.data.amount.usd;n&&r&&(u(h,this).call("MetaMetricsController:trackEvent",(0,i.getWalletFundsObtainedEventProperties)({chainId:n,amountUsd:r})),u(h,this).call("AppStateController:setCanTrackWalletFundsObtained",!1),u(g,this)&&(u(h,this).unsubscribe("NotificationServicesController:notificationsListUpdated",u(g,this)),d(g,this,null)))}}s.WalletFundsObtainedMonitor=class{constructor({messenger:e}){!function(e,t){l(e,t),t.add(e)}(this,f),c(this,h,void 0),c(this,m,!1),c(this,g,null),d(h,this,e)}setupMonitoring(){if(u(m,this))return;const e=u(h,this).call("OnboardingController:getState"),{firstTimeFlowType:t}=e;if(t!==o.FirstTimeFlowType.create&&t!==o.FirstTimeFlowType.socialCreate)return void u(h,this).call("AppStateController:setCanTrackWalletFundsObtained",!1);u(h,this).call("NotificationServicesController:getState").isNotificationServicesEnabled?p(f,this,w).call(this)?u(h,this).call("AppStateController:setCanTrackWalletFundsObtained",!1):(d(g,this,p(f,this,v).call(this)),u(h,this).subscribe("NotificationServicesController:notificationsListUpdated",u(g,this)),d(m,this,!0)):u(h,this).call("AppStateController:setCanTrackWalletFundsObtained",!1)}}}}},{package:"$root$",file:"app/scripts/lib/WalletFundsObtainedMonitor.ts"}],[2670,{"@metamask/chain-agnostic-permission":1610,"@metamask/permission-controller":2862,"@metamask/rpc-errors":3026,"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.walletRevokeSession=void 0;const n=e("@metamask/chain-agnostic-permission"),a=e("@metamask/permission-controller"),r=e("@metamask/rpc-errors"),i=e("@metamask/utils");s.walletRevokeSession={methodNames:["wallet_revokeSession"],implementation:async function(e,t,s,o,c){const{params:{scopes:l}}=e;try{l?.length?function(e,t){let s=t.getCaveatForOrigin(n.Caip25EndowmentPermissionName,n.Caip25CaveatType).value;for(const t of e){const e=n.Caip25CaveatMutators[n.Caip25CaveatType].removeScope(s,t);e.operation!==a.CaveatMutatorOperation.Noop&&(s=e?.value??{requiredScopes:{},optionalScopes:{},sessionProperties:{},isMultichainOrigin:!0})}(0,n.getCaipAccountIdsFromCaip25CaveatValue)(s).length?t.updateCaveat(n.Caip25EndowmentPermissionName,n.Caip25CaveatType,s):t.revokePermissionForOrigin(n.Caip25EndowmentPermissionName)}(l,c):c.revokePermissionForOrigin(n.Caip25EndowmentPermissionName)}catch(e){if(u=e,!((0,i.isObject)(u)&&"name"in u&&"string"==typeof u.name&&[a.UnrecognizedSubjectError.name,a.PermissionDoesNotExistError.name].includes(u.name)))return console.error(e),o(r.rpcErrors.internal())}var u;return t.result=!0,o()},hookNames:{revokePermissionForOrigin:!0,updateCaveat:!0,getCaveatForOrigin:!0}}}}},{package:"@metamask/multichain-api-middleware",file:"node_modules/@metamask/multichain-api-middleware/dist/handlers/wallet-revokeSession.cjs"}],[2671,{"./handlers/types.cjs":2666,"./handlers/wallet-createSession.cjs":2667,"./handlers/wallet-getSession.cjs":2668,"./handlers/wallet-invokeMethod.cjs":2669,"./handlers/wallet-revokeSession.cjs":2670,"./middlewares/MultichainMiddlewareManager.cjs":2672,"./middlewares/MultichainSubscriptionManager.cjs":2673,"./middlewares/multichainMethodCallValidatorMiddleware.cjs":2674},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){Object.defineProperty(s,"__esModule",{value:!0}),s.MultichainApiNotifications=s.MultichainSubscriptionManager=s.MultichainMiddlewareManager=s.multichainMethodCallValidatorMiddleware=s.walletRevokeSession=s.walletInvokeMethod=s.walletGetSession=s.walletCreateSession=void 0;var n=e("./handlers/wallet-createSession.cjs");Object.defineProperty(s,"walletCreateSession",{enumerable:!0,get:function(){return n.walletCreateSession}});var a=e("./handlers/wallet-getSession.cjs");Object.defineProperty(s,"walletGetSession",{enumerable:!0,get:function(){return a.walletGetSession}});var r=e("./handlers/wallet-invokeMethod.cjs");Object.defineProperty(s,"walletInvokeMethod",{enumerable:!0,get:function(){return r.walletInvokeMethod}});var i=e("./handlers/wallet-revokeSession.cjs");Object.defineProperty(s,"walletRevokeSession",{enumerable:!0,get:function(){return i.walletRevokeSession}});var o=e("./middlewares/multichainMethodCallValidatorMiddleware.cjs");Object.defineProperty(s,"multichainMethodCallValidatorMiddleware",{enumerable:!0,get:function(){return o.multichainMethodCallValidatorMiddleware}});var c=e("./middlewares/MultichainMiddlewareManager.cjs");Object.defineProperty(s,"MultichainMiddlewareManager",{enumerable:!0,get:function(){return c.MultichainMiddlewareManager}});var l=e("./middlewares/MultichainSubscriptionManager.cjs");Object.defineProperty(s,"MultichainSubscriptionManager",{enumerable:!0,get:function(){return l.MultichainSubscriptionManager}});var u=e("./handlers/types.cjs");Object.defineProperty(s,"MultichainApiNotifications",{enumerable:!0,get:function(){return u.MultichainApiNotifications}})}}},{package:"@metamask/multichain-api-middleware",file:"node_modules/@metamask/multichain-api-middleware/dist/index.cjs"}],[2672,{"@metamask/rpc-errors":3026},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n,a,r,i,o,c=this&&this.__classPrivateFieldGet||function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)},l=this&&this.__classPrivateFieldSet||function(e,t,s,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?a.call(e,s):a?a.value=s:t.set(e,s),s};Object.defineProperty(s,"__esModule",{value:!0}),s.MultichainMiddlewareManager=void 0;const u=e("@metamask/rpc-errors"),d=["eth_subscribe","eth_unsubscribe"];s.MultichainMiddlewareManager=class{constructor(){n.add(this),a.set(this,[])}addMiddleware(e){const{scope:t,origin:s,tabId:i}=e;c(this,n,"m",r).call(this,{scope:t,origin:s,tabId:i})||c(this,a,"f").push(e)}removeMiddlewareByScope(e){c(this,a,"f").forEach(t=>{t.scope===e&&c(this,n,"m",o).call(this,t)})}removeMiddlewareByScopeAndOrigin(e,t){c(this,a,"f").forEach(s=>{s.scope===e&&s.origin===t&&c(this,n,"m",o).call(this,s)})}removeMiddlewareByOriginAndTabId(e,t){c(this,a,"f").forEach(s=>{s.origin===e&&s.tabId===t&&c(this,n,"m",o).call(this,s)})}generateMultichainMiddlewareForOriginAndTabId(e,t){const s=(s,a,i,o)=>{const{scope:l}=s,p=c(this,n,"m",r).call(this,{scope:l,origin:e,tabId:t});return d.includes(s.method)?p?(p.middleware(s,a,i,o),undefined):o(u.rpcErrors.methodNotFound()):i()};return s.destroy=this.removeMiddlewareByOriginAndTabId.bind(this,e,t),s}},a=new WeakMap,n=new WeakSet,r=function({scope:e,origin:t,tabId:s}){return c(this,a,"f").find(n=>n.scope===e&&n.origin===t&&n.tabId===s)},i=function({scope:e,origin:t,tabId:s}){l(this,a,c(this,a,"f").filter(n=>n.scope!==e||n.origin!==t||n.tabId!==s),"f")},o=function(e){Promise.resolve(e.middleware.destroy?.()).catch(()=>{}),c(this,n,"m",i).call(this,e)}}}},{package:"@metamask/multichain-api-middleware",file:"node_modules/@metamask/multichain-api-middleware/dist/middlewares/MultichainMiddlewareManager.cjs"}],[2673,{"../handlers/types.cjs":2666,"@metamask/controller-utils":1639,"@metamask/eth-json-rpc-filters/subscriptionManager.js":2083,"@metamask/safe-event-emitter":3028,"@metamask/utils":3554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n,a,r,i,o,c,l,u=this&&this.__classPrivateFieldSet||function(e,t,s,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?a.call(e,s):a?a.value=s:t.set(e,s),s},d=this&&this.__classPrivateFieldGet||function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)},p=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(s,"__esModule",{value:!0}),s.MultichainSubscriptionManager=void 0;const h=e("@metamask/controller-utils"),m=p(e("@metamask/eth-json-rpc-filters/subscriptionManager.js")),g=p(e("@metamask/safe-event-emitter")),f=e("@metamask/utils"),w=e("../handlers/types.cjs");class v extends g.default{constructor(e){super(),n.add(this),a.set(this,void 0),r.set(this,void 0),i.set(this,[]),u(this,a,e.findNetworkClientIdByChainId,"f"),u(this,r,e.getNetworkClientById,"f")}notify({scope:e,origin:t,tabId:s},{method:n,params:a}){this.emit("notification",t,s,{method:w.MultichainApiNotifications.walletNotify,params:{scope:e,notification:{method:n,params:a}}})}subscribe(e){const t=d(this,n,"m",o).call(this,e);if(t)return t.subscriptionManager;const s=d(this,a,"f").call(this,(0,h.toHex)((0,f.parseCaipChainId)(e.scope).reference)),c=d(this,r,"f").call(this,s),u=(0,m.default)({blockTracker:c.blockTracker,provider:c.provider});u.events.on("notification",t=>{this.notify(e,t)});const p={...e,subscriptionManager:u};return u.destroy=u.middleware.destroy,u.middleware.destroy=d(this,n,"m",l).bind(this,p),d(this,i,"f").push(p),u}unsubscribeByScope(e){d(this,i,"f").forEach(t=>{t.scope===e&&d(this,n,"m",l).call(this,t)})}unsubscribeByScopeAndOrigin(e,t){d(this,i,"f").forEach(s=>{s.scope===e&&s.origin===t&&d(this,n,"m",l).call(this,s)})}unsubscribeByOriginAndTabId(e,t){d(this,i,"f").forEach(s=>{s.origin===e&&s.tabId===t&&d(this,n,"m",l).call(this,s)})}}s.MultichainSubscriptionManager=v,a=new WeakMap,r=new WeakMap,i=new WeakMap,n=new WeakSet,o=function({scope:e,origin:t,tabId:s}){return d(this,i,"f").find(n=>n.scope===e&&n.origin===t&&n.tabId===s)},c=function({scope:e,origin:t,tabId:s}){u(this,i,d(this,i,"f").filter(n=>n.scope!==e||n.origin!==t||n.tabId!==s),"f")},l=function(e){e.subscriptionManager.destroy?.(),d(this,n,"m",c).call(this,e)}}}},{package:"@metamask/multichain-api-middleware",file:"node_modules/@metamask/multichain-api-middleware/dist/middlewares/MultichainSubscriptionManager.cjs"}],[2674,{"@metamask/api-specs":2677,"@metamask/json-rpc-engine":2418,"@metamask/rpc-errors":3026,"@metamask/utils":3554,"@open-rpc/schema-utils-js/build/dereference-document.js":3613,"@open-rpc/schema-utils-js/build/parse-open-rpc-document.js":3614,jsonschema:5058},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(s,"__esModule",{value:!0}),s.multichainMethodCallValidatorMiddleware=void 0;const a=e("@metamask/api-specs"),r=e("@metamask/json-rpc-engine"),i=e("@metamask/rpc-errors"),o=e("@metamask/utils"),c=n(e("@open-rpc/schema-utils-js/build/dereference-document.js")),l=e("@open-rpc/schema-utils-js/build/parse-open-rpc-document.js"),u=e("jsonschema"),d=(e,t,s)=>{const n=`${t.name}${e.path.length>0?`.${e.path.join(".")}`:""} ${e.message}`;return i.rpcErrors.invalidParams({message:n,data:{param:t.name,path:e.path,schema:e.schema,got:s}})},p=new u.Validator,h=(0,c.default)(a.MultiChainOpenRPCDocument,(0,l.makeCustomResolver)({}));s.multichainMethodCallValidatorMiddleware=(0,r.createAsyncMiddleware)(async(e,t,s)=>{const n=await(async(e,t)=>{const s=(await h).methods.find(t=>t.name===e);if(!s||!(0,o.isObject)(s)||!("params"in s))return[i.rpcErrors.methodNotFound({data:{method:e}})];const n=[];for(const e of s.params){if(!(0,o.isObject)(t))return[i.rpcErrors.invalidParams()];const s=e,a=t[s.name],r=p.validate(a,s.schema,{required:s.required});r.errors&&n.push(...r.errors.map(e=>d(e,s,a)))}return n})(e.method,e.params);if(n.length>0)throw i.rpcErrors.invalidParams({data:n});return await s()})}}},{package:"@metamask/multichain-api-middleware",file:"node_modules/@metamask/multichain-api-middleware/dist/middlewares/multichainMethodCallValidatorMiddleware.cjs"}],[2675,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,s){t.exports={openrpc:"1.2.4",info:{title:"MetaMask MultiChain API",version:"1.0.0",description:"This provides the specs for the MultiChain API Layer for the MetaMask API"},methods:[{name:"wallet_notify",paramStructure:"by-name",params:[{name:"scope",description:"a valid `scope` string that has been previously authorized via `provider_authorize`",required:!0,schema:{$ref:"#/components/schemas/ScopeString"}},{name:"notification",description:"an object containing a JSON-RPC notification with `method` and `params`",deprecated:!1,required:!0,schema:{type:"object",properties:{method:{type:"string"},params:!0}}}]},{name:"wallet_invokeMethod",paramStructure:"by-name",params:[{name:"scope",description:"a valid `scope` string that has been previously authorized via `provider_authorize`",required:!0,schema:{$ref:"#/components/schemas/ScopeString"}},{name:"request",description:"an object containing a JSON-RPC request with `method` and `params`",deprecated:!1,required:!0,schema:{type:"object",properties:{method:{type:"string"},params:!0}}}],result:{name:"wallet_invokeMethodResult",schema:!0},examples:[{name:"wallet_invokeMethodExample",params:[{name:"scope",value:"eip155:1"},{name:"request",value:{method:"eth_getBalance",params:[]}}],result:{name:"wallet_invokeMethodResult",value:"0x1"}}]},{name:"wallet_revokeSession",description:"The `wallet_revokeSession` method revokes the entire active session.",params:[],result:{name:"wallet_revokeSessionResult",schema:{type:"boolean"}},examples:[{name:"wallet_revokeSessionExample",params:[],result:{name:"wallet_revokeSessionExampleResult",value:!0}}],errors:[{$ref:"#/components/errors/UnknownError"}]},{name:"wallet_sessionChanged",paramStructure:"by-name",description:"This notification is published by the wallet to notify the callers of updates to a shared session's authorization scopes. The event payload contains the new `sessionScopes`.",params:[{name:"sessionScopes",schema:{$ref:"#/components/schemas/SessionScopes"}}],examples:[{name:"wallet_sessionChangedExample",description:"Example of a wallet_sessionChanged notification.",params:[{name:"sessionScopes",value:{"eip155:1337":{accounts:["eip155:1337:0x5cfe73b6021e818b776b421b1c4db2474086a7e1"],methods:["personal_sign","eth_signTypedData_v4","wallet_watchAsset","eth_sendTransaction","eth_decrypt","eth_getEncryptionPublicKey","web3_clientVersion","eth_subscribe","eth_unsubscribe","wallet_swapAsset","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter"],notifications:["eth_subscription"]},wallet:{accounts:[],methods:["wallet_registerOnboarding","wallet_scanQRCode"],notifications:[]},"wallet:eip155":{accounts:["wallet:eip155:0x5cfe73b6021e818b776b421b1c4db2474086a7e1"],methods:["wallet_addEthereumChain"],notifications:[]}}}]}]},{name:"wallet_getSession",description:"The `wallet_getSession` method returns an active session.",params:[],result:{name:"wallet_getSessionResult",schema:{type:"object",properties:{sessionScopes:{$ref:"#/components/schemas/SessionScopes"}}}},examples:[{name:"wallet_getSessionExample",description:"Example of a getSession request.",params:[],result:{name:"wallet_getSessionResultExample",value:{sessionScopes:{"eip155:1337":{accounts:["eip155:1337:0x5cfe73b6021e818b776b421b1c4db2474086a7e1"],methods:["personal_sign","eth_signTypedData_v4","wallet_watchAsset","eth_sendTransaction","eth_decrypt","eth_getEncryptionPublicKey","web3_clientVersion","eth_subscribe","eth_unsubscribe","wallet_swapAsset","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter"],notifications:["eth_subscription"]},wallet:{accounts:[],methods:["wallet_registerOnboarding","wallet_scanQRCode"],notifications:[]},"wallet:eip155":{accounts:["wallet:eip155:0x5cfe73b6021e818b776b421b1c4db2474086a7e1"],methods:["wallet_addEthereumChain"],notifications:[]}}}}}]},{name:"wallet_createSession",paramStructure:"by-name",params:[{name:"requiredScopes",description:"Scopes that the wallet must support in order to be used with this provider.",schema:{type:"object",patternProperties:{"[-a-z0-9]{3,8}(:[-_a-zA-Z0-9]{1,32})?":{$ref:"#/components/schemas/Scope"}}}},{name:"optionalScopes",description:"Scopes that the wallet may support in order to be used with this provider.",schema:{type:"object",patternProperties:{"[-a-z0-9]{3,8}(:[-_a-zA-Z0-9]{1,32})?":{$ref:"#/components/schemas/Scope"}}}},{name:"sessionProperties",description:"Properties that the wallet may use to determine if the session is valid.",schema:{type:"object"}}],result:{name:"wallet_createSessionResult",schema:{type:"object",properties:{sessionScopes:{$ref:"#/components/schemas/SessionScopes"},sessionProperties:{type:"object"}}}},examples:[{name:"wallet_createSessionEthExample",description:"Example of a createSession request.",params:[{name:"optionalScopes",value:{"eip155:1337":{methods:["wallet_watchAsset","eth_sendTransaction","eth_decrypt","eth_getEncryptionPublicKey","web3_clientVersion","eth_subscribe","eth_unsubscribe","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter"],notifications:["eth_subscription"]},wallet:{methods:["wallet_registerOnboarding","wallet_scanQRCode"],notifications:[]},"wallet:eip155":{methods:["wallet_addEthereumChain"],notifications:[]}}}],result:{name:"wallet_createSessionResultExample",value:{sessionProperties:{},sessionScopes:{"eip155:1337":{accounts:["eip155:1337:0x5cfe73b6021e818b776b421b1c4db2474086a7e1"],methods:["personal_sign","eth_signTypedData_v4","wallet_watchAsset","eth_sendTransaction","eth_decrypt","eth_getEncryptionPublicKey","web3_clientVersion","eth_subscribe","eth_unsubscribe","wallet_swapAsset","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter"],notifications:["eth_subscription"]},wallet:{accounts:[],methods:["wallet_registerOnboarding","wallet_scanQRCode"],notifications:[]},"wallet:eip155":{accounts:["wallet:eip155:0x5cfe73b6021e818b776b421b1c4db2474086a7e1"],methods:["wallet_addEthereumChain"],notifications:[]}}}}},{name:"wallet_createSessionEthUnsupportedMethodsExample",description:"Example of a createSession request with unsupported eip155 methods.",params:[{name:"optionalScopes",value:{"eip155:1337":{methods:["not_supported"],notifications:[]},wallet:{methods:[],notifications:[]},"wallet:eip155":{methods:[],notifications:[]}}}],result:{name:"wallet_createSessionEthUnsupportedMethodsResultExample",value:{sessionProperties:{},sessionScopes:{"eip155:1337":{accounts:["eip155:1337:0x5cfe73b6021e818b776b421b1c4db2474086a7e1"],methods:["personal_sign","eth_signTypedData_v4","wallet_watchAsset","eth_sendTransaction","eth_decrypt","eth_getEncryptionPublicKey","web3_clientVersion","eth_subscribe","eth_unsubscribe","wallet_swapAsset","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter"],notifications:["eth_subscription"]},wallet:{accounts:[],methods:["wallet_registerOnboarding","wallet_scanQRCode"],notifications:[]},"wallet:eip155":{accounts:["wallet:eip155:0x5cfe73b6021e818b776b421b1c4db2474086a7e1"],methods:["wallet_addEthereumChain"],notifications:[]}}}}},{name:"wallet_createSessionUnsupportedScopesExample",description:"Example of a createSession request with unsupported scopes.",params:[{name:"optionalScopes",value:{foobar:{methods:["eth_getBalance"],notifications:["eth_subscription"]},"eip155:1":{accounts:["eip155:1:0x5cfe73b6021e818b776b421b1c4db2474086a7e1"],methods:["personal_sign","eth_signTypedData_v4","wallet_watchAsset","eth_sendTransaction","eth_decrypt","eth_getEncryptionPublicKey","web3_clientVersion","eth_subscribe","eth_unsubscribe","wallet_swapAsset","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter"],notifications:["eth_subscription"]}}}],result:{name:"wallet_createSessionUnsupportedScopesResultExample",value:{sessionProperties:{},sessionScopes:{"eip155:1":{accounts:["eip155:1:0x5cfe73b6021e818b776b421b1c4db2474086a7e1"],methods:["personal_sign","eth_signTypedData_v4","wallet_watchAsset","eth_sendTransaction","eth_decrypt","eth_getEncryptionPublicKey","web3_clientVersion","eth_subscribe","eth_unsubscribe","wallet_swapAsset","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter"],notifications:["eth_subscription"]}}}}}],errors:[{$ref:"#/components/errors/UnknownError"},{code:5100,message:"Requested networks are not supported"},{code:5101,message:"Requested methods are not supported"},{code:5102,message:"Requested notifications are not supported"},{code:5300,message:"Invalid scopedProperties requested"},{code:5301,message:"scopedProperties can only be outside of sessionScopes"},{code:5302,message:"Invalid sessionProperties requested"}]}],components:{errors:{UnknownError:{code:5e3,message:"Unknown error with request"}},schemas:{SessionScopes:{type:"object",patternProperties:{"[-a-z0-9]{3,8}(:[-_a-zA-Z0-9]{1,32})?":{$ref:"#/components/schemas/Scope"}}},ScopeString:{type:"string",pattern:"[-a-z0-9]{3,8}(:[-_a-zA-Z0-9]{1,32})?"},Scope:{type:"object",title:"Scope",description:"Scope for a multi-chain connection",additionalProperties:!0,required:["notifications","methods"],properties:{scopes:{type:"array",items:{$ref:"#/components/schemas/ScopeString"}},methods:{description:"Methods that the wallet must support in order to be used with this provider.",type:"array",items:{type:"string"}},notifications:{description:"Notifications that the wallet must support in order to be used with this provider.",type:"array",items:{type:"string"}},rpcEndpoints:{description:"JSON-RPC endpoints for this namespace.",type:"array",items:{type:"string",format:"uri"}},rpcDocuments:{type:"array",description:"OpenRPC documents that define RPC methods in which to anchor the methods authorized in a CAIP-25 interaction.",items:{type:"string",format:"uri"}}}}}}}}}},{package:"@metamask/multichain-api-middleware>@metamask/api-specs",file:"node_modules/@metamask/multichain-api-middleware/node_modules/@metamask/api-specs/dist/build/multichain-openrpc.json"}]],[],{});